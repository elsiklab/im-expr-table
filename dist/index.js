!function t(e,n,r){function i(s,a){if(!n[s]){if(!e[s]){var u="function"==typeof require&&require;if(!a&&u)return u(s,!0);if(o)return o(s,!0);throw new Error("Cannot find module '"+s+"'")}var l=n[s]={exports:{}};e[s][0].call(l.exports,function(t){var n=e[s][1][t];return i(n?n:t)},l,l.exports,t,e,n,r)}return n[s].exports}for(var o="function"==typeof require&&require,s=0;s<r.length;s++)i(r[s]);return i}({1:[function(t,e,n){function r(t){var e=a("#my-id"),n={root:"http://www.bovinegenome.org/bovinemine"},r={model:{name:"genomic"},select:["Expression.sampleName","Expression.fpkm","Expression.normalizedCounts","Expression.sampleMetadata.tissue"],orderBy:[{"Expression.fpkm":"DESC"}],where:[{path:"Expression.isoform",op:"LOOKUP",code:"A",value:t}]};i.configure({TableCell:{PreviewTrigger:"click"}}),i.configure("TableResults.CacheFactor",20),i.formatting.registerFormatter(s,"genomic","Expression",["sampleName"]),i.loadTable(e,{start:0,size:25},{service:n,query:r}).then(function(t){a("#message").html("Powered by <a href='http://bovinegenome.org/bovinemine/'>BovineMine</a>")},function(t){console.error("Could not load table",t)})}var i=t("im-tables"),o=t("./js/util"),s=t("./js/formatter"),a=t("jquery"),u=o.getParameterByName("transcript_id");u&&(a("#transcript_id").val(u),r(u)),a("form").submit(function(){var t=a("#transcript_id").val();return r(t),!1})},{"./js/formatter":2,"./js/util":4,"im-tables":45,jquery:309}],2:[function(t,e,n){{var r=t("./non-escaping-simple-formatter");t("underscore")}e.exports=r("Expression",["sampleName"],function(t){var e=t.sampleName,n=e+","+e+"_XYPlot,"+e+"_Density,"+e+"_cufflinks_chr_2015_09_02_transcripts,"+e+"_tophat_chr_2015_09_02_junctions";return e+" [<a href=http://bovinegenome.org:8080/Btau_4.6.1/jbrowse/?loc="+$("#transcript_id").val()+"&tracks="+n+">JBrowse</a>]"})},{"./non-escaping-simple-formatter":3,underscore:310}],3:[function(t,e,n){(function(){var n,r,i,o,s,a=[].slice;s=t("underscore"),r=s.compose,i=s.escape,o=t("im-tables/build/utils/ensure-required-data"),n=function(t){return function(){var e,n;return n=arguments[0],e=2<=arguments.length?a.call(arguments,1):[],t.apply(null,e)}},e.exports=function(t,e,i,s){return{classes:s,target:t,replaces:e,call:n(r(i,o(t,e)))}}}).call(this)},{"im-tables/build/utils/ensure-required-data":110,underscore:310}],4:[function(t,e,n){e.exports={filter:function(t,e){for(var n,r=[],i=0,o=t.length;o>i;i++)n=t[i],e(n)&&r.push(n);return r},explode:function(t,e){if(t=t.replace(/  +/g," ").replace(/^ /,"").replace(/ $/,""),"undefined"==typeof t)return"";if("undefined"==typeof e&&(e=30),t.length<=e)return t;var n=t.substring(0,e);if(t=t.substring(e)," "!==t.charAt(0)){for(;" "!==n.charAt(n.length-1)&&n.length>0;)t=n.charAt(n.length-1)+t,n=n.substring(0,n.length-1);0==n.length?(n=t.substring(0,e),t=t.substring(e)):n=n.substring(0,n.length-1)}else t=t.substring(1);return n+"\n"+this.explode(t,e)},getParameterByName:function(t){t=t.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var e=new RegExp("[\\?&]"+t+"=([^&#]*)"),n=e.exec(location.search);return null===n?"":decodeURIComponent(n[1].replace(/\+/g," "))}}},{}],5:[function(t,e,n){},{}],6:[function(t,e,n){function r(t,e,n){if(!(this instanceof r))return new r(t,e,n);var i=typeof t;if("base64"===e&&"string"===i)for(t=k(t);t.length%4!==0;)t+="=";var o;if("number"===i)o=P(t);else if("string"===i)o=r.byteLength(t,e);else{if("object"!==i)throw new Error("First argument needs to be a number, array or string.");o=P(t.length)}var s;r._useTypedArrays?s=r._augment(new Uint8Array(o)):(s=this,s.length=o,s._isBuffer=!0);var a;if(r._useTypedArrays&&"number"==typeof t.byteLength)s._set(t);else if(A(t))for(a=0;o>a;a++)s[a]=r.isBuffer(t)?t.readUInt8(a):t[a];else if("string"===i)s.write(t,0,e);else if("number"===i&&!r._useTypedArrays&&!n)for(a=0;o>a;a++)s[a]=0;return s}function i(t,e,n,i){n=Number(n)||0;var o=t.length-n;i?(i=Number(i),i>o&&(i=o)):i=o;var s=e.length;H(s%2===0,"Invalid hex string"),i>s/2&&(i=s/2);for(var a=0;i>a;a++){var u=parseInt(e.substr(2*a,2),16);H(!isNaN(u),"Invalid hex string"),t[n+a]=u}return r._charsWritten=2*a,a}function o(t,e,n,i){var o=r._charsWritten=j(I(e),t,n,i);return o}function s(t,e,n,i){var o=r._charsWritten=j(D(e),t,n,i);return o}function a(t,e,n,r){return s(t,e,n,r)}function u(t,e,n,i){var o=r._charsWritten=j(q(e),t,n,i);return o}function l(t,e,n,i){var o=r._charsWritten=j(L(e),t,n,i);return o}function c(t,e,n){return B.fromByteArray(0===e&&n===t.length?t:t.slice(e,n))}function h(t,e,n){var r="",i="";n=Math.min(t.length,n);for(var o=e;n>o;o++)t[o]<=127?(r+=$(i)+String.fromCharCode(t[o]),i=""):i+="%"+t[o].toString(16);return r+$(i)}function p(t,e,n){var r="";n=Math.min(t.length,n);for(var i=e;n>i;i++)r+=String.fromCharCode(t[i]);return r}function f(t,e,n){return p(t,e,n)}function d(t,e,n){var r=t.length;(!e||0>e)&&(e=0),(!n||0>n||n>r)&&(n=r);for(var i="",o=e;n>o;o++)i+=R(t[o]);return i}function m(t,e,n){for(var r=t.slice(e,n),i="",o=0;o<r.length;o+=2)i+=String.fromCharCode(r[o]+256*r[o+1]);return i}function g(t,e,n,r){r||(H("boolean"==typeof n,"missing or invalid endian"),H(void 0!==e&&null!==e,"missing offset"),H(e+1<t.length,"Trying to read beyond buffer length"));var i=t.length;if(!(e>=i)){var o;return n?(o=t[e],i>e+1&&(o|=t[e+1]<<8)):(o=t[e]<<8,i>e+1&&(o|=t[e+1])),o}}function y(t,e,n,r){r||(H("boolean"==typeof n,"missing or invalid endian"),H(void 0!==e&&null!==e,"missing offset"),H(e+3<t.length,"Trying to read beyond buffer length"));var i=t.length;if(!(e>=i)){var o;return n?(i>e+2&&(o=t[e+2]<<16),i>e+1&&(o|=t[e+1]<<8),o|=t[e],i>e+3&&(o+=t[e+3]<<24>>>0)):(i>e+1&&(o=t[e+1]<<16),i>e+2&&(o|=t[e+2]<<8),i>e+3&&(o|=t[e+3]),o+=t[e]<<24>>>0),o}}function v(t,e,n,r){r||(H("boolean"==typeof n,"missing or invalid endian"),H(void 0!==e&&null!==e,"missing offset"),H(e+1<t.length,"Trying to read beyond buffer length"));var i=t.length;if(!(e>=i)){var o=g(t,e,n,!0),s=32768&o;return s?-1*(65535-o+1):o}}function b(t,e,n,r){r||(H("boolean"==typeof n,"missing or invalid endian"),H(void 0!==e&&null!==e,"missing offset"),H(e+3<t.length,"Trying to read beyond buffer length"));var i=t.length;if(!(e>=i)){var o=y(t,e,n,!0),s=2147483648&o;return s?-1*(4294967295-o+1):o}}function _(t,e,n,r){return r||(H("boolean"==typeof n,"missing or invalid endian"),H(e+3<t.length,"Trying to read beyond buffer length")),V.read(t,e,n,23,4)}function w(t,e,n,r){return r||(H("boolean"==typeof n,"missing or invalid endian"),H(e+7<t.length,"Trying to read beyond buffer length")),V.read(t,e,n,52,8)}function x(t,e,n,r,i){i||(H(void 0!==e&&null!==e,"missing value"),H("boolean"==typeof r,"missing or invalid endian"),H(void 0!==n&&null!==n,"missing offset"),H(n+1<t.length,"trying to write beyond buffer length"),F(e,65535));var o=t.length;if(!(n>=o))for(var s=0,a=Math.min(o-n,2);a>s;s++)t[n+s]=(e&255<<8*(r?s:1-s))>>>8*(r?s:1-s)}function C(t,e,n,r,i){i||(H(void 0!==e&&null!==e,"missing value"),H("boolean"==typeof r,"missing or invalid endian"),H(void 0!==n&&null!==n,"missing offset"),H(n+3<t.length,"trying to write beyond buffer length"),F(e,4294967295));var o=t.length;if(!(n>=o))for(var s=0,a=Math.min(o-n,4);a>s;s++)t[n+s]=e>>>8*(r?s:3-s)&255}function T(t,e,n,r,i){i||(H(void 0!==e&&null!==e,"missing value"),H("boolean"==typeof r,"missing or invalid endian"),H(void 0!==n&&null!==n,"missing offset"),H(n+1<t.length,"Trying to write beyond buffer length"),z(e,32767,-32768));var o=t.length;n>=o||(e>=0?x(t,e,n,r,i):x(t,65535+e+1,n,r,i))}function S(t,e,n,r,i){i||(H(void 0!==e&&null!==e,"missing value"),H("boolean"==typeof r,"missing or invalid endian"),H(void 0!==n&&null!==n,"missing offset"),H(n+3<t.length,"Trying to write beyond buffer length"),z(e,2147483647,-2147483648));var o=t.length;n>=o||(e>=0?C(t,e,n,r,i):C(t,4294967295+e+1,n,r,i))}function E(t,e,n,r,i){i||(H(void 0!==e&&null!==e,"missing value"),H("boolean"==typeof r,"missing or invalid endian"),H(void 0!==n&&null!==n,"missing offset"),H(n+3<t.length,"Trying to write beyond buffer length"),U(e,3.4028234663852886e38,-3.4028234663852886e38));var o=t.length;n>=o||V.write(t,e,n,r,23,4)}function N(t,e,n,r,i){i||(H(void 0!==e&&null!==e,"missing value"),H("boolean"==typeof r,"missing or invalid endian"),H(void 0!==n&&null!==n,"missing offset"),H(n+7<t.length,"Trying to write beyond buffer length"),U(e,1.7976931348623157e308,-1.7976931348623157e308));var o=t.length;n>=o||V.write(t,e,n,r,52,8)}function k(t){return t.trim?t.trim():t.replace(/^\s+|\s+$/g,"")}function M(t,e,n){return"number"!=typeof t?n:(t=~~t,t>=e?e:t>=0?t:(t+=e,t>=0?t:0))}function P(t){return t=~~Math.ceil(+t),0>t?0:t}function O(t){return(Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)})(t)}function A(t){return O(t)||r.isBuffer(t)||t&&"object"==typeof t&&"number"==typeof t.length}function R(t){return 16>t?"0"+t.toString(16):t.toString(16)}function I(t){for(var e=[],n=0;n<t.length;n++){var r=t.charCodeAt(n);if(127>=r)e.push(t.charCodeAt(n));else{var i=n;r>=55296&&57343>=r&&n++;for(var o=encodeURIComponent(t.slice(i,n+1)).substr(1).split("%"),s=0;s<o.length;s++)e.push(parseInt(o[s],16))}}return e}function D(t){for(var e=[],n=0;n<t.length;n++)e.push(255&t.charCodeAt(n));return e}function L(t){for(var e,n,r,i=[],o=0;o<t.length;o++)e=t.charCodeAt(o),n=e>>8,r=e%256,i.push(r),i.push(n);return i}function q(t){return B.toByteArray(t)}function j(t,e,n,r){for(var i=0;r>i&&!(i+n>=e.length||i>=t.length);i++)e[i+n]=t[i];return i}function $(t){try{return decodeURIComponent(t)}catch(e){return String.fromCharCode(65533)}}function F(t,e){H("number"==typeof t,"cannot write a non-number as a number"),H(t>=0,"specified a negative value for writing an unsigned value"),H(e>=t,"value is larger than maximum value for type"),H(Math.floor(t)===t,"value has a fractional component")}function z(t,e,n){H("number"==typeof t,"cannot write a non-number as a number"),H(e>=t,"value larger than maximum allowed value"),H(t>=n,"value smaller than minimum allowed value"),H(Math.floor(t)===t,"value has a fractional component")}function U(t,e,n){H("number"==typeof t,"cannot write a non-number as a number"),H(e>=t,"value larger than maximum allowed value"),H(t>=n,"value smaller than minimum allowed value")}function H(t,e){if(!t)throw new Error(e||"Failed assertion")}var B=t("base64-js"),V=t("ieee754");n.Buffer=r,n.SlowBuffer=r,n.INSPECT_MAX_BYTES=50,r.poolSize=8192,r._useTypedArrays=function(){try{var t=new ArrayBuffer(0),e=new Uint8Array(t);return e.foo=function(){return 42},42===e.foo()&&"function"==typeof e.subarray}catch(n){return!1}}(),r.isEncoding=function(t){switch(String(t).toLowerCase()){case"hex":case"utf8":case"utf-8":case"ascii":case"binary":case"base64":case"raw":case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":return!0;default:return!1}},r.isBuffer=function(t){return!(null===t||void 0===t||!t._isBuffer)},r.byteLength=function(t,e){var n;switch(t+="",e||"utf8"){case"hex":n=t.length/2;break;case"utf8":case"utf-8":n=I(t).length;break;case"ascii":case"binary":case"raw":n=t.length;break;case"base64":n=q(t).length;break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":n=2*t.length;break;default:throw new Error("Unknown encoding")}return n},r.concat=function(t,e){if(H(O(t),"Usage: Buffer.concat(list, [totalLength])\nlist should be an Array."),0===t.length)return new r(0);if(1===t.length)return t[0];var n;if("number"!=typeof e)for(e=0,n=0;n<t.length;n++)e+=t[n].length;var i=new r(e),o=0;for(n=0;n<t.length;n++){var s=t[n];s.copy(i,o),o+=s.length}return i},r.prototype.write=function(t,e,n,r){if(isFinite(e))isFinite(n)||(r=n,n=void 0);else{var c=r;r=e,e=n,n=c}e=Number(e)||0;var h=this.length-e;n?(n=Number(n),n>h&&(n=h)):n=h,r=String(r||"utf8").toLowerCase();var p;switch(r){case"hex":p=i(this,t,e,n);break;case"utf8":case"utf-8":p=o(this,t,e,n);break;case"ascii":p=s(this,t,e,n);break;case"binary":p=a(this,t,e,n);break;case"base64":p=u(this,t,e,n);break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":p=l(this,t,e,n);break;default:throw new Error("Unknown encoding")}return p},r.prototype.toString=function(t,e,n){var r=this;if(t=String(t||"utf8").toLowerCase(),e=Number(e)||0,n=void 0!==n?Number(n):n=r.length,n===e)return"";var i;switch(t){case"hex":i=d(r,e,n);break;case"utf8":case"utf-8":i=h(r,e,n);break;case"ascii":i=p(r,e,n);break;case"binary":i=f(r,e,n);break;case"base64":i=c(r,e,n);break;case"ucs2":case"ucs-2":case"utf16le":case"utf-16le":i=m(r,e,n);break;default:throw new Error("Unknown encoding")}return i},r.prototype.toJSON=function(){return{type:"Buffer",data:Array.prototype.slice.call(this._arr||this,0)}},r.prototype.copy=function(t,e,n,i){var o=this;if(n||(n=0),i||0===i||(i=this.length),e||(e=0),i!==n&&0!==t.length&&0!==o.length){H(i>=n,"sourceEnd < sourceStart"),H(e>=0&&e<t.length,"targetStart out of bounds"),H(n>=0&&n<o.length,"sourceStart out of bounds"),H(i>=0&&i<=o.length,"sourceEnd out of bounds"),i>this.length&&(i=this.length),t.length-e<i-n&&(i=t.length-e+n);var s=i-n;if(100>s||!r._useTypedArrays)for(var a=0;s>a;a++)t[a+e]=this[a+n];else t._set(this.subarray(n,n+s),e)}},r.prototype.slice=function(t,e){var n=this.length;if(t=M(t,n,0),e=M(e,n,n),r._useTypedArrays)return r._augment(this.subarray(t,e));for(var i=e-t,o=new r(i,void 0,!0),s=0;i>s;s++)o[s]=this[s+t];return o},r.prototype.get=function(t){return console.log(".get() is deprecated. Access using array indexes instead."),this.readUInt8(t)},r.prototype.set=function(t,e){return console.log(".set() is deprecated. Access using array indexes instead."),this.writeUInt8(t,e)},r.prototype.readUInt8=function(t,e){return e||(H(void 0!==t&&null!==t,"missing offset"),H(t<this.length,"Trying to read beyond buffer length")),t>=this.length?void 0:this[t]},r.prototype.readUInt16LE=function(t,e){return g(this,t,!0,e)},r.prototype.readUInt16BE=function(t,e){return g(this,t,!1,e)},r.prototype.readUInt32LE=function(t,e){return y(this,t,!0,e)},r.prototype.readUInt32BE=function(t,e){return y(this,t,!1,e)},r.prototype.readInt8=function(t,e){if(e||(H(void 0!==t&&null!==t,"missing offset"),H(t<this.length,"Trying to read beyond buffer length")),!(t>=this.length)){var n=128&this[t];return n?-1*(255-this[t]+1):this[t]}},r.prototype.readInt16LE=function(t,e){return v(this,t,!0,e)},r.prototype.readInt16BE=function(t,e){return v(this,t,!1,e)},r.prototype.readInt32LE=function(t,e){return b(this,t,!0,e)},r.prototype.readInt32BE=function(t,e){return b(this,t,!1,e)},r.prototype.readFloatLE=function(t,e){return _(this,t,!0,e)},r.prototype.readFloatBE=function(t,e){return _(this,t,!1,e)},r.prototype.readDoubleLE=function(t,e){return w(this,t,!0,e)},r.prototype.readDoubleBE=function(t,e){return w(this,t,!1,e)},r.prototype.writeUInt8=function(t,e,n){n||(H(void 0!==t&&null!==t,"missing value"),H(void 0!==e&&null!==e,"missing offset"),H(e<this.length,"trying to write beyond buffer length"),F(t,255)),e>=this.length||(this[e]=t)},r.prototype.writeUInt16LE=function(t,e,n){x(this,t,e,!0,n)},r.prototype.writeUInt16BE=function(t,e,n){x(this,t,e,!1,n)},r.prototype.writeUInt32LE=function(t,e,n){C(this,t,e,!0,n)},r.prototype.writeUInt32BE=function(t,e,n){C(this,t,e,!1,n)},r.prototype.writeInt8=function(t,e,n){n||(H(void 0!==t&&null!==t,"missing value"),H(void 0!==e&&null!==e,"missing offset"),H(e<this.length,"Trying to write beyond buffer length"),z(t,127,-128)),e>=this.length||(t>=0?this.writeUInt8(t,e,n):this.writeUInt8(255+t+1,e,n))},r.prototype.writeInt16LE=function(t,e,n){T(this,t,e,!0,n)},r.prototype.writeInt16BE=function(t,e,n){T(this,t,e,!1,n)},r.prototype.writeInt32LE=function(t,e,n){S(this,t,e,!0,n)},r.prototype.writeInt32BE=function(t,e,n){S(this,t,e,!1,n)},r.prototype.writeFloatLE=function(t,e,n){E(this,t,e,!0,n)},r.prototype.writeFloatBE=function(t,e,n){E(this,t,e,!1,n)},r.prototype.writeDoubleLE=function(t,e,n){N(this,t,e,!0,n)},r.prototype.writeDoubleBE=function(t,e,n){N(this,t,e,!1,n)},r.prototype.fill=function(t,e,n){if(t||(t=0),e||(e=0),n||(n=this.length),"string"==typeof t&&(t=t.charCodeAt(0)),H("number"==typeof t&&!isNaN(t),"value is not a number"),H(n>=e,"end < start"),n!==e&&0!==this.length){H(e>=0&&e<this.length,"start out of bounds"),H(n>=0&&n<=this.length,"end out of bounds");for(var r=e;n>r;r++)this[r]=t}},r.prototype.inspect=function(){for(var t=[],e=this.length,r=0;e>r;r++)if(t[r]=R(this[r]),r===n.INSPECT_MAX_BYTES){t[r+1]="...";break}return"<Buffer "+t.join(" ")+">"},r.prototype.toArrayBuffer=function(){if("undefined"!=typeof Uint8Array){if(r._useTypedArrays)return new r(this).buffer;for(var t=new Uint8Array(this.length),e=0,n=t.length;n>e;e+=1)t[e]=this[e];return t.buffer}throw new Error("Buffer.toArrayBuffer not supported in this browser")};var W=r.prototype;r._augment=function(t){return t._isBuffer=!0,t._get=t.get,t._set=t.set,t.get=W.get,t.set=W.set,t.write=W.write,t.toString=W.toString,t.toLocaleString=W.toString,t.toJSON=W.toJSON,t.copy=W.copy,t.slice=W.slice,t.readUInt8=W.readUInt8,t.readUInt16LE=W.readUInt16LE,t.readUInt16BE=W.readUInt16BE,t.readUInt32LE=W.readUInt32LE,t.readUInt32BE=W.readUInt32BE,t.readInt8=W.readInt8,t.readInt16LE=W.readInt16LE,t.readInt16BE=W.readInt16BE,t.readInt32LE=W.readInt32LE,t.readInt32BE=W.readInt32BE,t.readFloatLE=W.readFloatLE,t.readFloatBE=W.readFloatBE,t.readDoubleLE=W.readDoubleLE,t.readDoubleBE=W.readDoubleBE,t.writeUInt8=W.writeUInt8,t.writeUInt16LE=W.writeUInt16LE,t.writeUInt16BE=W.writeUInt16BE,t.writeUInt32LE=W.writeUInt32LE,t.writeUInt32BE=W.writeUInt32BE,t.writeInt8=W.writeInt8,t.writeInt16LE=W.writeInt16LE,t.writeInt16BE=W.writeInt16BE,t.writeInt32LE=W.writeInt32LE,t.writeInt32BE=W.writeInt32BE,t.writeFloatLE=W.writeFloatLE,t.writeFloatBE=W.writeFloatBE,t.writeDoubleLE=W.writeDoubleLE,t.writeDoubleBE=W.writeDoubleBE,t.fill=W.fill,t.inspect=W.inspect,t.toArrayBuffer=W.toArrayBuffer,t}},{"base64-js":7,ieee754:8}],7:[function(t,e,n){var r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";!function(t){"use strict";function e(t){var e=t.charCodeAt(0);return e===s||e===h?62:e===a||e===p?63:u>e?-1:u+10>e?e-u+26+26:c+26>e?e-c:l+26>e?e-l+26:void 0}function n(t){function n(t){l[h++]=t}var r,i,s,a,u,l;if(t.length%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var c=t.length;u="="===t.charAt(c-2)?2:"="===t.charAt(c-1)?1:0,l=new o(3*t.length/4-u),s=u>0?t.length-4:t.length;var h=0;for(r=0,i=0;s>r;r+=4,i+=3)a=e(t.charAt(r))<<18|e(t.charAt(r+1))<<12|e(t.charAt(r+2))<<6|e(t.charAt(r+3)),n((16711680&a)>>16),n((65280&a)>>8),n(255&a);return 2===u?(a=e(t.charAt(r))<<2|e(t.charAt(r+1))>>4,n(255&a)):1===u&&(a=e(t.charAt(r))<<10|e(t.charAt(r+1))<<4|e(t.charAt(r+2))>>2,n(a>>8&255),n(255&a)),l}function i(t){function e(t){return r.charAt(t)}function n(t){return e(t>>18&63)+e(t>>12&63)+e(t>>6&63)+e(63&t)}var i,o,s,a=t.length%3,u="";for(i=0,s=t.length-a;s>i;i+=3)o=(t[i]<<16)+(t[i+1]<<8)+t[i+2],u+=n(o);switch(a){case 1:o=t[t.length-1],u+=e(o>>2),u+=e(o<<4&63),u+="==";break;case 2:o=(t[t.length-2]<<8)+t[t.length-1],u+=e(o>>10),u+=e(o>>4&63),u+=e(o<<2&63),u+="="}return u}var o="undefined"!=typeof Uint8Array?Uint8Array:Array,s="+".charCodeAt(0),a="/".charCodeAt(0),u="0".charCodeAt(0),l="a".charCodeAt(0),c="A".charCodeAt(0),h="-".charCodeAt(0),p="_".charCodeAt(0);t.toByteArray=n,t.fromByteArray=i}("undefined"==typeof n?this.base64js={}:n)},{}],8:[function(t,e,n){n.read=function(t,e,n,r,i){var o,s,a=8*i-r-1,u=(1<<a)-1,l=u>>1,c=-7,h=n?i-1:0,p=n?-1:1,f=t[e+h];for(h+=p,o=f&(1<<-c)-1,f>>=-c,c+=a;c>0;o=256*o+t[e+h],h+=p,c-=8);for(s=o&(1<<-c)-1,o>>=-c,c+=r;c>0;s=256*s+t[e+h],h+=p,c-=8);if(0===o)o=1-l;else{if(o===u)return s?0/0:(f?-1:1)*(1/0);s+=Math.pow(2,r),o-=l}return(f?-1:1)*s*Math.pow(2,o-r)},n.write=function(t,e,n,r,i,o){var s,a,u,l=8*o-i-1,c=(1<<l)-1,h=c>>1,p=23===i?Math.pow(2,-24)-Math.pow(2,-77):0,f=r?0:o-1,d=r?1:-1,m=0>e||0===e&&0>1/e?1:0;for(e=Math.abs(e),isNaN(e)||e===1/0?(a=isNaN(e)?1:0,s=c):(s=Math.floor(Math.log(e)/Math.LN2),e*(u=Math.pow(2,-s))<1&&(s--,u*=2),e+=s+h>=1?p/u:p*Math.pow(2,1-h),e*u>=2&&(s++,u/=2),s+h>=c?(a=0,s=c):s+h>=1?(a=(e*u-1)*Math.pow(2,i),s+=h):(a=e*Math.pow(2,h-1)*Math.pow(2,i),s=0));i>=8;t[n+f]=255&a,f+=d,a/=256,i-=8);for(s=s<<i|a,l+=i;l>0;t[n+f]=255&s,f+=d,s/=256,l-=8);t[n+f-d]|=128*m}},{}],9:[function(t,e,n){function r(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function i(t){return"function"==typeof t}function o(t){return"number"==typeof t}function s(t){return"object"==typeof t&&null!==t}function a(t){return void 0===t}e.exports=r,r.EventEmitter=r,r.prototype._events=void 0,r.prototype._maxListeners=void 0,r.defaultMaxListeners=10,r.prototype.setMaxListeners=function(t){if(!o(t)||0>t||isNaN(t))throw TypeError("n must be a positive number");return this._maxListeners=t,this},r.prototype.emit=function(t){var e,n,r,o,u,l;if(this._events||(this._events={}),"error"===t&&(!this._events.error||s(this._events.error)&&!this._events.error.length)){if(e=arguments[1],e instanceof Error)throw e;throw TypeError('Uncaught, unspecified "error" event.')}if(n=this._events[t],a(n))return!1;if(i(n))switch(arguments.length){case 1:n.call(this);break;case 2:n.call(this,arguments[1]);break;case 3:n.call(this,arguments[1],arguments[2]);break;default:for(r=arguments.length,o=new Array(r-1),u=1;r>u;u++)o[u-1]=arguments[u];n.apply(this,o)}else if(s(n)){for(r=arguments.length,o=new Array(r-1),u=1;r>u;u++)o[u-1]=arguments[u];for(l=n.slice(),r=l.length,u=0;r>u;u++)l[u].apply(this,o)}return!0},r.prototype.addListener=function(t,e){var n;if(!i(e))throw TypeError("listener must be a function");if(this._events||(this._events={}),this._events.newListener&&this.emit("newListener",t,i(e.listener)?e.listener:e),this._events[t]?s(this._events[t])?this._events[t].push(e):this._events[t]=[this._events[t],e]:this._events[t]=e,s(this._events[t])&&!this._events[t].warned){var n;n=a(this._maxListeners)?r.defaultMaxListeners:this._maxListeners,n&&n>0&&this._events[t].length>n&&(this._events[t].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[t].length),"function"==typeof console.trace&&console.trace())}return this},r.prototype.on=r.prototype.addListener,r.prototype.once=function(t,e){function n(){this.removeListener(t,n),r||(r=!0,e.apply(this,arguments))}if(!i(e))throw TypeError("listener must be a function");var r=!1;return n.listener=e,this.on(t,n),this},r.prototype.removeListener=function(t,e){var n,r,o,a;if(!i(e))throw TypeError("listener must be a function");if(!this._events||!this._events[t])return this;if(n=this._events[t],o=n.length,r=-1,n===e||i(n.listener)&&n.listener===e)delete this._events[t],this._events.removeListener&&this.emit("removeListener",t,e);else if(s(n)){for(a=o;a-->0;)if(n[a]===e||n[a].listener&&n[a].listener===e){r=a;break}if(0>r)return this;1===n.length?(n.length=0,delete this._events[t]):n.splice(r,1),this._events.removeListener&&this.emit("removeListener",t,e)}return this},r.prototype.removeAllListeners=function(t){var e,n;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[t]&&delete this._events[t],this;if(0===arguments.length){for(e in this._events)"removeListener"!==e&&this.removeAllListeners(e);return this.removeAllListeners("removeListener"),this._events={},this}if(n=this._events[t],i(n))this.removeListener(t,n);else for(;n.length;)this.removeListener(t,n[n.length-1]);return delete this._events[t],this},r.prototype.listeners=function(t){var e;return e=this._events&&this._events[t]?i(this._events[t])?[this._events[t]]:this._events[t].slice():[]},r.listenerCount=function(t,e){var n;return n=t._events&&t._events[e]?i(t._events[e])?1:t._events[e].length:0}},{}],10:[function(t,e,n){var r=e.exports,i=(t("events").EventEmitter,t("./lib/request")),o=t("url");r.request=function(t,e){"string"==typeof t&&(t=o.parse(t)),t||(t={}),t.host||t.port||(t.port=parseInt(window.location.port,10)),!t.host&&t.hostname&&(t.host=t.hostname),t.scheme||(t.scheme=window.location.protocol.split(":")[0]),t.host||(t.host=window.location.hostname||window.location.host),/:/.test(t.host)&&(t.port||(t.port=t.host.split(":")[1]),t.host=t.host.split(":")[0]),t.port||(t.port="https"==t.scheme?443:80);var n=new i(new s,t);return e&&n.on("response",e),n},r.get=function(t,e){t.method="GET";var n=r.request(t,e);return n.end(),n},r.Agent=function(){},r.Agent.defaultMaxSockets=4;var s=function(){if("undefined"==typeof window)throw new Error("no window object present");if(window.XMLHttpRequest)return window.XMLHttpRequest;if(window.ActiveXObject){for(var t=["Msxml2.XMLHTTP.6.0","Msxml2.XMLHTTP.3.0","Microsoft.XMLHTTP"],e=0;e<t.length;e++)try{var n=new window.ActiveXObject(t[e]);return function(){if(n){var r=n;return n=null,r}return new window.ActiveXObject(t[e])}}catch(r){}throw new Error("ajax not supported in this browser")}throw new Error("ajax not supported in this browser")}();r.STATUS_CODES={100:"Continue",101:"Switching Protocols",102:"Processing",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",207:"Multi-Status",300:"Multiple Choices",301:"Moved Permanently",302:"Moved Temporarily",303:"See Other",304:"Not Modified",305:"Use Proxy",307:"Temporary Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Time-out",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Request Entity Too Large",414:"Request-URI Too Large",415:"Unsupported Media Type",416:"Requested Range Not Satisfiable",417:"Expectation Failed",418:"I'm a teapot",422:"Unprocessable Entity",423:"Locked",424:"Failed Dependency",425:"Unordered Collection",426:"Upgrade Required",428:"Precondition Required",429:"Too Many Requests",431:"Request Header Fields Too Large",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Time-out",505:"HTTP Version Not Supported",506:"Variant Also Negotiates",507:"Insufficient Storage",509:"Bandwidth Limit Exceeded",510:"Not Extended",511:"Network Authentication Required"}},{"./lib/request":11,events:9,url:28}],11:[function(t,e,n){var r=t("stream"),i=t("./response"),o=t("Base64"),s=t("inherits"),a=e.exports=function(t,e){var n=this;n.writable=!0,n.xhr=t,n.body=[],n.uri=(e.scheme||"http")+"://"+e.host+(e.port?":"+e.port:"")+(e.path||"/"),"undefined"==typeof e.withCredentials&&(e.withCredentials=!0);try{t.withCredentials=e.withCredentials}catch(r){}if(t.open(e.method||"GET",n.uri,!0),n._headers={},e.headers)for(var s=u(e.headers),a=0;a<s.length;a++){var l=s[a];if(n.isSafeRequestHeader(l)){var c=e.headers[l];n.setHeader(l,c)}}e.auth&&this.setHeader("Authorization","Basic "+o.btoa(e.auth));var h=new i;h.on("close",function(){n.emit("close")}),h.on("ready",function(){n.emit("response",h)}),t.onreadystatechange=function(){t.__aborted||h.handle(t)}};s(a,r),a.prototype.setHeader=function(t,e){this._headers[t.toLowerCase()]=e},a.prototype.getHeader=function(t){return this._headers[t.toLowerCase()]},a.prototype.removeHeader=function(t){delete this._headers[t.toLowerCase()]},a.prototype.write=function(t){this.body.push(t)},a.prototype.destroy=function(t){this.xhr.__aborted=!0,this.xhr.abort(),this.emit("close")},a.prototype.end=function(t){void 0!==t&&this.body.push(t);for(var e=u(this._headers),n=0;n<e.length;n++){var r=e[n],i=this._headers[r];if(l(i))for(var o=0;o<i.length;o++)this.xhr.setRequestHeader(r,i[o]);else this.xhr.setRequestHeader(r,i)}if(0===this.body.length)this.xhr.send("");else if("string"==typeof this.body[0])this.xhr.send(this.body.join(""));else if(l(this.body[0])){for(var s=[],n=0;n<this.body.length;n++)s.push.apply(s,this.body[n]);this.xhr.send(s)}else if(/Array/.test(Object.prototype.toString.call(this.body[0]))){for(var a=0,n=0;n<this.body.length;n++)a+=this.body[n].length;for(var s=new this.body[0].constructor(a),c=0,n=0;n<this.body.length;n++)for(var h=this.body[n],o=0;o<h.length;o++)s[c++]=h[o];this.xhr.send(s)}else{for(var s="",n=0;n<this.body.length;n++)s+=this.body[n].toString();this.xhr.send(s)}},a.unsafeHeaders=["accept-charset","accept-encoding","access-control-request-headers","access-control-request-method","connection","content-length","cookie","cookie2","content-transfer-encoding","date","expect","host","keep-alive","origin","referer","te","trailer","transfer-encoding","upgrade","user-agent","via"],a.prototype.isSafeRequestHeader=function(t){return t?-1===c(a.unsafeHeaders,t.toLowerCase()):!1};var u=Object.keys||function(t){var e=[];for(var n in t)e.push(n);return e},l=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},c=function(t,e){if(t.indexOf)return t.indexOf(e);for(var n=0;n<t.length;n++)if(t[n]===e)return n;return-1}},{"./response":12,Base64:13,inherits:14,stream:21}],12:[function(t,e,n){function r(t){for(var e=t.getAllResponseHeaders().split(/\r?\n/),n={},r=0;r<e.length;r++){var i=e[r];if(""!==i){var o=i.match(/^([^:]+):\s*(.*)/);if(o){var s=o[1].toLowerCase(),a=o[2];void 0!==n[s]?u(n[s])?n[s].push(a):n[s]=[n[s],a]:n[s]=a}else n[i]=!0}}return n}var i=t("stream"),o=t("util"),s=e.exports=function(t){this.offset=0,this.readable=!0};o.inherits(s,i);var a={streaming:!0,status2:!0};s.prototype.getResponse=function(t){var e=String(t.responseType).toLowerCase();return"blob"===e?t.responseBlob||t.response:"arraybuffer"===e?t.response:t.responseText},s.prototype.getHeader=function(t){return this.headers[t.toLowerCase()]},s.prototype.handle=function(t){if(2===t.readyState&&a.status2){try{this.statusCode=t.status,this.headers=r(t)}catch(e){a.status2=!1}a.status2&&this.emit("ready")}else if(a.streaming&&3===t.readyState){try{this.statusCode||(this.statusCode=t.status,this.headers=r(t),this.emit("ready"))}catch(e){}try{this._emitData(t)}catch(e){a.streaming=!1}}else 4===t.readyState&&(this.statusCode||(this.statusCode=t.status,this.emit("ready")),this._emitData(t),t.error?this.emit("error",this.getResponse(t)):this.emit("end"),this.emit("close"))},s.prototype._emitData=function(t){var e=this.getResponse(t);return e.toString().match(/ArrayBuffer/)?(this.emit("data",new Uint8Array(e,this.offset)),void(this.offset=e.byteLength)):void(e.length>this.offset&&(this.emit("data",e.slice(this.offset)),this.offset=e.length))};var u=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)}},{stream:21,util:30}],13:[function(t,e,n){!function(){function t(t){this.message=t}var e="undefined"!=typeof n?n:this,r="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";t.prototype=new Error,t.prototype.name="InvalidCharacterError",e.btoa||(e.btoa=function(e){for(var n,i,o=0,s=r,a="";e.charAt(0|o)||(s="=",o%1);a+=s.charAt(63&n>>8-o%1*8)){if(i=e.charCodeAt(o+=.75),i>255)throw new t("'btoa' failed: The string to be encoded contains characters outside of the Latin1 range.");n=n<<8|i}return a}),e.atob||(e.atob=function(e){if(e=e.replace(/=+$/,""),e.length%4==1)throw new t("'atob' failed: The string to be decoded is not correctly encoded.");for(var n,i,o=0,s=0,a="";i=e.charAt(s++);~i&&(n=o%4?64*n+i:i,o++%4)?a+=String.fromCharCode(255&n>>(-2*o&6)):0)i=r.indexOf(i);return a})}()},{}],14:[function(t,e,n){e.exports="function"==typeof Object.create?function(t,e){t.super_=e,t.prototype=Object.create(e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:function(t,e){t.super_=e;var n=function(){};n.prototype=e.prototype,t.prototype=new n,t.prototype.constructor=t}},{}],15:[function(t,e,n){function r(){}var i=e.exports={};i.nextTick=function(){var t="undefined"!=typeof window&&window.setImmediate,e="undefined"!=typeof window&&window.postMessage&&window.addEventListener;if(t)return function(t){return window.setImmediate(t)};if(e){var n=[];return window.addEventListener("message",function(t){var e=t.source;if((e===window||null===e)&&"process-tick"===t.data&&(t.stopPropagation(),n.length>0)){var r=n.shift();r()}},!0),function(t){
n.push(t),window.postMessage("process-tick","*")}}return function(t){setTimeout(t,0)}}(),i.title="browser",i.browser=!0,i.env={},i.argv=[],i.on=r,i.addListener=r,i.once=r,i.off=r,i.removeListener=r,i.removeAllListeners=r,i.emit=r,i.binding=function(t){throw new Error("process.binding is not supported")},i.cwd=function(){return"/"},i.chdir=function(t){throw new Error("process.chdir is not supported")}},{}],16:[function(t,e,n){(function(t){!function(r){function i(t){throw RangeError(R[t])}function o(t,e){for(var n=t.length;n--;)t[n]=e(t[n]);return t}function s(t,e){return o(t.split(A),e).join(".")}function a(t){for(var e,n,r=[],i=0,o=t.length;o>i;)e=t.charCodeAt(i++),e>=55296&&56319>=e&&o>i?(n=t.charCodeAt(i++),56320==(64512&n)?r.push(((1023&e)<<10)+(1023&n)+65536):(r.push(e),i--)):r.push(e);return r}function u(t){return o(t,function(t){var e="";return t>65535&&(t-=65536,e+=L(t>>>10&1023|55296),t=56320|1023&t),e+=L(t)}).join("")}function l(t){return 10>t-48?t-22:26>t-65?t-65:26>t-97?t-97:x}function c(t,e){return t+22+75*(26>t)-((0!=e)<<5)}function h(t,e,n){var r=0;for(t=n?D(t/E):t>>1,t+=D(t/e);t>I*T>>1;r+=x)t=D(t/I);return D(r+(I+1)*t/(t+S))}function p(t){var e,n,r,o,s,a,c,p,f,d,m=[],g=t.length,y=0,v=k,b=N;for(n=t.lastIndexOf(M),0>n&&(n=0),r=0;n>r;++r)t.charCodeAt(r)>=128&&i("not-basic"),m.push(t.charCodeAt(r));for(o=n>0?n+1:0;g>o;){for(s=y,a=1,c=x;o>=g&&i("invalid-input"),p=l(t.charCodeAt(o++)),(p>=x||p>D((w-y)/a))&&i("overflow"),y+=p*a,f=b>=c?C:c>=b+T?T:c-b,!(f>p);c+=x)d=x-f,a>D(w/d)&&i("overflow"),a*=d;e=m.length+1,b=h(y-s,e,0==s),D(y/e)>w-v&&i("overflow"),v+=D(y/e),y%=e,m.splice(y++,0,v)}return u(m)}function f(t){var e,n,r,o,s,u,l,p,f,d,m,g,y,v,b,_=[];for(t=a(t),g=t.length,e=k,n=0,s=N,u=0;g>u;++u)m=t[u],128>m&&_.push(L(m));for(r=o=_.length,o&&_.push(M);g>r;){for(l=w,u=0;g>u;++u)m=t[u],m>=e&&l>m&&(l=m);for(y=r+1,l-e>D((w-n)/y)&&i("overflow"),n+=(l-e)*y,e=l,u=0;g>u;++u)if(m=t[u],e>m&&++n>w&&i("overflow"),m==e){for(p=n,f=x;d=s>=f?C:f>=s+T?T:f-s,!(d>p);f+=x)b=p-d,v=x-d,_.push(L(c(d+b%v,0))),p=D(b/v);_.push(L(c(p,0))),s=h(n,y,r==o),n=0,++r}++n,++e}return _.join("")}function d(t){return s(t,function(t){return P.test(t)?p(t.slice(4).toLowerCase()):t})}function m(t){return s(t,function(t){return O.test(t)?"xn--"+f(t):t})}var g="object"==typeof n&&n,y="object"==typeof e&&e&&e.exports==g&&e,v="object"==typeof t&&t;(v.global===v||v.window===v)&&(r=v);var b,_,w=2147483647,x=36,C=1,T=26,S=38,E=700,N=72,k=128,M="-",P=/^xn--/,O=/[^ -~]/,A=/\x2E|\u3002|\uFF0E|\uFF61/g,R={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},I=x-C,D=Math.floor,L=String.fromCharCode;if(b={version:"1.2.4",ucs2:{decode:a,encode:u},decode:p,encode:f,toASCII:m,toUnicode:d},"function"==typeof define&&"object"==typeof define.amd&&define.amd)define("punycode",function(){return b});else if(g&&!g.nodeType)if(y)y.exports=b;else for(_ in b)b.hasOwnProperty(_)&&(g[_]=b[_]);else r.punycode=b}(this)}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],17:[function(t,e,n){"use strict";function r(t,e){return Object.prototype.hasOwnProperty.call(t,e)}e.exports=function(t,e,n,o){e=e||"&",n=n||"=";var s={};if("string"!=typeof t||0===t.length)return s;var a=/\+/g;t=t.split(e);var u=1e3;o&&"number"==typeof o.maxKeys&&(u=o.maxKeys);var l=t.length;u>0&&l>u&&(l=u);for(var c=0;l>c;++c){var h,p,f,d,m=t[c].replace(a,"%20"),g=m.indexOf(n);g>=0?(h=m.substr(0,g),p=m.substr(g+1)):(h=m,p=""),f=decodeURIComponent(h),d=decodeURIComponent(p),r(s,f)?i(s[f])?s[f].push(d):s[f]=[s[f],d]:s[f]=d}return s};var i=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)}},{}],18:[function(t,e,n){"use strict";function r(t,e){if(t.map)return t.map(e);for(var n=[],r=0;r<t.length;r++)n.push(e(t[r],r));return n}var i=function(t){switch(typeof t){case"string":return t;case"boolean":return t?"true":"false";case"number":return isFinite(t)?t:"";default:return""}};e.exports=function(t,e,n,a){return e=e||"&",n=n||"=",null===t&&(t=void 0),"object"==typeof t?r(s(t),function(r){var s=encodeURIComponent(i(r))+n;return o(t[r])?t[r].map(function(t){return s+encodeURIComponent(i(t))}).join(e):s+encodeURIComponent(i(t[r]))}).join(e):a?encodeURIComponent(i(a))+n+encodeURIComponent(i(t)):""};var o=Array.isArray||function(t){return"[object Array]"===Object.prototype.toString.call(t)},s=Object.keys||function(t){var e=[];for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&e.push(n);return e}},{}],19:[function(t,e,n){"use strict";n.decode=n.parse=t("./decode"),n.encode=n.stringify=t("./encode")},{"./decode":17,"./encode":18}],20:[function(t,e,n){function r(t){return this instanceof r?(a.call(this,t),u.call(this,t),t&&t.readable===!1&&(this.readable=!1),t&&t.writable===!1&&(this.writable=!1),this.allowHalfOpen=!0,t&&t.allowHalfOpen===!1&&(this.allowHalfOpen=!1),void this.once("end",i)):new r(t)}function i(){if(!this.allowHalfOpen&&!this._writableState.ended){var t=this;s(function(){t.end()})}}e.exports=r;var o=t("inherits"),s=t("process/browser.js").nextTick,a=t("./readable.js"),u=t("./writable.js");o(r,a),r.prototype.write=u.prototype.write,r.prototype.end=u.prototype.end,r.prototype._write=u.prototype._write},{"./readable.js":24,"./writable.js":26,inherits:14,"process/browser.js":22}],21:[function(t,e,n){function r(){i.call(this)}e.exports=r;var i=t("events").EventEmitter,o=t("inherits");o(r,i),r.Readable=t("./readable.js"),r.Writable=t("./writable.js"),r.Duplex=t("./duplex.js"),r.Transform=t("./transform.js"),r.PassThrough=t("./passthrough.js"),r.Stream=r,r.prototype.pipe=function(t,e){function n(e){t.writable&&!1===t.write(e)&&l.pause&&l.pause()}function r(){l.readable&&l.resume&&l.resume()}function o(){c||(c=!0,t.end())}function s(){c||(c=!0,"function"==typeof t.destroy&&t.destroy())}function a(t){if(u(),0===i.listenerCount(this,"error"))throw t}function u(){l.removeListener("data",n),t.removeListener("drain",r),l.removeListener("end",o),l.removeListener("close",s),l.removeListener("error",a),t.removeListener("error",a),l.removeListener("end",u),l.removeListener("close",u),t.removeListener("close",u)}var l=this;l.on("data",n),t.on("drain",r),t._isStdio||e&&e.end===!1||(l.on("end",o),l.on("close",s));var c=!1;return l.on("error",a),t.on("error",a),l.on("end",u),l.on("close",u),t.on("close",u),t.emit("pipe",l),t}},{"./duplex.js":20,"./passthrough.js":23,"./readable.js":24,"./transform.js":25,"./writable.js":26,events:9,inherits:14}],22:[function(t,e,n){var r=e.exports={};r.nextTick=function(){var t="undefined"!=typeof window&&window.setImmediate,e="undefined"!=typeof window&&window.postMessage&&window.addEventListener;if(t)return function(t){return window.setImmediate(t)};if(e){var n=[];return window.addEventListener("message",function(t){var e=t.source;if((e===window||null===e)&&"process-tick"===t.data&&(t.stopPropagation(),n.length>0)){var r=n.shift();r()}},!0),function(t){n.push(t),window.postMessage("process-tick","*")}}return function(t){setTimeout(t,0)}}(),r.title="browser",r.browser=!0,r.env={},r.argv=[],r.binding=function(t){throw new Error("process.binding is not supported")},r.cwd=function(){return"/"},r.chdir=function(t){throw new Error("process.chdir is not supported")}},{}],23:[function(t,e,n){function r(t){return this instanceof r?void i.call(this,t):new r(t)}e.exports=r;var i=t("./transform.js"),o=t("inherits");o(r,i),r.prototype._transform=function(t,e,n){n(null,t)}},{"./transform.js":25,inherits:14}],24:[function(t,e,n){(function(n){function r(e,n){e=e||{};var r=e.highWaterMark;this.highWaterMark=r||0===r?r:16384,this.highWaterMark=~~this.highWaterMark,this.buffer=[],this.length=0,this.pipes=null,this.pipesCount=0,this.flowing=!1,this.ended=!1,this.endEmitted=!1,this.reading=!1,this.calledRead=!1,this.sync=!0,this.needReadable=!1,this.emittedReadable=!1,this.readableListening=!1,this.objectMode=!!e.objectMode,this.defaultEncoding=e.defaultEncoding||"utf8",this.ranOut=!1,this.awaitDrain=0,this.readingMore=!1,this.decoder=null,this.encoding=null,e.encoding&&(C||(C=t("string_decoder").StringDecoder),this.decoder=new C(e.encoding),this.encoding=e.encoding)}function i(t){return this instanceof i?(this._readableState=new r(t,this),this.readable=!0,void S.call(this)):new i(t)}function o(t,e,n,r,i){var o=l(e,n);if(o)t.emit("error",o);else if(null===n||void 0===n)e.reading=!1,e.ended||c(t,e);else if(e.objectMode||n&&n.length>0)if(e.ended&&!i){var a=new Error("stream.push() after EOF");t.emit("error",a)}else if(e.endEmitted&&i){var a=new Error("stream.unshift() after end event");t.emit("error",a)}else!e.decoder||i||r||(n=e.decoder.write(n)),e.length+=e.objectMode?1:n.length,i?e.buffer.unshift(n):(e.reading=!1,e.buffer.push(n)),e.needReadable&&h(t),f(t,e);else i||(e.reading=!1);return s(e)}function s(t){return!t.ended&&(t.needReadable||t.length<t.highWaterMark||0===t.length)}function a(t){if(t>=M)t=M;else{t--;for(var e=1;32>e;e<<=1)t|=t>>e;t++}return t}function u(t,e){return 0===e.length&&e.ended?0:e.objectMode?0===t?0:1:isNaN(t)||null===t?e.flowing&&e.buffer.length?e.buffer[0].length:e.length:0>=t?0:(t>e.highWaterMark&&(e.highWaterMark=a(t)),t>e.length?e.ended?e.length:(e.needReadable=!0,0):t)}function l(t,e){var n=null;return E.isBuffer(e)||"string"==typeof e||null===e||void 0===e||t.objectMode||n||(n=new TypeError("Invalid non-string/buffer chunk")),n}function c(t,e){if(e.decoder&&!e.ended){var n=e.decoder.end();n&&n.length&&(e.buffer.push(n),e.length+=e.objectMode?1:n.length)}e.ended=!0,e.length>0?h(t):_(t)}function h(t){var e=t._readableState;e.needReadable=!1,e.emittedReadable||(e.emittedReadable=!0,e.sync?N(function(){p(t)}):p(t))}function p(t){t.emit("readable")}function f(t,e){e.readingMore||(e.readingMore=!0,N(function(){d(t,e)}))}function d(t,e){for(var n=e.length;!e.reading&&!e.flowing&&!e.ended&&e.length<e.highWaterMark&&(t.read(0),n!==e.length);)n=e.length;e.readingMore=!1}function m(t){return function(){var e=t._readableState;e.awaitDrain--,0===e.awaitDrain&&g(t)}}function g(t){function e(t,e,i){var o=t.write(n);!1===o&&r.awaitDrain++}var n,r=t._readableState;for(r.awaitDrain=0;r.pipesCount&&null!==(n=t.read());)if(1===r.pipesCount?e(r.pipes,0,null):w(r.pipes,e),t.emit("data",n),r.awaitDrain>0)return;return 0===r.pipesCount?(r.flowing=!1,void(T.listenerCount(t,"data")>0&&v(t))):void(r.ranOut=!0)}function y(){this._readableState.ranOut&&(this._readableState.ranOut=!1,g(this))}function v(t,e){var n=t._readableState;if(n.flowing)throw new Error("Cannot switch to old mode now.");var r=e||!1,i=!1;t.readable=!0,t.pipe=S.prototype.pipe,t.on=t.addListener=S.prototype.on,t.on("readable",function(){i=!0;for(var e;!r&&null!==(e=t.read());)t.emit("data",e);null===e&&(i=!1,t._readableState.needReadable=!0)}),t.pause=function(){r=!0,this.emit("pause")},t.resume=function(){r=!1,i?N(function(){t.emit("readable")}):this.read(0),this.emit("resume")},t.emit("readable")}function b(t,e){var n,r=e.buffer,i=e.length,o=!!e.decoder,s=!!e.objectMode;if(0===r.length)return null;if(0===i)n=null;else if(s)n=r.shift();else if(!t||t>=i)n=o?r.join(""):E.concat(r,i),r.length=0;else if(t<r[0].length){var a=r[0];n=a.slice(0,t),r[0]=a.slice(t)}else if(t===r[0].length)n=r.shift();else{n=o?"":new E(t);for(var u=0,l=0,c=r.length;c>l&&t>u;l++){var a=r[0],h=Math.min(t-u,a.length);o?n+=a.slice(0,h):a.copy(n,u,0,h),h<a.length?r[0]=a.slice(h):r.shift(),u+=h}}return n}function _(t){var e=t._readableState;if(e.length>0)throw new Error("endReadable called on non-empty stream");!e.endEmitted&&e.calledRead&&(e.ended=!0,N(function(){e.endEmitted||0!==e.length||(e.endEmitted=!0,t.readable=!1,t.emit("end"))}))}function w(t,e){for(var n=0,r=t.length;r>n;n++)e(t[n],n)}function x(t,e){for(var n=0,r=t.length;r>n;n++)if(t[n]===e)return n;return-1}e.exports=i,i.ReadableState=r;var C,T=t("events").EventEmitter,S=t("./index.js"),E=t("buffer").Buffer,N=t("process/browser.js").nextTick,k=t("inherits");k(i,S),i.prototype.push=function(t,e){var n=this._readableState;return"string"!=typeof t||n.objectMode||(e=e||n.defaultEncoding,e!==n.encoding&&(t=new E(t,e),e="")),o(this,n,t,e,!1)},i.prototype.unshift=function(t){var e=this._readableState;return o(this,e,t,"",!0)},i.prototype.setEncoding=function(e){C||(C=t("string_decoder").StringDecoder),this._readableState.decoder=new C(e),this._readableState.encoding=e};var M=8388608;i.prototype.read=function(t){var e=this._readableState;e.calledRead=!0;var n=t;if(("number"!=typeof t||t>0)&&(e.emittedReadable=!1),0===t&&e.needReadable&&(e.length>=e.highWaterMark||e.ended))return h(this),null;if(t=u(t,e),0===t&&e.ended)return 0===e.length&&_(this),null;var r=e.needReadable;e.length-t<=e.highWaterMark&&(r=!0),(e.ended||e.reading)&&(r=!1),r&&(e.reading=!0,e.sync=!0,0===e.length&&(e.needReadable=!0),this._read(e.highWaterMark),e.sync=!1),r&&!e.reading&&(t=u(n,e));var i;return i=t>0?b(t,e):null,null===i&&(e.needReadable=!0,t=0),e.length-=t,0!==e.length||e.ended||(e.needReadable=!0),e.ended&&!e.endEmitted&&0===e.length&&_(this),i},i.prototype._read=function(t){this.emit("error",new Error("not implemented"))},i.prototype.pipe=function(t,e){function r(t){t===c&&o()}function i(){t.end()}function o(){t.removeListener("close",a),t.removeListener("finish",u),t.removeListener("drain",d),t.removeListener("error",s),t.removeListener("unpipe",r),c.removeListener("end",i),c.removeListener("end",o),(!t._writableState||t._writableState.needDrain)&&d()}function s(e){l(),0===v&&0===T.listenerCount(t,"error")&&t.emit("error",e)}function a(){t.removeListener("finish",u),l()}function u(){t.removeListener("close",a),l()}function l(){c.unpipe(t)}var c=this,h=this._readableState;switch(h.pipesCount){case 0:h.pipes=t;break;case 1:h.pipes=[h.pipes,t];break;default:h.pipes.push(t)}h.pipesCount+=1;var p=(!e||e.end!==!1)&&t!==n.stdout&&t!==n.stderr,f=p?i:o;h.endEmitted?N(f):c.once("end",f),t.on("unpipe",r);var d=m(c);t.on("drain",d);var v=T.listenerCount(t,"error");return t.once("error",s),t.once("close",a),t.once("finish",u),t.emit("pipe",c),h.flowing||(this.on("readable",y),h.flowing=!0,N(function(){g(c)})),t},i.prototype.unpipe=function(t){var e=this._readableState;if(0===e.pipesCount)return this;if(1===e.pipesCount)return t&&t!==e.pipes?this:(t||(t=e.pipes),e.pipes=null,e.pipesCount=0,this.removeListener("readable",y),e.flowing=!1,t&&t.emit("unpipe",this),this);if(!t){var n=e.pipes,r=e.pipesCount;e.pipes=null,e.pipesCount=0,this.removeListener("readable",y),e.flowing=!1;for(var i=0;r>i;i++)n[i].emit("unpipe",this);return this}var i=x(e.pipes,t);return-1===i?this:(e.pipes.splice(i,1),e.pipesCount-=1,1===e.pipesCount&&(e.pipes=e.pipes[0]),t.emit("unpipe",this),this)},i.prototype.on=function(t,e){var n=S.prototype.on.call(this,t,e);if("data"!==t||this._readableState.flowing||v(this),"readable"===t&&this.readable){var r=this._readableState;r.readableListening||(r.readableListening=!0,r.emittedReadable=!1,r.needReadable=!0,r.reading?r.length&&h(this,r):this.read(0))}return n},i.prototype.addListener=i.prototype.on,i.prototype.resume=function(){v(this),this.read(0),this.emit("resume")},i.prototype.pause=function(){v(this,!0),this.emit("pause")},i.prototype.wrap=function(t){var e=this._readableState,n=!1,r=this;t.on("end",function(){if(e.decoder&&!e.ended){var t=e.decoder.end();t&&t.length&&r.push(t)}r.push(null)}),t.on("data",function(i){if(e.decoder&&(i=e.decoder.write(i)),i&&(e.objectMode||i.length)){var o=r.push(i);o||(n=!0,t.pause())}});for(var i in t)"function"==typeof t[i]&&"undefined"==typeof this[i]&&(this[i]=function(e){return function(){return t[e].apply(t,arguments)}}(i));var o=["error","close","destroy","pause","resume"];return w(o,function(e){t.on(e,function(t){return r.emit.apply(r,e,t)})}),r._read=function(e){n&&(n=!1,t.resume())},r},i._fromList=b}).call(this,t("IrXUsu"))},{"./index.js":21,IrXUsu:15,buffer:6,events:9,inherits:14,"process/browser.js":22,string_decoder:27}],25:[function(t,e,n){function r(t,e){this.afterTransform=function(t,n){return i(e,t,n)},this.needTransform=!1,this.transforming=!1,this.writecb=null,this.writechunk=null}function i(t,e,n){var r=t._transformState;r.transforming=!1;var i=r.writecb;if(!i)return t.emit("error",new Error("no writecb in Transform class"));r.writechunk=null,r.writecb=null,null!==n&&void 0!==n&&t.push(n),i&&i(e);var o=t._readableState;o.reading=!1,(o.needReadable||o.length<o.highWaterMark)&&t._read(o.highWaterMark)}function o(t){if(!(this instanceof o))return new o(t);a.call(this,t);var e=(this._transformState=new r(t,this),this);this._readableState.needReadable=!0,this._readableState.sync=!1,this.once("finish",function(){"function"==typeof this._flush?this._flush(function(t){s(e,t)}):s(e)})}function s(t,e){if(e)return t.emit("error",e);var n=t._writableState,r=(t._readableState,t._transformState);if(n.length)throw new Error("calling transform done when ws.length != 0");if(r.transforming)throw new Error("calling transform done when still transforming");return t.push(null)}e.exports=o;var a=t("./duplex.js"),u=t("inherits");u(o,a),o.prototype.push=function(t,e){return this._transformState.needTransform=!1,a.prototype.push.call(this,t,e)},o.prototype._transform=function(t,e,n){throw new Error("not implemented")},o.prototype._write=function(t,e,n){var r=this._transformState;if(r.writecb=n,r.writechunk=t,r.writeencoding=e,!r.transforming){var i=this._readableState;(r.needTransform||i.needReadable||i.length<i.highWaterMark)&&this._read(i.highWaterMark)}},o.prototype._read=function(t){var e=this._transformState;e.writechunk&&e.writecb&&!e.transforming?(e.transforming=!0,this._transform(e.writechunk,e.writeencoding,e.afterTransform)):e.needTransform=!0}},{"./duplex.js":20,inherits:14}],26:[function(t,e,n){function r(t,e,n){this.chunk=t,this.encoding=e,this.callback=n}function i(t,e){t=t||{};var n=t.highWaterMark;this.highWaterMark=n||0===n?n:16384,this.objectMode=!!t.objectMode,this.highWaterMark=~~this.highWaterMark,this.needDrain=!1,this.ending=!1,this.ended=!1,this.finished=!1;var r=t.decodeStrings===!1;this.decodeStrings=!r,this.defaultEncoding=t.defaultEncoding||"utf8",this.length=0,this.writing=!1,this.sync=!0,this.bufferProcessing=!1,this.onwrite=function(t){f(e,t)},this.writecb=null,this.writelen=0,this.buffer=[]}function o(t){return this instanceof o||this instanceof C.Duplex?(this._writableState=new i(t,this),this.writable=!0,void C.call(this)):new o(t)}function s(t,e,n){var r=new Error("write after end");t.emit("error",r),T(function(){n(r)})}function a(t,e,n,r){var i=!0;if(!S.isBuffer(n)&&"string"!=typeof n&&null!==n&&void 0!==n&&!e.objectMode){var o=new TypeError("Invalid non-string/buffer chunk");t.emit("error",o),T(function(){r(o)}),i=!1}return i}function u(t,e,n){return t.objectMode||t.decodeStrings===!1||"string"!=typeof e||(e=new S(e,n)),e}function l(t,e,n,i,o){n=u(e,n,i);var s=e.objectMode?1:n.length;e.length+=s;var a=e.length<e.highWaterMark;return e.needDrain=!a,e.writing?e.buffer.push(new r(n,i,o)):c(t,e,s,n,i,o),a}function c(t,e,n,r,i,o){e.writelen=n,e.writecb=o,e.writing=!0,e.sync=!0,t._write(r,i,e.onwrite),e.sync=!1}function h(t,e,n,r,i){n?T(function(){i(r)}):i(r),t.emit("error",r)}function p(t){t.writing=!1,t.writecb=null,t.length-=t.writelen,t.writelen=0}function f(t,e){var n=t._writableState,r=n.sync,i=n.writecb;if(p(n),e)h(t,n,r,e,i);else{var o=y(t,n);o||n.bufferProcessing||!n.buffer.length||g(t,n),r?T(function(){d(t,n,o,i)}):d(t,n,o,i)}}function d(t,e,n,r){n||m(t,e),r(),n&&v(t,e)}function m(t,e){0===e.length&&e.needDrain&&(e.needDrain=!1,t.emit("drain"))}function g(t,e){e.bufferProcessing=!0;for(var n=0;n<e.buffer.length;n++){var r=e.buffer[n],i=r.chunk,o=r.encoding,s=r.callback,a=e.objectMode?1:i.length;if(c(t,e,a,i,o,s),e.writing){n++;break}}e.bufferProcessing=!1,n<e.buffer.length?e.buffer=e.buffer.slice(n):e.buffer.length=0}function y(t,e){return e.ending&&0===e.length&&!e.finished&&!e.writing}function v(t,e){var n=y(t,e);return n&&(e.finished=!0,t.emit("finish")),n}function b(t,e,n){e.ending=!0,v(t,e),n&&(e.finished?T(n):t.once("finish",n)),e.ended=!0}e.exports=o,o.WritableState=i;var _="undefined"!=typeof Uint8Array?function(t){return t instanceof Uint8Array}:function(t){return t&&t.constructor&&"Uint8Array"===t.constructor.name},w="undefined"!=typeof ArrayBuffer?function(t){return t instanceof ArrayBuffer}:function(t){return t&&t.constructor&&"ArrayBuffer"===t.constructor.name},x=t("inherits"),C=t("./index.js"),T=t("process/browser.js").nextTick,S=t("buffer").Buffer;x(o,C),o.prototype.pipe=function(){this.emit("error",new Error("Cannot pipe. Not readable."))},o.prototype.write=function(t,e,n){var r=this._writableState,i=!1;return"function"==typeof e&&(n=e,e=null),!S.isBuffer(t)&&_(t)&&(t=new S(t)),w(t)&&"undefined"!=typeof Uint8Array&&(t=new S(new Uint8Array(t))),S.isBuffer(t)?e="buffer":e||(e=r.defaultEncoding),"function"!=typeof n&&(n=function(){}),r.ended?s(this,r,n):a(this,r,t,n)&&(i=l(this,r,t,e,n)),i},o.prototype._write=function(t,e,n){n(new Error("not implemented"))},o.prototype.end=function(t,e,n){var r=this._writableState;"function"==typeof t?(n=t,t=null,e=null):"function"==typeof e&&(n=e,e=null),"undefined"!=typeof t&&null!==t&&this.write(t,e),r.ending||r.finished||b(this,r,n)}},{"./index.js":21,buffer:6,inherits:14,"process/browser.js":22}],27:[function(t,e,n){function r(t){if(t&&!a.isEncoding(t))throw new Error("Unknown encoding: "+t)}function i(t){return t.toString(this.encoding)}function o(t){var e=this.charReceived=t.length%2;return this.charLength=e?2:0,e}function s(t){var e=this.charReceived=t.length%3;return this.charLength=e?3:0,e}var a=t("buffer").Buffer,u=n.StringDecoder=function(t){switch(this.encoding=(t||"utf8").toLowerCase().replace(/[-_]/,""),r(t),this.encoding){case"utf8":this.surrogateSize=3;break;case"ucs2":case"utf16le":this.surrogateSize=2,this.detectIncompleteChar=o;break;case"base64":this.surrogateSize=3,this.detectIncompleteChar=s;break;default:return void(this.write=i)}this.charBuffer=new a(6),this.charReceived=0,this.charLength=0};u.prototype.write=function(t){for(var e="",n=0;this.charLength;){var r=t.length>=this.charLength-this.charReceived?this.charLength-this.charReceived:t.length;if(t.copy(this.charBuffer,this.charReceived,n,r),this.charReceived+=r-n,n=r,this.charReceived<this.charLength)return"";e=this.charBuffer.slice(0,this.charLength).toString(this.encoding);var i=e.charCodeAt(e.length-1);if(!(i>=55296&&56319>=i)){if(this.charReceived=this.charLength=0,r==t.length)return e;t=t.slice(r,t.length);break}this.charLength+=this.surrogateSize,e=""}var o=this.detectIncompleteChar(t),s=t.length;this.charLength&&(t.copy(this.charBuffer,0,t.length-o,s),this.charReceived=o,s-=o),e+=t.toString(this.encoding,0,s);var s=e.length-1,i=e.charCodeAt(s);if(i>=55296&&56319>=i){var a=this.surrogateSize;return this.charLength+=a,this.charReceived+=a,this.charBuffer.copy(this.charBuffer,a,0,a),this.charBuffer.write(e.charAt(e.length-1),this.encoding),e.substring(0,s)}return e},u.prototype.detectIncompleteChar=function(t){for(var e=t.length>=3?3:t.length;e>0;e--){var n=t[t.length-e];if(1==e&&n>>5==6){this.charLength=2;break}if(2>=e&&n>>4==14){this.charLength=3;break}if(3>=e&&n>>3==30){this.charLength=4;break}}return e},u.prototype.end=function(t){var e="";if(t&&t.length&&(e=this.write(t)),this.charReceived){var n=this.charReceived,r=this.charBuffer,i=this.encoding;e+=r.slice(0,n).toString(i)}return e}},{buffer:6}],28:[function(t,e,n){function r(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}function i(t,e,n){if(t&&l(t)&&t instanceof r)return t;var i=new r;return i.parse(t,e,n),i}function o(t){return u(t)&&(t=i(t)),t instanceof r?t.format():r.prototype.format.call(t)}function s(t,e){return i(t,!1,!0).resolve(e)}function a(t,e){return t?i(t,!1,!0).resolveObject(e):e}function u(t){return"string"==typeof t}function l(t){return"object"==typeof t&&null!==t}function c(t){return null===t}function h(t){return null==t}var p=t("punycode");n.parse=i,n.resolve=s,n.resolveObject=a,n.format=o,n.Url=r;var f=/^([a-z0-9.+-]+:)/i,d=/:[0-9]*$/,m=["<",">",'"',"`"," ","\r","\n","	"],g=["{","}","|","\\","^","`"].concat(m),y=["'"].concat(g),v=["%","/","?",";","#"].concat(y),b=["/","?","#"],_=255,w=/^[a-z0-9A-Z_-]{0,63}$/,x=/^([a-z0-9A-Z_-]{0,63})(.*)$/,C={javascript:!0,"javascript:":!0},T={javascript:!0,"javascript:":!0},S={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},E=t("querystring");r.prototype.parse=function(t,e,n){if(!u(t))throw new TypeError("Parameter 'url' must be a string, not "+typeof t);var r=t;r=r.trim();var i=f.exec(r);if(i){i=i[0];var o=i.toLowerCase();this.protocol=o,r=r.substr(i.length)}if(n||i||r.match(/^\/\/[^@\/]+@[^@\/]+/)){var s="//"===r.substr(0,2);!s||i&&T[i]||(r=r.substr(2),this.slashes=!0)}if(!T[i]&&(s||i&&!S[i])){for(var a=-1,l=0;l<b.length;l++){var c=r.indexOf(b[l]);-1!==c&&(-1===a||a>c)&&(a=c)}var h,d;d=-1===a?r.lastIndexOf("@"):r.lastIndexOf("@",a),-1!==d&&(h=r.slice(0,d),r=r.slice(d+1),this.auth=decodeURIComponent(h)),a=-1;for(var l=0;l<v.length;l++){var c=r.indexOf(v[l]);-1!==c&&(-1===a||a>c)&&(a=c)}-1===a&&(a=r.length),this.host=r.slice(0,a),r=r.slice(a),this.parseHost(),this.hostname=this.hostname||"";var m="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!m)for(var g=this.hostname.split(/\./),l=0,N=g.length;N>l;l++){var k=g[l];if(k&&!k.match(w)){for(var M="",P=0,O=k.length;O>P;P++)M+=k.charCodeAt(P)>127?"x":k[P];if(!M.match(w)){var A=g.slice(0,l),R=g.slice(l+1),I=k.match(x);I&&(A.push(I[1]),R.unshift(I[2])),R.length&&(r="/"+R.join(".")+r),this.hostname=A.join(".");break}}}if(this.hostname=this.hostname.length>_?"":this.hostname.toLowerCase(),!m){for(var D=this.hostname.split("."),L=[],l=0;l<D.length;++l){var q=D[l];L.push(q.match(/[^A-Za-z0-9_-]/)?"xn--"+p.encode(q):q)}this.hostname=L.join(".")}var j=this.port?":"+this.port:"",$=this.hostname||"";this.host=$+j,this.href+=this.host,m&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==r[0]&&(r="/"+r))}if(!C[o])for(var l=0,N=y.length;N>l;l++){var F=y[l],z=encodeURIComponent(F);z===F&&(z=escape(F)),r=r.split(F).join(z)}var U=r.indexOf("#");-1!==U&&(this.hash=r.substr(U),r=r.slice(0,U));var H=r.indexOf("?");if(-1!==H?(this.search=r.substr(H),this.query=r.substr(H+1),e&&(this.query=E.parse(this.query)),r=r.slice(0,H)):e&&(this.search="",this.query={}),r&&(this.pathname=r),S[o]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var j=this.pathname||"",q=this.search||"";this.path=j+q}return this.href=this.format(),this},r.prototype.format=function(){var t=this.auth||"";t&&(t=encodeURIComponent(t),t=t.replace(/%3A/i,":"),t+="@");var e=this.protocol||"",n=this.pathname||"",r=this.hash||"",i=!1,o="";this.host?i=t+this.host:this.hostname&&(i=t+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(i+=":"+this.port)),this.query&&l(this.query)&&Object.keys(this.query).length&&(o=E.stringify(this.query));var s=this.search||o&&"?"+o||"";return e&&":"!==e.substr(-1)&&(e+=":"),this.slashes||(!e||S[e])&&i!==!1?(i="//"+(i||""),n&&"/"!==n.charAt(0)&&(n="/"+n)):i||(i=""),r&&"#"!==r.charAt(0)&&(r="#"+r),s&&"?"!==s.charAt(0)&&(s="?"+s),n=n.replace(/[?#]/g,function(t){return encodeURIComponent(t)}),s=s.replace("#","%23"),e+i+n+s+r},r.prototype.resolve=function(t){return this.resolveObject(i(t,!1,!0)).format()},r.prototype.resolveObject=function(t){if(u(t)){var e=new r;e.parse(t,!1,!0),t=e}var n=new r;if(Object.keys(this).forEach(function(t){n[t]=this[t]},this),n.hash=t.hash,""===t.href)return n.href=n.format(),n;if(t.slashes&&!t.protocol)return Object.keys(t).forEach(function(e){"protocol"!==e&&(n[e]=t[e])}),S[n.protocol]&&n.hostname&&!n.pathname&&(n.path=n.pathname="/"),n.href=n.format(),n;if(t.protocol&&t.protocol!==n.protocol){if(!S[t.protocol])return Object.keys(t).forEach(function(e){n[e]=t[e]}),n.href=n.format(),n;if(n.protocol=t.protocol,t.host||T[t.protocol])n.pathname=t.pathname;else{for(var i=(t.pathname||"").split("/");i.length&&!(t.host=i.shift()););t.host||(t.host=""),t.hostname||(t.hostname=""),""!==i[0]&&i.unshift(""),i.length<2&&i.unshift(""),n.pathname=i.join("/")}if(n.search=t.search,n.query=t.query,n.host=t.host||"",n.auth=t.auth,n.hostname=t.hostname||t.host,n.port=t.port,n.pathname||n.search){var o=n.pathname||"",s=n.search||"";n.path=o+s}return n.slashes=n.slashes||t.slashes,n.href=n.format(),n}var a=n.pathname&&"/"===n.pathname.charAt(0),l=t.host||t.pathname&&"/"===t.pathname.charAt(0),p=l||a||n.host&&t.pathname,f=p,d=n.pathname&&n.pathname.split("/")||[],i=t.pathname&&t.pathname.split("/")||[],m=n.protocol&&!S[n.protocol];if(m&&(n.hostname="",n.port=null,n.host&&(""===d[0]?d[0]=n.host:d.unshift(n.host)),n.host="",t.protocol&&(t.hostname=null,t.port=null,t.host&&(""===i[0]?i[0]=t.host:i.unshift(t.host)),t.host=null),p=p&&(""===i[0]||""===d[0])),l)n.host=t.host||""===t.host?t.host:n.host,n.hostname=t.hostname||""===t.hostname?t.hostname:n.hostname,n.search=t.search,n.query=t.query,d=i;else if(i.length)d||(d=[]),d.pop(),d=d.concat(i),n.search=t.search,n.query=t.query;else if(!h(t.search)){if(m){n.hostname=n.host=d.shift();var g=n.host&&n.host.indexOf("@")>0?n.host.split("@"):!1;g&&(n.auth=g.shift(),n.host=n.hostname=g.shift())}return n.search=t.search,n.query=t.query,c(n.pathname)&&c(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.href=n.format(),n}if(!d.length)return n.pathname=null,n.path=n.search?"/"+n.search:null,n.href=n.format(),n;for(var y=d.slice(-1)[0],v=(n.host||t.host)&&("."===y||".."===y)||""===y,b=0,_=d.length;_>=0;_--)y=d[_],"."==y?d.splice(_,1):".."===y?(d.splice(_,1),b++):b&&(d.splice(_,1),b--);if(!p&&!f)for(;b--;b)d.unshift("..");!p||""===d[0]||d[0]&&"/"===d[0].charAt(0)||d.unshift(""),v&&"/"!==d.join("/").substr(-1)&&d.push("");var w=""===d[0]||d[0]&&"/"===d[0].charAt(0);if(m){n.hostname=n.host=w?"":d.length?d.shift():"";var g=n.host&&n.host.indexOf("@")>0?n.host.split("@"):!1;g&&(n.auth=g.shift(),n.host=n.hostname=g.shift())}return p=p||n.host&&d.length,p&&!w&&d.unshift(""),d.length?n.pathname=d.join("/"):(n.pathname=null,n.path=null),c(n.pathname)&&c(n.search)||(n.path=(n.pathname?n.pathname:"")+(n.search?n.search:"")),n.auth=t.auth||n.auth,n.slashes=n.slashes||t.slashes,n.href=n.format(),n},r.prototype.parseHost=function(){var t=this.host,e=d.exec(t);e&&(e=e[0],":"!==e&&(this.port=e.substr(1)),t=t.substr(0,t.length-e.length)),t&&(this.hostname=t)}},{punycode:16,querystring:19}],29:[function(t,e,n){e.exports=function(t){return t&&"object"==typeof t&&"function"==typeof t.copy&&"function"==typeof t.fill&&"function"==typeof t.readUInt8}},{}],30:[function(t,e,n){(function(e,r){function i(t,e){var r={seen:[],stylize:s};return arguments.length>=3&&(r.depth=arguments[2]),arguments.length>=4&&(r.colors=arguments[3]),m(e)?r.showHidden=e:e&&n._extend(r,e),w(r.showHidden)&&(r.showHidden=!1),w(r.depth)&&(r.depth=2),w(r.colors)&&(r.colors=!1),w(r.customInspect)&&(r.customInspect=!0),r.colors&&(r.stylize=o),u(r,t,r.depth)}function o(t,e){var n=i.styles[e];return n?"["+i.colors[n][0]+"m"+t+"["+i.colors[n][1]+"m":t}function s(t,e){return t}function a(t){var e={};return t.forEach(function(t,n){e[t]=!0}),e}function u(t,e,r){if(t.customInspect&&e&&E(e.inspect)&&e.inspect!==n.inspect&&(!e.constructor||e.constructor.prototype!==e)){var i=e.inspect(r,t);return b(i)||(i=u(t,i,r)),i}var o=l(t,e);if(o)return o;var s=Object.keys(e),m=a(s);if(t.showHidden&&(s=Object.getOwnPropertyNames(e)),S(e)&&(s.indexOf("message")>=0||s.indexOf("description")>=0))return c(e);if(0===s.length){if(E(e)){var g=e.name?": "+e.name:"";return t.stylize("[Function"+g+"]","special")}if(x(e))return t.stylize(RegExp.prototype.toString.call(e),"regexp");if(T(e))return t.stylize(Date.prototype.toString.call(e),"date");if(S(e))return c(e)}var y="",v=!1,_=["{","}"];if(d(e)&&(v=!0,_=["[","]"]),E(e)){var w=e.name?": "+e.name:"";

y=" [Function"+w+"]"}if(x(e)&&(y=" "+RegExp.prototype.toString.call(e)),T(e)&&(y=" "+Date.prototype.toUTCString.call(e)),S(e)&&(y=" "+c(e)),0===s.length&&(!v||0==e.length))return _[0]+y+_[1];if(0>r)return x(e)?t.stylize(RegExp.prototype.toString.call(e),"regexp"):t.stylize("[Object]","special");t.seen.push(e);var C;return C=v?h(t,e,r,m,s):s.map(function(n){return p(t,e,r,m,n,v)}),t.seen.pop(),f(C,y,_)}function l(t,e){if(w(e))return t.stylize("undefined","undefined");if(b(e)){var n="'"+JSON.stringify(e).replace(/^"|"$/g,"").replace(/'/g,"\\'").replace(/\\"/g,'"')+"'";return t.stylize(n,"string")}return v(e)?t.stylize(""+e,"number"):m(e)?t.stylize(""+e,"boolean"):g(e)?t.stylize("null","null"):void 0}function c(t){return"["+Error.prototype.toString.call(t)+"]"}function h(t,e,n,r,i){for(var o=[],s=0,a=e.length;a>s;++s)o.push(O(e,String(s))?p(t,e,n,r,String(s),!0):"");return i.forEach(function(i){i.match(/^\d+$/)||o.push(p(t,e,n,r,i,!0))}),o}function p(t,e,n,r,i,o){var s,a,l;if(l=Object.getOwnPropertyDescriptor(e,i)||{value:e[i]},l.get?a=l.set?t.stylize("[Getter/Setter]","special"):t.stylize("[Getter]","special"):l.set&&(a=t.stylize("[Setter]","special")),O(r,i)||(s="["+i+"]"),a||(t.seen.indexOf(l.value)<0?(a=g(n)?u(t,l.value,null):u(t,l.value,n-1),a.indexOf("\n")>-1&&(a=o?a.split("\n").map(function(t){return"  "+t}).join("\n").substr(2):"\n"+a.split("\n").map(function(t){return"   "+t}).join("\n"))):a=t.stylize("[Circular]","special")),w(s)){if(o&&i.match(/^\d+$/))return a;s=JSON.stringify(""+i),s.match(/^"([a-zA-Z_][a-zA-Z_0-9]*)"$/)?(s=s.substr(1,s.length-2),s=t.stylize(s,"name")):(s=s.replace(/'/g,"\\'").replace(/\\"/g,'"').replace(/(^"|"$)/g,"'"),s=t.stylize(s,"string"))}return s+": "+a}function f(t,e,n){var r=0,i=t.reduce(function(t,e){return r++,e.indexOf("\n")>=0&&r++,t+e.replace(/\u001b\[\d\d?m/g,"").length+1},0);return i>60?n[0]+(""===e?"":e+"\n ")+" "+t.join(",\n  ")+" "+n[1]:n[0]+e+" "+t.join(", ")+" "+n[1]}function d(t){return Array.isArray(t)}function m(t){return"boolean"==typeof t}function g(t){return null===t}function y(t){return null==t}function v(t){return"number"==typeof t}function b(t){return"string"==typeof t}function _(t){return"symbol"==typeof t}function w(t){return void 0===t}function x(t){return C(t)&&"[object RegExp]"===k(t)}function C(t){return"object"==typeof t&&null!==t}function T(t){return C(t)&&"[object Date]"===k(t)}function S(t){return C(t)&&("[object Error]"===k(t)||t instanceof Error)}function E(t){return"function"==typeof t}function N(t){return null===t||"boolean"==typeof t||"number"==typeof t||"string"==typeof t||"symbol"==typeof t||"undefined"==typeof t}function k(t){return Object.prototype.toString.call(t)}function M(t){return 10>t?"0"+t.toString(10):t.toString(10)}function P(){var t=new Date,e=[M(t.getHours()),M(t.getMinutes()),M(t.getSeconds())].join(":");return[t.getDate(),D[t.getMonth()],e].join(" ")}function O(t,e){return Object.prototype.hasOwnProperty.call(t,e)}var A=/%[sdj%]/g;n.format=function(t){if(!b(t)){for(var e=[],n=0;n<arguments.length;n++)e.push(i(arguments[n]));return e.join(" ")}for(var n=1,r=arguments,o=r.length,s=String(t).replace(A,function(t){if("%%"===t)return"%";if(n>=o)return t;switch(t){case"%s":return String(r[n++]);case"%d":return Number(r[n++]);case"%j":try{return JSON.stringify(r[n++])}catch(e){return"[Circular]"}default:return t}}),a=r[n];o>n;a=r[++n])s+=g(a)||!C(a)?" "+a:" "+i(a);return s},n.deprecate=function(t,i){function o(){if(!s){if(e.throwDeprecation)throw new Error(i);e.traceDeprecation?console.trace(i):console.error(i),s=!0}return t.apply(this,arguments)}if(w(r.process))return function(){return n.deprecate(t,i).apply(this,arguments)};if(e.noDeprecation===!0)return t;var s=!1;return o};var R,I={};n.debuglog=function(t){if(w(R)&&(R=e.env.NODE_DEBUG||""),t=t.toUpperCase(),!I[t])if(new RegExp("\\b"+t+"\\b","i").test(R)){var r=e.pid;I[t]=function(){var e=n.format.apply(n,arguments);console.error("%s %d: %s",t,r,e)}}else I[t]=function(){};return I[t]},n.inspect=i,i.colors={bold:[1,22],italic:[3,23],underline:[4,24],inverse:[7,27],white:[37,39],grey:[90,39],black:[30,39],blue:[34,39],cyan:[36,39],green:[32,39],magenta:[35,39],red:[31,39],yellow:[33,39]},i.styles={special:"cyan",number:"yellow","boolean":"yellow",undefined:"grey","null":"bold",string:"green",date:"magenta",regexp:"red"},n.isArray=d,n.isBoolean=m,n.isNull=g,n.isNullOrUndefined=y,n.isNumber=v,n.isString=b,n.isSymbol=_,n.isUndefined=w,n.isRegExp=x,n.isObject=C,n.isDate=T,n.isError=S,n.isFunction=E,n.isPrimitive=N,n.isBuffer=t("./support/isBuffer");var D=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];n.log=function(){console.log("%s - %s",P(),n.format.apply(n,arguments))},n.inherits=t("inherits"),n._extend=function(t,e){if(!e||!C(e))return t;for(var n=Object.keys(e),r=n.length;r--;)t[n[r]]=e[n[r]];return t}}).call(this,t("IrXUsu"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"./support/isBuffer":29,IrXUsu:15,inherits:14}],31:[function(t,e,n){(function(){var e,r,i,o,s,a,u;o=t("es6-promise").Promise,u=t("underscore"),e=t("jquery"),i=t("./options"),r={server:"http://cdn.intermine.org",imtables:"/js/intermine/im-tables/2.0.0-beta/",tests:{fontawesome:/font-awesome/,glyphicons:/bootstrap-icons/},resources:{prettify:["/js/google-code-prettify/latest/prettify.js"],d3:"/js/d3/3.0.6/d3.v3.min.js",glyphicons:"/css/bootstrap/2.3.2/css/bootstrap-icons.css",fontawesome:"/css/font-awesome/4.x/css/font-awesome.min.css",filesaver:"/js/filesaver.js/FileSaver.min.js"}},i.set("CDN",r),s=function(t){var e;return null==t?!1:(e=u.asArray(document.querySelectorAll('link[rel="stylesheet"]')),u.any(e,function(e){return t.test(e.href)}))},a=function(t){return function(n,r){var i,a,l;return l=new o(function(t){return u.delay(t,50,!0)}),/\.css$/.test(n)?s(r)?l:(a=e('<link type="text/css" rel="stylesheet">'),a.appendTo("head").attr({href:t+n}),l):(i=e.ajax({url:t+n,cache:!0,dataType:"script"}),i.then(function(){return l}))}},n.load=function(t){var e,n,r,s,l;return s=i.get("CDN.server"),n=i.get(["CDN","resources",t]),l=i.get(["CDN","tests",t]),r=a(s),n?u.isArray(n)?o.all(function(){var t,i,o;for(o=[],t=0,i=n.length;i>t;t++)e=n[t],o.push(r(e));return o}()):r(n,l):o.reject("No resource is configured for "+t)}}).call(this)},{"./options":93,"es6-promise":277,jquery:305,underscore:308}],32:[function(t,e,n){(function(){var n,r,i,o={}.hasOwnProperty,s=function(t,e){function n(){this.constructor=t}for(var r in e)o.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},a=[].slice;n=t("backbone"),i=function(t){return!t},e.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return s(e,t),e.prototype.destroyed=!1,e.prototype.toggle=function(t){return this.swap(t,i)},e.prototype.swap=function(t,e){return this.set(t,e(this.get(t)))},e.prototype.toJSON=function(){return this.destroyed?"DESTROYED":e.__super__.toJSON.apply(this,arguments)},e.prototype.destroy=function(){return this.destroyed?void 0:(this.stopListening(),this.destroyed=!0,this.trigger("destroy",this,this.collection),this._frozen=[],this.clear(),this.off())},e.prototype._frozen=[],e.prototype._validate=function(t,n){var r,i,o,s,a;for(a=this._frozen,o=0,s=a.length;s>o;o++)if(i=a[o],i in t&&t[i]!==this.get(i)){if(r=""+i+" is frozen (trying to set it to "+t[i]+" - is "+this.get(i)+")",!n.merge)throw new Error(r);t[i]=this.get(i)}return e.__super__._validate.apply(this,arguments)},e.prototype.freeze=function(){var t;return t=1<=arguments.length?a.call(arguments,0):[],this._frozen=this._frozen.concat(t),this},e}(n.Model)}).call(this)},{backbone:262}],33:[function(t,e,n){(function(){var n,r,i,o,s,a,u,l,c,h,p,f,d,m,g,y,v,b,_={}.hasOwnProperty,w=function(t,e){function n(){this.constructor=t}for(var r in e)_.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},x=[].slice;t("./shim"),r=t("backbone"),b=t("underscore"),n=t("jquery"),i=t("./core-model"),l=t("./messages"),c=t("./templates"),a=t("./icons"),s=t("./event"),p=t("./templates/helpers"),v=t("./utils/on-change"),u=c.template("progress-bar")({doneness:1}),f=0,h=function(){return f++},m=function(){return y.call(this,"model")},g=function(){return y.call(this,"state")},d=function(){return y.call(this,"collection")},y=function(t){var e,n,r,i;if(e=b.result(this,""+t+"Events"),b.size(e)){if(null==this[t])throw new Error("Cannot listen to "+t+" - it is null.");i=[];for(n in e){if(r=e[n],r=b.isFunction(r)?r:this[r],null==r)throw new Error("No handler for "+t+":"+n);i.push(this.listenTo(this[t],n,r))}return i}},e.exports=o=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}var r;return w(e,t),e.include=function(t){return b.extend(this.prototype,t)},e.prototype.hasOwnModel=!0,e.prototype.parameters=[],e.prototype.optionalParameters=[],e.prototype.parameterTypes={},e.prototype.initState=function(){},e.prototype.initialize=function(t){var e,n,r,o,s,u,l,c,h;for(null==t&&(t={}),this.state=t.state,o=null!=(l=b.result(this,"parameters"))?l:[],n=null!=(c=b.result(this,"optionalParameters"))?c:[],b.extend(this,b.pick.apply(b,[t].concat(x.call(o)))),s=0,u=n.length;u>s;s++)r=n[s],null!=t[r]&&(this[r]=t[r]);return this.children={},e=this.Model||i,null!=(null!=(h=this.model)?h.toJSON:void 0)&&(this.hasOwnModel=!1),null==this.model&&(this.model=new e),null==this.model.toJSON&&(this.model=new e(this.model)),null==this.state&&(this.state=new i),null==this.state.toJSON&&(this.state=new i(this.state)),null!=this.RERENDER_EVENT&&this.listenTo(this.model,this.RERENDER_EVENT,this.reRender),this.on("rendering",this.preRender),this.on("rendered",this.postRender),this.assertInvariants(),this.initState(),m.call(this),g.call(this),d.call(this),this.listenTo(a,this.ICONS,function(){return this.template?this.reRender():void 0}),this.listenTo(this.model,"destroy",function(){return this.remove()})},e.prototype.ICONS="change",e.prototype.stopListeningTo=function(t){return this.stopListening(t)},e.prototype.renderRequires=[],e.prototype.modelEvents={},e.prototype.stateEvents={},e.prototype.collectionEvents={},e.prototype.listenForChange=function(){var t,e,n;if(t=arguments[0],e=arguments[1],n=3<=arguments.length?x.call(arguments,2):[],!(null!=n?n.length:void 0))throw new Error("No properties listed");return this.listenTo(t,v(n),e)},e.prototype.renderError=function(t){return renderError(this.el)(t)},e.prototype.helpers=function(){return b.extend({IndeterminateProgressBar:u},p)},e.prototype.getBaseData=function(){var t;return p=b.result(this,"helpers"),t=b.result(this,"labels"),b.extend({state:this.state.toJSON(),Messages:l,Icons:a,labels:t},p)},e.prototype.getData=function(){var t,e;return b.extend(this.getBaseData(),this.model.toJSON(),{collection:null!=(t=null!=(e=this.collection)?e.toJSON():void 0)?t:[]})},e.prototype.reRender=function(){return this.rendered&&!this.removed&&this.render(),this},e.prototype.postRender=function(){},e.prototype.preRender=function(){},r=function(t,e){return b.all(e,function(e){return t.has(e)})},e.prototype.onRenderError=function(t){return console.error("RENDER FAILED",this,t),this.state.set({error:t})},e.prototype.render=function(){var t,e,n,i;if(!this.removed){if(i=b.result(this,"renderRequires"),(null!=i?i.length:void 0)&&!r(this.model,i))return e=v(i),this.listenToOnce(this.model,e,this.render),this;if(n=new s(this.rendered),this.trigger("rendering",n),n.cancelled)return this;if(this.removeAllChildren(),null!=this.template)try{this.$el.html(this.template(this.getData()))}catch(o){t=o,this.onRenderError(t)}return this.renderChildren(),this.trigger("rendered",this.rendered=!0),this}},e.prototype.renderChildren=function(){},e.prototype.renderChild=function(t,e,n,r){if(null==n&&(n=this.el),null==r&&(r="append"),null==t&&(t=h()),this.removeChild(t),this.children[t]=e,null==e)return this;switch(r){case"append":e.$el.appendTo(n);break;case"prepend":e.$el.prependTo(n);break;case"at":e.setElement(n[0]||n);break;default:throw new Error("Unknown position: "+r)}return e.render(),this},e.prototype.renderChildAt=function(t,e,n){return null==n&&(n=this.$(t)),this.renderChild(t,e,n,"at")},e.prototype.removeChild=function(t){var e;return null!=(e=this.children[t])&&e.remove(),delete this.children[t]},e.prototype.removeAllChildren=function(){var t,e,n,r,i;if(null!=this.children){for(r=b.keys(this.children),i=[],e=0,n=r.length;n>e;e++)t=r[e],i.push(this.removeChild(t));return i}},e.prototype.removed=!1,e.prototype.remove=function(){return this.removed?void 0:(this.stopListening(),this.removed=!0,this.$el.parent().trigger("childremoved",this),this.trigger("remove",this),this.hasOwnModel&&this.model.destroy(),this.removeAllChildren(),this.off(),e.__super__.remove.apply(this,arguments),this)},e.prototype.make=function(t,e,r){var i,o,s,a,u,l,c;if(o=document.createElement(t),i=n(o),null!=e)for(s in e)a=e[s],"class"===s||"className"===s?i.addClass(a):i.attr(s,a);if(null!=r)if(b.isArray(r))for(l=0,c=r.length;c>l;l++)u=r[l],i.append(u);else i.append(r);return o},e.prototype.invariants=function(){return{}},e.prototype.assertInvariant=function(t,e){if(!t)throw new Error(e)},e.prototype.assertInvariants=function(){var t,e,n,r,i,o,s,a,u,l,c,h,p,f,d,m,g,y,v;for(s=null!=(f=b.result(this,"parameters"))?f:[],r=null!=(d=b.result(this,"optionalParameters"))?d:[],o=null!=(m=b.result(this,"parameterTypes"))?m:{},l=0,h=s.length;h>l;l++)i=s[l],u=this[i],this.assertInvariant(null!=u,"Missing required option: "+i);for(g=s.concat(r),c=0,p=g.length;p>c;c++)i=g[c],a=o[i],null!=a&&(u=this[i],t=a.test(u),n=a.message(i),this.assertInvariant(t,n));y=this.invariants(),v=[];for(e in y)n=y[e],v.push(this.assertInvariant(b.result(this,e),n));return v},e}(r.View)}).call(this)},{"./core-model":32,"./event":41,"./icons":44,"./messages":46,"./shim":96,"./templates":97,"./templates/helpers":98,"./utils/on-change":123,backbone:262,jquery:305,underscore:308}],34:[function(t,e,n){(function(){var n,r,i,o,s={}.hasOwnProperty,a=function(t,e){function n(){this.constructor=t}for(var r in e)s.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};r=t("../core-view"),o=t("../templates"),i=t("../messages"),e.exports=n=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return a(e,t),e.prototype["class"]="checkbox",e.prototype.template=o.template("checkbox"),e.prototype.getData=function(){return{checked:this.checked(),label:this.label?i.getText(this.label):null}},e.prototype.initialize=function(t){return this.attr=t.attr,this.label=t.label,e.__super__.initialize.apply(this,arguments)},e.prototype.checked=function(){return this.model.get(this.attr)},e.prototype.toggle=function(t){return null!=t&&t.stopPropagation(),this.model.toggle(this.attr)},e.prototype.events=function(){return{click:"toggle"}},e.prototype.modelEvents=function(){var t;return t={},t["change:"+this.attr]=this.setCheckboxState,t},e.prototype.setCheckboxState=function(){return null==this.cb&&(this.cb=this.$("input")[0]),this.cb.checked=this.model.get(this.attr)},e}(r)}).call(this)},{"../core-view":33,"../messages":46,"../templates":97}],35:[function(t,e,n){(function(){var n,r,i,o={}.hasOwnProperty,s=function(t,e){function n(){this.constructor=t}for(var r in e)o.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};n=t("backbone"),i=t("../core-model"),e.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return s(e,t),e.prototype.model=i,e.prototype.close=function(){var t;for(this.trigger("close",this),this.off();t=this.pop();)t.collection===this&&(delete t.collection,t.destroy());return this.reset(),this.stopListening()},e}(n.Collection)}).call(this)},{"../core-model":32,backbone:262}],36:[function(t,e,n){(function(){var n,r,i,o,s={}.hasOwnProperty,a=function(t,e){function n(){this.constructor=t}for(var r in e)s.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};o=t("underscore"),n=t("../core-view"),i=t("../templates"),e.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return a(e,t),e.prototype.className="input-group",e.prototype.template=i.template("input-with-button"),e.prototype.getData=function(){return o.extend(this.getBaseData(),{value:this.model.get(this.sets),placeholder:this.placeholder,button:this.button})},e.prototype.initialize=function(t){return this.placeholder=t.placeholder,this.button=t.button,this.sets=t.sets,e.__super__.initialize.apply(this,arguments),null!=this.sets?this.sets:this.sets="value"},e.prototype.postRender=function(){return this.$el.addClass(this.className)},e.prototype.modelEvents=function(){var t;return t={},t["change:"+this.sets]=this.setDomValue,t},e.prototype.events=function(){return{"keyup input":"setModelValue","click button":"act"}},e.prototype.setModelValue=function(t){return this.model.set(this.sets,t.target.value)},e.prototype.setDomValue=function(){var t,e,n;return n=this.model.get(this.sets),t=this.$("input"),e=t.val(),e!==n?t.val(n):void 0},e.prototype.act=function(){return this.trigger("act",this.model.get(this.sets))},e}(n)}).call(this)},{"../core-view":33,"../templates":97,underscore:308}],37:[function(t,e,n){(function(){var n,r,i,o,s={}.hasOwnProperty,a=function(t,e){function n(){this.constructor=t}for(var r in e)s.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};o=t("underscore"),n=t("../core-view"),i=t("../templates"),e.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return a(e,t),e.prototype.className="form-group",e.prototype.template=i.template("input-with-label"),e.prototype.parameters=function(){return["attr","placeholder","label"]},e.prototype.optionalParameters=function(){return["getProblem","helpMessage"]},e.prototype.getProblem=function(t){return null},e.prototype.helpMessage=null,e.prototype.initialize=function(){return e.__super__.initialize.apply(this,arguments),this.setValidity()},e.prototype.setValidity=function(){return this.state.set({problem:this.getProblem(this.model.get(this.attr))})},e.prototype.getData=function(){return o.extend(this.getBaseData(),{value:this.model.get(this.attr),label:this.label,placeholder:this.placeholder,helpMessage:this.helpMessage,hasProblem:this.state.get("problem")})},e.prototype.postRender=function(){return this.$el.addClass(this.className),this.onChangeValidity()},e.prototype.events=function(){return{"keyup input":"setModelValue"}},e.prototype.stateEvents=function(){return{"change:problem":this.onChangeValidity}},e.prototype.modelEvents=function(){var t;return t={},t["change:"+this.attr]=this.onChangeValue,t},e.prototype.onChangeValue=function(){return this.setValidity(),this.setDOMValue()},e.prototype.onChangeValidity=function(){var t,e;return e=this.state.get("problem"),t=this.$(".help-block"),e?(this.$el.toggleClass("has-warning","warning"===e.level),this.$el.toggleClass("has-error","warning"!==e.level),null!=e.message&&t.text(Messages.getText(e.message)),t.slideDown()):(this.$el.removeClass("has-warning has-error"),t.slideUp())},e.prototype.setModelValue=function(t){return this.model.set(this.attr,this.$(t.target).val())},e.prototype.setDOMValue=function(){var t,e,n;return t=this.$("input"),e=t.val(),n=this.model.get(this.attr),n!==e?t.val(n):void 0},e}(n)}).call(this)},{"../core-view":33,"../templates":97,underscore:308}],38:[function(t,e,n){(function(){var n,r,i,o,s,a,u={}.hasOwnProperty,l=function(t,e){function n(){this.constructor=t}for(var r in e)u.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},c=[].slice;a=t("underscore"),n=t("../core-model"),o=function(t,e){return a.extend({},a.isObject(t)?t:{},e)},s=function(t,e){var n;return n=t[e],a.isObject(n)?n:t[e]={}},i=function(t){return a.isObject(t)&&!a.isFunction(t)&&!a.isArray(t)},e.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return l(e,t),e.prototype._triggerChangeRecursively=function(t,e){var n,r,i,o;o=[];for(n in e)i=e[n],r=""+t+"."+n,o.push(a.isObject(i)?this._triggerChangeRecursively(r,i):this.trigger("change:"+r,this,this.get(r)));return o},e.prototype.get=function(t){var n,r;return a.isArray(t)?(n=t[0],r=2<=t.length?c.call(t,1):[],r.reduce(function(t,e){return t&&t[e]},e.__super__.get.call(this,n))):/\w+\.\w+/.test(t)?this.get(t.split(/\./)):e.__super__.get.call(this,t)},e.prototype.pick=function(){var t;return t=1<=arguments.length?c.call(arguments,0):[],a.object(a.flatten(t).map(function(t){return function(e){return[e,t.get(e)]}}(this)))},e.prototype._triggerPathChange=function(t,e){var n,r,i,o,s;for(n=[],this.trigger("change",this,t.join("."),e),s=[],i=0,o=t.length;o>i;i++)r=t[i],n.push(r),s.push(this.trigger("change:"+n.join("."),this,this.get(n)));return s},e.prototype._triggerUnsetPath=function(t,e){var n,r,i;if(a.isObject(e)){i=[];for(n in e)r=e[n],i.push(this._triggerUnsetPath(t.concat([n]),r));return i}return this.trigger("change:"+t.join("."))},e.prototype.set=function(t,n){var r,o,u,l,h,p,f,d,m,g,y;if(null==t)throw new Error("No key");if(!a.isArray(t)){if(a.isString(t))return/\w+\.\w+/.test(t)?this.set(t.split(/\./),n):a.isObject(n)&&!a.isArray(n)?this.set([t],n):e.__super__.set.apply(this,arguments);y=[];for(h in t)m=t[h],y.push(this.set(h,m));return y}{if(!i(n))return u=t[0],p=3<=t.length?c.call(t,1,g=t.length-1):(g=1,[]),o=t[g++],l=this.get(u),!l||!a.isFunction(l)&&a.isObject(l)||this.unset(u),d=null!=l?l:{},r=p.reduce(s,d),f=r[o],r[o]=n,e.__super__.set.call(this,u,d),this._triggerPathChange(t,n),null!=f&&null==n?this._triggerUnsetPath(t,f):void 0;for(h in n)m=n[h],this.set(t.concat([h]),m)}},e}(n)}).call(this)},{"../core-model":32,underscore:308}],39:[function(t,e,n){(function(){var n,r,i,o,s={}.hasOwnProperty,a=function(t,e){function n(){this.constructor=t}for(var r in e)s.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};o=t("underscore"),i=t("../templates"),n=t("./input-with-label"),e.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return a(e,t),e.prototype.parameters=function(){return["model","collection","attr","label","optionLabel"]},e.prototype.optionalParameters=function(){return["noOptionsMessage"].concat(e.__super__.optionalParameters.apply(this,arguments))},e.prototype.template=i.template("select-with-label"),e.prototype.noOptionsMessage="core.NoOptions",e.prototype.events=function(){return{"change select":"setModelValue"}},e.prototype.collectionEvents=function(){return{"add remove reset change":this.reRender}},e.prototype.getData=function(){var t;return t=this.model.get(this.attr),o.extend(this.getBaseData(),{label:this.label,model:this.model.toJSON(),selected:function(e){return e.name===t},options:this.collection.toJSON(),optionLabel:this.optionLabel,helpMessage:this.helpMessage,noOptionsMessage:this.noOptionsMessage,hasProblem:this.state.get("problem")})},e}(n)}).call(this)},{"../templates":97,"./input-with-label":37,underscore:308}],40:[function(t,e,n){(function(){var e,r,i,o,s,a,u,l,c,h,p,f,d=[].slice;f=t("underscore"),r=t("backbone"),s=t("../core-model"),o=t("./collection"),n.assertMatch=function(t,e,n){var r;if(null==n&&(n="value"),r=t.test(e),!r)throw new Error(t.message(n))},u=function(){function t(e,n){return this.type=e,this.name=n,this instanceof t?void 0:new t(this.type,this.name)}return t.prototype.test=function(t){return t instanceof this.type},t.prototype.message=function(t){return""+t+" is not an instance of "+this.name},t}(),p=function(){function t(t,e){this.name=t,this.structure=e,this._msg=null}return t.prototype.failValidation=function(t){return this._msg=t,!1},t.prototype.test=function(t){var e,n,r,i,o;if(this._msg=null,null==t)return this.failValidation("it is null");if(null==t)return!1;o=this.structure;for(r in o)if(i=o[r],e=t[r],n=i.test(e),!n)return this.failValidation(i.message("."+r));return!0},t.prototype.message=function(t){return""+t+" failed "+this.name+" validation, because "+this._msg},t}(),n.InstanceOf=u,n.Structure=p,n.Model=new u(r.Model,"Backbone.Model"),n.CoreModel=new u(s,"core-model"),n.CoreCollection=new u(o,"core/collection"),n.Array=c={name:"array",test:f.isArray,message:function(t){return""+t+" is not an array"}},n.ArrayOf=e=function(t){return{name:"array of "+t.name,test:function(e){return this.passed=c.test(e)&&f.all(e,t.test)},message:function(e){var n;return""+e+" is not an array of "+(null!=(n=t.name)?n:"the correct type")}}},n.Function={name:"function",test:f.isFunction,message:function(t){return""+t+" is not a function"}},n.Number={name:"number",test:f.isNumber,message:function(t){return""+t+" is not a number"}},n.String=h={name:"string",test:f.isString,message:function(t){return""+t+" is not a string"}},n.Maybe=function(t){return{name:"maybe "+t.name,test:function(e){return null==e||t.test(e)},message:function(e){return t.message(e)}}},n.Callable=i={name:"callable",test:function(t){return null!=t&&f.isFunction(t.call)},message:function(t){return""+t+" is not callable"}},n.HasProperty=function(t){return{name:"has-property("+t+")",test:function(e){return null!=e&&t in e},message:function(e){return""+e+"."+t+" not found"}}},n.UnionOf=function(){var t;return t=1<=arguments.length?d.call(arguments,0):[],{name:function(){return"Union of "+t.map(function(t){return t.name}).join(", ")},test:function(e){return f.all(t,function(t){return function(n){return t._t=n,n.test(e)}}(this))},message:function(t){var e;return null!=(e=this._t)?e.message(t):void 0}}},n.Listenable=new p("Listenable",{on:n.Function,off:n.Function}),n.Service=l=new p("Service",{root:h,query:i,fetchModel:i,fetchLists:i,count:i,whoami:i}),n.DataModel=a=new p("imjs.Model",{name:h,makePath:i,findCommonType:i}),n.Query=new p("Query",{service:l,model:a,rows:i,count:i,toXML:i,root:h,views:e(h)})}).call(this)},{"../core-model":32,"./collection":35,backbone:262,underscore:308}],41:[function(t,e,n){(function(){var t;e.exports=t=function(){function t(t,e){this.data=t,this.target=e}return t.prototype.cancel=function(){return this.cancelled=!0},t.prototype.preventDefault=function(){return this.cancel()},t.prototype.stopPropagation=function(){},t}()}).call(this)},{}],42:[function(t,e,n){(function(){n.suppress=function(t){return null!=t&&t.preventDefault(),null!=t?t.stopPropagation():void 0}}).call(this)},{}],43:[function(t,e,n){(function(){var e,r,i,o,s,a,u,l,c;c=t("underscore"),r=t("./templates"),e=t("./core/nested-model"),l=function(t){return t.isAttribute()?t.getParent().getType():t.getType()},a=function(t){var e;return e=l(t),[e.name].concat(t.model.getAncestorsOf(e))},i=function(t){return!!t},s=new e,n.getFormatter=u=function(t){var e,n,r,i,o,u,l,c,h;if(null==t||t.isRoot())throw new Error("No path or path is root");for(u=t.model,o=null!=(h=s.get([u.name]))?h:{},n=a(t),r=t.end.name,l=0,c=n.length;c>l;l++)if(e=n[l],i=o[""+e+"."+r]||o[""+e+".*"],i===!0&&(i=o[e]),null!=i)return i;return null},n.shouldFormat=function(t){if(null==t)throw new Error("no path");return t.isAttribute()?i(u(t)):!1},n.registerFormatter=function(t,e,n,r){if(null==r&&(r=["*"]),null==(null!=t?t.call:void 0))throw new Error("formatter is not a function");return 1===r.length&&"*"!==r[0]?s.set([e,""+n+"."+r[0]],t):(s.set([e,n],t),o(e,n,r))},n.disableFormatter=function(t,e,n){var r,i,o,a;for(null==n&&(n=["*"]),a=[],i=0,o=n.length;o>i;i++)r=n[i],a.push(s.set([t,""+e+"."+r],!1));return a},n.list=function(t){var e,n,r,i;r=s.get([t]),i=[];for(e in r)n=r[e],n&&i.push(e);return i},n.enableFormatter=o=function(t,e,n){var r,i,o,a;for(null==n&&(n=["*"]),a=[],i=0,o=n.length;o>i;i++)r=n[i],a.push(s.set([t,""+e+"."+r],!0));return a},n.defaultFormatter=function(t,e,n){return null!=n?c.escape(n):r.null_value},n.reset=function(){return s.clear(),s.trigger("reset")}}).call(this)},{"./core/nested-model":38,"./templates":97,underscore:308}],44:[function(t,e,n){(function(){var n,r,i,o,s,a,u={}.hasOwnProperty,l=function(t,e){function n(){this.constructor=t}for(var r in e)u.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};a=t("underscore"),i=t("./core-model"),o=t("./options"),n={},s=function(t,e){return n[t]=a.extend({},e)},r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return l(e,t),e.prototype.icon=function(t,e,n){var r,i,o,s;return null==n&&(n={}),r=[],s=function(){var t;t=[];for(i in n)o=n[i],"className"!==i&&t.push(""+i+'="'+a.escape(o)+'"');return t}(),"className"in n&&r.push(a.escape(n.className)),r.push(this.iconClasses(t)),e&&r.push(this.getSize(e)),'<i class="'+r.join(" ")+'" '+s.join(" ")+"></i>"},e.prototype.iconWithProps=function(t,e){return this.icon(t,null,e)},e.prototype.getSize=function(t){var e;return null!=(e=this.get("size"+t.toUpperCase()))?e:""},e.prototype.iconClasses=function(t){return""+this.get("Base")+" "+this.get(t)},e.prototype._loadIconSet=function(){var t;return(t=n[this.options.get("icons")])&&(this.clear({silent:!0}),null!=t)?this.set(t):void 0},e.prototype.initialize=function(t){return this.options=null!=t?t:o,this._loadIconSet(),this.listenTo(this.options,"change:icons",this._loadIconSet)},e}(i),n.glyphicons={Base:"glyphicon",unsorted:"glyphicon-resize-vertical",ASC:"glyphicon-arrow-up",DESC:"glyphicon-arrow-down",headerIcon:"icon",headerIconRemove:"glyphicon-remove",headerIconHide:"glyphicon-minus",headerIconReveal:"glyphicon-fullscreen",SortStringASC:"glyphicon-sort-by-alphabet",SortStringDESC:"glyphicon-sort-by-alphabet-alt",SortNumericASC:"glyphicon-sort-by-order",SortNumericDESC:"glyphicon-sort-by-order-alt",RootClass:"glyphicon-stop",Yes:"glyphicon-star",No:"glyphicon-star-empty",Table:"glyphicon-list",Script:"glyphicon-console",Export:"glyphicon-cloud-download",Error:"glyphicon-warning-sign",Info:"glyphicon-info-sign",Warning:"glyphicon-warning-sign",Remove:"glyphicon-minus-sign",OK:"glyphicon-ok",Cancel:"glyphicon-remove",Check:"glyphicon-check",UnCheck:"glyphicon-unchecked",CheckUnCheck:"glyphicon-ok-none",Add:"glyphicon-plus-sign",Move:"glyphicon-move",More:"glyphicon-plus-sign",Filter:"glyphicon-filter",Summary:"glyphicon-stats",Undo:"glyphicon-refresh",Refresh:"glyphicon-refresh",Columns:"glyphicon-pause",Collapsed:"glyphicon-chevron-right",Expanded:"glyphicon-chevron-down",CollapsedSection:"glyphicon-triangle-right",ExpandedSection:"glyphicon-triangle-bottom",MoveDown:"glyphicon-chevron-down",GoBack:"glyphicon-chevron-left",GoForward:"glyphicon-chevron-right",MoveUp:"glyphicon-chevron-up",Toggle:"glyphicon-random",ExpandCollapse:"glyphicon-chevron-right icon-chevron-down",Help:"glyphicon-question-sign",ReverseRef:"glyphicon-retweet",Reorder:"glyphicon-menu-hamburger",Edit:"glyphicon-edit",ExtraValue:"glyphicon-map-marker",Tree:"glyphicon-plus",Download:"glyphicon-save-file",download:"glyphicon-cloud-download",Options:"glyphicon-tasks",ClipBoard:"glyphicon-paperclip",Composed:"glyphicon-tags",RemoveConstraint:"glyphicon-remove-sign",Dismiss:"glyphicon-remove-sign",ClosedReference:"glyphicon-expand",OpenReference:"glyphicon-collapse-down",Lock:"glyphicon-lock",Lists:"glyphicon-list-alt",Attribute:"glyphicon-unchecked",ExternalLink:"glyphicon-globe",tsv:"glyphicon-list",csv:"glyphicon-list",xml:"glyphicon-xml",json:"glyphicon-json",fake:"glyphicon-bug",Bug:"glyphicon-bug",Rubbish:"glyphicon-trash",RubbishFull:"glyphicon-trash",Joins:"glyphicon-link",Mail:"glyphicon-envelope"},n.fontawesome={Base:"fa",unsorted:"fa-unsorted",ASC:"fa-sort-up",DESC:"fa-sort-down",SortStringASC:"fa-sort-alpha-asc",SortStringDESC:"fa-sort-alpha-desc",SortNumericASC:"fa-sort-numeric-asc",SortNumericDESC:"fa-sort-numeric-desc",headerIcon:"fa",headerIconRemove:"fa-times",headerIconHide:"fa-ellipsis-h",headerIconReveal:"fa-arrows-h",sizeLG:"fa-2x",Yes:"fa-star",No:"fa-star-o",Table:"fa-list",EmptyTable:"fa-table",Script:"fa-file-code-o",Export:"fa-cloud-download",Remove:"fa-minus-circle",
OK:"fa-check",Cancel:"fa-remove",Check:"fa-toggle-on",UnCheck:"fa-toggle-off",CheckUnCheck:"fa-toggle-on fa-toggle-off",Add:"fa-plus",Move:"fa-arrows",More:"fa-plus",Dropbox:"fa-dropbox",Drive:"fa-google",download:"fa-cloud-download",Galaxy:"fa-cloud-upload",GenomeSpace:"fa-cloud-upload",Filter:"fa-filter",Summary:"fa-bar-chart-o",Undo:"fa-undo",Refresh:"fa-refresh",Columns:"fa-columns",Collapsed:"fa-chevron-right",Expanded:"fa-chevron-down",CollapsedSection:"fa-caret-right",ExpandedSection:"fa-caret-down",MoveDown:"fa-chevron-down",GoBack:"fa-chevron-left",GoForward:"fa-chevron-right",MoveUp:"fa-chevron-up",Toggle:"fa-retweet",ExpandCollapse:"fa-chevron-right fa-chevron-down",Help:"fa-question-circle",Tree:"fa-sitemap",ReverseRef:"fa-retweet",Reorder:"fa-reorder",Options:"fa-tasks",Edit:"fa-edit",ExtraValue:"fa-database",Download:"fa-file-archive-o",ClipBoard:"fa-paperclip",Composed:"fa-tags",RemoveConstraint:"fa-times-circle",Dismiss:"fa-times-circle",Error:"fa-warning",Info:"fa-info-circle",Warning:"fa-warning",Lock:"fa-lock",RootClass:"fa-square",Attribute:"fa-tag",ClosedReference:"fa-plus-square",OpenReference:"fa-plus-square-o",CodeFile:"fa-file-code-o",Rubbish:"fa-trash-o",RubbishFull:"fa-trash",Joins:"fa-share-alt",ExternalLink:"fa-globe",Lists:"fa-cloud-upload",tsv:"fa-file-excel-o",csv:"fa-file-excel-o",xml:"fa-code",json:"fa-json",fake:"fa-bug",Bug:"fa-bug",Mail:"fa-envelope"},e.exports=new r,e.exports.Icons=r,e.exports.registerIconSet=s,e.exports.names=function(){var t,e,r;return t=function(){var t;t=[];for(e in n)r=n[e],t.push(a.keys(r));return t}(),a.union.apply(null,t)}}).call(this)},{"./core-model":32,"./options":93,underscore:308}],45:[function(t,e,n){(function(){var e,r,i,o,s,a,u,l,c,h,p,f,d,m;m=t("underscore"),t("./shim"),c=t("imjs").Service.connect,s=t("es6-promise").Promise,d=t("./version"),u=t("./core/type-assertions"),e=t("./views/dashboard"),a=t("./views/table"),o=t("./options"),i=t("./messages"),r=t("./formatting"),f=t("./utils/simple-formatter"),p=function(t){var e;return e=function(n,r,i){var o,a,l;return u.Query.test(i)?new s(h(t,n,i,r)):(l=i.service,a=i.query,o=u.Service.test(l)?l:c(l),o.query(a).then(m.partial(e,n,r)))}},h=function(t,e,n,r){return null==r&&(r={}),function(i){var s,a,u,c,h,p,f;for(a=l(e),u="undefined"!=typeof page&&null!==page?m.pick(r,"start","size"):null,r=m.extend(m.omit(r,"start","size"),{model:u,query:n}),c=t(r),c.setElement(a),f=m.result(c,"className").split(" "),h=0,p=f.length;p>h;h++)s=f[h],a.classList.add(s);return a.classList.add(o.get("StylePrefix")),c.render(),i(c)}},l=function(t){var e,n;if(null==t)throw new Error("No target element provided");if(e=m.isString(t)?document.querySelector(t):null!=(n=t[0])?n:t,null==e)throw new Error("Target("+t+") not found on page");return e},n.version=d,n.setMessages=i.set.bind(i),n.configure=o.set.bind(o),n.loadTable=p(a.create),n.loadDash=p(function(t){return new e(t)}),n.createFormatter=f,n.formatting=m.omit(r,"getFormatter","shouldFormat","reset")}).call(this)},{"./core/type-assertions":40,"./formatting":43,"./messages":46,"./options":93,"./shim":96,"./utils/simple-formatter":134,"./version":141,"./views/dashboard":166,"./views/table":239,"es6-promise":277,imjs:286,underscore:308}],46:[function(t,e,n){(function(){var n,r,i,o,s,a,u,l,c,h,p=function(t,e){return function(){return t.apply(e,arguments)}},f={}.hasOwnProperty,d=function(t,e){function n(){this.constructor=t}for(var r in e)f.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};n=t("backbone"),c=t("underscore"),s=t("./messages/actions"),a=t("./messages/common"),h=t("./templates/helpers"),u=h.numToString,l=h.pluralise,r=[a,s],i={formatNumber:u,pluralise:l},o=function(t){function e(){return this.getText=p(this.getText,this),e.__super__.constructor.apply(this,arguments)}return d(e,t),e.prototype.initialize=function(){return this.cache={},this.on("change",function(t){return function(){return t.cache={}}}(this))},e.prototype.destroy=function(){var t,e;this.off(),e=[];for(t in this)e.push(delete this[t]);return e},e.prototype.getTemplate=function(t){var e,n;return e=null!=(n=this.cache[t])?n:this.get(t),null!=e&&null==e.call&&(e=c.template(e)),this.cache[t]=e},e.prototype.getText=function(t,e){var n,r;return null==e&&(e={}),n=this.getTemplate(t),null!=(r="function"==typeof n?n(c.extend({Messages:this},i,e)):void 0)?r:"!!!No message for "+t+"!!!"},e.prototype.setWithPrefix=function(t,e){var n,r,i;i=[];for(n in e)r=e[n],i.push(this.set(""+t+"."+n,r));return i},e.prototype.defaults=function(){return c.extend.apply(null,[{}].concat(r))},e}(n.Model),e.exports=new o,e.exports.Messages=o}).call(this)},{"./messages/actions":47,"./messages/common":50,"./templates/helpers":98,backbone:262,underscore:308}],47:[function(t,e,n){(function(){e.exports={"export.Export":"Export","export.ExportQuery":"Export","export.DialogueTitle":"Export","export.category.Format":"<%= format.EXT %> Format","export.category.Columns":"<%= columns %> Columns","export.category.Preview":"Preview","export.preview.Limit":"Preview is limited to at most 3 results.","export.heading.Columns":"Columns","export.category.Rows":"<% if (rowCount === max) { %>\n  All\n<% } else { %>\n  <%= rowCount %> of <%= max %>\n<% } %>\nRows","export.category.Compression":"<% if (compression) { %>\n  <%= compression.toUpperCase() %>\n<% } else { %>\n  No\n<% } %> Compression","export.category.Options":"Options","export.category.JsonFormat":"As <%= (jsonFormat === 'objects') ? 'Objects' : 'Rows' %>","export.category.FastaFormat":"FASTA options","export.category.ColumnHeaders":"<% if (headers) { %>\n  <%= {friendly: 'Formatted', path: 'Raw'}[headerType] %>\n<% } else { %>\n  No\n<% } %>\nColumn Headers","export.category.Destination":"<% if (dest === 'download') { %>\n  Download <%= format.EXT %> file\n<% } else { %>\n  Send <%= format.EXT %> to <%= dest %>\n<% } %>","export.galaxy.name":["<% if (orgs.length === 1) { %><%= orgs[0] %> <% } %>","<%= cls %> data","<% if (branding) { %> from <%= branding.name %><% } %>"].join(""),"export.galaxy.info":"<%= query.root %> data from <%= query.service.root %>.\nUploaded from <%= currentLocation %>.\n<% if (lists.length) { %>source: <%= lists.join(', ') %><% } %>\n<% if (orgs.length)  { %>organisms: <%= orgs.join(', ') %><% } %>","export.format.description.TSV":"A flat file format suitable for spreadsheet programmes","export.format.name.TSV":"Tab separated values.","export.format.description.CSV":"A flat file format, suitable for spreadsheet programmes","export.format.name.CSV":"Comma separated values.","export.format.description.XML":"A text format suitable for machine processing.","export.format.name.XML":"XML","export.format.name.JSON":"JSON","export.format.description.JSON":"A text format suitable for machine processing.","export.format.name.FASTA":"FASTA sequence.","export.format.description.FASTA":"FASTA output for sequence data.","export.format.name.GFF3":"GFF3 features.","export.format.description.GFF3":"GFF3 output for sequence features.","export.format.name.BED":"BED locations.","export.format.description.BED":"BED output for sequence feature locations.","export.format.name.FAKE":"Fake","export.format.description.FAKE":"Fake format for testing. Should only appear if the\nquery has departments in the view.","export.format.name.FAKE_2":"Also Fake","export.format.description.FAKE_2":"Fake format for testing. Should only appear if the\nquery has companies in the view.","export.param.Size":"Size: <%= size %>","export.param.Format":"Format","export.param.Start":"Offset: <%= start %>","export.param.Destination":"Destination","export.param.Name":"File name","export.help.AdditionalCols":"You can add any attributes of objects which are already\nin the query.","rows.All":"No limit","export.cloud.FileLocation":"Upload to <%- cloud %> successful. Your file is available at:","export.UseCompression":"Compress results","export.UseGZIP":"Use GZIP compression (produces a .gzip archive)","export.UseZIP":"Use Zip compression (produces a .zip archive)","export.AddHeaders":"Add column headers","export.json.Rows":"Return results as rows - each row is an Array of JSON values, e.g.:","export.SetTablePage":"Select rows in table","export.ResetRowSelection":"Select all rows","export.json.RowsExample":'["eve", "2R", 5866824, 5868300]',"export.json.ObjExample":'{\n  "class": "Gene",\n  "symbol": "eve",\n  "chromosomeLocation": {\n    "class": "ChromosomeLocation",\n    "start": 5866824,\n    "end": 5868300\n    "locatedOn": {\n      "class": "Chromosome",\n      "primaryIdentifier": "2R"\n    }\n  }\n}',"export.json.Objects":"Return results as objects - each result is a nested graph of\ndata, e.g.:","export.json.ObjWarning":"Please note that it is not recommended to set the size parameters\nwhen requesting object results, since the size of the result\nset, and the position of the offsets will differ when multiple\nrows are replaced by a single object with a collection.","export.ff.FriendlyHeaders":'Human readable headers (eg. "Gene > Organism Name")',"export.ff.PathHeaders":'Raw path headers (eg. "Gene.organism.shortName)',"export.error.NoColumnsSelected":"No columns selected","export.error.OffsetOutOfBounds":"The offset is greater than the total number of results.",ListNameDuplicate:"List names must be unique. This name is already taken",ListNameEmpty:"Lists must have names. Please enter one",ListNameIllegal:"Some characters are not allowed in list names. This name contains the following\nillegal characters: <%- illegals.join(', ') %>. Please remove them.",ExportTitle:"Download results for <%= name || 'query' %>",ConfigureExport:"Configure Export",GetData:"Download Data",ExportHelp:"Download file containing results to your computer",ExportButton:"Download","download-file":"Download File",download:"Download file",Galaxy:"Send to Galaxy",GenomeSpace:"Upload to Genomespace",Drive:"Save to Google Drive",Dropbox:"Save to Dropbox","Destdownload-file":"File",DestGalaxy:"Galaxy",DestGenomespace:"Genomespace",ExportAlt:"Send Data Somewhere Else",ExportLong:'<span class="hidden-tablet">Download</span>\nFile\n<span class="im-only-widescreen">to your Computer</span>',SendToGalaxy:'<span class="hidden-tablet">Send to</span>\nGalaxy\n<span class="im-only-widescreen">for analysis</span>',SendToGenomespace:'<span class="hidden-tablet">Upload to</span>\n<span class="im-only-widescreen">your</span>\nGenomespace\n<span class="im-only-widescreen">account</span>',MyGalaxy:"Send to your Galaxy",ForgetGalaxy:"Clear this galaxy URL",GalaxyHelp:"Start a file upload job within Galaxy",GalaxyURILabel:"Galaxy Location:",GalaxyAlt:"Send to a specific Galaxy",SaveGalaxyURL:"Make this my default Galaxy",WhatIsGalaxy:"What is Galaxy?",WhatIsGalaxyURL:"http://wiki.g2.bx.psu.edu/",GalaxyAuthExplanation:"If you have already logged into Galaxy with this browser, then the data\nwill be sent into your active account. Otherwise it will appear in a \ntemporary anonymous account.",CopyToClipBoard:"Copy to clipboard: <CTL>+C, <ENTER>",IsPrivateData:"This link provides access to data stored in your private lists. In order to do so\nit uses the API access token provided on initialisation. If this is your permanent\nAPI token you should be as careful of this link as you would of the data is provides\naccess to. If this is just a 24 hour access token, then you will need to replace it\nonce it becomes invalid.",LongURI:"The normal URI for this query (which includes the full query XML in the \nparameters) is too long for a GET request. The URI you can see here uses a\nquery-id, which has a limited validity. You should not store this URI for long\nterm use.",SendToOtherGalaxy:"Send",AllRows:"Whole Result Set",SomeRows:"Specific Range",WhichRows:"Rows to Export",RowsHelp:"Export all rows, or define a range of rows to export.",AllColumns:"All Current Columns",SomeColumns:"Choose Columns",CompressResults:"Compress results",NoCompression:"No compression",GZIPCompression:"GZIP",ZIPCompression:"ZIP",Copy:"copy to clip-board",ResultsPermaLink:"Perma-link to results",ResultsPermaLinkText:"Results URI",QueryXML:"Query XML",ResultsPermaLinkTitle:"Get a permanent URL for these results, suitable for your own use",ResultsPermaLinkShareTitle:"Get a permanent URL for these results, suitable for sharing with others",ColumnsHelp:"Export all columns, or choose specific columns to export.",WhichColumns:"Columns to Export",ResetColumns:"Reset Columns.",FirstRow:"From",LastRow:"To",SpreadsheetOptions:"Spreadsheet Options",ColumnHeaders:"Include Column Headers",PossibleColumns:"You can add any attribute from these nodes without changing your results:",ExportedColumns:"Exported Columns (drag to reorder)",ChangeColumns:"You may add any of the columns in the right hand box by clicking on the\nplus sign. You may remove unwanted columns by clicking on the minus signs\nin the left hand box. Note that while adding these columns will not alter your query,\nif you remove all the attributes from an item, then you <b>may change</b> the results\nyou receive.",OuterJoinWarning:"This query has outer-joined collections. This means that the number of rows in \nthe table is likely to be different from the number of rows in the exported results.\n<b>You are strongly discouraged from specifying specific ranges for export</b>. If\nyou do specify a certain range, please check that you did in fact get all the \nresults you wanted.",IncludedFeatures:"Exportable parts of this Query - <strong>choose at least one</strong>:",FastaFeatures:"Features with Sequences in this Query - <strong>select one</strong>:",FastaOptions:"FASTA Specific Options",FastaExtension:"Extension (eg: 100/100bp/5kbp/0.5mbp):",ExtraAttributes:"Columns to include as extra attributes on each exported record:",NoSuitableColumns:"There are no columns of a suitable type for this format.",BEDOptions:"BED Specific Options",Gff3Options:"GFF3 Specific Options",ChrPrefix:'Prefix "chr" to the chromosome identifier as per UCSC convention (eg: chr2)',ConfigureExportHelp:"Configure the export options in these categories","largetable.ok":"Set page size to <%- size %>","largetable.abort":"Cancel","largetable.appeal":"You have requested a very large table size (<%= size %> rows per page). Your\nbrowser may struggle to render such a large table,\nand the page could become unresponsive. In any case,\nwill be very difficult for you to read the whole table\nin the page. We suggest the following alternatives:"}}).call(this)},{}],48:[function(t,e,n){(function(){var e;e=t("../messages"),e.setWithPrefix("codegen",{AsHTML:"As HTML page",DialogueTitle:'Generated <%= Messages.getText("codegen.Lang", {lang: lang}) %>\nCode for <%= query.name || "Query" %>',CannotExportXML:"You cannot save the XML as a file directly. Please use your browser's cut\nand paste functionality.",PrimaryAction:"Save",ChooseLang:"Choose Language",ShowBoilerPlate:"Show comments",HighlightSyntax:"Highlight Syntax",GenerateCodeIn:function(t){var n;return n=t.lang,"Generate "+e.getText("codegen.Lang",{lang:n})+"\n"+("xml"!==n?"code":"")},Lang:function(t){var e;switch(e=t.lang){case"py":return"Python";case"pl":return"Perl";case"java":return"Java";case"rb":return"Ruby";case"js":return"JavaScript";case"xml":return"XML";default:throw new Error("Unknown language "+e)}}})}).call(this)},{"../messages":46}],49:[function(t,e,n){(function(){var e;e=t("../messages"),e.setWithPrefix("columns",{DialogueTitle:"Manage Columns",ApplyChanges:"Apply Changes",FindColumnToAdd:"Add a Column",AddColumn:"<% if (num < 1) { %>\n  No columns chosen\n<% } else { %>\n  Add <%= num %> new <%= pluralise('column', num) %>\n<% } %>",AddColumnToSortOrder:"Sort by this column",NoChangesToApply:"There are no changes to apply.",OrderVerb:"Add / Remove / Re-Arrange",OrderTitle:"Columns",SortVerb:"Configure",SortTitle:"Sort-Order",OnlyColsInView:"Only show columns in the table:",SortingHelpTitle:"What Columns Can I Sort by?",ViewTabTitle:"Selected Columns",SortOrderTabTitle:"Sort Order",CurrentView:"Current Columns",CurrentViewHelp:"Re-arrange or remove columns by dragging, or by using the buttons",CurrentSortOrder:"<% if (oes.length) { %>\n  <%= oes.length %> Order <%= pluralise('Elements', oes.length) %>\n<% } else { %>\n  Not sorted.\n<% } %>",NoSortOrder:"No sort order. Drop columns here to sort the table.",RemoveOrderElement:"Remove this column from the sort-order",CurrentSortOrderHelp:"Re-arrange, add or remove columns. The full set of available\ncolumns is listed below.",ColumnsSelected:'<%= columns.length %> <%= pluralise("Column", columns.length) %>\nSelected<% if (removed) { %>, <%= removed %> Removed<% } %>',ChooseAPathFrom:"Choose a path from <%= root %>",RemoveColumn:"Remove this column",MoveUp:"Move this column up",MoveDown:"Move this column down",ColumnWillBeRemoved:"This column will be removed",RestoreColumn:"Add this column back to the table",ChangeDirection:"Change sort direction",CurrentDirection:"Sorted in\n<%= (dir === 'DESC') ? 'reverse' : void 0 %>\n<%= numeric ? 'numerical' : 'alphabetical' %>\norder.",ManageColumns:"Manage Columns",ManageColumnsShort:"Columns"})}).call(this)},{"../messages":46}],50:[function(t,e,n){(function(){e.exports={All:"All",Reset:"Reset",Export:"Download",Clear:"Clear",Cancel:"Cancel",Complete:"Complete",Error:"Error",Warning:"Warning",Filter:"Filter",Loading:"Loading",Undo:"Undo",and:"and",or:"or",comma:",",Number:"<%= formatNumber(n) %>","modal.DefaultTitle":"Excuse me...","modal.Dismiss":"Close","modal.OK":"OK","modal.ApplyChanges":"Apply Changes","core.NoOptions":"There are no options to select from.",ErrorTitle:function(t){var e;switch(e=t.level){case"Error":return"Error";case"Warning":return"Warning";case"Info":return"nb";case"Positive":return"Success";default:return"Error"}}}}).call(this)},{}],51:[function(t,e,n){(function(){var e;e=t("../messages"),e.setWithPrefix("constraints",{Heading:'<%= n %> Active <%= pluralise("Filter", n) %>',AddNewFilter:"Add New Filter",AddFilter:"Add filter",AddNew:"Add Filter",DefineNew:"Define a new filter",EditOrRemove:"edit or remove the currently active filters",None:"No active filters",NoOfValues:'<%= (n === 1) ? "one" : formatNumber(n) %> <%= pluralise("value", n) %>',NoOfIds:'<%= (n === 1) ? "one" : formatNumber(n) %> <%= pluralise("ID", n) %>',ISA:"is a",LookupIn:"in",AddConFor:"Add filter to\n<% if (isAttribute && !hideType) { %><%= typeName %><% } %>\n<%= _.last(parts) %>",ManageFilters:"Manage Filters",ManageFiltersShort:"Filters"})}).call(this)},{"../messages":46}],52:[function(t,e,n){(function(){var e;e=t("../messages"),e.setWithPrefix("error",{Oops:"Oops! - Sorry we cannot get that table for you.",EmailHelp:"Send a bug report",ShowQuery:"Show query",ShowError:"Show error",ConnectionError:"Could not connect to server"}),e.setWithPrefix("error.mail",{Subject:"[IMTABLES] - Error running query."}),e.setWithPrefix("error.client",{Heading:"Application error.",Body:"This is due to an unexpected error in the tables\napplication - this is our fault, and we are sorry for the\ninconvenience. Please send us the pre-filled bug report so\nwe can fix this as soon as possible."}),e.setWithPrefix("error.server",{Heading:"Server error - our bad!",Body:"This is most likely related to the query that was just run. If you have\ntwo minutes, please send us an email with details of this query to help us\ndiagnose and fix this bug - we have already pre-filled the bug report,\nyou just need to hit send (and maybe give us some extra details).\nAlternatively, you might be able to fix this query by changing its column, \nfilters or joins; use the tools above to do so."})}).call(this)},{"../messages":46}],53:[function(t,e,n){(function(){var e;e=t("../messages"),e.setWithPrefix("joins",{Heading:"Manage Relationships",Manage:function(){return e.getText("joins.Heading")},ManageShort:"Relationships",Inner:"Required",Outer:"Optional",ExplanationTitle:"What does this do?",Explanation:"You can specify the entity relationships within the query here. This\nhas a couple of effects - one is to exclude a class of matched results, the\nother is to change the way the results are presented in the table.\nIf set to required, then an entity which matches the filters\nbut lacks the given relationship will not be returned in the results,\nwhereas if set to optional it will. This also has an effect on the\nway that results are laid out: required collection relationships\nare returned inline, whereas optional collection relationships are\nreturned as nested sub-tables within the main result set."})}).call(this)},{"../messages":46}],54:[function(t,e,n){(function(){var e;e=t("../messages"),e.setWithPrefix("lists",{DefaultName:"<%= typeName %> List (<%= new Date() %>)",Create:"Create List",Append:"Add to List",SaveAsList:"Save as List",CreateListTitle:"Create a new List\n<% if (state.count) { %>\n  of <%= formatNumber(state.count) %>\n  <%= pluralise(state.typeName, (state.count || 0)) %>\n<% } %>",AppendToListTitle:"Add\n<% if (state.count) { %>\n  <%= formatNumber(state.count) %>\n  <%= pluralise(state.typeName, (state.count || 0)) %>\n<% } %>\nto\n<%= target || 'a List' %>",NoTags:"No tags",AddTag:"Add a new tag",AddTagBtn:"add",RemoveTag:"Remove this tag",ShowExtraOptions:"<% if (minimised) { %>Show <% } %>Optional attributes",TargetDoesNotExist:"Your target list does not exist.",NoTargetSelected:"Please select a target list.",PossibleAppendTarget:"<%= name %> (<%= formatNumber(size) %> <%= pluralise((typeName || 'item'), size) %>)",NoObjectsSelected:"No objects selected. Choose objects from the table beneath. You can\ndrag this dialog around if it is in the way.",StartPicking:"Pick items from the table",NoCommonType:"There is no common type for these objects."}),e.setWithPrefix("lists.error",{MustBeLoggedIn:"You are not logged in. Anonymous users cannot create lists."}),e.setWithPrefix("lists.params",{Name:"List Name",NamePlaceholder:"List name is required",Desc:"List Description",DescPlaceholder:"Enter a description",Target:"Choose list to append items to"}),e.setWithPrefix("lists.params.help",{Name:"You must provide a unique list name",Target:"You must select a target list"}),e.setWithPrefix("lists.picker",{Expand:"show more options",Collapse:"show fewer options"}),e.setWithPrefix("lists.append",{NoSuitableLists:"No suitable lists were found\n<% if (model.type) { %>\n  for <%- model.type %>.\n<% } else { %>\n  because no items are selected, or they have no common type.\n<% } %>"})}).call(this)},{"../messages":46}],55:[function(t,e,n){(function(){var e;e=t("../messages"),e.setWithPrefix("logic",{Heading:"Manage Constraint Logic",Manage:function(){return e.getText("logic.Heading")},ManageShort:"Constraint Logic",LogicLabel:function(){return e.getText("logic.ManageShort")},ApplyLogic:"Change logic"})}).call(this)},{"../messages":46}],56:[function(t,e,n){(function(){var e;e=t("../messages"),e.setWithPrefix("subtables",{OpenHint:"Click to view/hide rows",RemoveColumn:"Remove this column"})}).call(this)},{"../messages":46}],57:[function(t,e,n){(function(){var e;e=t("../messages"),e.setWithPrefix("summary",{Got:"<% if (available > got) { %>Showing <%= formatNumber(got) %> of<% } %>",Max:"Maximum",Min:"Minimum",Bucket:"<%= range.min %> to <%= range.max %>: <%= count %> values",Count:"Count",Item:"Item",Average:"Average",StdDev:"Standard Deviation",OnlyOne:"There is only one <%- names.typeName %> <%- names.endName %>:\n<strong><%- item.item %></strong>, which occurs\n<strong>\n  <% if (item.count === 1) { %>\n    once\n  <% } else if (item.count === 2) { %>\n    twice\n  <% } else { %>\n    <%- formatNumber(item.count) %> times\n  <% } %>\n</strong>",NumericDistribution:"Showing distribution of <%= formatNumber(n) %>",FilterValuesPlaceholder:"Filter values",DownloadData:"Download data",DownloadFormat:"As",MoreItems:"Load more items",Include:"Restrict table to matching rows",Exclude:"Exclude matching rows from table",Reset:"Reset selection",Toggle:"Toggle selection",SelectFilter:"Select filter type",FacetBar:"rgba(206, 210, 222, <%= opacity %>)",NoResults:"No results for <%= path %>",SelectedCount:"<%= isApprox ? \"ca. \" : void 0 %><%= formatNumber(selectedCount) %>\n<%= pluralise('Item', selectedCount) %> Selected",Total:"<% if (filtered) { %>(filtered from <%= formatNumber(total) %>)<% } %>"})}).call(this)},{"../messages":46}],58:[function(t,e,n){(function(){var e;e=t("../messages"),e.setWithPrefix("table",{Building:"Loading Table ...",OverlayText:"Requesting data...",Empty:"No Results",EmptyWhy:"This query returns no results. You may wish to change its filters"}),e.setWithPrefix("table.lg",{ShowingAll:"Showing all <%= formatNumber(count) %> rows",ShowingRange:'Showing <%= formatNumber(first) %> to <%= formatNumber(last) %>\nof <%= formatNumber(count) %> <%= pluralise("row", count) %>'}),e.setWithPrefix("table.md",{ShowingAll:"All <%= formatNumber(count) %> rows",ShowingRange:"Showing rows <%= formatNumber(first) %> to <%= formatNumber(last) %>\nof <%= formatNumber(count) %>"}),e.setWithPrefix("table.sm",{ShowingAll:"All rows",ShowingRange:"Rows <%= formatNumber(first) %> to <%= formatNumber(last) %>\nof <%= formatNumber(count) %>"}),e.setWithPrefix("table.xs",{ShowingAll:"All rows",ShowingRange:"<%= formatNumber(first) %> to <%= formatNumber(last) %>\nof <%= formatNumber(count) %>"}),e.setWithPrefix("table.header",{FailedToInitSortMenu:"Could not initialise the sorting menu.",FailedToInitFilter:"Could not initialise the filter menu.",FailedToInitSummary:"Could not intitialise the column summary.",ViewSummary:"View column summary",ToggleColumn:"Toggle column visibility",RemoveColumn:"Remove this column",SortColumn:"<% if (dir === 'ASC') { %>\n  Sorted in ascending order.\n<% } else if (dir === 'DESC') { %>\n  Sorted in descending order.\n<% } else { %>\n  Sort this column.\n<% } %>",ToggleTables:"Expand/collapse all sub-tables",Composed:"This column replaces <%= replaces.length %> others. Click here\nto show the individual columns separately.",FilterTitle:"<% if (count > 0) { %>\n  <%= count %> active filters.\n<% } else { %>\n  Filter by values in this column.\n<% } %>"})}).call(this)},{"../messages":46}],59:[function(t,e,n){(function(){var e;e=t("../messages"),e.setWithPrefix("undo",{StepTitle:"<% if (label === 'Initial') { %>\n  Initial State\n<% } else if (verb === 'Added') { %>\n  <% if (label === 'sort order element') { %>\n    Added <%= formatNumber(number) %> <%= pluralise('column', number) %> to the sort order\n  <% } else if (label === 'column') { %>\n    Selected <%= formatNumber(number) %> <%= pluralise('column', number) %>\n  <% } else { %>\n    Added <%= formatNumber(number) %> <%= pluralise(label, number) %>\n  <% } %>\n<% } else if (verb === 'Removed') { %>\n  <% if (label === 'sort order element') { %>\n    Removed <%= formatNumber(number) %> <%= pluralise('column', number) %> from the sort order\n  <% } else if (label === 'column') { %>\n    Unselected <%= formatNumber(number) %> <%= pluralise('column', number) %>\n  <% } else { %>\n    Removed <%= formatNumber(number) %> <%= pluralise(label, number) %>\n  <% } %>\n<% } else if (verb === 'Changed') { %>\n  <% if (label === 'sort order element') { %>\n    Changed sort order\n  <% } else { %>\n    Changed <%= pluralise(label, 2) %>\n  <% } %>\n<% } else if (verb === 'Rearranged') { %>\n  Rearranged <%= pluralise(label, 2) %>\n<% } else { %>\n  !!!Cannot handle <%= verb %> <%= label %>!!!\n<% } %>",StepCount:'<%= formatNumber(count) %> <%= pluralise("row", count) %>',RevertToState:"Revert to this state",IsCurrentState:"This is the current state",ViewCount:'<%= n %> <%= pluralise("column", n) %> selected',ConstraintCount:"<% if (n) { %>\n  <%= n %> <%= pluralise('filter', n) %>\n<% } else { %>\n  No filters\n<% } %>",OrderElemCount:"<% if (n) { %>\n  Sorted on <%= n %> <%= pluralise('column', n) %>\n<% } else { %>\n  Not sorted\n<% } %>",ShowAllStates:"Show <%= n %> hidden <%= pluralise('state', n) %>",ToggleTrivial:'<%= hideTrivial ? "Hiding" : "Hide" %> minor steps',ToggleTrivialTitle:'<%= hideTrivial ? "Hiding" : "Hide" %> steps that did not change the row count',Revision:"no. <%= v %>",RevisionTitle:"revision <%= v %>",MoreSteps:'<%= more %> more <%= pluralise("step", more) %>'})}).call(this)},{"../messages":46}],60:[function(t,e,n){(function(){var e,r;e=t("jquery"),r=function(t){var n,r,i;return n=e("body"),r=n.width(),i=t.width(),t.css({left:(r-i)/2,top:50})},n._showModal=function(){var t;return t=this.$el,t.modal({show:!1}).addClass("im-floating").draggable({handle:".modal-header"}).show(function(){return r(t),t.animate({opacity:1},{complete:function(){return t.addClass("in")}})}),this.listenToOnce(this,"remove",function(t){return function(){return t.$el.draggable("destroy")}}(this))},n._hideModal=function(){return this.$el.removeClass("in"),this.onHidden()}}).call(this)},{jquery:305}],61:[function(t,e,n){(function(){var e;e=t("underscore"),n.setChildIndices=function(t,n,r){var i,o,s,a,u,l,c,h,p;for(null==n&&(n="top"),null==r&&(r="collection"),s=this.children,i=this[r],l=e.compact(i.map(function(e){return s[t(e)]})),a=e.sortBy(l,function(t){return t.el.getBoundingClientRect()[n]}),p=[],o=c=0,h=a.length;h>c;o=++c)u=a[o],p.push(u.model.set({index:o}));return p}}).call(this)},{underscore:308}],62:[function(t,e,n){(function(){var e;e=t("underscore"),n.initTypeaheads=function(){return null!=this._typeaheads?this._typeaheads:this._typeaheads=[]},n.removeTypeAheads=function(){var t,e;if(null!=this._typeaheads){for(e=[];t=this._typeaheads.shift();)t.off("typeahead:select"),t.off("typeahead:selected"),t.off("typeahead:autocompleted"),t.off("typeahead:close"),e.push(t.typeahead("destroy"));return e}},n.lastTypeahead=function(){var t;return e.last(null!=(t=this._typeaheads)?t:[])},n.activateTypeahead=function(t,e,n,r,i,o){return t.attr({placeholder:r}).typeahead(e,n),t.on("typeahead:selected",i),t.on("typeahead:select",i),t.on("typeahead:autocompleted",i),null!=o&&t.on("typeahead:close",o),this.initTypeaheads().push(t),t.focus(),this}}).call(this)},{underscore:308}],63:[function(t,e,n){(function(){var e,r;r=t("underscore"),e={},n.runQuery=function(t){var n,r,i,o,s;return null==t&&(t={}),o=this.getExportParameters(t),i="results:"+this.query.service.root+":"+JSON.stringify(o),n="query/results",r=this.model.get("format"),(null!=(s=r.needs)?s.length:void 0)&&(n+="/"+r.id),null!=e[i]?e[i]:e[i]=this.query.service.post(n,o)},n.getEstimatedSize=function(){var t,n;return n=this.getExportQuery(),t="count:"+n.service.root+":"+n.toXML(),null!=e[t]?e[t]:e[t]=n.count()},n.getExportQuery=function(){var t,e;return e=this.query.clone(),t=this.model.get("columns"),(null!=t?t.length:void 0)&&e.select(t),e},n.getExportURI=function(t){return this.getExportQuery().getExportURI(this.model.get("format").id,this.getExportParameters(t))},n.getFileName=function(){return""+this.getBaseName()+"."+this.getFileExtension()},n.getBaseName=function(){return this.model.get("filename")},n.getFileExtension=function(){return this.model.get("format").ext},n.getExportParameters=function(t){var e;return null==t&&(t={}),e=this.model.pick("start","size","format","filename"),e.format=e.format.id,e.query=this.getExportQuery().toXML(),this.model.get("compress")&&(e.compress=this.model.get("compression")),this.model.get("headers")&&(e.columnheaders=this.model.get("headerType")),"json"===e.format&&"rows"!==this.model.get("jsonFormat")&&(e.format+=this.model.get("jsonFormat")),"fasta"===e.format&&this.model.get("fastaExtension")&&(e.extension=this.model.get("fastaExtension")),r.extend(e,t)}}).call(this)},{underscore:308}],64:[function(t,e,n){(function(){n.setPathNames=function(){var t,e,n,r,i,o,s,a,u,l;return e=null!=(u=this.query)?u:this.model.query,a=null!=(l=this.view)?l:this.model.view,r=e.service,s=a.getParent().getType(),t=a.end,n=this.state,i=function(t){return function(e){return n.set(t,e)}},o=i("error"),a.getDisplayName().then(i("pathName"),o),s.getDisplayName().then(i("typeName"),o),
r.get("model/"+s.name+"/"+t.name).then(function(t){var e;return e=t.name}).then(i("endName"),o)}}).call(this)},{}],65:[function(t,e,n){(function(){var n,r,i,o={}.hasOwnProperty,s=function(t,e){function n(){this.constructor=t}for(var r in e)o.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};i=t("underscore"),r=t("../core-model"),e.exports=n=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return s(e,t),e.prototype.defaults=function(){return{target:null,type:null}},e}(r)}).call(this)},{"../core-model":32,underscore:308}],66:[function(t,e,n){(function(){var n,r,i,o,s,a,u={}.hasOwnProperty,l=function(t,e){function n(){this.constructor=t}for(var r in e)u.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};r=t("../core/collection"),i=t("./path"),o=function(t,e,n){var r,i,o,s;return s=function(){var r,i,s,a;for(s=[e,n],a=[],r=0,i=s.length;i>r;r++)o=s[r],a.push(t(o));return a}(),r=s[0],i=s[1],i>r?-1:r>i?1:0},a=function(t){return t.get("parts").length},s=function(t){return t.get("displayName")},e.exports=n=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return l(e,t),e.prototype.model=i,e.prototype.add=function(t){var n;return n=e.__super__.add.apply(this,arguments),n&&null==n.collection?n.collection=this:void 0},e.prototype.initialize=function(){return e.__super__.initialize.apply(this,arguments),this.on("change:parts change:displayName",function(t){return function(){return t.sort()}}(this))},e.prototype.comparator=function(t,e){return o(a,t,e)||o(s,t,e)},e}(r)}).call(this)},{"../core/collection":35,"./path":86}],67:[function(t,e,n){(function(){var n,r,i,o,s,a,u={}.hasOwnProperty,l=function(t,e){function n(){this.constructor=t}for(var r in e)u.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};a=t("underscore"),s=t("es6-promise").Promise,o=t("../options"),r=t("../core-model"),i="DynamicObjects.NameDelimiter",e.exports=n=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return l(e,t),e.prototype.defaults=function(){return{columnName:null,typeName:null,typeNames:[],entity:null,column:null,node:null,field:null,value:null}},e.prototype.initialize=function(){var t,n,r,a,u,l;return e.__super__.initialize.apply(this,arguments),u=null!=(l=this.get("entity").get("classes"))?l:[this.get("node")],n=(t=this.get("column")).model,t.getDisplayName().then(function(t){return function(e){return t.set({columnName:e})}}(this)),r=function(){var t,e,r;for(r=[],t=0,e=u.length;e>t;t++)a=u[t],r.push(n.makePath(a).getDisplayName());return r}(),s.all(r).then(function(t){return function(e){return t.set({typeNames:e,typeName:e.join(o.get(i))})}}(this))},e.prototype.getPath=function(){return this.get("column")},e.prototype.toJSON=function(){return a.extend(e.__super__.toJSON.apply(this,arguments),{column:this.get("column").toString(),node:this.get("node").toString(),entity:this.get("entity").toJSON()})},e}(r)}).call(this)},{"../core-model":32,"../options":93,"es6-promise":277,underscore:308}],68:[function(t,e,n){(function(){var n,r,i,o={}.hasOwnProperty,s=function(t,e){function n(){this.constructor=t}for(var r in e)o.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};i=t("../options"),r=t("../core-model"),e.exports=n=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return s(e,t),e.prototype.defaults=function(){return{lang:i.get("CodeGen.Default"),showBoilerPlate:!1,highlightSyntax:!0}},e}(r)}).call(this)},{"../core-model":32,"../options":93}],69:[function(t,e,n){(function(){var n,r,i,o,s={}.hasOwnProperty,a=function(t,e){function n(){this.constructor=t}for(var r in e)s.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};n=t("../core/collection"),i=t("./header"),o=t("../utils/build-headers"),e.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return a(e,t),e.prototype.model=i,e.prototype.comparator="index",e.prototype.initialize=function(){return e.__super__.initialize.apply(this,arguments),this.listenTo(this,"change:index",this.sort)},e.prototype.setHeaders=function(t,e){var n;return n=o(t,e),n.then(function(e){return function(n){var r;return e.set(function(){var e,o,s;for(s=[],e=0,o=n.length;o>e;e++)r=n[e],s.push(new i(r,t));return s}())}}(this))},e}(n)}).call(this)},{"../core/collection":35,"../utils/build-headers":101,"./header":74}],70:[function(t,e,n){(function(){var n,r,i,o,s,a,u,l,c,h=[].indexOf||function(t){for(var e=0,n=this.length;n>e;e++)if(e in this&&this[e]===t)return e;return-1},p={}.hasOwnProperty,f=function(t,e){function n(){this.constructor=t}for(var r in e)p.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};l=t("underscore"),c=t("imjs").Query,r=c.LIST_OPS,i=c.LOOP_OPS,a=c.TERNARY_OPS,s=c.RANGE_OPS,o=t("./path"),u=function(t){var e,n,o,u;if(t.path.isAttribute())return t.values?"MULTI_VALUE":"ATTR_VALUE";if(t.type)return"TYPE";if(t.ids)return"IDS";if(t.values&&(e=t.op,h.call(s,e)>=0))return"RANGE";if(n=t.op,h.call(a,n)>=0)return"LOOKUP";if(o=t.op,h.call(r,o)>=0)return"LIST";if(u=t.op,h.call(i,u)>=0)return"LOOP";throw new Error("Cannot determine constraint type: "+t.path+" "+t.op)},e.exports=n=function(t){function e(t){var n;e.__super__.constructor.call(this,t.path),n=t.type,this.unset("id"),this.unset("type"),this.set(l.omit(t,"path","type")),null!=n&&(this.set({type:n.toString()}),n.getDisplayName().then(function(t){return function(e){return t.set({typeName:e})}}(this))),this.set({CONSTRAINT_TYPE:u(t)})}return f(e,t),e.prototype.defaults=function(){return l.extend(e.__super__.defaults.apply(this,arguments),{value:null,values:[],ids:[],extraValue:null,code:null,CONSTRAINT_TYPE:"ATTR_VALUE"})},e}(o)}).call(this)},{"./path":86,imjs:286,underscore:308}],71:[function(t,e,n){(function(){var n,r,i,o,s,a,u={}.hasOwnProperty,l=function(t,e){function n(){this.constructor=t}for(var r in e)u.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};a=t("underscore"),r=t("../core-model"),n=t("../core/collection"),o=/,\s*/,s=function(t){return t.replace(/(^\s+|\s+$)/g,"")},e.exports=i=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return l(e,t),e.prototype.defaults=function(){return{name:null,description:null}},e.prototype.initialize=function(){var t;return this.tags=new n,this.has("tags")&&this.tags.reset(function(){var e,n,r,i;for(r=this.get("tags"),i=[],e=0,n=r.length;n>e;e++)t=r[e],i.push({id:t});return i}.call(this)),this.listenTo(this.tags,"remove",function(t){return function(e){return t.trigger("remove:tag",e),t.trigger("change")}}(this)),this.listenTo(this.tags,"add",function(t){return function(e){return t.trigger("add:tag",e),t.trigger("change")}}(this))},e.prototype.toJSON=function(){return a.extend(e.__super__.toJSON.apply(this,arguments),{tags:this.tags.map(function(t){return t.get("id")})})},e.prototype.addTag=function(){var t,e,n,r,i,a;if(e=this.get("nextTag"),null==e)throw new Error("No tag to add");for(this.unset("nextTag"),i=s(e).split(o),a=[],n=0,r=i.length;r>n;n++)t=i[n],a.push(this.tags.add({id:t}));return a},e.prototype.destroy=function(){var t;return null!=(t=this.tags)&&t.close(),e.__super__.destroy.apply(this,arguments)},e}(r)}).call(this)},{"../core-model":32,"../core/collection":35,underscore:308}],72:[function(t,e,n){(function(){var e,r,i;i=t("underscore"),e=function(){function t(t){var e,n,r,o,s,a;this.id=t.id,this.group=t.group,o=t.icon,a=t.needs,this.maxColumns=t.maxColumns,r="tab"===this.id?"tsv":this.id,e=r.toUpperCase(),null==o&&(o=r),null==a&&(a=[]),n="export.format.description."+e,s="export.format.name."+e,i.extend(this,{icon:o,desc:n,name:s,needs:a,ext:r,EXT:e})}return t.prototype.toString=function(){return this.ext},t.prototype.toJSON=function(){return{id:this.id,group:this.group,icon:this.icon,needs:this.needs,ext:this.ext}},t.prototype.isSuitable=function(t){return 0===this.needs.length?!0:i.any(this.needs,function(e){return t[e]})},t}(),r=[new e({id:"tab",group:"flat"}),new e({id:"csv",group:"flat"}),new e({id:"xml",group:"machine"}),new e({id:"json",group:"machine"}),new e({id:"fasta",group:"bio",icon:"dna",needs:["Protein","SequenceFeature"],maxColumns:1}),new e({id:"gff3",group:"bio",icon:"dna",needs:["SequenceFeature"]}),new e({id:"bed",group:"bio",icon:"dna",needs:["SequenceFeature"]}),new e({id:"fake",group:"fake",icon:"fake",needs:["Department"]}),new e({id:"fake_2",group:"fake",icon:"fake",needs:["Company"]})],n.getFormat=function(t){return i.findWhere(r,{id:t})},n.getFormats=function(t){var e,n,i,o;for(o=[],n=0,i=r.length;i>n;n++)e=r[n],e.isSuitable(t)&&o.push(e);return o},n.registerFormat=function(t){var n,i,o;return i=t.id,n=t.icons,o=t.needs,r.push(new e(i,n,o))}}).call(this)},{underscore:308}],73:[function(t,e,n){(function(){var n,r,i={}.hasOwnProperty,o=function(t,e){function n(){this.constructor=t}for(var r in e)i.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};n=t("../core-model"),e.exports=r=function(t){function e(t,n){e.__super__.constructor.call(this),this.set({id:null,classes:[t["class"]],"service:base":"","service:url":"","report:uri":null}),this.set(n,t.value)}return o(e,t),e}(n)}).call(this)},{"../core-model":32}],74:[function(t,e,n){(function(){var n,r,i,o,s,a,u,l={}.hasOwnProperty,c=function(t,e){function n(){this.constructor=t}for(var r in e)l.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};u=t("underscore"),i=t("./path"),r=t("../options"),a=function(t){return null!=t?t.toUpperCase():void 0},o=u.compose(u.first,u.compact,u.map),s=function(t){return null!=t&&null!=t.isReference&&null!=t.isAttribute},e.exports=n=function(t){function e(t,n){var r;if(this.query=n,!(null!=(r=this.query)?r.on:void 0))throw new Error("no query");if(null==t)throw new Error("no options");e.__super__.constructor.call(this,t.path),this.set(u.omit(t,"path")),this.set({id:""+this.query.toXML()+"-"+this.get("path")}),this.listenTo(this.query,"change:joins",this.setOuterJoined),this.listenTo(this.query,"change:sortorder",this.setSortDirection),this.listenTo(this.query,"change:constraints",this.setConstraintNum),this._update_attrs()}return c(e,t),e.prototype.defaults=function(){return u.extend(e.__super__.defaults.apply(this,arguments),{replaces:[],isFormatted:!1,isComposed:!1,sortable:!0,sortDirection:null,numOfCons:0,minimised:!1,outerJoined:!1,expanded:r.get("Subtables.Initially.Expanded")})},e.prototype._update_attrs=function(){return this.setOuterJoined(),this.setSortDirection(),this.setConstraintNum()},e.prototype.toJSON=function(){return u.extend(e.__super__.toJSON.apply(this,arguments),{replaces:this.get("replaces").map(String)})},e.prototype.getView=function(){var t,e,n,r;return r=this.pick("replaces","isFormatted","path"),n=r.replaces,t=r.isFormatted,e=r.path,String(t&&1===n.length?n[0]:e)},e.prototype.validate=function(t,e){var n;if("replaces"in t){if(n=t.replaces,!u.isArray(n))return new Error("replaces must be an array");if(n.length&&!u.all(n,s))return new Error("all elements in replaces must be PathInfo objects")}},e.prototype.setOuterJoined=function(){var t,e,n,r,i;return i=this.getView(),n=this.get("replaces"),e=this.query.isOuterJoined(i),t=this.get("isFormatted")&&n.length>1,r=!e,this.set({outerJoined:e,isComposed:t,sortable:r})},e.prototype.setSortDirection=function(){var t,e,n,r;return n=this.get("replaces"),r=this.getView(),e=function(t){return function(e){return t.query.getSortDirection(e)}}(this),t=a(o(n.concat([r]),e)),this.set({sortDirection:t})},e.prototype.setConstraintNum=function(){var t,e,n;return n=this.getView(),e=u.size(function(){var e,r,i,o;for(i=this.query.constraints,o=[],e=0,r=i.length;r>e;e++)t=i[e],t.path.match(n)&&o.push(t);return o}.call(this)),this.set({numOfCons:e})},e}(i)}).call(this)},{"../options":93,"./path":86,underscore:308}],75:[function(t,e,n){(function(){var n,r,i,o,s={}.hasOwnProperty,a=function(t,e){function n(){this.constructor=t}for(var r in e)s.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};o=t("underscore"),n=t("../core/collection"),i=t("./step"),e.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return a(e,t),e.prototype.model=i,e.prototype.currentQuery=null,e.prototype.initialize=function(){return e.__super__.initialize.apply(this,arguments),this.listenTo(this,"remove",this.unwatch),this.listenTo(this,"add",this.watch)},e.prototype.currentStep=0,e.prototype.comparator="revision",e.prototype.getCurrentQuery=function(){return this.currentQuery},e.prototype.setCurrentQuery=function(t){return this.currentQuery=t.get("query").clone()},e.prototype.unwatch=function(t){var e,n;return e=null!=(n=null!=t?t.get("query"):void 0)?n:this.getCurrentQuery(),null!=e?this.stopListening(e):void 0},e.prototype.watch=function(t){var e;return this.setCurrentQuery(t),e=this.getCurrentQuery(),null!=e?(this.listenTo(e,"change:constraints",this.onChangeConstraints),this.listenTo(e,"change:views",this.onChangeViews),this.listenTo(e,"change:joins",this.onChangeJoins),this.listenTo(e,"change:sortorder",this.onChangeSortOrder),this.listenTo(e,"change:logic",this.onChangeLogic),this.listenTo(e,"undo",this.popState)):void 0},e.prototype.onChangeConstraints=function(){return this.onChange("constraints","filter",function(t){return o.map(t,JSON.stringify)})},e.prototype.onChangeViews=function(){return this.onChange("views","column")},e.prototype.onChangeJoins=function(){return this.onChange("joins","join",function(t){return o.map(t,function(t,e){return""+e+":"+t})})},e.prototype.onChangeSortOrder=function(){return this.onChange("sortOrder","sort order element",function(t){return o.map(t,JSON.stringify)})},e.prototype.onChangeLogic=function(){return this.onChange("constraintLogic","constraint logic element",function(t){var e;return null!=(e=null!=t?t.match(/([A-Z]+)/):void 0)?e:[]})},e.prototype.triggerChangedCurrent=function(){return this.trigger("changed:current",this.last())},e.prototype.onChange=function(t,e,n){var r,i,s,a,u,l,c,h;return null==n&&(n=function(t){return t}),a=this.currentQuery,s=this.last().get("query"),c=n(s[t]),h=n(a[t]),l=c.length,i=h.length,r=Math.abs(l-i),u=function(){switch(!1){case!(i>l):return"Added";case!(l>i):return"Removed";case i!==o.union(c,h).length:return"Rearranged";default:return"Changed"}}(),this.addStep(u,r,e,a)},e.prototype.setInitialState=function(t){return this.size()&&this.reset(),this.addStep(null,null,"Initial",t)},e.prototype.addStep=function(t,e,n,r){var i,o;return o=this.currentQuery,i=r.clone(),this.unwatch(),this.add({query:i,revision:this.currentStep++,title:{verb:t,number:e,label:n}}),null!=o&&o.trigger("replaced:by",i),this.triggerChangedCurrent()},e.prototype.popState=function(){return this.revertToIndex(-2)},e.prototype.revertToIndex=function(t){var e;return 0>t&&(t=this.length+t),e=this.at(t),this.revertTo(e)},e.prototype.revertTo=function(t){var e,n;if(!this.contains(t))throw new Error("State not in history");for(n=this.getCurrentQuery(),e=t.get("revision");this.last().get("revision")>e;)this.pop();return this.watch(t),null!=n&&n.trigger("replaced:by",t.get("query")),this.triggerChangedCurrent()},e}(n)}).call(this)},{"../core/collection":35,"./step":89,underscore:308}],76:[function(t,e,n){(function(){var n,r,i,o={}.hasOwnProperty,s=function(t,e){function n(){this.constructor=t}for(var r in e)o.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};i=t("underscore"),n=t("../core-model"),e.exports=r=function(t){function e(t,n,r){e.__super__.constructor.call(this,{classes:null!=n?n.map(String):void 0,id:r}),this.set({"service:base":t}),this.freeze("service:base","id","classes")}return s(e,t),e.prototype.toJSON=function(){var t,n;return n=this.get("service:url"),t=/^http/.test(n)?n:this.get("service:base")+n,i.extend(e.__super__.toJSON.apply(this,arguments),{"report:uri":t})},e.prototype.merge=function(t,e){return this.set(e,t.value),this.set({"service:url":t.url})},e}(n)}).call(this)},{"../core-model":32,underscore:308}],77:[function(t,e,n){(function(){var n,r,i,o,s,a={}.hasOwnProperty,u=function(t,e){function n(){this.constructor=t}for(var r in e)a.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};s=t("underscore"),n=t("../core/collection"),o=t("./path"),r=function(t){function e(t){var n,r;n=t.path,r=t.style,e.__super__.constructor.call(this,n),null!=r&&this.set({style:r})}return u(e,t),e.prototype.defaults=function(){return s.extend(e.__super__.defaults.apply(this,arguments),{style:"INNER"})},e}(o),e.exports=i=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return u(e,t),e.prototype.model=r,e.prototype.comparator="displayName",e.prototype.initialize=function(){return e.__super__.initialize.apply(this,arguments),this.listenTo(this,"change:displayName",this.sort)},e.prototype.getJoins=function(){return s.object(this.where({style:"OUTER"}).map(function(t){return[t.get("path"),t.get("style")]}))},e}(n),i.fromQuery=function(t){var e,n,o,s,a,u,l,c,h;e=new i,c=t.joins;for(o in c)a=c[o],s=t.makePath(o),e.add(new r({style:a,path:s}));for(h=t.getQueryNodes(),u=0,l=h.length;l>u;u++)for(n=h[u];!n.isRoot();)e.add(new r({path:n})),n=n.getParent();return e}}).call(this)},{"../core/collection":35,"./path":86,underscore:308}],78:[function(t,e,n){(function(){var n,r,i,o={}.hasOwnProperty,s=function(t,e){function n(){this.constructor=t}for(var r in e)o.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};i=t("underscore"),n=t("../core-model"),e.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return s(e,t),e.prototype.defaults=function(){return{columnName:null,columnTypeName:null,columnName:null,typeName:null,column:null,node:null,fieldName:null,contentName:null,view:[],rows:[]}},e.prototype.initialize=function(){return this.onChangeColumn(),this.listenTo(this,"change:column",this.onChangeColumn)},e.prototype.onChangeColumn=function(){var t,e,n;return t=this.get("column"),e=this.get("node"),n=this.get("view"),1===n.length&&(t=t.model.makePath(n[0],t.subclasses),e=t.isAttribute()?t.getParent():t),e.getType().getDisplayName().then(function(t){return function(e){return t.set({columnTypeName:e})}}(this)),t.getDisplayName().then(function(e){return function(n){return e.set({columnName:n}),t.isAttribute()&&e.set({fieldName:i.last(n.split(" > "))}),e.set({contentName:i.compact([e.get("columnTypeName"),e.get("fieldName")]).join(" ")})}}(this))},e.prototype.getPath=function(){return this.get("column")},e.prototype.toJSON=function(){return i.extend(e.__super__.toJSON.apply(this,arguments),{column:this.get("column").toString(),node:this.get("node").toString(),rows:this.get("rows").map(function(t){return t.map(function(t){return t.toJSON()})})})},e}(n)}).call(this)},{"../core-model":32,underscore:308}],79:[function(t,e,n){(function(){var n,r,i={}.hasOwnProperty,o=function(t,e){function n(){this.constructor=t}for(var r in e)i.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};n=t("../core-model"),e.exports=r=function(t){function e(t,n){e.__super__.constructor.call(this),this.set({id:null,isNULL:!0,classes:[t],"service:base":"","service:url":"","report:uri":null}),n&&this.set(n,null)}return o(e,t),e}(n)}).call(this)},{"../core-model":32}],80:[function(t,e,n){(function(){var n,r,i,o={}.hasOwnProperty,s=function(t,e){function n(){this.constructor=t}for(var r in e)o.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};i=t("underscore"),n=t("backbone"),e.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return s(e,t),e.prototype._defaults={},e.prototype.setLimits=function(t){return i.extend(this._defaults,t)},e.prototype.get=function(t){var n;return n=e.__super__.get.call(this,t),null!=n?n:t in this._defaults?this._defaults[t]:null},e.prototype.toJSON=function(){return i.extend({},this._defaults,this.attributes)},e.prototype.nullify=function(){var t,e,n,r,i;for(this.unset("min"),this.unset("max"),this.nulled=!0,r=["change:min","change:max","change"],i=[],e=0,n=r.length;n>e;e++)t=r[e],i.push(this.trigger(t,this));return i},e.prototype.reset=function(){return this.clear(),this.trigger("reset",this)},e.prototype.set=function(t,n){var r;return this.nulled=!1,i.isString(t)&&t in this._defaults?(r="min"===t?"max":"min",e.__super__.set.call(this,t,Math[r](this._defaults[t],n))):e.__super__.set.apply(this,arguments)},e.prototype.isAll=function(){return!this.isNotAll()},e.prototype.isNotAll=function(){var t,e,n;return this.nulled?!1:(n=this.toJSON(),e=n.min,t=n.max,null!=e&&e!==this._defaults.min||null!=t&&t!==this._defaults.max)},e}(n.Model)}).call(this)},{backbone:262,underscore:308}],81:[function(t,e,n){(function(){var n,r,i;i=t("underscore"),n=t("./intermine-object"),e.exports=r=function(){function t(t,e){if(this.schema=e,null==t)throw new Error("No root");if(null==this.schema)throw new Error("no schema");this.base=t.replace(/\/service\/?$/,""),this._objects={}}return t.prototype.get=function(t,e){var n,r,i;return n=null!=(r=this._objects)[i=t.id]?r[i]:r[i]=this._newObject(t),n.merge(t,e),n},t.prototype._newObject=function(t){var e,r;return r=function(){var n,r,i,o,s,a;for(s=null!=(i=null!=(o=t["class"])?o.split(","):void 0)?i:[],a=[],n=0,r=s.length;r>n;n++)e=s[n],a.push(this.schema.makePath(e));return a}.call(this),new n(this.base,r,t.id)},t.prototype.destroy=function(){var t,e,n;n=this._objects;for(t in n)e=n[t],e.destroy();return delete this.selectedObjects,delete this._objects},t}()}).call(this)},{"./intermine-object":76,underscore:308}],82:[function(t,e,n){(function(){var n,r,i,o,s={}.hasOwnProperty,a=function(t,e){function n(){this.constructor=t}for(var r in e)s.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};n=t("backbone"),i=t("./uniq-items"),o=function(t,e){if(!(null!=t?t.equals:void 0)||!(null!=e?e.isRoot:void 0))return!1;for(;!t.equals(e);){if(e.isRoot())return!1;e=e.getParent()}return!0},e.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return a(e,t),e.prototype.contains=function(t){return t instanceof n.Model?e.__super__.contains.call(this,t):this.any(function(e){return o(t,e.get("item"))})},e.prototype.remove=function(t){var r,i,s,a,u;if(null==t)return!1;for(t instanceof n.Model&&e.__super__.remove.call(this,t),r=this.filter(function(e){return o(t,e.get("item"))}),u=[],s=0,a=r.length;a>s;s++)i=r[s],u.push(e.__super__.remove.call(this,i));return u},e}(i)}).call(this)},{"./uniq-items":92,backbone:262}],83:[function(t,e,n){(function(){var n,r,i={}.hasOwnProperty,o=function(t,e){function n(){this.constructor=t}for(var r in e)i.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};r=t("./path"),e.exports=n=function(t){function e(t){var n,r;r=t.path,n=t.direction,e.__super__.constructor.call(this,r),null==n&&(n="ASC"),this.set({direction:n})}return o(e,t),e.prototype.asOrderElement=function(){return this.pick("path","direction")},e.prototype.toOrderString=function(){return""+this.get("path")+" "+this.get("direction")},e}(r)}).call(this)},{"./path":86}],84:[function(t,e,n){(function(){var t;e.exports=t=function(){function t(t,e){if(this.start=t,this.size=null!=e?e:null,!(null!=this.start&&this.start>=0))throw new Error("Start must be >= 0");if(null!=this.size&&this.size<0)throw new Error("Size must be null or Natural")}return t.prototype.end=function(){return this.all()?null:this.start+this.size},t.prototype.all=function(){return!this.size},t.prototype.isBefore=function(t){return null!=this.size&&this.end()<t},t.prototype.isAfter=function(t){return t<this.start},t.prototype.leftGap=function(t){return this.isAfter(t)?this.start-t:null},t.prototype.rightGap=function(t){return this.isBefore(t)?t-this.end():null},t.prototype.next=function(){return new t(this.end(),this.size)},t.prototype.prev=function(){return new t(Math.max(0,this.start-this.size),this.size)},t.prototype.toString=function(){return"Page("+this.start+" .. "+this.end()+")"},t}()}).call(this)},{}],85:[function(t,e,n){(function(){var n,r,i,o={}.hasOwnProperty,s=function(t,e){function n(){this.constructor=t}for(var r in e)o.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};i=t("./uniq-items"),n=t("backbone"),e.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return s(e,t),e.prototype.paths=function(){return this.map(function(t){return t.get("item")})},e.prototype.contains=function(t){return this.any(function(e){return t.equals(e.get("item"))})},e.prototype.toggle=function(t){return this.contains(t)?this.remove(t):this.add(t)},e.prototype.remove=function(t){var r;return t instanceof n.Model?e.__super__.remove.apply(this,arguments):(r=this.find(function(e){return t.equals(e.get("item"))}),null!=r?e.__super__.remove.call(this,r):void 0)},e}(i)}).call(this)},{"./uniq-items":92,backbone:262}],86:[function(t,e,n){(function(){var n,r,i,o,s,a={}.hasOwnProperty,u=function(t,e){function n(){this.constructor=t}for(var r in e)a.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},l=[].indexOf||function(t){for(var e=0,n=this.length;n>e;e++)if(e in this&&this[e]===t)return e;return-1};r=t("../core-model"),s=t("imjs").Model,i=s.NUMERIC_TYPES,n=s.BOOLEAN_TYPES,e.exports=o=function(t){function e(t){e.__super__.constructor.call(this),this.set(this.pathAttributes(t)),this.setDisplayName(t),this.setTypeName(t),this.pathInfo=function(){return t},this.freeze("path","isNumeric","isBoolean","isReference","isAttribute")}return u(e,t),e.prototype.defaults=function(){return{path:null,type:null,displayName:null,typeName:null,parts:[],isNumeric:!1,isBoolean:!1,isReference:!1,isAttribute:!0}},e.prototype.setDisplayName=function(t){return t.getDisplayName().then(function(t){return function(e){return t.set({displayName:e,parts:e.split(" > ")}),t.freeze("displayName","parts")}}(this))},e.prototype.setTypeName=function(t){var e;return e=(t.isAttribute()?t.getParent():t).getType(),e.getDisplayName().then(function(t){return function(e){return t.set({typeName:e})}}(this))},e.prototype.pathAttributes=function(t){var e,r,o,s,a;return o=String(t),r=t.isAttribute(),s=t.getType(),e={id:r?o:""+o+".id",path:o,type:null!=(a=s.name)?a:s},r?(e.isNumeric=l.call(i,s)>=0,e.isBoolean=l.call(n,s)>=0):(e.isReference=!0,e.isAttribute=!1),e},e}(r)}).call(this)},{"../core-model":32,imjs:286}],87:[function(t,e,n){(function(){var n,r,i,o,s,a={}.hasOwnProperty,u=function(t,e){function n(){this.constructor=t}for(var r in e)a.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};s=t("underscore"),r=t("../core-model"),n=t("../core/collection"),i=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return u(e,t),e.prototype.defaults=function(){return{index:null,query:null,cells:[]}},e.prototype.toJSON=function(){var t;return s.extend(e.__super__.toJSON.apply(this,arguments),{cells:function(){var e,n,r,i;for(r=this.get("cells"),i=[],e=0,n=r.length;n>e;e++)t=r[e],i.push(t.toJSON());return i}.call(this)})},e}(r),e.exports=o=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return u(e,t),e.prototype.model=i,e.prototype.comparator="index",e}(n)}).call(this)},{"../core-model":32,"../core/collection":35,underscore:308}],88:[function(t,e,n){(function(){var n,r,i,o,s,a={}.hasOwnProperty,u=function(t,e){function n(){this.constructor=t}for(var r in e)a.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};r=t("../core-model"),n=t("../core/collection"),s=t("../core/type-assertions"),o=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return u(e,t),e.prototype.defaults=function(){return{"class":null,id:null}},e.prototype.validate=function(t,e){return"class"in t&&null==t["class"]?'"class" must not be null':"id"in t&&null==t.id?'"id" must not be null':!1},e}(r),e.exports=i=function(t){function e(t){e.__super__.constructor.call(this),s.assertMatch(s.Service,t,"service"),this.state=new r({node:null,commonType:null,typeName:null}),this.listenTo(this.state,"change:commonType",this.onChangeType),this.listenTo(this.state,"change:node",this.onChangeNode),this.listenTo(this,"add remove reset",this.setType),t.fetchModel().then(function(t){return function(e){return t.schema=e,t.setType()}}(this))}return u(e,t),e.prototype.model=o,e.prototype.onChangeNode=function(){return this.trigger("change:node change",this.state.get("node"))},e.prototype.onChangeType=function(){var t,e;if(null!=this.schema)return e=this.state.get("commonType"),null==e?this.state.set({typeName:null}):(t=this.schema.makePath(e),t.getDisplayName().then(function(t){return function(e){return t.state.set({typeName:e}),t.trigger("change:typeName change")}}(this)),this.trigger("change:commonType change"))},e.prototype.setType=function(){var t;if(null!=this.schema)return t=this.size()?t=this.schema.findCommonType(this.map(function(t){return t.get("class")})):null,this.state.set(null!=t?{commonType:t}:{commonType:null,typeName:null})},e}(n)}).call(this)},{"../core-model":32,"../core/collection":35,"../core/type-assertions":40}],89:[function(t,e,n){(function(){var n,r,i,o,s={}.hasOwnProperty,a=function(t,e){function n(){this.constructor=t}for(var r in e)s.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};o=t("underscore"),n=t("../core-model"),r=t("../utils/count-executor"),e.exports=i=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return a(e,t),e.prototype.defaults=function(){return{count:0}},e.prototype.initialize=function(){return e.__super__.initialize.apply(this,arguments),this.set({createdAt:new Date}),this.listenTo(this,"change:query",this._setCount),this._setCount()},e.prototype._setCount=function(){var t;return t=this.get("query"),null!=t?r.count(t).then(function(t){return function(e){return t.set({count:e})}}(this)):this.set({count:0})},e.prototype.toJSON=function(){return o.extend(e.__super__.toJSON.apply(this,arguments),{query:this.get("query").toJSON()})},e}(n)}).call(this)},{"../core-model":32,"../utils/count-executor":107,underscore:308}],90:[function(t,e,n){(function(){var n,r,i,o,s,a,u,l,c,h,p={}.hasOwnProperty,f=function(t,e){function n(){this.constructor=t}for(var r in e)p.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};h=t("underscore"),r=t("../core-model"),n=t("../core/collection"),i=t("../options"),l=t("../services/column-summary").getColumnSummary,c=function(t){return"int"===t||"Integer"===t||"long"===t||"Long"===t||"short"===t||"Short"===t},e.exports=u=function(t){function e(t){var n,r;if(this.query=t.query,this.view=t.view,e.__super__.constructor.call(this),null==this.query)throw new Error("No query in call to new SummaryModel");if(null==this.view)throw new Error("No view in call to new SummaryModel");this.fetch=h.partial(l,this.query,this.view),r=this.view.getType(),n=c(r),this.set({limit:i.get("INITIAL_SUMMARY_ROWS"),canHaveMultipleValues:this.query.canHaveMultipleValues(this.view),type:r,integral:n}),this.histogram=new o,this.items=new a,this.listenTo(this,"change:filterTerm",this.onFilterChange),this.listenTo(this,"change:summaryLimit",this.onLimitChange),this.listenTo(this.query,"change:constraints",this.load),this.load()}return f(e,t),e.prototype.defaults=function(){return{error:null,maxCount:null,
loading:!1,initialized:!1,canHaveMultipleValues:!1,numeric:!1,filterTerm:null}},e.prototype.destroy=function(){return this.histogram.close(),this.items.close(),e.__super__.destroy.apply(this,arguments)},e.prototype.getMaxCount=function(){return this.get("maxCount")},e.prototype.hasMore=function(){return!this.get("numeric")&&this.get("got")<this.get("uniqueValues")},e.prototype.hasAll=function(){return!this.hasMore()},e.prototype.toJSON=function(){return h.extend(e.__super__.toJSON.apply(this,arguments),{items:this.items.toJSON(),histogram:this.getHistogram()})},e.prototype.onFilterChange=function(){return this.hasAll()?this.filterLocally():this.load()},e.prototype.filterLocally=function(){var t,e,n;return t=this.get("filterTerm"),null!=t?(e=t.toLowerCase().split(/\s+/),n=function(t){return h.all(e,function(e){return!(!t||!~t.toLowerCase().indexOf(e))})},this.items.each(function(t){return t.show(n(t.get("item")))})):this.items.each(function(t){return t.show()})},e.prototype.increaseLimit=function(t){var e;return null==t&&(t=2),e=t*this.get("limit"),this.set({limit:e})},e.prototype.onLimitChange=function(){return this.load()},e.prototype.setFilterTerm=function(t){return this.set({filterTerm:t})},e.prototype.fetchAll=function(){return this.set({limit:null})},e.prototype.load=function(){return this.set({loading:!0}),this.fetch(this.get("filterTerm"),this.get("limit")).then(this.getSummaryHandler()).then(null,function(t){return function(e){return t.set({error:e})}}(this))},e.prototype.getSummaryHandler=function(){var t;return this.lastSummaryHandlerCreatedAt=t=h.now(),function(e){return function(n){return e.handleSummary(t,n)}}(this)},e.prototype.getHistogram=function(){var t,e,n,r,i,o;if(e=this.get("buckets"),!e)return[];for(o=[],t=n=1;e>=1?e>=n:n>=e;t=e>=1?++n:--n)o.push(null!=(r=null!=(i=this.histogram.get(t))?i.get("count"):void 0)?r:0);return o},e.prototype.handleSummary=function(t,e){var n,r,i,o,s,a,u,l,c,p,f,d,m,g;return d=e.stats,f=e.results,t===this.lastSummaryHandlerCreatedAt?(p=null!=d.max,c={filteredCount:d.filteredCount,uniqueValues:d.uniqueValues,available:null!=(g=d.filteredCount)?g:d.uniqueValues,got:f.length,numeric:p,initialized:!0,loading:!1},p?(i=d.buckets,u=d.max,l=d.min,m=d.stdev,n=d.average,h.extend(c,{buckets:i,max:u,min:l,stdev:parseFloat(m),average:parseFloat(n)}),this.items.size()&&this.items.reset(),this.histogram.set(function(){var t,e,n,i;for(i=[],t=0,e=f.length;e>t;t++)n=f[t],r=n.bucket,o=n.count,i.push({item:r,count:o,id:r});return i}()),c.maxCount=this.histogram.getMaxCount()):(this.histogram.size()&&this.histogram.reset(),this.items.set(function(){var t,e,n,r;for(r=[],s=t=0,e=f.length;e>t;s=++t)n=f[s],a=n.item,o=n.count,r.push({item:a,count:o,id:s});return r}()),c.maxCount=this.items.getMaxCount()),this.set(c)):void 0},e}(r),s=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return f(e,t),e.prototype.defaults=function(){return{symbol:null,share:null,visible:!0,selected:!1,hover:!1,count:0,item:null}},e.prototype.select=function(){return this.set({selected:!1})},e.prototype.deselect=function(){return this.set({selected:!1})},e.prototype.hide=function(){return this.set({visible:!1})},e.prototype.show=function(t){return null==t&&(t=!0),this.set({visible:t})},e.prototype.mousein=function(){return this.set({hover:!0})},e.prototype.mouseout=function(){return this.set({hover:!1})},e}(r),a=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return f(e,t),e.prototype.model=s,e.prototype.getMaxCount=function(){var t;return null!=(t=this.first())?t.get("count"):void 0},e}(n),o=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return f(e,t),e.prototype.model=s,e.prototype.getMaxCount=function(){var t;return h.max(function(){var e,n,r,i;for(r=this.models,i=[],e=0,n=r.length;n>e;e++)t=r[e],i.push(t.get("count"));return i}.call(this))},e}(n)}).call(this)},{"../core-model":32,"../core/collection":35,"../options":93,"../services/column-summary":95,underscore:308}],91:[function(t,e,n){(function(){var n,r,i,o,s=function(t,e){return function(){return t.apply(e,arguments)}},a={}.hasOwnProperty,u=function(t,e){function n(){this.constructor=t}for(var r in e)a.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};r=t("../options"),n=t("../core-model"),i=t("./path-set"),e.exports=o=function(t){function e(){return this.filled=s(this.filled,this),e.__super__.constructor.apply(this,arguments)}return u(e,t),e.prototype.defaults=function(){return{phase:"FETCHING",start:0,size:r.get("DefaultPageSize"),count:null,fill:0,error:null,selecting:!1,previewOwner:null,highlitNode:null,minimisedColumns:new i}},e.prototype.initialize=function(){var t;return t=this.get("minimisedColumns"),this.listenTo(t,"add remove reset",function(){return this.trigger("change:minimisedColumns change")}),this.freeze("minimisedColumns")},e.prototype.filled=function(){return this.swap("fill",function(t){return t+1})},e.prototype.toJSON=function(){var t;return t=e.__super__.toJSON.apply(this,arguments),t.minimisedColumns=this.get("minimisedColumns").toJSON().map(String),t},e.prototype.destroy=function(){return this.get("minimisedColumns").close(),e.__super__.destroy.apply(this,arguments)},e}(n)}).call(this)},{"../core-model":32,"../options":93,"./path-set":85}],92:[function(t,e,n){(function(){var n,r,i,o,s,a,u={}.hasOwnProperty,l=function(t,e){function n(){this.constructor=t}for(var r in e)u.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};n=t("backbone"),a=t("underscore"),i=t("../core-model"),r=t("../core/collection"),o=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return l(e,t),e.prototype.initialize=function(t,e){return null!=e&&this.set(e),this.set({item:t,id:String(t)})},e}(i),e.exports=s=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return l(e,t),e.prototype.model=o,e.prototype.toJSON=function(){var t,e,n,r,i;for(r=this.models,i=[],e=0,n=r.length;n>e;e++)t=r[e],i.push(t.get("item"));return i},e.prototype.togglePresence=function(t){return this.contains(t)?this.remove(t):this.add(t)},e.prototype.get=function(t){return e.__super__.get.call(this,t instanceof n.Model?t:String(t))},e.prototype.contains=function(t){return t instanceof o?e.__super__.contains.call(this,t):null!=this.findWhere({item:t})},e.prototype.add=function(t,n){var r,i,s,u;for(t=a(t).isArray()?t:[t],u=[],i=0,s=t.length;s>i;i++)r=t[i],null!=r&&""!==r&&u.push(this.contains(r)?void 0:e.__super__.add.call(this,new o(r,n)));return u},e.prototype.remove=function(t,n){var r,i,s,u;for(t=a(t).isArray()?t:[t],u=[],i=0,s=t.length;s>i;i++)r=t[i],u.push(r instanceof o?e.__super__.remove.call(this,r,n):e.__super__.remove.call(this,this.findWhere({item:r}),n));return u},e}(r)}).call(this)},{"../core-model":32,"../core/collection":35,backbone:262,underscore:308}],93:[function(t,e,n){(function(){var n,r,i={}.hasOwnProperty,o=function(t,e){function n(){this.constructor=t}for(var r in e)i.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};n=t("./core/nested-model"),r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return o(e,t),e.prototype.defaults=function(){return{INITIAL_SUMMARY_ROWS:1e3,NUM_SEPARATOR:",",NUM_CHUNK_SIZE:3,MAX_PIE_SLICES:15,DropdownMax:20,DefaultPageSize:25,DynamicObjects:{NameDelimiter:" / "},CodeGen:{Default:"py",Langs:["py","pl","java","rb","js","xml"],Extra:{js:"codegen.AsHTML"}},ListFreshness:250,MaxSuggestions:1e3,ListCategorisers:["organism.name","department.company.name"],PieColors:"category10",TableResults:{CacheFactor:10,RequestLimit:5e3},TableHeader:{FullPathPopoverEnabled:!0},TableCell:{AddDataClasses:!0,PreviewTrigger:"hover",HoverDelay:200,IndicateOffHostLinks:!0,ExternalLinkIcons:{"http://some.host.somewhere":"http://some.host.somewhere/logo.png"}},ItemDetails:{ShowReferenceCounts:!1,Fields:{},Count:{}},StylePrefix:"imtables",SuggestionDepth:2,Events:{ActivateTab:"mouseenter"},Subtables:{Initially:{expanded:!1}},Facets:{DrawAverageLine:!0,Initially:{Open:!0}},Destinations:["download","Galaxy","GenomeSpace","Drive","Dropbox"],Destination:{download:{Enabled:!0},Galaxy:{Main:"http://main.g2.bx.psu.edu",Current:null,Tool:"flymine",Save:!1,Enabled:!0},GenomeSpace:{Upload:"https://gsui.genomespace.org/jsui/upload/loadUrlToGenomespace.html",Enabled:!0},Drive:{Library:"https://apis.google.com/js/client.js",Enabled:!1},Dropbox:{Library:"https://www.dropbox.com/static/api/2/dropins.js",Enabled:!1}},ShowId:!1,TableWidgets:{Pagination:{enabled:!0,index:0},PageSizer:{enabled:!0,index:1},TableSummary:{enabled:!0,index:2}},CellCutoff:100,ShowHistory:!0,icons:"fontawesome",D3:{Transition:{Easing:"exp",Duration:500,DurationShort:200}},brand:{"http://www_flymine_org/query/service/":{name:"FlyMine"},"http://preview_flymine_org/preview/service/":{name:"FlyMine-Preview"},"http://www_mousemine_org/mousemine/service/":{name:"MouseMine (MGI)"}},Formatters:{testmodel:{},genomic:{}},ColumnManager:{SelectColumn:{Multi:!0}},UndoHistory:{ShowAllStatesCutOff:6}}},e}(n),e.exports=new r,e.exports.Options=r}).call(this)},{"./core/nested-model":38}],94:[function(t,e,n){(function(){n.IS_BLANK=/^\s*$/}).call(this)},{}],95:[function(t,e,n){(function(){var t,e;t={},e=function(t,e){return""+t.service.root+":"+t.service.token+":"+t.toXML()+":"+e},n.getColumnSummary=function(n,r,i,o){var s;return null!=t[s=e(n,r,i,o)]?t[s]:t[s]=function(){return n.filterSummary(r,i,o)}()}}).call(this)},{}],96:[function(t,e,n){(function(e){(function(){var n,r,i,o;o=e.jQuery,i=n=t("jquery"),r=t("backbone"),r.$=i,e.jQuery=n,t("bootstrap"),t("typeahead.js"),t("jquery-ui/slider"),t("jquery-ui/draggable"),t("jquery-ui/droppable"),t("jquery-ui/sortable"),null!=o?e.jQuery=o:delete e.jQuery}).call(this)}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{backbone:262,bootstrap:263,jquery:305,"jquery-ui/draggable":299,"jquery-ui/droppable":300,"jquery-ui/slider":302,"jquery-ui/sortable":303,"typeahead.js":307}],97:[function(t,e,n){function r(t){if(!t)throw new Error("Name is required.");if(t=t.replace(/-/g,"_"),templ=o[t],templ)return templ;throw new Error('No template registered as "'+t+'"')}var i=t("underscore"),o=n;n.template=function(t,e){return i.template(r(t),e)},n.templateFromParts=function(t,e){var n=t.map(r).join("\n");return i.template(n,e)},o.clear='<div style="clear:both"></div>',n.constraint_adder='<div class="im-constraint-adder-options"></div>\n<div class="im-path-finder"><div>\n<div class="im-new-constraint"></div>\n',n.value_control_row='<td>\n  <input type="checkbox" {{ (selected) ? \'checked\' : void 0 }}>\n</td>\n<td class="im-multi-value">\n  {{# if (editing) { }}\n    <div class="input-group">\n      <input type="text" value="{{ value }}" class="form-control">\n      <span class="input-group-btn">\n        <button class="btn btn-success im-save"\n                title="{{ messages.getText(\'multivalue.SaveValue\') }}"\n                type="button">\n            {{{ icons.icon(\'OK\') }}}\n            <span class="im-long">{{ messages.getText(\'multivalue.SaveValue\') }}</span>\n        </button>\n        <button class="btn btn-danger im-cancel"\n                title="{{ messages.getText(\'Cancel\') }}"\n                type="button">\n            {{{ icons.icon(\'Cancel\') }}}\n            <span class="im-long">{{ messages.getText(\'Cancel\') }}</span>\n        </button>\n      </span>\n    </div>\n  {{# } else { }}\n    <a class="im-edit pull-right">{{{ icons.icon(\'Edit\') }}}</a>\n    {{ value }}\n  {{# } }}\n</td>\n',n.constraints_heading="<% /* requires constraints.length */ %>\n<h3>\n  <%- Messages.getText('constraints.Heading', {n: constraints.length}) %>\n</h3>\n",n.join_style='<% /* requires innerJoinBtn, outerJoinBtn */ %>\n<div class="btn-group pull-right">\n  <button class="<%- innerJoinBtn %>">\n    <%- Messages.getText(\'joins.Inner\') %>\n  </button>\n  <button class="<%- outerJoinBtn %>">\n    <%- Messages.getText(\'joins.Outer\') %>\n  </button>\n</div>\n',n.export_row_controls='<h4 class="im-title"></h4>\n\n<div class="form-group">\n    <label class="size-label"></label>\n    <input name="size"\n           step="1"\n           type="range"\n           min="1"\n           max="<%= max %>"\n           value="<%= size || max %>">\n</div>\n\n<div class="form-group">\n    <label class="start-label"></label>\n    <input name="start"\n           step="1"\n           type="range"\n           min="0"\n           max="<%= max - 1 %>"\n           value="<%= start %>">\n</div>\n\n<div class="form-group im-reset">\n</div>\n',n.summary_no_results="<div class=\"alert alert-warning\">\n    <%= Icons.icon('Warning') %>\n    <%- Messages.getText('summary.NoResults', {path: pathName}) %>\n</div>\n\n",n.page_sizer='<% /* Expects size, sizes */ %>\n<% if (sizes.length) { %>\n    <label>\n        <span class="hidden-tablet">Rows per page:</span>\n    </label>\n    <select class="form-control" title="Rows per page">\n        <% sizes.forEach(function (s) { %>\n            <option value="<%= s[0] %>" <%= (s[0] === size) && \'selected\' %>>\n            <%= s[1] || s[0] %>\n            </option>\n        <% }); %>\n    </select>\n<% } %>\n',n.modal_dialogue_opener='<button class="btn btn-default im-open-dialogue">\n  <%= Icons.icon(labels.ICON) %>\n  <span class="im-hidden-sm hidden-sm hidden-xs">\n    <%- Messages.getText(labels.LONG, state) %>\n  </span>\n  <span class="im-visible-sm-inline visible-sm-inline">\n    <%- Messages.getText(labels.SHORT, state) %>\n  <span>\n</button>\n',n.summary_selected_count="<% if (state.selectedCount) { %>\n    <div class=\"alert alert-info im-selected-count\">\n        <strong>\n            <%- Messages.getText('summary.SelectedCount', state) %>\n        </strong>\n    </div>\n<% } %>\n",n.export_add_column_control='<div class="row">\n    <div class="col-sm-1 im-help"\n         title="<%- Messages.getText(\'export.help.AdditionalCols\') %>">\n        <%= Icons.icon(\'Help\', \'lg\') %>\n    </div>\n    <div class="col-sm-11 form-group">\n        <input type="text" class="form-control">\n    </div>\n</div>\n',n.type_value_controls="<label class=\"span4\">\n    <%- messages.getText('conbuilder.IsA') %>\n</label>\n<% if (subclasses.length == 1) { %>\n  <select disabled class=\"form-control\">\n      <option><%- subclasses[0].text %></option>\n  </select>\n<% } else { %>\n  <%= select(subclasses, isSelected, 'form-control im-value-type') %>\n<% } %>\n  \n",n.select_with_label='<label><%- Messages.getText(label) %></label>\n\n<% if (options.length) { %>\n    <select class="form-control">\n        <% _.each(options, function (option) { %>\n            <option selected="<%= selected(option) ? \'selected\' : void 0 %>"\n                    value="<%- option.name %>">\n                <%- Messages.getText(optionLabel, option) %>\n            </option>\n        <% }) %>\n    </select>\n    <% if (helpMessage) { %>\n        <span style="display:<%= hasProblem ? \'block\' : \'none\' %>"\n              class="help-block">\n                <%- Messages.getText(helpMessage) %>\n        </span>\n    <% } %>\n<% } else { %>\n    <span class="help-block">\n        <%- Messages.getText(noOptionsMessage, {model: model}) %>\n    </span>\n<% } %>\n\n',n.export_fasta_options='<h3><%- Messages.getText(\'export.category.Options\') %></h3>\n\n<div class="form-group">\n    <label><%- Messages.getText(\'FastaExtension\') %></label>\n    <input type="text"\n           value="<%- fastaExtension %>"\n           placeholder="5kbp"\n           class="form-control im-fasta-ext">\n</div>\n',n.list_dialogue_button_node='<a href="#">\n    <strong>\n        <%- displayName || path %>\n    </strong>\n    <% if (state.count) { %>\n        (<%- numToString(state.count) %>\n        <%- pluralise((typeName || type), state.count) %>)\n    <% } %>\n</a>\n',n.undo_history='<button class="btn btn-default im-undo">\n  <%= Icons.icon(\'Undo\') %>\n  <span class="visible-lg-inline">\n    <%- Messages.getText(\'Undo\') %>\n  </span>\n</button>\n\n<button class="btn btn-default dropdown-toggle"\n        data-toggle="dropdown">\n  <span class="caret"></span>\n</button>\n\n<ul class="dropdown-menu im-state-list">\n    <li>\n      <button\n          title="<%- Messages.getText(\'undo.ToggleTrivialTitle\', state) %>"\n          class="btn btn-xs btn-default im-toggle-trivial <%= state.hideTrivial ? \'active\' : void 0 %>">\n        <%- Messages.getText(\'undo.ToggleTrivial\', state) %>\n      </button>\n    </li>\n</ul>\n',n.cell_preview_reference_relation='<% _.each(collection, function (relation) { %>\n  <li class="im-relation">\n    <span class="im-name"><%- _.last(relation.parts) %></span>\n    <span class="im-count"><%- numToString(relation.count) %></span>\n  </li>\n<% }); %>\n',n.select='<select class="<%- data.classes %>">\n  <% _.each(data.options, function (opt) { %>\n    <option value="<%- data.key(opt) %>"\n      <%- data.selectedTest(opt) ? \'selected\' : void 0 %> >\n      <% if (data.contentHandler) { %>\n        <%- data.contentHandler(opt) %>\n      <% } else { %>\n        <%- opt.text %>\n      <% } %>\n    </option>\n  <% }); %>\n</select>\n',n.list_dialogue_expander="<button class=\"btn btn-default im-expand-dialogue <%= minimised ? 'active' : void 0 %>\">\n  <%- Messages.getText('lists.picker.Collapse') %>\n</button>\n",n.code_gen_body='<div class="row">\n  <div class="col-sm-2">\n    <% /* requires lang :: string, options :: {Extra :: {}, Langs :: [string]} */ %>\n    <div class="btn-group language-selector">\n      <button type="button"\n              data-toggle="dropdown"\n              aria-expanded="false"\n              class="btn btn-default dropdown-toggle">\n        <span class="im-current-lang">\n          <%- Messages.getText(\'codegen.Lang\', {lang: lang}) %>\n        </span>\n        <span class="caret"></span>\n      </button>\n      <ul class="dropdown-menu im-code-gen-langs" role="menu">\n        <% _.each(options.Langs, function (l) { %>\n            <li data-lang="<%- l %>"\n                class="<%= (l === lang) ? \'active\' : void 0 %>">\n              <a href="#"><%- Messages.getText(\'codegen.Lang\', {lang: l}) %></a>\n            </li>\n        <% }); %>\n      </ul>\n    </div>\n    <div class="im-show-boilerplate"></div>\n    <div class="im-highlight-syntax"></div>\n    <div class="im-extra-options"></div>\n  </div>\n  <div class="col-sm-10">\n    <pre class="im-generated-code"><%- generatedCode %></pre>\n  </div>\n</div>\n',n.checkbox="<label>\n    <input type=\"checkbox\" \n           <%= checked ? 'checked' : void 0 %>\n           >\n    <%- label %>\n</label>\n",n.table_cell='<% if (state.minimised) { %>\n  &hellip;\n<% } else if (entity.id == null) { %>\n  <% if (value != null && formattedValue != null) { %>\n    <span class="im-displayed-value"><%= value %></span>\n  <% } else if (entity.isNULL) { %>\n    <span class="im-null-entity">\n      <%- Messages.getText(\'table.cell.NullEntity\', {type: entity[\'class\']}) %>\n    </span>\n  <% } else { %>\n    <%= NULL_VALUE %>\n  <% } %>\n<% } else { %>\n  <input\n    class="im-list-chooser"\n    type="checkbox"\n    <% if (input.checked) { %>checked<% } %>\n    <% if (input.disabled) { %>disabled<% } %>\n    style="display:<%- input.display %>">\n\n  <a class="im-cell-link" target="<%- target %>" href="<%= url %>">\n\n    <% if (isForeign) { %>\n      <% if (icon) { %>\n        <img src="<%= icon %>" class="im-external-link"></img>\n      <% } else { %>\n        <%= Icons.icon(\'ExternalLink\') %>\n      <% } %>\n    <% } %>\n\n    <% if (value != null && formattedValue != null) { %>\n      <span class="im-displayed-value"><%= formattedValue %></span>\n    <% } else { %>\n      <%= NULL_VALUE %>\n    <% } %>\n\n  </a>\n\n  <% if (value != null && field === \'url\' && rawValue != url) { %>\n    <a class="im-cell-link external" href="<%= rawValue %>">\n      <%= Icons.icon(\'ExternalLink\') %>\n      <%- Messages.getText(\'table.cell.Link\') %>\n    </a>\n  <% } %>\n<% } %>\n',n.export_dialogue_footer='<% if (linkToFile) { %>\n    <div class="pull-left alert alert-info">\n        <%- Messages.getText(\'export.cloud.FileLocation\', {cloud: dest}) %>\n        <a href="<%= linkToFile %>" target="_blank"><%- linkToFile %></a>\n    </div>\n<% } %>\n\n<button type="button" class="btn btn-cancel">\n    <%- dismissAction %>\n</button>\n\n<% if (dest === \'download\') { %>\n    <a class="btn btn-primary"\n        href="<%- exportURI %>">\n        <%= Icons.icon(primaryIcon) %>\n        <%- primaryAction %>\n    </a>\n<% } else { %>\n    <button type="button"\n            <%= (error || doneness != null) ? \'disabled\' : void 0 %>\n            class="btn btn-primary">\n        <%= Icons.icon(primaryIcon) %>\n        <%- primaryAction %>\n    </button>\n<% } %>\n\n',n.formatted_sorting="<a> <% /* requires Icons, direction and name */ %>\n    <%= Icons.icon(direction || 'unsorted') %>\n    <span class=\"im-sort-path\"><%- name %></span>\n</a>\n",n.modal_footer='<button type="button" class="btn btn-cancel">\n    <%- dismissAction %>\n</button>\n<% if (exportLink != null) { %>\n    <a class="btn btn-primary"\n        <%= (error) ? \'disabled\' : void 0 %>\n        href="<%- exportLink %>">\n        <%= Icons.icon(primaryIcon) %>\n        <%- primaryAction %>\n    </a>\n<% } else { %>\n    <% /* We need the wrapper to deal with the fact that tooltips do not\n        * work on disabled buttons. */ %>\n    <div class="im-tooltip-wrapper"\n        <% if (disabled && disabledReason) { %>\n          title="<%- Messages.getText(disabledReason)  %>"\n        <% } %>>\n        <button type="button"\n                <%= (error || disabled) ? \'disabled\' : void 0 %>\n                class="btn btn-primary">\n            <%= Icons.icon(primaryIcon) %>\n            <%- primaryAction %>\n        </button>\n    </div>\n<% } %>\n',n.column_manager_position_controls="<div class=\"im-position-controls\">\n    <% if (index > 0) { %>\n        <%= Icons.iconWithProps('ASC', {\n            className: 'im-move-up',\n            title: Messages.getText('columns.MoveUp')\n        }) %>\n    <% } %>\n    <% if (!isLast) { %>\n        <%= Icons.iconWithProps('DESC', {\n            className: 'im-move-down',\n            title: Messages.getText('columns.MoveDown')\n        }) %>\n    <% } %>\n</div>\n\n",n.row_surrogate="<%= Icons.icon(above ? 'ASC' : 'DESC') %>\n<%- item %>: <%- count %>\n",n.list_dialogue_button='<button class="btn btn-default dropdown-toggle" data-toggle="dropdown">\n  <%= Icons.icon(\'Lists\') %>\n  <span class="hidden-xxs">\n    <%- Messages.getText(\'lists.SaveAsList\') %>\n  </span>\n  <span class="caret"></span>\n</button>\n\n<ul class="dropdown-menu dropdown-menu-right" role="menu">\n    <li class="divider"></li>\n    <li>\n        <a class="im-pick-items" href="#">\n            <%- Messages.getText(\'lists.StartPicking\') %>\n        </a>\n    </li>\n    <li class="divider"></li>\n    <li>\n        <div class="btn-group btn-group-justified" role="group">\n            <a role="button" class="<%- createBtnClasses %>">\n                <%- Messages.getText(\'lists.Create\') %>\n            </a>\n            <a role="button" class="<%- appendBtnClasses %>">\n                <%- Messages.getText(\'lists.Append\') %>\n            </a>\n        </div>\n    </li>\n</ul>\n',n.active_constraint='<div class="im-con-overview">\n  <% if (data.con.editable != null && data.con.editable === false) { %>\n    <a title="<%- data.messages.getText(\'conbuilder.NotEditable\') %>">\n        <%= data.icons.icon(\'Lock\') %>\n    </a>\n  <% } else { %>\n    <a class="im-remove-constraint"\n        title="<%- data.messages.getText(\'conbuilder.Remove\') %>"\n        >\n        <%= data.icons.icon(\'RemoveConstraint\') %>\n    </a>\n    <a class="im-edit" title="<%- data.messages.getText(\'conbuilder.EditCon\') %>">\n        <%= data.icons.icon(\'Edit\') %>\n    </a>\n  <% } %>\n</div>\n\n<% /* We use the :empty selector on this element - hence it must be on one line */ %>\n<div class="im-constraint-editor"></div>\n',n.logic_manager_body='<div class="form-group">\n  <label class="form-label">\n    <%- Messages.getText(\'logic.LogicLabel\') %>\n    <input type="text"\n          class="im-logic form-control"\n          placeholder="<%- state.defaultLogic %>"\n          value="<%- logic %>">\n  </label>\n</div>\n<div class="form-group">\n  <button class="pull-right btn btn-primary <%- (state.disabled) ? \'disabled\' : null %>"\n          type="submit">\n    <%- Messages.getText(\'logic.ApplyLogic\') %>\n  </button>\n</div>\n',n.table_throbber='<tr class="im-table-throbber">\n  <td colspan="<%= colcount %>">\n    <h2><%- Messages.getText(\'table.RequestingData\') %></h2>\n    <div class="progress progress-info progress-striped active">\n      <div class="bar" style="width: 100%"></div>\n    </div>\n  </td>\n</tr>\n',n.join_manager_body="<ul class=\"list-group\"></ul>\n\n<div class=\"alert alert-info\">\n  <%= Icons.icon('Info') %>\n  <strong class=\"im-clickable\">\n    <%- Messages.getText('joins.ExplanationTitle') %>\n  </strong>\n  <p class=\"<%= (!state.explaining) ? 'im-latent' : void 0 %>\">\n    <%- Messages.getText('joins.Explanation') %>\n  </p>\n</div>\n",n.large_table_disuader='<div class="modal-dialog">\n    <div class="modal-content">\n        <div class="modal-header">\n            <h3>\n            <%= size %> rows - are you sure?\n            </h3>\n        </div>\n\n        <div class="modal-body">\n\n            <p><%= Messages.getText(\'largetable.appeal\', {size: size}) %></p>\n\n            <ul>\n                <li>\n                    <p>\n                        If you want to see all the data, you can page \n                        <span class="label label-info">\n                            <%= Icons.icon(\'GoBack\') %>\n                            backwards\n                        </span>\n                        and \n                        <span class="label label-info">\n                            forwards\n                            <%= Icons.icon(\'GoForward\') %>\n                        </span>\n                        through the results.\n                    </p>\n                    <div class="btn-group">\n                        <a class="btn btn-default im-alternative-action page-backwards" href="#">\n                            <%= Icons.icon(\'GoBack\') %>\n                            go one page back\n                        </a>\n                        <a class="btn btn-default im-alternative-action page-forwards" href="#">\n                            go one page forward\n                            <%= Icons.icon(\'GoForward\') %>\n                        </a>\n                    </div>\n                </li>\n\n                <li>\n                    <p>\n                        If you are looking for something specific, you can use the\n                        <span class="label label-info">filtering tools</span>\n                        to narrow down the result set. Then you \n                        might be able to fit the items you are interested in in a\n                        single page.\n                    </p>\n                    <button class="btn btn-default im-alternative-action add-filter-dialogue">\n                        <%= Icons.icon(\'Filter\') %>\n                        Add a new filter.\n                    </button>\n                </li>\n\n                <li>\n                    <p>\n                        If you want to get and save the results, we suggest\n                        <span class="label label-info">downloading</span>\n                        the results in a format that suits you. \n                    <p>\n                    <button class="btn btn-default im-alternative-action download-menu">\n                        <%= Icons.icon(\'Export\') %>\n                        Open the download menu.\n                    </buttn>\n                </li>\n\n            </ul>\n        </div>\n\n        <div class="modal-footer">\n            <button class="btn btn-primary pull-right">\n                <%- Messages.getText(\'largetable.ok\', {size: size}) %>\n            </button>\n            <button class="btn pull-left close">\n                <%- Messages.getText(\'largetable.abort\') %>\n            </button>\n        </div>\n    </div>\n</div>\n',n.input_with_button='<input type="text" class="form-control"\n       value="<%- value %>"\n       placeholder="<%- Messages.getText(placeholder) %>">\n<span class="input-group-btn">\n  <button class="btn btn-default" type="button">\n    <%- Messages.getText(button) %>\n  </button>\n</span>\n\n',n.add_value_control='<div class="im-table-height-wrapper">\n    <table class="table table-condensed"></table>\n</div>\n<div class="input-group">\n    <input type="text" class="im-new-multi-value form-control">\n    <span class="input-group-btn">\n        <button class="btn btn-primary im-add" type="button">\n            <span class="im-long"><%- messages.getText(\'multivalue.AddValue\') %></span>\n            <span class="im-short"><%- messages.getText(\'multivalue.AddValueShort\') %></span>\n        </button>\n    </span>\n</div>\n',n.export_format_controls='<h4 class="im-title"></h4>\n\n<% _.each(formats, function (formatDef) { %>\n    <div class="radio">\n        <label>\n            <input type="radio"\n                   name="format"\n                   value="<%= formatDef.id %>"\n                   <%= (formatDef.id === format) ? \'checked\' : void 0 %>>\n            <%= Icons.icon(formatDef.icon) %>\n            <%= Messages.getText(formatDef.desc) %>\n        </label>\n    </div>\n<% }); %>\n',n.export_column_controls='<h4><%- Messages.getText(\'export.heading.Columns\') %></h4>\n\n<ul class="list-group">\n</ul>\n\n<div class="row controls"></div>\n',n.list_dialogue_body='<div class="im-list-name"></div>\n\n<div class="row">\n  <div class="col-sm-12 im-more-options">\n    <h4>\n      <%= Icons.icon(\'Options\') %>\n      <span class="msg"><%- Messages.getText(\'lists.ShowExtraOptions\', state) %></span>\n    </h4>\n  </div>\n</div>\n\n<div class="im-optional-attributes" style="<%- state.minimised ? \'display:none\' : void 0 %>">\n  <div class="im-list-desc"></div>\n\n  <div class="well im-tags">\n    <div class="row im-active-tags">\n    </div>\n    <div class="row">\n      <div class="col-sm-6 im-apology">\n      </div>\n      <div class="col-sm-6">\n        <div class="im-next-tag">\n        </div>\n      </div>\n    </div>\n  </div>\n</div>\n',n.constraint_editor='<fieldset class="im-constraint-options form-group row">\n  <label class="col-sm-3 path-label"><%- data.con.displayName %></label>\n  <% if (data.con.op) { %>\n    <div class="im-operator col-sm-3">\n        <select class="form-control im-ops">\n        <option selected><%- data.con.op %></option>\n        <% data.otherOperators.forEach(function (op) { %>\n            <option><%- op %></option>\n        <% }); %>\n        </select>\n    </div>\n  <% } %>\n  <div class="col-sm-6 im-value-options im-value-section">\n  </div>\n</fieldset>\n\n<div class="btn-group im-con-buttons">\n  <% data.buttons.forEach(function (b, i) { %>\n  <button class="btn btn-<%= (i === 0) ? \'primary\' : \'default\' %> <%- b.classes %>">\n    <%- data.messages.getText(b.key) %>\n  </button>\n  <% }); %>\n</div>\n',n.column_manager_path_name='<% /* requires parts */ %>\n<span class="im-path-name">\n    <% _.each(parts, function (part) { %>\n        <span class="im-name-part"><%- part %></span>\n    <% }); %>\n</span>\n\n',n.column_manager_path_remover='<% /* requires: removeTitle */ %>\n<span class="pull-right im-remove-view"\n      title="<%- Messages.getText(removeTitle) %>">\n    <%= Icons.icon(\'Remove\') %>\n</span>\n\n',
n.facet_frequency='<% /* requires: error, initialized */ %>\n<% if (error) { %>\n    <% /* Oh noes - something went wrong. */ %>\n    <div class="alert alert-warning">\n        <%= Icons.icon(\'Error\') %>\n        <strong><%- Messages.getText(\'Error\') %></strong>\n        <% if (error.key) { %>\n            <%- Messages.getText(error.key) %>\n        <% } else { %>\n            <%- error.message || error %>\n        <% } %>\n    </div>\n<% } else if (initialized) { %>\n    <% /* Huzzah - there is data, which will be added here as child views */ %>\n<% } else { %>\n    <% /* Boo - no data. Show an indeterminate progress bar while we wait. */ %>\n    <div class="progress">\n      <div class="progress-bar progress-bar-info progress-bar-striped active"\n           role="progressbar"\n           style="width:100%">\n        <span class="sr-only"><%- Messages.getText(\'Loading\') %>.</span>\n      </div>\n    </div>\n<% } %>\n',n.column_manager_path_chooser_buttons="<button class=\"btn btn-default im-rearrange-columns\">\n  <%- Messages.getText('Cancel') %>\n</button>\n<button class=\"btn btn-success im-add-column\"\n  <%= collection.length ? (void 0) : 'disabled' %> >\n  <%- Messages.getText('columns.AddColumn', {num: collection.length}) %>\n</button>\n\n",n.null_value='<span class="im-null-value">&nbsp;</span>\n',n.table_subtable='<span class="im-subtable-summary">\n</span>\n<div class="im-table-wrapper">\n</div>\n',n.constraint_adder_options='<% if (showTree) { %>\n    <div class="col-sm-5">\n        <div class="input-group">\n            <span class="input-group-addon">find</span>\n            <input type="text"\n                value="<%- filter %>"\n                class="im-tree-filter form-control" placeholder="path">\n            <span class="input-group-btn">\n                <button class="btn btn-default im-clear-filter" type="button">\n                    <%- Messages.getText(\'Clear\') %>\n                </button>\n            </span>\n        </div>\n    </div>\n<% } %>\n<div class="col-sm-7">\n    <div class="btn-group">\n        <% if (!showTree) { %>\n            <button type="button" class="btn btn-default btn-chooser im-choose">\n                <%= Icons.icon(\'Tree\') %>\n                <span><%- Messages.getText(\'constraints.BrowseForColumn\') %></span>\n            </button>\n        <% } else { %>\n            <button <%= anyNodeChosen ? void 0 : \'disabled\' %>\n                    class="btn btn-primary im-approve"\n                    type="button" >\n                <%- Messages.getText(\'constraints.Choose\') %>\n                <% _.each(chosen, function (path, i) { %>\n                    <%- path %>\n                    <% if (i + 2 === chosen.length) { %>\n                        <%- Messages.get(\'and\') %>\n                    <% } else if (i + 2 < chosen.length) { %>\n                        <%- Messages.get(\'comma\') %>\n                    <% } %>\n                <% }); %>\n            </button>\n        <% } %>\n    </div>\n    <div class="form-group">\n        <label class="im-tree-option">\n            <%- Messages.getText(\'columns.AllowRevRef\') %>\n            <input type="checkbox"\n                    class="im-allow-rev-ref"\n                    <%= allowRevRefs ? \'checked\' : void 0 %> >\n        </label>\n    </div>\n</div>\n',n.summary_items_controls='<button class="btn btn-default pull-right im-download">\n  <%= Icons.icon(\'Download\') %>\n  <%- Messages.getText(\'summary.DownloadData\') %>\n</button>\n\n<div class="btn-group im-filter-group">\n  <button type="submit"\n        class="btn btn-primary im-filter-in"\n        <%= (anyItemSelected) ? void 0 : \'disabled\' %>>\n    <%- Messages.getText(\'Filter\') %>\n  </button>\n  <button class="btn btn-primary dropdown-toggle" \n          title="<%- Messages.getText(\'summary.SelectFilter\') %>"\n          <%= (anyItemSelected) ? void 0 : \'disabled\' %>>\n    <span class="caret"></span>\n  </button>\n  <ul class="dropdown-menu">\n    <li>\n      <a href="#" class="im-filter-in">\n        <%- Messages.getText(\'summary.Include\') %>\n      </a>\n    </li>\n    <li>\n      <a href="#" class="im-filter-out">\n        <%- Messages.getText(\'summary.Exclude\') %>\n      </a>\n    </li>\n  </ul>\n</div>\n\n<div class="btn-group">\n  <button class="btn btn-default btn-cancel"\n          <%= (anyItemSelected) ? void 0 : \'disabled\' %>\n          title="<%- Messages.getText(\'summary.Reset\') %>">\n    <%= Icons.icon(\'Undo\') %>\n  </button>\n  <% if (!(/boolean/i).test(type)) { %>\n    <button class="btn btn-default btn-toggle-selection"\n            title="<%- Messages.getText(\'summary.Toggle\') %>">\n        <%= Icons.icon(\'Toggle\') %>\n    </button>\n  <% } %>\n</div>\n\n',n.modal_base='<div class="modal-dialog <%- modalSize %>">\n    <div class="modal-content">\n        <div class="modal-header">\n            <button type="button" class="close">\n                <span aria-hidden="true">&times;</span>\n                <span class="sr-only">Close</span>\n            </button>\n            <h4 class="modal-title"><%- title %></h4>\n        </div>\n        <div class="modal-body">\n            <%= body %>\n        </div>\n    </div>\n</div>\n',n.count_summary="<% if (size && count) { %>\n  <% var msg = (size == 0 ? '.ShowingAll' : '.ShowingRange'); %>\n  <% ['xs', 'sm', 'md', 'lg'].forEach(function (pageSize) { %>\n    <span class=\"visible-<%= pageSize %>-inline\">\n      <%- Messages.getText('table.' + pageSize + msg, page) %>\n    </span>\n  <% }); %>\n<% } %>\n",n.active_progress_bar='<div class="progress progress-info progress-striped active">\n  <div class="bar" style="width: 100%"></div>\n</div>\n',n.boolean_value_controls="<button class=\"btn btn-default im-true {{ (value === true) ? ' active' : void 0 }}\">\n  True\n</button>\n<button class=\"btn btn-default im-false {{ (value === false) ? ' active' : void 0 }}\">\n  False\n</button>\n",n.summary_heading='<% /* requires:\n    *  numeric, available, got, uniqueValues\n    *  state.typeName, state.endName\n    *  filtered \n    */ %>\n<h3>\n  <% if (numeric) { %>\n    <%- Messages.getText(\'summary.NumericDistribution\', {n: available}) %>\n    <span class="im-type-name"><%- state.typeName %></span>\n    <span class="im-attr-name"><%- pluralise(state.endName, got) %></span>\n  <% } else { %> \n    <span class="im-item-got">\n      <%- Messages.getText(\'summary.Got\', {available: available, got: got}) %>\n    </span>\n    <span class="im-item-available">\n      <%- Messages.getText(\'Number\', {n: available}) %>\n    </span>\n    <span class="im-type-name"><%- state.typeName %></span>\n    <span class="im-attr-name"><%- pluralise(state.endName, got) %></span>\n    <span class="im-item-total">\n      <%- Messages.getText(\'summary.Total\', {\n            filtered: filtered,\n            total: uniqueValues\n          }) %>\n    </span>\n  <% } %> \n</h3>\n',n.column_manager_path_chooser="<div class=\"btn-group pull-right\">\n</div>\n<h4>\n  <%- Messages.getText('columns.ChooseAPathFrom', {root: state.rootName}) %>\n</h4>\n\n",n.column_name_popover='<% _.each(parts, function (part) { %>\n  <span class="im-name-part"><%- part %></span>\n<% }); %>\n',n.classy_popover='<div class="popover <%- classes %>" role="tooltip">\n  <div class="arrow"></div>\n  <h3 class="popover-title"></h3>\n  <div class="popover-content"></div>\n</div>\n',n.code_gen_button_main="<%= Icons.icon('CodeFile') %>\n<span class=\"hidden-sm hidden-xs\">\n  <%- Messages.getText('codegen.GenerateCodeIn', {lang: lang}) %>\n</span>\n<span class=\"visible-sm-inline im-current-lang\">\n    <%- Messages.getText('codegen.Lang', {lang: lang}) %>\n</span>\n\n",n.undo_history_step='<% if (!state.current) { %>\n  <button class="btn btn-default btn-small im-state-revert"\n      title="<%- Messages.getText(\'undo.RevertToState\') %>">\n      <%= Icons.icon(\'Undo\') %>\n  </button>\n<% } %>\n\n<h4>\n    <%- Messages.getText(\'undo.StepTitle\', title) %>\n</h4>\n\n<% if (state.current) { %>\n  <span class="help-block"><%- Messages.getText(\'undo.IsCurrentState\') %></span>\n<% } %>\n<div style="clear:both"></div>\n\n<span class="im-revision" title="<%- Messages.getText(\'undo.RevisionTitle\', {v: revision}) %>">\n  <%- Messages.getText(\'undo.Revision\', {v: revision}) %>\n</span>\n\n<div class="im-step-count">\n  <span><%- Messages.getText(\'undo.StepCount\', {count: count}) %></span>\n  <% if (diff) { %>\n    <span class="label im-label-<%= (diff > 0 ) ? \'pos\' : \'neg\' %>">\n      <% if (diff > 0) { %>+<% } %><%- numToString(diff) %>\n    </span>\n  <% } %>\n</div>\n\n<div class="im-step-details"></div>\n\n<div style="clear:both"></div>\n',n.export_preview='<div class="form-group im-export-formats">\n  <label><%- Messages.getText(\'export.param.Format\') %></label>\n  <select class="form-control">\n    <% _.each(formats, function (fmt) { %>\n      <option value="<%- fmt.id %>"\n              <%= (fmt.id === format.id) ? \'selected\' : void 0 %>>\n        <%- Messages.getText(fmt.name) %>\n      </option>\n    <% }); %>\n  </select>\n</div>\n\n<pre class="im-export-preview">\n<%- state.preview %>\n</pre>\n\n<div class="alert alert-info">\n    <strong class="nb">nb</strong>\n    <%- Messages.getText(\'export.preview.Limit\') %>\n</div>\n',n.list_value_controls="<% if (suitableLists.length) { %>\n    <%= select(suitableLists, isSelected, 'span7 im-value-options im-con-value im-con-value-list form-control', formatList, getOptionValue) %>\n<% } else { %>\n    <%- messages.getText('conbuilder.NoSuitableLists') %>\n<% } %>\n",n.column_manager_sort_order_editor='<% /* requires: collection, available */ %>\n<h4>\n  <%- Messages.getText(\'columns.CurrentSortOrder\', {\n    oes: collection\n  }) %>\n</h4>\n\n<span class="help-block">\n  <%- Messages.getText(\'columns.CurrentSortOrderHelp\') %>\n</span>\n\n<div class="well im-current-sort-order">\n\n  <div class="row">\n    <div class="col-md-6">\n        <% if (collection.length) { %>\n          <ul class="list-group im-active-oes im-connected-list"></ul>\n        <% } else { %>\n          <div class="im-empty-collection">\n            <%- Messages.getText(\'columns.NoSortOrder\') %>\n          </div>\n        <% } %>\n    </div>\n\n    <div class="col-md-6">\n        <% if (available) { %>\n          <div class="im-rubbish-bin">\n            <ul class="list-group im-removed im-available-oes im-connected-list">\n            </ul>\n          </div>\n        <% } %>\n    </div>\n  </div>\n</div>\n',n.extra_value_controls='<label class="im-value-options">\n    <%- messages.getText(\'conbuilder.ExtraLabel\') %>\n    <input type="text" class="im-extra-value form-control"\n            placeholder="<%- state.extraPlaceholder %>"\n            value="<%- con.extraValue %>">\n</label>\n\n',n.undo_history_step_section="<div class=\"im-section-summary\">\n  <% if (collection.length) { %>\n    <%= Icons.icon(state.open ? 'ExpandedSection' : 'CollapsedSection') %>\n  <% } %>\n  <%- Messages.getText(summaryLabel, {n: count}) %>\n</div>\n<% if (collection.length) { %>\n  <div class=\"<%- collectionClasses %>\">\n    <% _.each(collection, function (e) { %>\n      <span class=\"label label-<%= e.added ? 'success' : (e.removed ? 'danger' : 'default') %>\">\n        <%- labelContent(e) %>\n      </span>\n    <% }); %>\n  </div>\n<% } %>\n",n.summary_items='<% if (!(/boolean/i).test(type)) { %>\n    <div class="input-group im-filter-group">\n    <span class="input-group-btn">\n        <button class="btn btn-default im-clear-value-filter">\n        <%= Icons.icon(\'Refresh\') %>\n        </button>\n    </span>\n    <input type="search" class="form-control im-filter-values"\n        value="<%- filterTerm %>"\n        placeholder="<%- Messages.getText(\'summary.FilterValuesPlaceholder\') %>">\n    </div>\n<% } %>\n\n<div class="im-item-table">\n  <table class="table table-condensed table-striped">\n    <colgroup>\n      <% _.each(colClasses, function (cls) { %>\n        <col class="<%- cls %>">\n      <% }); %>\n    </colgroup>\n    <thead>\n      <tr>\n        <% _.each(colHeaders, function (hdr) { %>\n          <th><%- hdr %></th>\n        <% }); %>\n      </tr>\n    </thead>\n    <tbody class="scrollable">\n    </tbody>\n  </table>\n\n  <% if (hasMore) { %>\n    <div class="im-load-more">\n      <%- Messages.getText(\'summary.MoreItems\') %>\n    </div>\n  <% } %>\n</div>\n\n<div class="im-summary-controls">\n</div>\n',n.facet_title="<%= Icons.icon(state.open ? 'Expanded' : 'Collapsed') %>\n<span class=\"im-facet-title\"><%- pathName %></span>\n&nbsp;\n<span class=\"im-facet-count\"><%- Messages.getText('Number', {n: got} %></span>\n",n.too_many_suggestions="<span class=\"alert alert-info\">\n  {{{ icons.icon('Info') }}}\n  {{ messages.getText('conbuilder.TooManySuggestions') }}\n  There are {{ extra }} values we could not include.\n</span>\n",n.active_constraints='<% /* requires: constraints.length */ %>\n<div class="well im-current-constraints">\n    <p class="well-help">\n      <% if (constraints.length) { %>\n        <%- Messages.getText(\'constraints.EditOrRemove\') %>\n      <% } else { %>\n        <%- Messages.getText(\'constraints.None\') %>\n      <% } %>\n    </p>\n\n    <ul class="im-active-constraints">\n    </ul>\n</div>\n',n.reset_button="<button type=\"button\"\n        <%= (isAll) ? 'disabled' : void 0 %>\n        class=\"btn btn-default btn-reset\">\n    <%- Messages.getText('Reset') %>\n</button>\n",n.cell_preview_attribute='<tr>\n  <td class="im-field-name"><%- _.last(parts) %></td>\n  <td class="im-field-value <%- field.toLowerCase() %> <%- type %>">\n    <% if (isNumeric) { %>\n      <%- numToString(+value) %>\n    <% } else { %>\n      <%- value %>\n    <% } %>\n    <% if (tooLong) { %>\n      <span class="im-overspill"><%- valueOverspill %></span>\n      <a class="im-too-long">\n        <span class="im-ellipsis">...</span>\n        <%= Icons.icon(\'More\') %>\n      </a>\n    <% } %>\n  </td>\n</tr>\n',n.export_destination_radios='<label><%- Messages.getText(\'export.param.Destination\') %></label>\n<% _.each(destinations, function (d) { %>\n    <div class="radio im-dest-<%- d %>">\n        <label>\n            <input type="radio"\n                    name="dest"\n                    <%= (d === dest) ? \'checked\' : void 0 %>>\n            <%- Messages.getText(d) %>\n        </label>\n    </div>\n<% }); %>\n\n',n.export_dialogue='<div class="row">\n    <nav class="col-sm-3 menu">\n    </nav>\n    <div class="col-sm-9 main">\n    </div>\n</div>\n',n.column_manager_select_list='<div class="im-removal-and-rearrangement">\n  <button class="pull-right btn btn-success im-add-view-path">\n      <%= Icons.icon(\'Add\') %>\n      <%- Messages.getText(\'columns.FindColumnToAdd\') %>\n  </button>\n\n  <h4>\n    <%- Messages.getText(\'columns.ColumnsSelected\', {columns: collection, removed: hasRubbish}) %>\n  </h4>\n\n  <span class="help-block"><%- Messages.getText(\'columns.CurrentViewHelp\') %></span>\n\n  <div class="well im-current-view">\n\n    <div class="row">\n\n      <div class="col-md-6">\n        <ul class="list-group im-active-view im-connected-list">\n        </ul>\n      </div>\n\n      <div class="col-md-6">\n        <div class="im-rubbish-bin">\n            <%= Icons.icon((hasRubbish ? \'RubbishFull\' : \'Rubbish\'), \'lg\') %>\n            <% if (hasRubbish) { %>\n                <ul class="list-group im-removed im-removed-view im-connected-list">\n                </ul>\n            <% } %>\n        </div>\n      </div>\n\n    </div>\n  </div>\n</div>\n\n<div class="im-addition">\n</div>\n\n',n.table_building="<h2><%- Messages.getText('table.Building') %></h2>\n<%= IndeterminateProgressBar %>\n",n.constraint_summary="<% if (code) { %>\n  <li><span class=\"text-muted\"><strong><%- code %>:</strong></span></li>\n<% } %>\n<% _.each(labels, function (label) { %>\n  <li>        \n    <span class=\"label label-<%- label.type %>\">\n      <% if (_.include(['error', 'warning'], label.type)) { %>\n        <%= Icons.icon('Error') %>\n        <%- Messages.getText('consummary.' + label.content) %>\n      <% } else if (label.type === 'path') { %>\n        <% _.each(label.content.split(' > '), function (part) { %>\n          <span title=\"<%- label.content %>\" class=\"im-name-part\"><%- part %></span>\n        <% }); %>\n      <% } else { %>\n        <% if (label.icon) { %><%= Icons.icon(label.icon) %><% } %>\n        <%- label.content %>\n      <% } %>\n    </span>\n  </li>\n<% }); %>\n",n.cell_preview_items='<colgroup>\n  <col class="im-item-field"/>\n  <col class="im-item-value"/>\n</colgroup>\n<tbody></tbody>\n',n.slider='<div class="im-slider">\n    <% _.each(markers, function(marker) { %>\n        <span class="im-slider-marker"><%- marker.value %></span>\n    <% }); %>\n</div>\n',n.export_tab_menu='<% _.each(data.tabs, function (tabDef) { %>\n  <li role="presentation" class="im-tab-<%= tabDef.ident %> <%= data.tab === tabDef.ident ? \'active\' : void 0 %>">\n    <a><%- data.Messages.getText(tabDef.key, data) %></a>\n  </li>\n<% }); %>\n',n.loop_value_controls="<% if (candidateLoops.length) { %>\n    <%= select(candidateLoops, isSelected, 'form-control im-value-options im-con-value') %>\n<% } else { %>\n    <%- messages.getText('conbuilder.NoSuitableLoops') %>\n<% } %>\n",n.export_column_control="<span class=\"badge\"><%- item.getType() %></span>\n<span class=\"im-active-state\">\n    <% if (active) { %>\n        <%= Icons.icon('Check') %>\n    <% } else { %>\n        <%= Icons.icon('UnCheck') %>\n    <% } %>\n</span>\n<%- name %>\n",n.export_rows_reset_button="<button type=\"button\"\n        <%= (isAll) ? 'disabled' : void 0 %>\n        class=\"btn btn-default btn-reset\">\n        <%- Messages.getText('export.ResetRowSelection') %>\n</button>\n\n<% if (tablePage) { %>\n    <button type=\"button\"\n            <%= (tablePage.start === start && tablePage.size === size) ? 'disabled' : void 0 %>\n            class=\"btn btn-default im-set-table-page\">\n            <%- Messages.getText('export.SetTablePage') %>\n    </button>\n<% } %>\n        \n",n.input_with_label='<label><%- Messages.getText(label) %></label>\n<input class="form-control"\n       placeholder="<%- Messages.getText(placeholder) %>"\n       value="<%- value %>">\n<% if (helpMessage) { %>\n  <span style="display:<%= hasProblem ? \'block\' : \'none\' %>"\n        class="help-block">\n        <%- Messages.getText(helpMessage) %>\n  </span>\n<% } %>\n',n.error_message="<% if (error) { %>\n    <div class=\"alert alert-<%= error.level || 'danger' %>\">\n        <%= icons.icon('Error') %>\n        <span class=\"im-conbuilder-error\">\n            <%- error.message || error %>\n        </span>\n    </div>\n<% } %>\n\n",n.column_manager_tabs='<ul class="nav nav-tabs">\n    <li role="presentation" class="<%- classes.view %>">\n      <a href="#">\n        <%- Messages.getText(\'columns.ViewTabTitle\') %>\n      </a>\n    </li>\n    <li role="presentation" class="<%- classes.sortorder %>">\n      <a href="#">\n        <%- Messages.getText(\'columns.SortOrderTabTitle\') %>\n      </a>\n    </li>\n</ul>\n',n.modal_error='<% /* Renders an alert box at various levels, with appropriate icons and messages */ %>\n<% if (error) { %>\n    <div class="pull-left alert <%- errorAlert(error) %>">\n        <% if (!error.cannotDismiss) { %>\n            <button type="button" class="dismiss">\n                <span aria-hidden="true">&times;</span>\n                <span class="sr-only">Close</span>\n            </button>\n        <% } %>\n        <%= Icons.icon(errorIcon(error)) %>\n        <strong><%- Messages.getText(\'ErrorTitle\', error) %></strong>\n        <% if (error.key != null) { %>\n            <%- Messages.getText(error.key) %>\n        <% } else { %>\n            <%- error.message || error %>\n        <% } %>\n    </div>\n<% } %>\n',n.no_results="<% /* requires: selectList :: [], canUndo :: bool */ %>\n<td colspan=\"<%- selectList.length %>\">\n  <div class=\"alert alert-warning\">\n    <% if (canUndo) { %>\n      <button class=\"pull-right btn btn-large btn-default btn-undo\">\n        <%= Icons.icon('Undo') %>\n        <%- Messages.getText('Undo') %>\n      </button>\n    <% } %>\n    <strong><%- Messages.getText('table.Empty') %></strong>\n    <p><%- Messages.getText('table.EmptyWhy') %></p>\n  </div>\n</td>\n",n.only_one_item="<div class=\"alert alert-info\">\n    <%= Icons.icon('Info') %>\n    <%= Messages.getText('summary.OnlyOne', {names: state, item: items[0]}) %>\n</div>\n\n",n.code_gen_button='<% /* requires lang :: string, options.Langs :: [string] */ %>\n<div class="btn-group language-selector">\n    <button type="button"\n            class="btn btn-default im-show-code-gen-dialogue">\n    </button>\n    <button type="button"\n            data-toggle="dropdown"\n            aria-expanded="false"\n            class="btn btn-default dropdown-toggle">\n        <span class="caret"></span>\n    </button>\n    <ul class="dropdown-menu im-code-gen-langs" role="menu">\n        <% _.each(options.Langs, function (l) { %>\n            <li data-lang="<%- l %>" class="<%= (l === lang) ? \'active\' : void 0 %>">\n                <a href="#"><%- Messages.getText(\'codegen.Lang\', {lang: l}) %></a>\n            </li>\n        <% }); %>\n    </ul>\n</div>\n',n.export_compression_controls="<h4><%- Messages.getText('export.category.Compression', state) %></h4>\n\n<div class=\"checkbox im-compress\">\n    <label>\n        <input type=\"checkbox\" <%= compress ? 'checked' : void 0 %>>\n        <%- Messages.getText('export.UseCompression') %>\n    </label>\n</div>\n\n<fieldset <%= compress ? void 0 : 'disabled' %>>\n    <div class=\"radio\">\n        <label>\n            <input type=\"radio\"\n                name=\"gzip\"\n                <%= (compression === 'gzip') ? 'checked' : void 0 %>>\n            <%- Messages.getText('export.UseGZIP') %>\n        </label>\n    </div>\n\n    <div class=\"radio\">\n        <label>\n            <input type=\"radio\"\n                name=\"zip\"\n                <%= (compression === 'zip') ? 'checked' : void 0 %>>\n            <%- Messages.getText('export.UseZIP') %>\n        </label>\n    </div>\n</fieldset>\n\n",n.column_manager_order_direction="<% /* requires: direction, isNumeric */ %>\n<span class=\"im-change-direction\"\n  title=\"<%- Messages.getText('columns.ChangeDirection') %>\">\n  <span class=\"sr-only\">\n    <%- Messages.getText('columns.CurrentDirection', {\n      dir: direction, numeric: isNumeric\n    }) %>\n  </span>\n  <%= Icons.icon('Sort' + (isNumeric ? 'Numeric' : 'String') + direction) %>\n</span>\n",n.progress_bar='<% /* requires: doneness (float: 0 <= i <= 1) */ %>\n<% if (doneness != null && doneness >= 0) { %>\n    <div class="progress">\n        <div class="progress-bar progress-bar-striped active"\n             role="progressbar"\n             aria-valuenow="<%- doneness %>"\n             aria-valuemin="0"\n             aria-valuemax="1"\n             style="width: <%- 100 * doneness %>%;">\n            <% if (doneness < 1) { %>\n              <span class="sr-only">\n                <%- Math.round(100 * doneness) %>% <%- Messages.getText(\'Complete\') %>\n              </span>\n            <% } %>\n        </div>\n    </div>\n<% } %>\n',n.export_json_options="<h3><%- Messages.getText('export.category.Options') %></h3>\n\n<div class=\"radio\">\n    <label>\n        <input type=\"radio\"\n               name=\"rows\"\n               <%= (jsonFormat === 'rows') ? 'checked' : void 0 %>>\n        <%- Messages.getText('export.json.Rows') %>\n        <pre><%- Messages.getText('export.json.RowsExample') %></pre>\n    </label>\n</div>\n\n<div class=\"radio\">\n    <label>\n        <input type=\"radio\"\n               name=\"objects\"\n               <%= (jsonFormat === 'objects') ? 'checked' : void 0 %>>\n        <%- Messages.getText('export.json.Objects') %>\n        <pre><%- Messages.getText('export.json.ObjExample') %></pre>\n    </label>\n</div>\n\n<% if ((size || start) && jsonFormat === 'objects') { %>\n    <div class=\"alert alert-warning\">\n        <h4><%- Messages.get('Warning') %></h4>\n        <p><%- Messages.get('export.json.ObjWarning') %></p>\n    </div>\n<% } %>\n\n",n.export_destination_galaxy_options='<div class="form-group">\n    <label><%- Messages.getText(\'GalaxyURILabel\') %></label>\n    <input type="url"\n           class="form-control im-galaxy-uri-param"\n           value="<%- Galaxy.Current || Galaxy.Main %>">\n</div>\n<div class="checkbox im-save-galaxy">\n    <label>\n        <input type="checkbox" <%= (Galaxy.Save) ? \'checked\' : void 0 %>>\n        <%- Messages.getText(\'SaveGalaxyURL\') %></label>\n    </label>\n</div>\n',n.new_filter_dialogue='<div class="modal-body">\n</div>\n<div class="modal-footer">\n    <button class="disabled btn btn-primary pull-right im-add-constraint">\n        <%- Messages.getText(\'constraints.AddFilter\') %>\n    </button>\n    <button class="btn im-close pull-left">\n        <%- Messages.getText(\'Cancel\') %>\n        Cancel\n    </button>\n</div>\n',n.list_tags_apology="<% if (!hasTags) { %>\n  <span>\n    <%- Messages.getText('lists.NoTags') %>\n  </span>\n<% } %>\n",n.column_manager_restore_path='<% /* requires: restoreTitle */ %>\n<span class="pull-right im-restore-view"\n    title="<%- Messages.getText(restoreTitle) %>">\n    <%= Icons.icon(\'Add\') %>\n</span>\n\n',n.table_subtables_header="<a title=\"<%- Messages.getText('subtables.RemoveColumn') %>\">\n  <%= Icons.icon('Remove') %>\n</a>\n<% if (displayName && columnName) { %>\n  <%- displayName.replace(columnName, '').replace(/^ > /, '') %>\n<% } %>\n",n.pagination='<ul class="pagination">\n    <li class="hidden-xs <%= gotoStart || \'im-goto-start\' %>" title="Go to start">\n        <a class="im-pagination-button">&#x21e4;</a>\n    </li>\n    <li class="hidden-xs hidden-sm <%= goFiveBack || \'im-go-back-5\' %>"\n        title="Go back five pages"\n        class="visible-desktop">\n        <a class="im-pagination-button">&#x219e;</a>\n    </li>\n    <li class="<%= goOneBack || \'im-go-back-1\' %>"\n        title="Go to previous page">\n        <a class="im-pagination-button">&larr;</a>\n    </li>\n    <li class="im-current-page">\n        <% if (useSelect) { %>\n          <form class="im-page-form form form-inline">\n            <select class="form-control">\n              <% for (i = 0; i < max; i++) { %>\n                <option\n                  <%= selected(i) ? \'selected\' : void 0 %>\n                  value="<%= i * size %>">\n                  page <%= i + 1 %>\n                </option>\n              <% } %>\n            </select>\n          </form>\n        <% } else { %>\n          <a href="#">&hellip;</a>\n          <form class="im-page-form form form-inline"\n                style="display:none;">\n            <div class="control-group">\n                <input type="number"\n                       value="<%= currentPage %>"\n                       max="<%= max %>"\n                       min="<%= min %>"\n                       class="form-control im-page-number">\n            </div>\n          </form>\n        <% } %>\n    </li>\n    <li class="<%= goOneForward || \'im-go-fwd-1\' %>"\n        title="Go to next page">\n        <a class="im-pagination-button">&rarr;</a>\n    </li>\n    <li class="hidden-xs hidden-sm <%= goFiveForward || \'im-go-fwd-5\' %>"\n        title="Go forward five pages"\n        class="visible-desktop">\n        <a class="im-pagination-button">&#x21a0;</a>\n    </li>\n    <li class="hidden-xs <%= gotoEnd || \'im-goto-end\' %>"\n        title="Go to last page">\n        <a class="im-pagination-button">&#x21e5;</a>\n    </li>\n</ul>\n',n.facet_row='<% /* requires: selected, symbol, item, count, percent, opacity, share */ %>\n<td class="im-selector-col">\n  <span><%- symbol %></span>\n  <div class="checkbox"></div>\n</td>\n\n<td class="im-item-col">\n  <% if (item != null) { %>\n    <%- item %>\n  <% } else { %>\n    <span class=null-value>&nbsp;</span>\n  <% } %>\n</td>\n\n<td class="im-count-col">\n  <% if (max > 1) { %>\n    <div class="im-facet-bar"\n         style="width:<%- percent %>%;background:<%- Messages.getText(\'summary.FacetBar\', {opacity: opacity}) %>">\n    </div>\n  <% } %>\n  <span class="im-count"><%- numToString(count) %></span>\n</td>\n\n<% if (share != null) { %>\n    <td class="im-percent-col"><i><%- share.toFixed() %>%</i></td>\n<% } %>\n',n.table_subtable_summary="<% if (rows.length) { %>\n  <%= Icons.icon('Table') %>\n<% } else { %>\n  <%= Icons.icon('EmptyTable') %>\n<% } %>\n<%- rows.length %>\n<%- pluralise(contentName, rows.length) %>\n",n.attribute_value_select='<select class="form-control im-con-value-attr">\n    <% _.each(items, function (item) { %>\n    <option <%= (item.item === value) ? \'selected\' : void 0 %> value="<%- item.item %>">\n            <%- item.item %>\n        </option>\n    <% }); %>\n</select>\n',n.code_gen_js='<% if (asHTML) { %>\n<!-- The Element we will target -->\n<div id="some-elem"></div>\n<!-- The imtables source -->\n<script src="<%= imtablesJS %>" charset="UTF-8"></script>\n<link rel="stylesheet" href="<%= imtablesCSS %>">\n<script>\n<% } %>\n<% if (!asHTML) { %>\n/* Install from npm: npm install imtables\n * This snippet assumes the presence on the page of an element like:\n * <div id="some-elem"></div>\n */\nvar imtables = require(\'imtables\');\n<% } %>\n\nvar selector = \'#some-elem\';\nvar service  = {root: \'<%= service.root %>\'};\nvar query    = <%= JSON.stringify(query, null, 2) %>;\n\nimtables.loadTable(\n  selector, // Can also be an element, or a jQuery object.\n  <%= JSON.stringify(page) %>, // May be null\n  {service: service, query: query} // May be an imjs.Query\n).then(\n  function (table) { console.log(\'Table loaded\', table); },\n  function (error) { console.error(\'Could not load table\', error); }\n);\n<% if (asHTML) { %>\n</script>\n<% } %>\n',n.export_flat_file_options="<h4><%- Messages.getText('export.category.ColumnHeaders', state) %></h4>\n\n<div class=\"checkbox im-headers\">\n    <label>\n        <input type=\"checkbox\" <%= headers ? 'checked' : void 0 %>>\n        <%- Messages.getText('export.AddHeaders') %>\n    </label>\n</div>\n\n<fieldset <%= headers ? void 0 : 'disabled' %>>\n    <div class=\"radio\">\n        <label>\n            <input type=\"radio\"\n                name=\"hdrs-friendly\"\n                <%= (headerType === 'friendly') ? 'checked' : void 0 %>>\n            <%- Messages.getText('export.ff.FriendlyHeaders') %>\n        </label>\n    </div>\n\n    <div class=\"radio\">\n        <label>\n            <input type=\"radio\"\n                name=\"hdrs-path\"\n                <%= (headerType === 'path') ? 'checked' : void 0 %>>\n            <%- Messages.getText('export.ff.PathHeaders') %>\n        </label>\n    </div>\n</fieldset>\n\n",n.cell_preview_error='<div class="alert alert-error">\n    <h4>Error</h4>\n    <p>Sorry. We could not fetch the preview due to an error:</p>\n    <code><%- message %></code>\n</div>\n',n.cell_preview_reference="<tr>\n    <td class=\"im-field-name\"><%- _.rest(parts).join(' ') %></td>\n    <td class=\"im-field-value <%- field.toLowerCase() %>\">\n        <%- values.join(', ') %>\n    </td>\n</tr>\n",n.export_destination_options='<div class="form-group im-param-name">\n    <label><%- Messages.getText(\'export.param.Name\') %></label>\n    <div class="input-group">\n      <input type="text"\n             value="<%- filename %>"\n             class="form-control"\n             placeholder="<%- Messages.getText(\'export.param.Name\') %>"\n             aria-label="<%- Messages.getText(\'export.param.Name\') %>">\n      <div class="input-group-btn">\n        <button type="button"\n                class="btn btn-default dropdown-toggle"\n                data-toggle="dropdown"\n                aria-expanded="false">\n          .<%- format %>\n          <span class="caret"></span>\n        </button>\n        <ul class="dropdown-menu dropdown-menu-right" role="menu">\n          <% _.chain(formats).groupBy(\'group\').each(function (fmts, grp) { %>\n            <% if (this.i++) { %><li class="divider"></li><% } %>\n            <% _.each(fmts, function (fmt) { %>\n                <li>\n                    <a href="#"\n                       class="im-fmt-<%- fmt.id %>">\n                      <%= Icons.icon(fmt.icon) %>\n                      <%- Messages.getText(fmt.name) %>\n                    </a>\n                </li>\n            <% }); %>\n          <% }, {i: 0}); %>\n        </ul>\n      </div>\n    </div>\n</div>\n\n<% if (format && format.desc) { %>\n  <div class="alert alert-info">\n    <%- Messages.getText(format.desc) %>\n  </div>\n<% } %>\n\n<div class="row">\n    <div class="col-sm-6 im-param-dest">\n    </div>\n    <div class="col-sm-6 im-dest-opts">\n    </div>\n</div>\n',
n.column_header='<% /* requires the properties of HeaderModel +\n    *  penult, last, headerClasses, colTitleClasses, penultClasses\n    *  and the usual Icons, Messages\n    */ %>\n<div class="<%- headerClasses %>">\n\n<div class="im-th-buttons">\n    \n    <% if (outerJoined && isReference) { %>\n      <a href="#" \n          class="im-subtable-expander im-th-button"\n          title="<%- Messages.getText(\'table.header.ToggleTables\') %>">\n        <%= Icons.icon(\'Table\') %>\n      </a>\n    <% } %>\n\n    <% if (sortable) { %>\n        <span class="im-th-dropdown im-col-sort dropdown">\n            <a class="im-th-button im-col-sort-indicator"\n                title="<%- Messages.getText(\'table.header.SortColumn\', {dir: sortDirection}) %>">\n                <%= Icons.icon(sortDirection || \'unsorted\') %>\n            </a>\n            <div class="dropdown-menu">\n                <div><%- Messages.getText(\'table.header.FailedToInitSortMenu\') %></div>\n            </div>\n        </span>\n    <% } %>\n\n    <a class="im-th-button im-col-remover"\n        title="<%- Messages.getText(\'table.header.RemoveColumn\') %>">\n        <%= Icons.icon(\'headerIconRemove\') %>\n    </a>\n\n    <a class="im-th-button im-col-minumaximiser"\n        title="<%- Messages.getText(\'table.header.ToggleColumn\') %>">\n        <%= Icons.icon(minimised ? \'headerIconReveal\' : \'headerIconHide\') %>\n    </a>\n\n    <span class="dropdown im-filter-summary im-th-dropdown">\n        <a class="im-th-button im-col-filters dropdown-toggle"\n            title="<%- Messages.getText(\'table.header.FilterTitle\', {count: numOfCons}) %>"\n            data-toggle="dropdown" >\n            <%= Icons.icon(\'Filter\') %>\n        </a>\n        <div class="dropdown-menu">\n            <div><%- Messages.getText(\'table.header.FailedToInitFilter\') %></div>\n        </div>\n    </span>\n\n    <span class="dropdown im-summary im-th-dropdown">\n        <a class="im-th-button summary-img dropdown-toggle"\n            title="<%- Messages.getText(\'table.header.ViewSummary\') %>"\n            data-toggle="dropdown" >\n            <%= Icons.icon(\'Summary\') %>\n        </a>\n        <div class="dropdown-menu">\n            <div><%- Messages.getText(\'table.header.FailedToInitSummary\') %></div>\n        </div>\n    </span>\n\n    <% if (isComposed) { %>\n        <a class="im-th-button im-col-composed"\n            title="<%- Messages.getText(\'table.header.Composed\', {replaces: replaces}) %>">\n            <%= Icons.icon(\'Composed\') %>\n        </a>\n    <% } %>\n</div>\n\n<div class="<%- colTitleClasses %>">\n  <div class="<%- penultClasses %>">\n      <%- penult %>\n  </div>\n  <% if (last) { %>\n    <div class="im-title-part im-last">\n        <%- last %>\n    </div>\n  <% } %>\n</div>\n\n</div>\n\n',n.summary_stats='<table class="table">\n    <thead>\n        <tr>\n            <th><%- Messages.getText(\'summary.Max\') %></th>\n            <th><%- Messages.getText(\'summary.Min\') %></th>\n            <th><%- Messages.getText(\'summary.Average\') %></th>\n            <th><%- Messages.getText(\'summary.StdDev\') %></th>\n        </tr>\n        <tr>\n            <td><%- Messages.getText(\'Number\', {n: max}) %></td>\n            <td><%- Messages.getText(\'Number\', {n: min}) %></td>\n            <td><%- Messages.getText(\'Number\', {n: average}) %></td>\n            <td><%- Messages.getText(\'Number\', {n: stdev}) %></td>\n        </tr>\n    </thead>\n</table>\n\n<div class="row im-range-controls">\n    <div class="col-sm-4 im-range-from">\n        <input type="text"\n               class="form-control im-range-min input im-range-val"\n               value="<%- min %>">\n    </div>\n    <div class="col-sm-1 im-ellipsis">\n        <span>...</span>\n    </div>\n    <div class="col-sm-4 im-range-to">\n        <input type="text"\n               class="form-control im-range-max input im-range-val"\n               value="<%- max %>">\n    </div>\n    <div class="col-sm-3 im-range-buttons">\n        <div class="btn-group pull-right">\n            <button class="btn btn-primary disabled">Apply</button>\n            <button class="btn btn-cancel disabled">Reset</button>\n        </div>\n    </div>\n</div>\n\n<div class="slider"></div>\n\n',n.list_tag="<%- id %>\n<span class=\"im-remove\" title=\"<%- Messages.getText('lists.RemoveTag') %>\">\n    <%= Icons.icon('Remove') %>\n</span>\n",n.facet_item='<dd>\n    <a href=#>\n        <b class="im-facet-count pull-right">\n            (<%- count %>)\n        </b>\n        <%- item %>\n    </a>\n</dd>\n',n.attribute_value_controls='<div>\n    <input class="form-control im-constraint-value im-value-options im-con-value im-con-value-attr"\n           type="text"\n           placeholder="<%- state.valuePlaceholder %>"\n           value="<%- con.value %>">\n</div>\n',n.table_error="<div class=\"alert alert-error alert-warning\">\n\n  <h2><%= Icons.icon('Bug') %><%- Messages.getText('error.Oops') %></h2>\n\n  <p>\n    <i><%- Messages.getText(error.key || 'error.' + domain + '.Heading') %></i>\n  </p>\n\n  <p><%- Messages.getText('error.' + domain + '.Body') %></p>\n\n  <a class=\"btn btn-primary pull-right\" href=\"mailto:<%= mailto %>\">\n    <%= Icons.icon('Mail') %>\n    <%- Messages.getText('error.EmailHelp') %>\n  </a>\n\n  <button class=\"btn btn-default im-show-query\">\n    <%= Icons.icon('xml') %>\n    <%- Messages.getText('error.ShowQuery') %>\n  </button>\n  <% if (error.message) { %>\n    <button class=\"btn btn-default im-show-error\">\n      <%= Icons.icon('Bug') %>\n      <%- Messages.getText('error.ShowError') %>\n    </button>\n  <% } %>\n\n  <pre class=\"query-xml well im-latent\"><%- indent(query) %></pre>\n\n  <% if (error.message) { %>\n    <pre class=\"error-message well im-latent\"><%- error.message %></pre>\n  <% } %>\n\n</div>\n",n.download_popover='<% /* requires: formats, query, path */ %>\n<ul role="menu" class="im-export-summary">\n    <% _.each(formats, function (icon, param) { %>\n      <li role="presentation">\n        <a role="menuitem"\n            href="<%= query.getExportURI(param) %>&summaryPath=<%= path %>">\n            <%= Icons.icon(icon) %>\n            <%- icon.toUpperCase() %>\n        </a>\n      </li>\n    <% }); %>\n</ul>\n'},{underscore:308}],98:[function(t,e,n){(function(){var e,r,i,o,s;s=t("underscore"),e=t("../options"),r=t("pluralize"),i='<select class="<%- data.classes %>">\n  <% _.each(data.options, function (opt) { %>\n    <option value="<%- data.key(opt) %>"\n      <%- data.selectedTest(opt) ? \'selected\' : void 0 %> >\n      <% if (data.contentHandler) { %>\n        <%- data.contentHandler(opt) %>\n      <% } else { %>\n        <%- opt.text %>\n      <% } %>\n    </option>\n  <% }); %>\n</select>\n',o=s.template(i,{variable:"data"}),n.select=function(t,e,n,r,i){return null==e&&(e=function(){return!1}),null==n&&(n=""),null==r&&(r=null),null==i&&(i=function(t){return null!=t?t.value:void 0}),o({options:t,selectedTest:e,classes:n,contentHandler:r,key:i})},n.pluralise=function(t,e){return null!=t?r(t,e):t},n.numToString=function(t){var n,r,i,o,a,u,l,c,h,p;if(!(null!=t?t.toFixed:void 0))return t;if(c=e.get("NUM_SEPARATOR"),r=e.get("NUM_CHUNK_SIZE"),l=[],a=0,t>-1&&1>t)return String(t);for(p=t.toFixed(3).split("."),h=p[0],i=p[1],n=h.split(""),u=n.length,o=s(n).groupBy(function(t,e){return Math.floor((u-(e+1))/r).toFixed()});o[a];)l.unshift(o[a].join("")),a++;return l.join(c)+("000"===i?"":"."+i)},n.errorAlert=function(t){var e;switch(e=t.level){case"Error":return"alert-danger";case"Warning":return"alert-warning";case"Info":return"alert-info";case"OK":return"alert-success";default:return"alert-danger"}},n.errorIcon=function(t){var e;return e=t.level,null!=e?e:"Error"}}).call(this)},{"../options":93,pluralize:306,underscore:308}],99:[function(t,e,n){(function(){e.exports={interpolate:/\{\{\{ (.+?) \}\}\}/g,escape:/\{\{ (.+?) \}\}/g,evaluate:/\{\{# (.+?) \}\}/g}}).call(this)},{}],100:[function(t,e,n){(function(){var n,r,i,o,s;r=t("../options"),i=t("es6-promise").Promise,s={},o=function(t){var e;return null!=s[e=t.root]?s[e]:s[e]=new n(t)},e.exports=function(t){return o(t).getBranding()},n=function(){function t(t){this.key=t.root.replace(/\./g,"_"),this.promise=t.get("branding").then(function(t){return function(e){return r.set(["brand",t.key],e.properties)}}(this))}return t.prototype.getBranding=function(){return new i(function(t){return function(e){return t.promise.then(function(){return e(r.get(["brand",t.key]))},function(){return e(null)})}}(this))},t}()}).call(this)},{"../options":93,"es6-promise":277}],101:[function(t,e,n){(function(){var n,r,i,o,s,a,u,l=[].indexOf||function(t){for(var e=0,n=this.length;n>e;e++)if(e in this&&this[e]===t)return e;return-1};r=t("./create-columns"),s=t("./is-key-field"),i=t("./get-replaced-test"),n=t("../formatting"),a=function(t){return function(e){return!t.findWhere({formatter:e})}},u=function(t,e){return function(n){var r;return r=t(n),e(r)?r:null}},o=function(t){var e,n,r,i,o;for(o=[],e=r=0,i=t.length;i>r;e=++r)n=t[e],o.push(n.index=e);return o},e.exports=function(t,e){return t.service.fetchClassKeys().then(function(c){var h,p,f,d,m,g,y,v,b,_,w,x,C,T,S,E,N,k,M,P,O,A,R;for(y=s(c),w={},f={},m=u(n.getFormatter,a(e)),p=r(t),C=0,N=p.length;N>C;C++)if(h=p[C],h.path.isAttribute()&&(d=m(h.path)))for(h.isFormatted=!0,h.formatter=d,b=h.path.getParent(),A=null!=(O=d.replaces)?O:[],T=0,k=A.length;k>T;T++)_=A[T],x=""+b+"."+_,null==w[x]&&(w[x]=h),l.call(t.views,x)>=0&&h.replaces.push(t.makePath(x));for(S=0,M=p.length;M>S;S++)for(h=p[S],R=h.replaces,E=0,P=R.length;P>E;E++)_=R[E],f[_]=h;return g=i(w,f),v=function(){var t,e,n,r;for(r=[],e=0,t=p.length;t>e;e++)h=p[e],g(h)||(h.isFormatted&&(n=h.path,l.call(h.replaces,n)<0&&h.replaces.push(h.path),(y(h.path)||h.replaces.length>1)&&(h.path=h.path.getParent())),r.push(h));return r}(),o(v),v})}}).call(this)},{"../formatting":43,"./create-columns":108,"./get-replaced-test":115,"./is-key-field":119}],102:[function(t,e,n){(function(){e.exports=function(t,e){var n,r,i,o,s,a,u,l,c,h,p,f,d,m,g;for(c={},h=0,f=t.length;f>h;h++)if(r=t[h],null!=(null!=(m=r.formatter)?m.replaces:void 0)&&(s=r.model.get("node").toString(),i=r.model.get("column"),a=i.toString(),null!=e&&i.isAttribute()&&r.formatter.replaces.length>1&&(o=e.indexOf(e.get(a)),e.remove(a),u=i.getParent(),n=e.add(u,{at:o}),n.set({replaces:r.formatter.replaces.map(function(t){return u.append(t)})})),!c[a]))for(g=r.formatter.replaces.map(function(t){return s+"."+t}),p=0,d=g.length;d>p;p++)l=g[p],l!==a&&(c[l]=!0,null!=e&&e.remove(l));return c}}).call(this)},{}],103:[function(t,e,n){(function(){var t,n,r,i=[].indexOf||function(t){for(var e=0,n=this.length;n>e;e++)if(e in this&&this[e]===t)return e;return-1};n=function(t,e,n){var r,i,o;if(i=t.getOuterJoin(e),!i||i===n)return null;for(o=t.makePath(i),r=o.isCollection()?i:null,o=o.getParent();o&&!o.isRoot();)!function(e){var i;return null!=e&&(i=t.makePath(e)),(null!=i?i.isCollection():void 0)&&e!==n&&(r=e),o=null!=i?i.getParent():void 0}(t.getOuterJoin(o));return r},r=function(t,e){return n(t,e,null)},e.exports=t=function(t){var e,o,s,a,u,l,c,h,p,f,d,m,g;for(c=[],a={},g=t.views,p=0,d=g.length;d>p;p++)if(h=g[p],!a[h])if(l=r(t,h)){for(e=t.views.filter(function(e){return l===r(t,e)}),s={column:l,view:[]},f=0,m=e.length;m>f;f++)o=e[f],u=n(t,o,l),a[o]=s,u?i.call(s.view,u)>=0||s.view.push(u):s.view.push(o);c.push(a[l]=s)}else c.push(a[h]={column:h});return c}}).call(this)},{}],104:[function(t,e,n){(function(){n.bool=function(t){return!!t}}).call(this)},{}],105:[function(t,e,n){(function(){var n,r,i,o,s,a,u;u=t("underscore"),a=t("../models/object-store"),o=t("../models/nested-table"),n=t("../models/cell"),s=t("../models/null-object"),i=t("../models/fast-path-object"),e.exports=r=function(){function t(t,e){this.itemModels=new a(t.root,e)}return t.prototype.getCreator=function(t){var e;if(!t)throw new Error("No query");return e=function(n){return function(r){var i;return i=t.makePath(r.column),u.has(r,"rows")?n._make_sub_table_model(r,i,e):n._make_simple_cell_model(r,i)}}(this)},t.prototype._make_sub_table_model=function(t,e,n){var r;return new o(u.extend({},t,{node:e,column:e,rows:function(){var e,i,o,s;for(o=t.rows,s=[],e=0,i=o.length;i>e;e++)r=o[e],s.push(r.map(function(t){return n(t)}));return s}()}))},t.prototype._make_simple_cell_model=function(t,e){var r,o,a;return a=e.getParent(),o=e.end.name,r=null!=t.id?this.itemModels.get(t,o):null==t["class"]?new s(a.getType().name,o):new i(t,o),new n({entity:r,node:a,column:e,field:o,value:t.value})},t.prototype.destroy=function(){var t;return null!=(t=this.itemModels)&&t.destroy(),delete this.itemModels,this},t}()}).call(this)},{"../models/cell":67,"../models/fast-path-object":73,"../models/nested-table":78,"../models/null-object":79,"../models/object-store":81,underscore:308}],106:[function(t,e,n){(function(){var e;e=t("underscore"),n.createChild=function(t,n,r){var i,o,s;return null==r&&(r={}),i=(null!=(s=n.prototype.parameters)?s:[]).concat(n.prototype.optionalParameters),o=e.extend(e.pick(t,i),r),new n(o)}}).call(this)},{underscore:308}],107:[function(t,e,n){(function(){var t,e;t={},e=function(t){return""+t.service.root+":"+t.service.token+":"+t.toXML()},n.count=function(n){var r;return null!=t[r=e(n)]?t[r]:t[r]=n.count()},n.clearCache=function(){return t={}}}).call(this)},{}],108:[function(t,e,n){(function(){var n,r,i;r=t("./longest-common-prefix"),i=t("./calculate-row-template"),e.exports=n=function(t){return i(t).map(function(e){var n,i,o,s,a;return null!=e.view?(n=r(e.view),i=t.makePath(n),s=function(){var n,r,i,o;for(i=e.view,o=[],n=0,r=i.length;r>n;n++)a=i[n],o.push(t.makePath(a));return o}(),o=function(){var e,r,i,o;for(i=t.views,o=[],e=0,r=i.length;r>e;e++)a=i[e],0===a.indexOf(n)&&o.push(t.makePath(a));return o}()):(i=t.makePath(e.column),s=null,o=[]),{path:i,subview:s,replaces:o}})}}).call(this)},{"./calculate-row-template":103,"./longest-common-prefix":121}],109:[function(t,e,n){(function(){var n,r;r=t("underscore"),e.exports=n=function(){function t(t){this.definitions=t}return t.prototype.activeClasses=function(){var t,e;e=[];for(t in this.definitions)r.result(this.definitions,t)&&e.push(t);return e},t.prototype.toString=function(){return this.activeClasses().join(" ")},t}()}).call(this)},{underscore:308}],110:[function(t,e,n){(function(){var n,r,i;n=t("./fetch-missing-data"),r=t("./has-fields"),i=function(t,e){return e.then(function(e){return t.set(e)})},e.exports=function(t,e){var o,s;return s=n(t,e),o=r(e),function(t,e){return o(t)||i(t,s(e,t.get("id"))),t.toJSON()}}}).call(this)},{"./fetch-missing-data":112,"./has-fields":117}],111:[function(t,e,n){(function(){var e,r;r=t("underscore"),e=t("backbone"),n.ignore=function(t){return null!=t&&t.preventDefault(),null!=t&&t.stopPropagation(),!1},n.Bus=function(){function t(){}return r.extend(t.prototype,e.Events),t.prototype.destroy=function(){return this.stopListening(),this.off()},t}()}).call(this)},{backbone:262,underscore:308}],112:[function(t,e,n){(function(){var n,r,i,o;o=t("underscore"),n=function(t){return function(e){return e?o.object(o.zip(t,e)):{}}},r=function(t){var e;return o.flatten(function(){var n,r,o;for(o=[],n=0,r=t.length;r>n;n++)e=t[n],~e.indexOf(".")&&o.push(i(e));return o}())},i=function(t){var e,n,r,i,o;for(n=t.split("."),o=[],e=r=1,i=n.length;i>=1?i>r:r>i;e=i>=1?++r:--r)o.push(n.slice(0,e).join("."));return o},e.exports=function(t,e,i){return null==i&&(i={}),function(s,a){var u;return u=s.root+"#"+a,null!=i[u]?i[u]:i[u]=function(){return s.rows({select:e,from:t,where:{id:a},joins:r(e)}).then(o.compose(n(e),o.head))}()}}}).call(this)},{underscore:308}],113:[function(t,e,n){(function(){var t,n=[].indexOf||function(t){for(var e=0,n=this.length;n>e;e++)if(e in this&&this[e]===t)return e;return-1};e.exports=t=function(e,r){var i,o,s,a,u,l;return l=function(){var t;t=[];for(s in e)o=e[s],null!=o&&n.call(r,s)<0&&t.push(o);return t}(),i=function(){var t,e,n;for(n=[],t=0,e=l.length;e>t;t++)u=l[t],null==u.objectId&&n.push(u);return n}(),a=function(){var t,e,n;for(n=[],t=0,e=l.length;e>t;t++)u=l[t],null!=u.objectId&&n.push(u);return n}(),a.reduce(function(e,n){return e.concat(t(n,r))},i)}}).call(this)},{}],114:[function(t,e,n){(function(){var n,r,i,o,s,a,u,l,c,h=[].indexOf||function(t){for(var e=0,n=this.length;n>e;e++)if(e in this&&this[e]===t)return e;return-1};c=t("underscore"),r=t("es6-promise").Promise,u=c.compose(c.uniq,c.flatten),o=function(t){var e;return null!=(null!=(e=t.getType().fields)?e.organism:void 0)},a=function(t){return"Organism"===t.getEndClass().name||o(t)},s=function(t){var e;return"Organism"===t.getEndClass().name&&("name"===(e=t.end.name)||"shortName"===e)},l=function(t){return null!=t&&/\*/.test(t)},n=["=","==","ONE OF"],e.exports=i=function(t){return new r(function(e,r){var i,p,f,d,m,g,y,v,b;return f=c.compose(e,u),y=function(){return e([])},p=function(){var e,r,o,a,u;for(o=t.constraints,u=[],e=0,r=o.length;r>e;e++)i=o[e],a=i.op,h.call(n,a)>=0&&!l(i.value)&&s(t.makePath(i.path))&&u.push(i.value||i.values);return u}(),v=function(){var e,n,r,s;for(r=t.constraints,s=[],e=0,n=r.length;n>e;e++)i=r[e],"LOOKUP"===i.op&&null!=i.extraValue&&o(t.makePath(i.path))&&s.push(i.extraValue);return s}(),d=c.union(p,v),d.length?f(d):(g=function(){var e,n,r,i;for(r=t.getViewNodes(),i=[],e=0,n=r.length;n>e;e++)m=r[e],a(m)&&(b="Organism"===m.getType().name?m:m.append("organism"),i.push(b.append("shortName")));return i}(),g.length?t.clone().select(c.uniq(g,String)).orderBy([]).rows().then(f,y):y())})}}).call(this)},{"es6-promise":277,underscore:308}],115:[function(t,e,n){(function(){var n,r,i;i=t("../formatting").shouldFormat,r=function(t){return t.isAttribute()&&"id"===t.end.name},e.exports=n=function(t,e){return function(n){var o,s;if(null==n)throw new Error("no column");return o=n.path,i(o)||o in e?(s=t[o],r(o)&&null==s&&(s=t[o.getParent()]),s&&null!=s.formatter&&n!==s):!1}}}).call(this)},{"../formatting":43}],116:[function(t,e,n){(function(){var n,r;n=t("es6-promise").Promise,e.exports=r=function(t){return new n(function(e,n){var r,i,o,s,a;return s=t.getViewNodes(),i=t.model,e((r=i.findCommonType(function(){var t,e,n;for(n=[],t=0,e=s.length;e>t;t++)o=s[t],n.push(o.getType());return n}()))?i.getPathInfo(r).getDisplayName():null!=(a=i.name)?a:"")})}}).call(this)},{"es6-promise":277}],117:[function(t,e,n){(function(){e.exports=function(t){return null==t&&(t=[]),function(e){return t.every(function(t){return e.has(t)})}}}).call(this)},{}],118:[function(t,e,n){(function(){var t;e.exports=t=function(t){var e,n,r,i,o,s,a,u,l;for(a=t.split(/></),n=1,e=[],u=0,l=a.length;l>u;u++)s=a[u],/>$/.test(s)||(s+=">"),/^</.test(s)||(s="<"+s),r=/^<\/\w+\s*>/.test(s),i=/\/>$/.test(s)||!r&&/<\/\w+>$/.test(s),o=!(i||r),r&&n--,e.push(new Array(n).join("  ")+s),o&&n++;return e.join("\n")}}).call(this)},{}],119:[function(t,e,n){(function(){var t,n=[].indexOf||function(t){for(var e=0,n=this.length;n>e;e++)if(e in this&&this[e]===t)return e;return-1};e.exports=t=function(t){return function(e){var r,i,o,s,a;return e.isAttribute()?(o=e.getParent().getType().name,r=e.end.name,i=null!=(s=null!=t?t[o]:void 0)?s:[],a=""+o+"."+r,n.call(i,a)>=0):!1}}}).call(this)},{}],120:[function(t,e,n){(function(n){(function(){var r,i,o;r=t("jquery"),o=t("es6-promise").Promise,i=t("../options"),e.exports=function(t,e){return n[e]?o.resolve(n[e]):o.resolve(r.ajax({url:i.get(t),cache:!0,dataType:"script"})).then(function(){return n[e]})}}).call(this)}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../options":93,"es6-promise":277,jquery:305}],121:[function(t,e,n){(function(){var n,r,i,o=[].slice;i=t("underscore"),r=function(t){return function(e){return i.all(t,function(t){return 0===t.indexOf(e)})}},e.exports=n=function(t){var e,n,i,s,a,u,l,c,h;if(e=t[0],u=2<=t.length?o.call(t,1):[],null==e)throw new Error("Empty list");if(!u.length)return e;for(s=e.split(/\./),l=r(u),a=s[0],c=0,h=s.length;h>c;c++)i=s[c],l(n=""+a+"."+i)&&(a=n);return a}}).call(this)},{underscore:308}],122:[function(t,e,n){(function(){n.href=function(t,e,n){var r,i;return r=[["subject",e],["body",n]],i=r.map(function(t){var e,n;return e=t[0],n=t[1],""+e+"="+encodeURIComponent(n)}).join("&"),t+"?"+i}}).call(this)},{}],123:[function(t,e,n){(function(){var t;e.exports=t=function(t){return t.map(function(t){return"change:"+t}).join(" ")}}).call(this)},{}],124:[function(t,e,n){(function(){var t;e.exports=t=function(t,e,n){var r,i,o,s,a;i=document.createElement("form"),i.method="POST",i.style.display="none",i.action=t,i.target=e+(new Date).getTime();for(s in n)o=document.createElement("input"),o.type="hidden",o.name=s,o.value=n[s],i.appendChild(o);r=document.querySelector("body"),r.appendChild(i),a=window.open("somenonexistantpathtonowhere",e),i.submit(),r.removeChild(i),a.close()}}).call(this)},{}],125:[function(t,e,n){(function(){var n,r;r=t("underscore"),n=function(t){var e;return r.object(function(){var n,r,i;for(i=[],n=0,r=t.length;r>n;n++)e=t[n],i.push(e.split("=").map(decodeURIComponent));return i}())},e.exports=function(t){var e,r,i,o,s;return s=t.split("?"),e=s[0],o=s[1],r=o.split("&"),i=n(r),{URL:e,params:i}}}).call(this)},{underscore:308}],126:[function(t,e,n){(function(){var n,r;r=t("underscore"),n=function(t,e){return t.toLowerCase().indexOf(e)>=0},e.exports=function(t){return function(e,i){var o,s,a,u,l;return s=null!=(u=null!=e&&null!=(l=e.toLowerCase())?l.split(" "):void 0)?u:[],o=function(t){var e,i,o;return o=t.path,e=t.item,i=t.name,r.all(s,function(t){return null==o&&(o=e),n(o.toString(),t)||n(i,t)})},i(null!=t.each?t.map(function(t){return t.toJSON()}).filter(o):function(){var e,n,r;for(r=[],e=0,n=t.length;n>e;e++)a=t[e],o(a)&&r.push(a);return r}())}}}).call(this)},{underscore:308}],127:[function(t,e,n){(function(){var n,r,i,o,s;s=t("underscore"),r=t("es6-promise").Promise,n={},o=function(t){return function(e){var n,r,i,o,a,u,l;for(a=s.zip(t,e),l=[],i=0,o=a.length;o>i;i++)u=a[i],r=u[0],n=u[1],l.push({path:r,name:n});return l}},e.exports=i=function(t,e){var i,s,a,u;return i=""+t.service.root+":"+t.root+":"+e,i in n?n[i]:(u=function(){var n,r,i,o;for(i=t.getPossiblePaths(e),o=[],n=0,r=i.length;r>n;n++)a=i[n],o.push(t.makePath(a));return o}(),u=u.filter(function(t){var e;return!("id"===(null!=(e=t.end)?e.name:void 0))}),s=function(){var t,e,n;for(n=[],t=0,e=u.length;e>t;t++)a=u[t],n.push(a.getDisplayName());return n}(),null!=n[i]?n[i]:n[i]=r.all(s).then(o(u)))}}).call(this)},{"es6-promise":277,underscore:308}],128:[function(t,e,n){(function(){var t,n;n=function(){function t(t){this.wrapped=t,this.root=this.wrapped.root,this._foundById={},this._counts={}}return t.prototype.fetchModel=function(){return this.wrapped.fetchModel()},t.prototype.findById=function(t,e,n){var r,i;return null!=(r=this._foundById)[i=""+t+":"+e+":"+n]?r[i]:r[i]=this.wrapped.findById(t,e,n)},t.prototype.count=function(t){var e,n;return null!=(e=this._counts)[n=JSON.stringify(t)]?e[n]:e[n]=this.wrapped.count(t)},t.prototype.destroy=function(){return this._foundById={},this._counts={},delete this.wrapped},t}(),e.exports=t=function(){function t(t,e){this.Preview=e,this.service=new n(t)}return t.prototype.get=function(t){var e,n,r,i;return e=this.Preview,r=this.service,i=t.get("classes"),n=t.get("id"),new e({service:r,model:{types:i,id:n}})},t.prototype.destroy=function(){return this.service.destroy(),delete this.service},t}()}).call(this)},{}],129:[function(t,e,n){(function(){n.fromPairs=function(t){var e;return function(){var n,r,i;for(i=[],n=0,r=t.length;r>n;n++)e=t[n],i.push(e.map(encodeURIComponent).join("="));return i}().join("&")}}).call(this)},{}],130:[function(t,e,n){(function(){var n,r,i,o,s;n=t("jquery"),i=t("es6-promise").Promise,r=t("../options"),s=t("./load-resource"),o=function(){return s("Destination.Dropbox.Library","Dropbox")},e.exports=function(t,e,n){return o().then(function(o){return new i(function(i,s){return o.appKey=r.get("auth.dropbox"),o.save({files:[{url:t,filename:e}],success:i,progress:n,cancel:s,error:s})})})}}).call(this)},{"../options":93,"./load-resource":120,"es6-promise":277,jquery:305}],131:[function(t,e,n){(function(){var n,r,i,o,s,a,u,l,c,h,p;p=t("underscore"),i=t("es6-promise").Promise,r=t("../options"),n=t("../messages"),s=t("./get-organisms"),o=t("./branding"),u=t("./get-result-class"),l=t("./open-window-with-post"),c=t("./parse-url"),e.exports=h=function(t,e,n){var c,h,f,d,m,g;return c=r.get("Destination.Galaxy"),m=null!=(g=c.Current)?g:c.Main,/tool_runner$/.test(m)||(m+="/tool_runner"),h=o(this.query.service),d=u(this.query),f=s(this.query),i.all([d,f,h]).then(a(t,this.query,this.model.format.ext)).then(p.partial(l,m,"Upload"))},a=function(t,e,i){return function(o){var s,a,u,l,h,f,d,m,g,y,v,b,_,w;return l=o[0],v=o[1],a=o[2],w=c(t),s=w.URL,b=w.params,m=function(){var t,n,r,i;for(r=e.constraints,i=[],t=0,n=r.length;n>t;t++)u=r[t],"IN"===u.op&&i.push(u.value);return i}(),f="tsv"===i?"tabular":i,h=window.location.toString().replace(/\?.*$/,""),_=r.get("Destination.Galaxy.Tool"),g=n.getText("export.galaxy.name",{cls:l,orgs:v,branding:a}),d=n.getText("export.galaxy.info",{query:e,lists:m,orgs:v,currentLocation:h}),null!=v&&(y=v.join(", ")),p.extend(b,{tool_id:_,URL:s,name:g,info:d,data_type:f,organism:y,URL_method:"post"})}},h.after=function(){var t;return t=r.get("Destination.Galaxy"),t.Current&&t.Save?this.query.service.whoami().then(function(e){return e.preferences["galaxy-url"]!==t.Current?e.setPreference("galaxy-url",t.Current):void 0}):i.resolve(null)}}).call(this)},{"../messages":46,"../options":93,"./branding":100,"./get-organisms":114,"./get-result-class":116,"./open-window-with-post":124,"./parse-url":125,"es6-promise":277,underscore:308}],132:[function(t,e,n){(function(){var n,r,i,o,s,a;a=t("underscore"),r=t("es6-promise").Promise,n=t("../options"),i=t("./query-string").fromPairs,o=function(t,e){var r,o,s;return r=n.get("Destination.GenomeSpace"),o=[["uploadUrl",t],["fileName",e]],s=i(o),""+r.Upload+"?"+s},s=function(t,e){return new r(function(n,r){var i;return i=window.open(o(t,e)),i.setCallbackOnGSUploadComplete=function(t){return n(t)},i.setCallbackOnGSUploadError=function(t){return console.log("GSERR",arguments),r(new Error("Could not save to "+t))},i.addEventListener("unload",function(){return r(new Error("Upload cancelled"))}),i.focus()})},e.exports=s}).call(this)},{"../options":93,"./query-string":129,"es6-promise":277,underscore:308}],133:[function(t,e,n){(function(){var n,r,i,o,s,a,u,l,c,h,p,f,d,m,g,y,v,b,_,w,x,C,T;n=t("jquery"),C=t("underscore"),m=t("es6-promise").Promise,d=t("../options"),_=t("./load-resource"),T=null,h="Destination.Drive.Library",r="-------314159265358979323846",o="\r\n--"+r+"\r\n",i="\r\n--"+r+"--",b="v2",v="https://www.googleapis.com/auth/drive.file",u="No configuration available for Google Drive",p="Content-Type: application/json\r\n\r\n",l="Content-Type: text/tab-separated-values\r\n\r\n",g='multipart/mixed; boundary="'+r+'"',a="/upload/drive/v2/files",s="POST",y={path:a,method:s,params:{uploadType:"multipart"},headers:{"Content-Type":g}},x=function(){return null!=T?T:T=_(h,"gapi").then(function(t){return new c(t)})},e.exports=w=function(t,e,n){return x().then(function(r){return n(1),r.upload(t,e)})},f=function(){function t(t){this.title=t}return t.prototype.mimetype="text/plain",t.prototype.toString=function(){return JSON.stringify({title:this.title,mimetype:this.mimetype})},t}(),c=function(){function t(t){if(this.gapi=t,!this.gapi)throw new Error("No api");if(!d.get("auth.drive"))throw new Error(u);console.log(this.gapi)}return t.prototype.authorize=function(){return new m(function(t){return function(e,n){var r,i,o,s,a,u;o=t.gapi,u=null,a={client_id:d.get("auth.drive"),scope:v,immediate:!1},s=function(){return o.auth.authorize(a,function(t){return null==t?n(new Error("Not authorized")):t.error?n(new Error(t.error)):e()})},r=function(){return clearTimeout(u),n(new Error("timed out"))},i=function(){var t;return clearTimeout(u),(null!=(t=o.auth)?t.authorize:void 0)?s():u=setTimeout(i,50)},i(),setTimeout(r,5e3)}}(this))},t.prototype.loadClient=function(){return new m(function(t){return function(e,n){return t.gapi.client.load("drive",b,e)}}(this))},t.prototype.makeRequestBody=function(t,e){return o+p+String(t)+o+l+e+i},t.prototype.makeRequest=function(t){return this.gapi.client.request(C.extend({body:t},y))},t.prototype.upload=function(t,e){return this.authorize().then(function(t){return function(){return t.loadClient()}}(this)).then(function(){return m.resolve(n.get(t))}).then(function(t){return function(n){return t.makeRequestBody(new f(e),n)}}(this)).then(function(t){return function(e){return t.makeRequest(e)}}(this)).then(function(t){return t.result.alternateLink})},t}()}).call(this)},{"../options":93,"./load-resource":120,"es6-promise":277,jquery:305,underscore:308}],134:[function(t,e,n){(function(){var n,r,i,o,s,a=[].slice;s=t("underscore"),r=s.compose,i=s.escape,o=t("./ensure-required-data"),n=function(t){return function(){var e,n;return n=arguments[0],e=2<=arguments.length?a.call(arguments,1):[],t.apply(null,e)}},e.exports=function(t,e,i,s){return{classes:s,target:t,replaces:e,call:n(r(i,o(t,e)))}}}).call(this)},{"./ensure-required-data":110,underscore:308}],135:[function(t,e,n){(function(){var t,n;t={ASC:"DESC",DESC:"ASC",NONE:"ASC"},e.exports=n=function(e,n){var r,i,o;return r=null!=(o=e.getSortDirection(n))?o:"NONE",i=t[r],e.orderBy([{path:n,direction:i}])}}).call(this)},{}],136:[function(t,e,n){(function(){var t;e.exports=t=function(t){return null!=t?(t=t.replace(/\n\s*\n/g,"\n\n"),t.replace(/(^\s*|\s*$)/g,"")):void 0}}).call(this)},{}],137:[function(t,e,n){(function(){var n,r,i,o,s,a,u,l,c=function(t,e){return function(){return t.apply(e,arguments)}};l=t("underscore"),i=t("../options"),r=t("../messages"),n=t("../icons"),a=t("../templates/mustache-settings"),s="<span class=\"alert alert-info\">\n  {{{ icons.icon('Info') }}}\n  {{ messages.getText('conbuilder.TooManySuggestions') }}\n  There are {{ extra }} values we could not include.\n</span>\n",u=l.template(s,a),e.exports=o=function(){function t(t,e){var o;this.suggestions=t,this.total=e,this.suggest=c(this.suggest,this),o=i.get("MaxSuggestions"),this.total>o&&(this.tooMany=u({icons:n,messages:r,extra:e-o}))}return t.prototype.tooMany="<span></span>",t.prototype.suggest=function(t,e){var n,r,i,o,s;return null==t||""===t?e(function(){var t,e,n,r;for(n=this.suggestions.slice(0,10),r=[],t=0,e=n.length;e>t;t++)i=n[t],r.push(i);return r}.call(this)):(r=null!=(o=null!=t&&null!=(s=t.toLowerCase())?s.split(" "):void 0)?o:[],n=function(t){var e;return e=t.item,null==e&&(e=""),l.all(r,function(t){return e.toLowerCase().indexOf(t)>=0})},e(function(){var t,e,r,o;for(r=this.suggestions,o=[],t=0,e=r.length;e>t;t++)i=r[t],n(i)&&o.push(i);return o}.call(this)))},t}()}).call(this)},{"../icons":44,"../messages":46,"../options":93,"../templates/mustache-settings":99,underscore:308}],138:[function(t,e,n){(function(){var e,r,i,o,s,a,u=[].indexOf||function(t){for(var e=0,n=this.length;n>e;e++)if(e in this&&this[e]===t)return e;return-1};s=t("es6-promise").Promise,i=t("../options"),o=t("../models/page"),r={},e=s.resolve(!0),n.getCache=function(t){var e,n,i;return n=t.toXML(),e=t.service.root,null!=r[i=e+":"+n]?r[i]:r[i]=new a(t)},n.onListChange=function(t){var e,n;for(n in r)e=r[n],u.call(listNamesFor(e.query),t)>=0&&e.dropRows();return!1},a=function(){function t(t){this.query=t.clone()}return t.prototype.offset=0,t.prototype.rows=null,t.prototype.toString=function(){var t;return(null!=(t=this.rows)?t.length:void 0)?"ResultCache("+this.offset+" .. "+(this.offset+this.rows.length)+")":"ResultCache(EMPTY)"},t.prototype.fetchRows=function(t,e){var n,r;return null==t&&(t=0),null==e&&(e=null),n=new o(t,e),r=this.updateCache(n),r.then(function(t){return function(){return t.getRows(n)}}(this))},t.prototype.updateCache=function(t){var n;return this.contains(t)?e:(n=this.getRequestPage(t),this.query.tableRows({start:n.start,
size:n.size}).then(this.addRowsToCache(n)))},t.prototype.contains=function(t){var e,n;return e=this.rows,(null!=e?e.length:void 0)?(n=this.offset+e.length,!t.all()&&t.start>=this.offset&&t.end()<=n):!1},t.prototype.dropRows=function(){return this.rows=null,this.offset=0},t.prototype.getRequestPage=function(t){var e,n,r,s,a,u,l,c;return e=this.rows,n=i.get("TableResults.CacheFactor"),s=i.get("TableResults.RequestLimit"),u=t.all()?t.size:t.size*n,null==e?new o(t.start,u):(c=this.offset+e.length,l=t.all()||t.start>=this.offset?t.start:Math.max(0,t.start-u),a=new o(l,u),a.isBefore(this.offset)?(r=a.rightGap(this.offset),r+a.size>s?this.dropRows():a.size+=r):a.isAfter(c)&&(r=a.leftGap(c),r+a.size>s?this.dropRows():(a.size+=r,a.start=c)),a)},t.prototype.addRowsToCache=function(t){return function(e){return function(n){var r,i,o;if(r=e.rows,i=e.offset,null!=r){if(o=e.offset+r.length,t.start<i){if(t.end()<i)throw new Error("Cannot add "+t+" to "+e+" - non contiguous");r=t.all()||t.end()>o?n.slice():n.concat(r.slice(t.end()-i))}else{if(t.start>o)throw new Error("Cannot add "+t+" to "+e+" - non contiguous");t.all()||o<t.end()?r=r.slice(0,t.start-i).concat(n):console.error("Useless cache add - we already had these rows: "+t)}i=Math.min(i,t.start)}else r=n.slice(),i=t.start;return e.offset=i,e.rows=r,!0}}(this)},t.prototype.getRows=function(t){var e,n,r;if(r=t.start,n=t.size,null==this.rows)throw new Error("Cache has not been updated");return e=this.rows.slice(),e.splice(0,r-this.offset),null!=n&&n>0&&e.splice(n,e.length),e},t}(),n.ResultCache=a}).call(this)},{"../models/page":84,"../options":93,"es6-promise":277}],139:[function(t,e,n){(function(){var t;e.exports=t=function(t){return t.getDisplayName().then(function(e){return{path:t.toString(),name:e}})}}).call(this)},{}],140:[function(t,e,n){(function(n){(function(){var r,i,o,s,a,u=[].indexOf||function(t){for(var e=0,n=this.length;n>e;e++)if(e in this&&this[e]===t)return e;return-1};o=t("es6-promise").Promise,r=t("../cdn"),i={},s=function(t,e){return u.call(n,e)>=0?o.resolve(n[e]):r.load(t).then(function(){return n[e]},console.error.bind(console))},e.exports=a=function(t,e,n){return(null!=i[t]?i[t]:i[t]=s(t,e)).then(n)}}).call(this)}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../cdn":31,"es6-promise":277}],141:[function(t,e,n){e.exports="2.0.0-beta-42"},{}],142:[function(t,e,n){(function(){var n,r,i,o,s,a,u,l,c,h,p,f,d,m,g,y,v,b,_=[].indexOf||function(t){for(var e=0,n=this.length;n>e;e++)if(e in this&&this[e]===t)return e;return-1},w={}.hasOwnProperty,x=function(t,e){function n(){this.constructor=t}for(var r in e)w.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};v=t("underscore"),n=t("jquery"),p=t("es6-promise").Promise,b=t("imjs"),f=b.Query,c=b.Model,a=t("../core-model"),l=t("../messages"),d=t("../templates"),u=t("../icons"),h=t("../options"),m=t("../core-view"),s=t("./constraint-summary"),i=t("./constraint-editor"),l.setWithPrefix("conbuilder",{Add:"Add constraint",Update:"Update",Cancel:"Cancel",Remove:"Remove",EditCon:"Edit filter",NotEditable:"This constraint is not editable",ValuePlaceholder:"David*",ExtraPlaceholder:"Wernham-Hogg",ExtraLabel:"in",IsA:"is a",NoValue:"No value selected. Please enter a value.",NoOperator:"No operator selected. Please choose an operator.",BadLoop:"The selected path is not in the query.",NaN:"The value provided is not a number.",Duplicate:"This constraint is already on the query",TooManySuggestions:"We cannot show you all the possible values",NoSuitableLists:"No lists of this type are available",NoSuitableLoops:"No suitable loop paths were found"}),g=function(t,e){var n,r,i;return t||e?t&&e?(i=v.sortBy([t,e],function(t){return t.length}),r=i[0],n=i[1],v.all(n,function(t){return _.call(r,t)>=0})):!1:!0},y=function(t,e){var n,r,i,o,s,a,u,l,c;if(!t||!e)return t===e;for(r=v.union.apply(v,[t,e].map(v.keys)),i=!0,u=0,l=r.length;l>u;u++)n=r[u],c=function(){var r,i,o,s;for(o=[t,e],s=[],r=0,i=o.length;i>r;r++)a=o[r],s.push(a[n]);return s}(),o=c[0],s=c[1],i&&(i=v.isArray(o)?g(o,s):o===s);return i},o=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return x(e,t),e.prototype.defaults=function(){return{code:null}},e.prototype.isTypeConstraint=function(){return null==this.get("op")},e}(a),e.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}var n;return x(e,t),e.prototype.Model=o,e.prototype.tagName="div",e.prototype.className="im-constraint row-fluid",e.prototype.parameters=["query","constraint"],e.prototype.optionalParameters=["buttonDelegate"],e.prototype.initialize=function(){var t;e.__super__.initialize.apply(this,arguments),this.model.set(this.constraint),this.state.set({editing:!1}),this.listenTo(this.state,"change:editing",this.toggleEditor),this.listenTo(this.model,"change:type",this.setTypeName),this.listenTo(this.model,"change:path",this.setDisplayName),this.listenTo(l,"change",this.reRender),this.listenTo(this.model,"cancel",this.cancelEditing),this.listenTo(this.model,"apply",this.applyChanges);try{this.model.set({path:this.query.makePath(this.constraint.path)})}catch(n){t=n,this.model.set({error:t}),this.state.set({editing:!0})}return this.setTypeName()},e.prototype.setDisplayName=function(){return this.model.get("path").getDisplayName(function(t){return function(e,n){return t.model.set({error:e,displayName:n}),null!=e?t.listenToOnce(t.query,"change:constraints",function(){return t.model.set({path:t.query.getPathInfo(t.constraint.path)}),t.setDisplayName()}):void 0}}(this))},e.prototype.cancelEditing=function(){return this.state.set({editing:!1}),this.model.set(v.omit(this.constraint,"path")),this.model.set({error:null})},e.prototype.toggleEditing=function(){return this.state.get("editing")?this.cancelEditing():this.state.set({editing:!0})},e.prototype.setTypeName=function(){var t,e;if(e=this.model.get("type"),null==e)return this.model.unset("typeName");try{return this.query.model.makePath(e).getDisplayName(function(t){return function(e,n){return t.model.set({error:e,typeName:n})}}(this))}catch(n){return t=n,this.model.set({error:t,typeName:e})}},e.prototype.events=function(){return{"click .im-edit":"toggleEditing","click .im-remove-constraint":"removeConstraint"}},n=/^\s*$/,e.prototype.getLoopProblem=function(t){var e,n;return n=function(){try{return this.query.getPathInfo(t.value),null}catch(n){return e=n,"BadLoop"}}.call(this)},e.prototype.getValueProblem=function(t){var e,r,i,o;return r=t.path,e=t.op,i=t.value,null==i||n.test(i)?"NoValue":(o=r.getType(),_.call(c.NUMERIC_TYPES,o)>=0&&v.isNaN(1*i)?"NaN":null)},e.prototype.getProblem=function(t){var e,r;return null!=t.type?null:!t.op||n.test(t.op)?"NoOperator":!t.path.isReference()||"="!==(e=t.op)&&"!="!==e?(r=t.op,_.call(f.ATTRIBUTE_VALUE_OPS.concat(f.REFERENCE_OPS),r)>=0?this.getValueProblem(t):this.isDuplicate(t)?"Duplicate":null):this.getLoopProblem(t)},e.prototype.isDuplicate=function(t){return v.any(this.query.constraints,v.partial(y,t))},e.prototype.setError=function(t){var e;return e=l.get("conbuilder."+t),this.model.set({error:e})},e.prototype.applyChanges=function(t){var e,n;return e=this.getProblem(t),null!=e?this.setError(e):(this.state.set({editing:!1}),this.removeConstraint(null,n=!0),null==t.values||t.values.length?(t.path=t.path.toString(),this.query.addConstraint(t),this.constraint=t,this.model.unset("new")):this.query.trigger("change:constraints"))},e.prototype.removeConstraint=function(t,e){return null==e&&(e=!1),null!=t&&t.preventDefault(),null!=t&&t.stopPropagation(),this.model.get("new")||this.query.removeConstraint(this.constraint,e),null!=t?this.remove():void 0},e.prototype.getData=function(){var t,e,n;return n=l,e=u,t=this.model.toJSON(),{icons:e,messages:n,con:t}},e.prototype.template=d.template("active-constraint",{variable:"data"}),e.prototype.toggleEditor=function(){var t;return this.state.get("editing")&&this.rendered?(t={model:this.model,query:this.query,buttonDelegate:this.buttonDelegate},this.renderChild("editor",new i(t),this.$(".im-constraint-editor"))):this.removeChild("editor")},e.prototype.renderSummary=function(){var t;return t={model:this.model},this.renderChild("summary",new s(t),this.$(".im-con-overview"))},e.prototype.postRender=function(){return this.renderSummary(),this.toggleEditor(),this.$("[title]").tooltip()},e}(m)}).call(this)},{"../core-model":32,"../core-view":33,"../icons":44,"../messages":46,"../options":93,"../templates":97,"./constraint-editor":159,"./constraint-summary":160,"es6-promise":277,imjs:286,jquery:305,underscore:308}],143:[function(t,e,n){(function(){var n,r,i,o,s,a,u,l,c,h,p,f,d,m,g,y,v,b,_,w,x,C,T={}.hasOwnProperty,S=function(t,e){function n(){this.constructor=t}for(var r in e)T.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},E=[].indexOf||function(t){for(var e=0,n=this.length;n>e;e++)if(e in this&&this[e]===t)return e;return-1};n=t("jquery"),w=t("underscore"),p=t("es6-promise").Promise,u=t("../messages"),m=t("../templates"),i=t("../core-view"),h=t("../options"),c=t("../core/nested-model"),g=t("../utils/branding"),a=t("../patterns").IS_BLANK,o=t("../mixins/has-typeaheads"),d=t("../utils/suggestion-source"),x=t("imjs"),C=x.Model,s=C.INTEGRAL_TYPES,l=C.NUMERIC_TYPES,f=x.Query,b=m.template("attribute_value_select"),_=function(t){return String(t).replace(/^\s+/,"").replace(/\s+$/,"")},v=function(t){return 1*_(t)},y=t("../templates/helpers").numToString,u.set({"constraintvalue.NoValues":"There are no possible values. This query returns no results","constraintvalue.OneValue":"There is only one possible value: <%- value %>. You might want to remove this constraint"}),e.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return S(e,t),e.include(o),e.prototype.className="im-attribute-value-controls",e.prototype.template=m.template("attribute_value_controls"),e.prototype.getData=function(){return w.extend(this.getBaseData(),{messages:u,con:this.model.toJSON()})},e.prototype.initialize=function(t){var n;return this.query=t.query,e.__super__.initialize.apply(this,arguments),this.sliders=[],this.branding=new c,this.cast=(n=this.model.get("path").getType(),E.call(l,n)>=0?v:_),this.listenTo(u,"change",this.reRender),this.state.set({valuePlaceholder:u.getText("conbuilder.ValuePlaceholder")}),this.listenTo(this.branding,"change:defaults.value",function(){return this.state.set({valuePlaceholder:this.branding.get("defaults.value")})}),null!=this.query?(this.listenTo(this.query,"change:constraints",this.clearCachedData),this.listenTo(this.query,"change:constraints",this.reRender),g(this.query.service).then(function(t){return function(e){return t.branding.set(e)}}(this))):void 0},e.prototype.modelEvents=function(){return{destroy:function(){return this.stopListening()},"change:value":this.onChangeValue,"change:op":this.onChangeOp}},e.prototype.stateEvents=function(){return{"change:valuePlaceholder":this.reRender}},e.prototype.onChangeOp=function(){var t;return t=this.model.get("op"),null!=this.model.get("value")&&E.call(f.MULTIVALUE_OPS,t)>=0&&this.model.set({value:null,values:[this.model.get("value")]}),this.reRender()},e.prototype.onChangeValue=function(){return this.reRender()},e.prototype.removeAllChildren=function(){return this.removeTypeAheads(),this.removeSliders(),e.__super__.removeAllChildren.apply(this,arguments)},e.prototype.removeSliders=function(){var t,e;for(e=[];t=this.sliders.pop();)try{t.slider("destroy"),e.push(t.remove())}catch(n){}return e},e.prototype.events=function(){return{"change .im-con-value-attr":"setAttributeValue"}},e.prototype.updateInput=function(){var t,e;return t=null!=(e=this.lastTypeahead())?e:this.$(".im-con-value-attr"),t.val(this.model.get("value"))},e.prototype.readAttrValue=function(){var t,e,n;e=(null!=(n=this.lastTypeahead())?n:this.$(".im-con-value-attr")).val();try{return null==e||a.test(e)?null:this.cast(e)}catch(r){return t=r,this.model.set({error:new Error(""+e+" might not be a legal value for "+this.path)}),e}},e.prototype.setAttributeValue=function(){return this.model.set({value:this.readAttrValue()})},e.prototype.postRender=function(){return this.provideSuggestions().then(null,function(t){return function(e){return t.model.set({error:e})}}(this)),this.$(".im-con-value-attr").focus()},e.prototype.provideSuggestions=function(){return this.getSuggestions().then(function(t){return function(e){var n,r,i;return i=e.stats,r=e.results,0===i.uniqueValues?(n=u.getText("constraintvalue.NoValues"),t.model.set({error:{message:n,level:"warning"}})):1===i.uniqueValues?(n=u.getText("constraintvalue.OneValue",{value:r[0].item}),t.model.set({error:{message:n,level:"warning"}})):null!=i.max?t.handleNumericSummary(i):null!=r[0].item?t.handleSummary(r,i.uniqueValues):void 0}}(this))},e.prototype.clearCachedData=function(){return delete this.__suggestions,this.model.unset("error")},e.prototype.getSuggestions=function(){return null!=this.__suggestions?this.__suggestions:this.__suggestions=function(t){return function(){var e,n,r,i,o;return t.model.get("path")?(n=t.query.clone(),o=t.model.get("value"),i=String(t.model.get("path")),r=h.get("MaxSuggestions"),n.constraints=function(){var t,r,s,a;for(s=n.constraints,a=[],t=0,r=s.length;r>t;t++)e=s[t],(e.path!==i||e.value!==o)&&a.push(e);return a}(),n.summarise(i,r)):p.reject(new Error("no path"))}}(this)()},e.prototype.replaceInputWithSelect=function(t){var e;return this.model.has("value")?(e=this.model.get("value"),null==e||w.any(t,function(t){var n;return n=t.item,n===e})||t.push({item:e})):this.model.set({value:t[0].item}),this.$el.html(b({Messages:u,items:t,value:e}))},e.prototype.handleSummary=function(t,e){var n,r,i,o,s,a;return("="===(a=this.model.get("op"))||"!="===a)&&t.length<h.get("DropdownMax")?this.replaceInputWithSelect(t):(i=this.$(".im-con-value-attr"),s=new d(t,e),o={minLength:0,highlight:!0},n={name:"summary_suggestions",source:s.suggest,displayKey:"item",templates:{footer:s.tooMany}},this.removeTypeAheads(),r=function(t){return function(e,n){return t.model.set({value:n.item})}}(this),this.activateTypeahead(i,o,n,t[0].item,r,function(t){return function(){return t.setAttributeValue()}}(this)))},e.prototype.clearer='<div class="" style="clear:both;">',e.prototype.getMarkers=function(t,e,n){var r,i,o,s,a,u,l,c;for(s=e-t,o=function(e){var r;return r=e*s+t,n?Math.round(r):r},i=function(t){return Math.round(100*t)},l=[0,.5,1],c=[],a=0,u=l.length;u>a;a++)r=l[a],c.push({percent:i(r),value:y(o(r))});return c},e.prototype.makeSlider=m.template("slider",{variable:"markers"}),e.prototype.handleNumericSummary=function(t){var e,r,i,o,a,u,l,c,h,p,f,d;return h=t.min,c=t.max,r=t.average,p=this.model.get("path"),d=p.getType(),u=E.call(s,d)>=0,f=u?1:c-h/100,i=u?function(t){return parseInt(t,10)}:parseFloat,o=this.$el,a=this.$("input"),o.append(this.clearer),l=this.getMarkers(h,c,u),this.removeSliders(),a.off("change.slider"),e=n(this.makeSlider(l)),e.appendTo(o).slider({min:h,max:c,value:this.model.has("value")?this.model.get("value"):i(r),step:f,slide:function(t,e){return a.val(e.value).change()}}),a.attr({placeholder:i(r)}),o.append(this.clearer),a.on("change.slider",function(t){return e.slider("value",i(a.val()))}),this.sliders.push(e)},e.prototype.remove=function(){return e.__super__.remove.apply(this,arguments),this.removeTypeAheads()},e}(i)}).call(this)},{"../core-view":33,"../core/nested-model":38,"../messages":46,"../mixins/has-typeaheads":62,"../options":93,"../patterns":94,"../templates":97,"../templates/helpers":98,"../utils/branding":100,"../utils/suggestion-source":137,"es6-promise":277,imjs:286,jquery:305,underscore:308}],144:[function(t,e,n){(function(){var n,r,i,o,s,a,u,l={}.hasOwnProperty,c=function(t,e){function n(){this.constructor=t}for(var r in e)l.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};u=t("underscore"),r=t("../messages"),o=t("../core-view"),i=t("../options"),a=t("../templates/mustache-settings"),s="<button class=\"btn btn-default im-true {{ (value === true) ? ' active' : void 0 }}\">\n  True\n</button>\n<button class=\"btn btn-default im-false {{ (value === false) ? ' active' : void 0 }}\">\n  False\n</button>\n",e.exports=n=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return c(e,t),e.prototype.className="im-value-options btn-group",e.prototype.modelEvents=function(){return{change:this.reRender}},e.prototype.getData=function(){return u.extend({value:null},e.__super__.getData.apply(this,arguments))},e.prototype.template=u.template(s,a),e.prototype.events=function(){return{"click .im-true":"setValueTrue","click .im-false":"setValueFalse"}},e.prototype.setValueTrue=function(){return this.model.set({value:!0})},e.prototype.setValueFalse=function(){return this.model.set({value:!1})},e}(o)}).call(this)},{"../core-view":33,"../messages":46,"../options":93,"../templates/mustache-settings":99,underscore:308}],145:[function(t,e,n){(function(){var n,r,i,o,s,a,u,l,c,h={}.hasOwnProperty,p=function(t,e){function n(){this.constructor=t}for(var r in e)h.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};c=t("underscore"),i=t("../core-view"),a=t("../messages"),u=t("../options"),l=t("../templates"),r=t("../models/code-gen"),o=t("./code-gen-dialogue"),t("../messages/code-gen"),s=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return p(e,t),e.prototype.modelEvents=function(){return{"change:lang":this.reRender}},e.prototype.template=l.template("code-gen-button-main"),e}(i),e.exports=n=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return p(e,t),e.prototype.parameters=["query","tableState"],e.prototype.Model=r,e.prototype.template=l.template("code-gen-button"),e.prototype.getData=function(){return c.extend(e.__super__.getData.apply(this,arguments),{options:u.get("CodeGen")})},e.prototype.renderChildren=function(){return this.renderChildAt(".im-show-code-gen-dialogue",new s({model:this.model}))},e.prototype.events=function(){return{"click .dropdown-menu.im-code-gen-langs li":"chooseLang","click .im-show-code-gen-dialogue":"showDialogue"}},e.prototype.chooseLang=function(t){var e;return e=this.$(t.target).closest("li").data("lang"),this.model.set({lang:e}),this.showDialogue()},e.prototype.showDialogue=function(){var t,e;return e=this.tableState.pick("start","size"),t=new o({query:this.query,model:this.model,page:e}),this.renderChild("dialogue",t),t.show()},e}(i)}).call(this)},{"../core-view":33,"../messages":46,"../messages/code-gen":48,"../models/code-gen":68,"../options":93,"../templates":97,"./code-gen-dialogue":146,underscore:308}],146:[function(t,e,n){(function(n){(function(){var r,i,o,s,a,u,l,c,h,p,f,d,m,g,y,v,b,_,w,x,C,T,S,E,N=[].indexOf||function(t){for(var e=0,n=this.length;n>e;e++)if(e in this&&this[e]===t)return e;return-1},k={}.hasOwnProperty,M=function(t,e){function n(){this.constructor=t}for(var r in e)k.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};E=t("underscore"),m=t("es6-promise").Promise,p=t("./modal"),h=t("../messages"),d=t("../options"),g=t("../templates"),a=t("../models/code-gen"),o=t("../core/checkbox"),t("../messages/code-gen"),_=t("../utils/indent-xml"),x=t("../utils/strip-extra-whitespace"),S=t("../utils/with-cdn-resource"),f=/\s*#.*$/gm,i=/\/\*(\*(?!\/)|[^*])*\*\//gm,y="application/xml;charset=utf8",l="text/javascript;charset=utf8",u="text/html;charset=utf8",r={level:"Info",key:"codegen.CannotExportXML"},c={js:l,xml:y,html:u},T=E.partial(S,"prettify","prettyPrintOne"),C=E.partial(S,"filesaver","saveAs"),v=m.reject("Requirements not met"),w=function(t){var e,n;return E.object(function(){var r;r=[];for(e in t)n=t[e],n&&0!==n.length&&r.push([e,n]);return r}())},b=function(){var t;return t=!1,N.call(n,t)>=0?v:C(E.identity)},e.exports=s=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return M(e,t),e.prototype.Model=a,e.prototype.parameters=["query"],e.prototype.optionalParameters=["page"],e.prototype.page={start:0,size:d.get("DefaultPageSize")},e.prototype.initialize=function(){return e.__super__.initialize.apply(this,arguments),this.generateCode(),this.setExportLink()},e.prototype.modalSize=function(){return"lg"},e.prototype.title=function(){return h.getText("codegen.DialogueTitle",{query:this.query,lang:this.model.get("lang")})},e.prototype.primaryIcon=function(){return"Download"},e.prototype.primaryAction=function(){return h.getText("codegen.PrimaryAction")},e.prototype.body=g.template("code_gen_body"),e.prototype.invariants=function(){return{hasQuery:"No query"}},e.prototype.hasQuery=function(){return null!=this.query},e.prototype.modelEvents=function(){return{change:this.onChangeLang,"change:showBoilerPlate":this.reRenderBody,"change:highlightSyntax":this.reRenderBody}},e.prototype.stateEvents=function(){return{"change:generatedCode":this.reRenderBody}},e.prototype.events=function(){return E.extend(e.__super__.events.apply(this,arguments),{"click .dropdown-menu.im-code-gen-langs li":"chooseLang"})},e.prototype.getBoilerPlateRegex=function(){if(!this.model.get("showBoilerPlate"))switch(this.model.get("lang")){case"pl":case"py":case"rb":return f;case"java":case"js":return i;default:return null}},e.prototype.act=function(){var t,e,n,r;return n=this.model.get("lang"),"js"===n&&this.model.get("extrajs")&&(n="html"),t=new Blob([this.state.get("generatedCode")],{type:c[n]}),e=""+(null!=(r=this.query.name)?r:"name")+"."+n,C(function(n){return function(n){return n(t,e)}}(this))},e.prototype.onChangeLang=function(){var t;return t=this.model.get("lang"),this.$(".im-current-lang").text(h.getText("codegen.Lang",{lang:t})),this.$(".modal-title").text(this.title()),"js"===t||"xml"===t?b().then(function(t){return function(){return t.state.unset("error")}}(this)).then(null,function(t){return function(){return t.state.set({error:r})}}(this)):this.state.unset("error"),this.generateCode(),this.setExportLink()},e.prototype.generateCode=function(){var t;switch(t=this.model.get("lang")){case"xml":return this.state.set({generatedCode:this.generateXML()});case"js":return this.state.set({generatedCode:this.generateJS()});default:return this.getCodeFromCache(t)}},e.prototype.getCodeFromCache=function(t){var e,n;return null==this.cache&&(this.cache={}),null!=(null!=(n=this.cache)?n[t]:void 0)?this.state.set({generatedCode:this.cache[t]}):(e={query:this.query.toXML(),lang:t,date:Date.now()},this.query.service.post("query/code?cachebuster="+Date.now(),e).then(function(e){return function(n){return e.cache[t]=n.code,e.state.set({generatedCode:n.code})}}(this)))},e.prototype.generateXML=function(){return _(this.query.toXML())},e.prototype.generateJS=function(){var t,e,n,r;return r=g.template("code-gen-js"),n=w(this.query.toJSON()),t=d.get("CDN.server")+d.get(["CDN","imtables"]),e={service:this.query.service,query:n,page:this.page,asHTML:this.model.get("extrajs"),imtablesJS:t+"imtables.js",imtablesCSS:t+"main.sandboxed.css"},r(e)},e.prototype.setExportLink=function(){var t;switch(t=this.model.get("lang")){case"xml":case"js":return this.state.set({exportLink:null});default:return this.state.set({exportLink:this.query.getCodeURI(t)})}},e.prototype.reRenderBody=function(){return this.rendered?(this.$(".modal-body").html(this.body(this.getData())),this.trigger("rendered",this.rendered)):void 0},e.prototype.postRender=function(){return e.__super__.postRender.apply(this,arguments),this.addCheckboxes(),this.highlightCode(),this.setMaxHeight()},e.prototype.setMaxHeight=function(){var t;return t=Math.max(250,this.$el.closest(".modal").height()-200),this.$(".im-generated-code").css({"max-height":t})},e.prototype.addCheckboxes=function(){var t;return this.renderChildAt(".im-show-boilerplate",new o({model:this.model,attr:"showBoilerPlate",label:"codegen.ShowBoilerPlate"})),this.renderChildAt(".im-highlight-syntax",new o({model:this.model,attr:"highlightSyntax",label:"codegen.HighlightSyntax"})),(t=d.get(["CodeGen","Extra",this.model.get("lang")]))?this.renderChildAt(".im-extra-options",new o({model:this.model,attr:"extra"+this.model.get("lang"),label:t})):void 0},e.prototype.highlightCode=function(){var t,e,n;if(this.model.get("highlightSyntax")){if(e=this.model.get("lang"),n=this.$(".im-generated-code"),t=this.getCode(),null==t)return;return T(function(e){return n.html(e(E.escape(t)))})}},e.prototype.getData=function(){return E.extend(e.__super__.getData.apply(this,arguments),{options:d.get("CodeGen"),generatedCode:this.getCode()})},e.prototype.getCode=function(){var t,e;return t=this.state.get("generatedCode"),e=this.getBoilerPlateRegex(),e?x(null!=t?t.replace(e,""):void 0):t},e.prototype.toggleShowBoilerPlate=function(){return this.model.toggle("showBoilerPlate")},e.prototype.toggleHighlightSyntax=function(){return this.model.toggle("highlightSyntax")},e.prototype.chooseLang=function(t){var e;return t.stopPropagation(),e=this.$(t.target).closest("li").data("lang"),this.model.set({lang:e})},e}(p)}).call(this)}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../core/checkbox":34,"../messages":46,"../messages/code-gen":48,"../models/code-gen":68,"../options":93,"../templates":97,"../utils/indent-xml":118,"../utils/strip-extra-whitespace":136,"../utils/with-cdn-resource":140,"./modal":227,"es6-promise":277,underscore:308}],147:[function(t,e,n){(function(){var n,r,i,o,s,a,u,l,c,h,p,f,d,m,g,y=function(t,e){return function(){return t.apply(e,arguments)}},v={}.hasOwnProperty,b=function(t,e){function n(){this.constructor=t}for(var r in e)v.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};g=t("underscore"),u=t("./modal"),m=t("../templates"),a=t("../messages"),r=t("../core/collection"),h=t("../models/path"),o=t("./column-manager/tabs"),f=t("./column-manager/select-list"),d=t("./column-manager/sort-order"),n=t("../models/available-columns"),c=t("../models/order-element"),t("../messages/columns"),s=function(t){function e(){this.model=y(this.model,this),e.__super__.constructor.apply(this,arguments),this.listenTo(this,"change:index",function(){return g.defer(function(t){return function(){return t.sort()}}(this))})}return b(e,t),e.prototype.comparator="index",e.prototype.add=function(){return e.__super__.add.apply(this,arguments)},e.prototype.modelFactory=r.prototype.model,e.prototype.model=function(t){var e,n;return e=this.size(),n=new this.modelFactory(t),n.collection=this,n.set({index:e}),n},e}(r),p=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return b(e,t),e.prototype.modelFactory=h,e}(s),l=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return b(e,t),e.prototype.modelFactory=c,e}(s),e.exports=i=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return b(e,t),e.prototype.parameters=["query"],e.prototype.modalSize=function(){return"lg"},e.prototype.className=function(){return e.__super__.className.apply(this,arguments)+" im-column-manager"},e.prototype.title=function(){return a.getText("columns.DialogueTitle")},e.prototype.primaryAction=function(){return a.getText("columns.ApplyChanges")},e.prototype.dismissAction=function(){return a.getText("Cancel")},e.prototype.act=function(){var t,e,n,r;return this.state.get("disabled")?void 0:(r=this.state.pick("viewChanged","orderChanged"),n=r.viewChanged,e=r.orderChanged,n&&!e?this.query.select(this.getCurrentView()):e&&!n?this.query.orderBy(this.getCurrentSortOrder()):(t={silent:!0,events:[]},this.query.select(this.getCurrentView(),t),this.query.orderBy(this.getCurrentSortOrder(),t),this.query.trigger(t.events.join(" "))),this.resolve("changed"))},e.prototype.stateEvents=function(){return{"change:currentTab":this.renderTabContent,"change:adding":this.setDisabled}},e.prototype.initialize=function(){var t,r,i,o,s,a,u,c,h,f,d,m,g;for(e.__super__.initialize.apply(this,arguments),this.selectList=new p,this.rubbishBin=new p,this.sortOrder=new l,this.availableColumns=new n,f=this.query.views,o=0,u=f.length;u>o;o++)i=f[o],this.selectList.add(this.query.makePath(i));for(d=this.query.sortOrder,s=0,c=d.length;c>s;s++)m=d[s],r=m.path,t=m.direction,this.sortOrder.add({direction:t,path:this.query.makePath(r)});for(g=this.getRelevantPaths(),a=0,h=g.length;h>a;a++)r=g[a],this.sortOrder.get(r.toString())||this.availableColumns.add(r,{sort:!1});return this.availableColumns.sort(),this.listenTo(this.selectList,"sort add remove",this.setDisabled),this.listenTo(this.sortOrder,"sort add remove",this.setDisabled)},e.prototype.getRelevantPaths=function(){return g.chain(this.query.getQueryNodes()).filter(function(t){return function(e){return!t.query.isOuterJoined(e)}}(this)).map(function(t){var e,n,r,i,o;for(i=t.getChildNodes(),o=[],n=0,r=i.length;r>n;n++)e=i[n],e.isAttribute()&&"id"!==e.end.name&&o.push(e);return o}).flatten().value()},e.prototype.getCurrentView=function(){return this.selectList.pluck("path")},e.prototype.getCurrentSortOrder=function(){return this.sortOrder.map(function(t){return t.asOrderElement()})},e.prototype.setDisabled=function(){var t,e,n,r,i,o;return this.state.get("adding")?this.state.set({disabled:!0}):(e=this.getCurrentView().join(" "),r=this.query.views.join(" "),t=this.sortOrder.map(function(t){return t.toOrderString()}).join(" "),n=this.query.getSorting(),o=e===r,i=t===n,this.state.set({viewChanged:!o,orderChanged:!i,disabled:o&&i}))},e.prototype.initState=function(){return this.state.set({disabledReason:"columns.NoChangesToApply",disabled:!0,currentTab:o.TABS[0]})},e.prototype.renderTabs=function(){return this.renderChild("tabs",new o({state:this.state}),this.$(".modal-body"))},e.prototype.renderTabContent=function(){var t;return this.rendered?(t=function(){switch(this.state.get("currentTab")){case"view":return new f({state:this.state,query:this.query,rubbishBin:this.rubbishBin,collection:this.selectList});case"sortorder":return new d({query:this.query,availableColumns:this.availableColumns,collection:this.sortOrder});default:throw new Error("Cannot render "+this.state.get("currentTab"))}}.call(this),this.renderChild("main",t,this.$(".modal-body"))):void 0},e.prototype.postRender=function(){return e.__super__.postRender.apply(this,arguments),this.renderTabs(),this.renderTabContent()},e.prototype.remove=function(){return this.selectList.close(),this.rubbishBin.close(),this.sortOrder.close(),this.availableColumns.close(),e.__super__.remove.apply(this,arguments)},e}(u)}).call(this)},{"../core/collection":35,"../messages":46,"../messages/columns":49,"../models/available-columns":66,"../models/order-element":83,"../models/path":86,"../templates":97,"./column-manager/select-list":152,"./column-manager/sort-order":154,"./column-manager/tabs":155,"./modal":227,underscore:308}],148:[function(t,e,n){(function(){var n,r,i,o,s={}.hasOwnProperty,a=function(t,e){function n(){this.constructor=t}for(var r in e)s.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};o=t("underscore"),i=t("./unselected-column"),r=900,e.exports=n=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return a(e,t),e.prototype.parameters=["findActives"],e.prototype.restoreTitle="columns.AddColumnToSortOrder",e.prototype.events=function(){return o.extend(e.__super__.events.apply(this,arguments),{mousedown:"onMouseDown",dragstart:"onDragStart",dragstop:"onDragStop"})},e.prototype.onMouseDown=function(){return this.fixAppendTo()},e.prototype.fixAppendTo=function(){var t,e;return this.$el.draggable("option","appendTo",this.$el.closest(".well")),t=this.$el.closest(".modal").width(),e=t>=r,this.$el.draggable("option","axis",e?null:"y")},e.prototype.onDragStart=function(){return this.state.set({dragged:this.model.get("path")}),this.$el.addClass("ui-dragging")},e.prototype.onDragStop=function(){return this.state.unset("dragged"),
this.$el.removeClass("ui-dragging")},e.prototype.postRender=function(){var t,e,n;return e=this.$el.closest(".modal").width(),n=e>=r,t=this.model.collection.indexOf(this.model),this.$el.draggable({axis:n?null:"y",connectToSortable:this.findActives(),helper:"clone",revert:"invalid",opacity:.8,cancel:"i,a,button",zIndex:1e3}),this.$("[title]").tooltip({placement:0===t?"bottom":"top"})},e}(i)}).call(this)},{"./unselected-column":156,underscore:308}],149:[function(t,e,n){(function(){var n,r,i,o={}.hasOwnProperty,s=function(t,e){function n(){this.constructor=t}for(var r in e)o.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};i=t("../query-dialogue-button"),n=t("../column-manager"),t("../../messages/columns"),e.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return s(e,t),e.prototype.className="im-column-manager-button",e.prototype.longLabel="columns.ManageColumns",e.prototype.shortLabel="columns.ManageColumnsShort",e.prototype.icon="Columns",e.prototype.Dialogue=n,e}(i)}).call(this)},{"../../messages/columns":49,"../column-manager":147,"../query-dialogue-button":236}],150:[function(t,e,n){(function(){var n,r,i,o,s,a,u={}.hasOwnProperty,l=function(t,e){function n(){this.constructor=t}for(var r in e)u.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};a=t("underscore"),r=t("./selected-column"),o=t("../../templates"),i=["column-manager-position-controls","column-manager-order-direction","column-manager-path-name","column-manager-path-remover"],s=function(t){return"ASC"===t?"DESC":"ASC"},e.exports=n=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return l(e,t),e.prototype.removeTitle="columns.RemoveOrderElement",e.prototype.template=o.templateFromParts(i),e.prototype.modelEvents=function(){return a.extend(e.__super__.modelEvents.apply(this,arguments),{"change:direction":this.reRender})},e.prototype.events=function(){return a.extend(e.__super__.events.apply(this,arguments),{"click .im-change-direction":"changeDirection"})},e.prototype.changeDirection=function(){return this.model.swap("direction",s)},e}(r)}).call(this)},{"../../templates":97,"./selected-column":153,underscore:308}],151:[function(t,e,n){(function(){var n,r,i,o,s,a,u,l,c={}.hasOwnProperty,h=function(t,e){function n(){this.constructor=t}for(var r in e)c.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};i=t("../../core-view"),l=t("../../templates"),s=t("../../options"),u=t("../../models/path-set"),o=t("../../models/open-nodes"),a=t("../path-chooser"),n=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return h(e,t),e.prototype.parameters=["collection","selectList"],e.prototype.template=l.template("column-manager-path-chooser-buttons"),e.prototype.collectionEvents=function(){return{"add remove reset":"reRender"}},e.prototype.events=function(){return{"click .im-add-column":"addColumn","click .im-rearrange-columns":"cancel"}},e.prototype.cancel=function(){return this.trigger("done")},e.prototype.addColumn=function(){var t,e;return e=this.selectList,t=this.collection.paths(),this.cancel(),e.add(t)},e}(i),e.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return h(e,t),e.prototype.parameters=["query","collection"],e.prototype.template=l.template("column-manager-path-chooser"),e.prototype.initialize=function(){var t;return e.__super__.initialize.apply(this,arguments),this.chosenPaths=new u,this.view=new u(function(){var e,n,r,i;for(r=this.collection.pluck("path"),i=[],e=0,n=r.length;n>e;e++)t=r[e],i.push(this.query.makePath(t));return i}.call(this)),this.openNodes=new o(this.query.getViewNodes())},e.prototype.initState=function(){return this.query.makePath(this.query.root).getDisplayName().then(function(t){return function(e){return t.state.set({rootName:e})}}(this))},e.prototype.stateEvents=function(){return{"change:rootName":"reRender"}},e.prototype.postRender=function(){return this.renderButtons(),this.openPathChooser()},e.prototype.renderButtons=function(){var t;return t=new n({state:this.state,collection:this.chosenPaths,selectList:this.collection}),this.listenTo(t,"done",function(t){return function(){return t.trigger("done")}}(this)),this.renderChildAt(".btn-group",t)},e.prototype.openPathChooser=function(){var t,e;return t={dontSelectView:!0,multiSelect:s.get("ColumnManager.SelectColumn.Multi")},e=new a({model:t,query:this.query,chosenPaths:this.chosenPaths,openNodes:this.openNodes,view:this.view,trail:[]}),this.renderChild("pathChooser",e),this.setPathChooserHeight()},e.prototype.setPathChooserHeight=function(){return this.$(".im-path-chooser").css({"max-height":this.$el.closest(".modal").height()-350})},e.prototype.remove=function(){return this.chosenPaths.close(),this.view.close(),this.openNodes.close(),e.__super__.remove.apply(this,arguments)},e}(i)}).call(this)},{"../../core-view":33,"../../models/open-nodes":82,"../../models/path-set":85,"../../options":93,"../../templates":97,"../path-chooser":231}],152:[function(t,e,n){(function(){var n,r,i,o,s,a,u,l,c,h,p,f,d={}.hasOwnProperty,m=function(t,e){function n(){this.constructor=t}for(var r in e)d.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};f=t("underscore"),i=t("../../core-view"),u=t("../../templates"),n=t("../../core/collection"),o=t("../../mixins/handles-dom-resort"),a=t("./selected-column"),l=t("./unselected-column"),r=t("./path-chooser"),h=function(t){return"path_"+t.get("id")},c=function(t){return"expath_"+t.get("id")},p=function(t){return t+1},e.exports=s=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return m(e,t),e.include(o),e.prototype.parameters=["query","collection","rubbishBin"],e.prototype.className="im-select-list-editor",e.prototype.template=u.template("column-manager-select-list"),e.prototype.getData=function(){return f.extend(e.__super__.getData.apply(this,arguments),{hasRubbish:this.rubbishBin.size()})},e.prototype.initialize=function(){return e.__super__.initialize.apply(this,arguments),this.listenTo(this.rubbishBin,"remove",this.restoreView)},e.prototype.initState=function(){return this.state.set({adding:!1})},e.prototype.collectionEvents=function(){return{remove:"moveToBin","add remove":"reRender"}},e.prototype.events=function(){return{"drop .im-rubbish-bin":"onDragToBin","sortupdate .im-active-view":"onOrderChanged","click .im-add-view-path":"setAddingTrue"}},e.prototype.stateEvents=function(){return{"change:adding":"onChangeMode"}},e.prototype.setAddingTrue=function(){return this.state.set({adding:!0})},e.prototype.onDragToBin=function(t,e){return e.draggable.trigger("binned")},e.prototype.moveToBin=function(t){return this.rubbishBin.add(this.query.makePath(t.get("path"))),this.reIndexFrom(t.get("index"))},e.prototype.reIndexFrom=function(t){var e,n,r,i,o;for(o=[],e=n=t,r=this.collection.size();r>=t?r>=n:n>=r;e=r>=t?++n:--n)o.push(null!=(i=this.collection.at(e))?i.set({index:e}):void 0);return o},e.prototype.restoreView=function(t){return this.collection.add(this.query.makePath(t.get("path")))},e.prototype.onChangeMode=function(){return this.rendered?this.state.get("adding")?(this.$(".im-removal-and-rearrangement").hide(),this.$(".im-addition").show(),this.renderPathChooser()):(this.$(".im-removal-and-rearrangement").show(),this.$(".im-addition").hide(),this.removeChild("columnChooser")):void 0},e.prototype.renderPathChooser=function(){var t;return t=new r({query:this.query,collection:this.collection}),this.listenTo(t,"done",function(t){return function(){return t.state.set({adding:!1})}}(this)),this.renderChild("columnChooser",t,this.$(".im-addition"))},e.prototype.onOrderChanged=function(t,e){return null!=e.sender?this.restoreFromBin(e.item):this.onDOMResort()},e.prototype.getInsertPoint=function(t){var e,n,r;return e=t.prev(),n=this.children,r=this.collection.find(function(t){var r;return r=n[h(t)],r.el===e[0]}),null==r?0:r.get("index")+1},e.prototype.getRestoredModel=function(t){return this.rubbishBin.find(function(e){return function(n){var r;return r=e.children[c(n)],(null!=r?r.el:void 0)===t[0]}}(this))},e.prototype.restoreFromBin=function(t){var e,n,r,i,o,s,a,u,l,c;if(i=this.children,s=this.collection.size(),n=this.getInsertPoint(t),u=this.getRestoredModel(t),null==u)return void console.error("could not find model for:",t);if(u.destroy(),n!==s){for(a=function(){var t,e;for(e=[],r=t=n;s>=n?s>t:t>s;r=s>=n?++t:--t)e.push(this.collection.at(r));return e}.call(this),e=this.collection.last(),l=0,c=a.length;c>l;l++)o=a[l],o.swap("index",p);return e.set({index:n}),i[h(e)].$el.insertBefore(i[h(a[0])].el)}},e.prototype.onDOMResort=function(){return this.setChildIndices(h)},e.prototype.postRender=function(){var t,e,n,r,i;return e=this.$(".im-active-view"),t=this.$(".im-removed-view"),n=900,r=this.$el.closest(".modal").width(),i=r>=n,this.collection.each(function(t){return function(e){return e.collection=t.collection}}(this)),this.rubbishBin.each(function(t){return function(e){return e.collection=t.rubbishBin}}(this)),this.collection.each(function(t){return function(n){return t.renderChild(h(n),new a({model:n}),e)}}(this)),this.rubbishBin.each(function(e){return function(n){return e.renderChild(c(n),new l({model:n}),t)}}(this)),e.sortable({placeholder:"im-view-list-placeholder",opacity:.6,cancel:"i,a,button",axis:i?null:"y",appendTo:this.el}),this.$(".im-removed-view").sortable({placeholder:"im-view-list-placeholder",connectWith:e,opacity:.6,cancel:"i,a,button",axis:i?null:"y",appendTo:this.el}),this.$(".im-rubbish-bin").droppable({accept:".im-selected-column",activeClass:"im-can-remove-column",hoverClass:"im-will-remove-column"}),this.onChangeMode()},e.prototype.removeAllChildren=function(){return this.rendered&&(this.$(".im-active-view").sortable("destroy"),this.$(".im-removed-view").sortable("destroy"),this.$(".im-rubbish-bin").droppable("destroy")),e.__super__.removeAllChildren.apply(this,arguments)},e}(i)}).call(this)},{"../../core-view":33,"../../core/collection":35,"../../mixins/handles-dom-resort":61,"../../templates":97,"./path-chooser":151,"./selected-column":153,"./unselected-column":156,underscore:308}],153:[function(t,e,n){(function(){var n,r,i,o,s,a,u,l,c,h,p={}.hasOwnProperty,f=function(t,e){function n(){this.constructor=t}for(var r in e)p.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};h=t("underscore"),r=t("../../core-view"),n=t("../../core/collection"),a=t("../../templates"),i=t("../../models/path"),l=t("../../utils/events").ignore,u=function(t){return t-1},c=function(t){return t+1},s=["column-manager-path-remover","column-manager-position-controls","column-manager-path-name"],e.exports=o=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return f(e,t),e.prototype.Model=i,e.prototype.tagName="li",e.prototype.className="list-group-item im-selected-column",e.prototype.template=a.templateFromParts(s),e.prototype.removeTitle="columns.RemoveColumn",e.prototype.getData=function(){var t;return t=this.model===this.model.collection.last(),h.extend(e.__super__.getData.apply(this,arguments),{removeTitle:this.removeTitle,isLast:t,parts:this.parts.pluck("part")})},e.prototype.initialize=function(){return e.__super__.initialize.apply(this,arguments),this.parts=new n,this.listenTo(this.parts,"add remove reset",this.reRender),this.resetParts(),this.listenTo(this.model.collection,"sort",this.onCollectionSorted)},e.prototype.modelEvents=function(){return{destroy:this.stopListeningTo,"change:parts":this.resetParts}},e.prototype.stateEvents=function(){return{"change:fullPath":this.setFullPathClass}},e.prototype.onCollectionSorted=function(){return this.reRender()},e.prototype.resetParts=function(){var t,e;return this.parts.reset(function(){var n,r,i,o;for(i=this.model.get("parts"),o=[],t=n=0,r=i.length;r>n;t=++n)e=i[t],o.push({part:e,id:t});return o}.call(this))},e.prototype.postRender=function(){return this.$("[title]").tooltip({container:this.$el})},e.prototype.events=function(){return{"click .im-remove-view":"removeView","click .im-move-up":"moveUp","click .im-move-down":"moveDown",click:"toggleFullPath",binned:"removeView"}},e.prototype.toggleFullPath=function(){return this.state.toggle("fullPath")},e.prototype.moveDown=function(t){var e;return l(t),e=this.model.collection.at(c(this.model.get("index"))),e.swap("index",u),this.model.swap("index",c),this.$el.insertAfter(this.$el.next())},e.prototype.moveUp=function(t){var e;return l(t),e=this.model.collection.at(u(this.model.get("index"))),e.swap("index",c),this.model.swap("index",u),this.$el.insertBefore(this.$el.prev())},e.prototype.setFullPathClass=function(){return this.$el.toggleClass("im-full-path",this.state.get("fullPath"))},e.prototype.removeView=function(t){return l(t),this.model.collection.remove(this.model),this.model.destroy()},e}(r)}).call(this)},{"../../core-view":33,"../../core/collection":35,"../../models/path":86,"../../templates":97,"../../utils/events":111,underscore:308}],154:[function(t,e,n){(function(n){(function(){var r,i,o,s,a,u,l,c,h,p,f={}.hasOwnProperty,d=function(t,e){function n(){this.constructor=t}for(var r in e)f.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};p=t("underscore"),o=t("../../core-view"),i=t("../../core-model"),l=t("../../templates"),s=t("../../mixins/handles-dom-resort"),r=t("./available-path"),a=t("./order-element"),c=function(t){return"active_"+t.get("id")},h=function(t){return"inactive_"+t.get("id")},e.exports=u=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return d(e,t),e.include(s),e.prototype.parameters=["collection","query","availableColumns"],e.prototype.className="im-sort-order-editor",e.prototype.template=l.template("column-manager-sort-order-editor"),e.prototype.getData=function(){return p.extend(e.__super__.getData.apply(this,arguments),{available:this.availableColumns.size()})},e.prototype.collectionEvents=function(){return{"add remove":this.reRender,sort:this.resortSortOrder,remove:this.makeAvailable}},e.prototype.initialize=function(){return e.__super__.initialize.apply(this,arguments),this.dragState=new i,this.listenTo(this.availableColumns,"sort add remove",this.resortAvailable),this.listenTo(this.availableColumns,"remove",this.addToSortOrder)},e.prototype.currentSortOrder=function(){return this.collection.map(function(t){return""+t.get("path")+" "+t.get("direction")}).join(" ")},e.prototype.postRender=function(){return this.resortSortOrder(),this.activateSortables(),this.resortAvailable(),this.setAvailableHeight()},e.prototype.activateSortables=function(){var t,e,n,r;return t=this.$(".im-active-oes"),e=900,n=this.$el.closest(".modal").width(),r=n>=e,this.collection.size()?this.$actives=t.sortable({placeholder:"im-view-list-placeholder",opacity:.6,cancel:"i,a,button",axis:r?null:"y",appendTo:this.el}):this.$droppable=this.$(".im-empty-collection").droppable({accept:".im-selected-column",activeClass:"im-can-add-column",hoverClass:"im-will-add-column"})},e.prototype.removeAllChildren=function(){var t,n;return null!=(t=this.$actives)&&t.sortable("destroy"),null!=(n=this.$droppable)&&n.droppable("destroy"),this.$droppable=null,this.$actives=null,e.__super__.removeAllChildren.apply(this,arguments)},e.prototype.events=function(){return{"drop .im-empty-collection":"addSortElement","sortupdate .im-active-oes":"onDOMResort"}},e.prototype.onDOMResort=function(t,e){var n,r,i;return(i=this.dragState.get("dragged"))?(r=this.availableColumns.findWhere({path:i}),n=e.item.prevAll().length,this.addToSortOrder(r,n),this.dragState.unset("dragged")):this.setChildIndices(c)},e.prototype.makeAvailable=function(t){return this.availableColumns.add(this.query.makePath(t.get("path")))},e.prototype.findAvailable=function(t){return this.availableColumns.find(function(e){return function(n){var r;return(null!=(r=e.children[h(n)])?r.el:void 0)===t}}(this))},e.prototype.addSortElement=function(t,e){var n,r;return n=e.draggable,r=this.findAvailable(n[0]),this.addToSortOrder(r)},e.prototype.addToSortOrder=function(t,e){var n,r,i,o,s,a,u,l;if(o=this.query.makePath(t.get("path")),i={id:String(o),path:o},s=this.collection.size(),t.destroy(),this.collection.add(i),null!=e&&s>e){for(a=this.collection.filter(function(t){return t.get("index")>=e}),n=this.collection.last(),u=0,l=a.length;l>u;u++)r=a[u],r.swap("index",function(t){return t+1});return n.set({index:e})}},e.prototype.resortAvailable=function(){var t;return this.rendered?(t=n.document.createDocumentFragment(),this.availableColumns.each(function(e){return function(n){return e._renderAvailable(n,t)}}(this)),this.$(".im-available-oes").html(t)):void 0},e.prototype._renderAvailable=function(t,e){var n,i,o;return i=h(t),n=function(t){return function(){return t.$actives}}(this),o=new r({model:t,findActives:n,state:this.dragState}),this.renderChild(i,o,e)},e.prototype.resortSortOrder=function(){var t;return this.rendered?(t=n.document.createDocumentFragment(),this.collection.each(function(e){return function(n){return e.renderChild(c(n),new a({model:n}),t)}}(this)),this.$(".im-active-oes").html(t)):void 0},e.prototype.setAvailableHeight=function(){return this.$(".im-rubbish-bin").css({"max-height":Math.max(200,this.$el.closest(".modal").height()-450)})},e.prototype.remove=function(){return this.dragState.destroy(),e.__super__.remove.apply(this,arguments)},e}(o)}).call(this)}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../../core-model":32,"../../core-view":33,"../../mixins/handles-dom-resort":61,"../../templates":97,"./available-path":148,"./order-element":150,underscore:308}],155:[function(t,e,n){(function(){var n,r,i,o,s,a,u={}.hasOwnProperty,l=function(t,e){function n(){this.constructor=t}for(var r in e)u.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};a=t("underscore"),i=t("../../core-view"),o=t("../../templates"),n=t("../../utils/css-class-set"),s=function(t,e){var r;return r={active:function(){return e.get("currentTab")===t}},r["im-"+t+"-tab"]=!0,new n(r)},e.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return l(e,t),e.TABS=["view","sortorder"],e.prototype.template=o.template("column-manager-tabs"),e.prototype.className="im-column-manager-tabs",e.prototype.getData=function(){return a.extend(e.__super__.getData.apply(this,arguments),{classes:this.classSets})},e.prototype.initState=function(){return this.state.set({currentTab:e.TABS[0]})},e.prototype.initialize=function(){return e.__super__.initialize.apply(this,arguments),this.initClassSets()},e.prototype.stateEvents=function(){return{"change:currentTab":this.reRender}},e.prototype.events=function(){return{"click .im-view-tab":"selectViewTab","click .im-sortorder-tab":"selectSortOrderTab"}},e.prototype.selectViewTab=function(){return this.state.set({currentTab:"view"})},e.prototype.selectSortOrderTab=function(){return this.state.set({currentTab:"sortorder"})},e.prototype.initClassSets=function(){var t,e,n,r,i;for(this.classSets={},r=["view","sortorder"],i=[],e=0,n=r.length;n>e;e++)t=r[e],i.push(function(t){return function(e){return t.classSets[e]=s(e,t.state)}}(this)(t));return i},e}(i)}).call(this)},{"../../core-view":33,"../../templates":97,"../../utils/css-class-set":109,underscore:308}],156:[function(t,e,n){(function(){var n,r,i,o,s,a={}.hasOwnProperty,u=function(t,e){function n(){this.constructor=t}for(var r in e)a.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};s=t("underscore"),n=t("./selected-column"),i=t("../../templates"),r=["column-manager-path-name","column-manager-restore-path"],e.exports=o=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return u(e,t),e.prototype.template=i.templateFromParts(r),e.prototype.events=function(){return{"click .im-restore-view":"removeView",click:"toggleFullPath"}},e.prototype.restoreTitle="columns.RestoreColumn",e.prototype.getData=function(){return s.extend(e.__super__.getData.apply(this,arguments),{restoreTitle:this.restoreTitle})},e}(n)}).call(this)},{"../../templates":97,"./selected-column":153,underscore:308}],157:[function(t,e,n){(function(){var n,r,i,o,s,a,u,l,c,h,p,f=[].slice,d={}.hasOwnProperty,m=function(t,e){function n(){this.constructor=t}for(var r in e)d.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};p=t("underscore"),s=t("es6-promise").Promise,u=t("../core-view"),o=t("../options"),a=t("../templates"),r=t("../mixins/has-typeaheads"),i=t("../patterns").IS_BLANK,c=t("../utils/path-suggester"),l=t("../utils/path-suggestions"),h=function(t){var e,n,r,i,o,s;return e=t.split(" > "),e.length>3?(n=4<=e.length?f.call(e,0,s=e.length-3):(s=0,[]),r=e[s++],i=e[s++],o=e[s++],"..."+r+" > "+i+" > "+o):t},e.exports=n=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return m(e,t),e.include(r),e.prototype.className="row",e.prototype.initialize=function(t){return this.query=t.query,this.openNodes=t.openNodes,this.chosenPaths=t.chosenPaths,e.__super__.initialize.apply(this,arguments),this.state.set({chosen:[]}),this.listenTo(this.openNodes,"add remove reset",this.reRender),this.listenTo(this.chosenPaths,"add remove reset",this.reRender),this.listenTo(this.chosenPaths,"add remove reset",this.setChosen),this.setChosen(),this.generatePathSuggestions()},e.prototype.modelEvents=function(){return{destroy:this.stopListeningTo,"change:showTree change:allowRevRefs":this.reRender}},e.prototype.stateEvents=function(){return{"change:chosen change:suggestions":this.reRender}},e.prototype.pathAcceptable=function(t){var e;return"id"===(null!=(e=t.end)?e.name:void 0)?!1:this.model.get("canSelectReferences")?!0:t.isAttribute()},e.prototype.generatePathSuggestions=function(){var t;return t=o.get("SuggestionDepth"),l(this.query,t).then(function(t){return function(e){return t.state.set({suggestions:e.filter(function(e){return t.pathAcceptable(e.path)})})}}(this))},e.prototype.getData=function(){var t,n;return n=this.openNodes.size(),t=this.chosenPaths.size(),p.extend({anyNodesOpen:n,anyNodeChosen:t},this.state.toJSON(),e.__super__.getData.apply(this,arguments))},e.prototype.template=a.template("constraint_adder_options"),e.prototype.render=function(){return e.__super__.render.apply(this,arguments),this.state.has("suggestions")&&this.installTypeahead(),this},e.prototype.installTypeahead=function(){var t,e,n,r,i;return this.removeTypeAheads(),e=this.$(".im-tree-filter"),i=this.state.get("suggestions"),r=c(i),n={minLength:3,highlight:!0},t={name:"path_suggestions",source:r,displayKey:"name"},this.activateTypeahead(e,n,t,i[0].name,function(t){return function(e,n){var r;return r=n.path,t.openNodes.add(r),t.model.get("multiSelect")?t.chosenPaths.add(r):t.chosenPaths.reset([r])}}(this))},e.prototype.events=function(){return{"click .im-collapser":"collapseBranches","change .im-allow-rev-ref":"toggleReverseRefs","change .im-tree-filter":"setFilter","click .im-choose":"toggleShowTree","click .im-approve":"triggerApproval","click .im-clear-filter":"clearFilter"}},e.prototype.triggerApproval=function(){return this.model.trigger("approved")},e.prototype.remove=function(){return this.removeTypeAheads(),e.__super__.remove.apply(this,arguments)},e.prototype.clearFilter=function(){return this.model.set({filter:null}),this.reRender()},e.prototype.setFilter=function(t){var e;return e=t.target.value,this.model.set({filter:i.test(e)?null:e})},e.prototype.collapseBranches=function(){return this.openNodes.reset()},e.prototype.toggleShowTree=function(){return this.model.toggle("showTree")},e.prototype.toggleReverseRefs=function(){return this.model.toggle("allowRevRefs")},e.prototype.setConstraint=function(){return this.model.trigger("approved")},e.prototype.setChosen=function(){var t,e,n;return n=this.chosenPaths.toJSON(),t=s.all(function(){var t,r,i;for(i=[],t=0,r=n.length;r>t;t++)e=n[t],i.push(e.getDisplayName());return i}()),t.then(function(t){var e,n,r,i;for(i=[],n=0,r=t.length;r>n;n++)e=t[n],i.push(h(e));return i}).then(function(t){return function(e){return t.state.set({chosen:e})}}(this),function(t){return console.error(t)})},e}(u)}).call(this)},{"../core-view":33,"../mixins/has-typeaheads":62,"../options":93,"../patterns":94,"../templates":97,"../utils/path-suggester":126,"../utils/path-suggestions":127,"es6-promise":277,underscore:308}],158:[function(t,e,n){(function(){var n,r,i,o,s,a,u,l,c,h,p,f,d,m={}.hasOwnProperty,g=function(t,e){function n(){this.constructor=t}for(var r in e)m.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},y=function(t,e){return function(){return t.apply(e,arguments)}};d=t("underscore"),s=t("../messages"),p=t("../templates"),f=t("../core-view"),o=t("../core-model"),h=t("../models/path-set"),l=t("../models/open-nodes"),i=t("./constraint-adder-options"),a=t("./new-constraint"),c=t("./path-chooser"),s.set({"constraints.BrowseForColumn":"Browse for Column","constraints.AddANewFilter":"Add a new filter","constraints.Choose":"Choose","constraints.Filter":"Filter","columns.CollapseAll":"Collapse columns","columns.AllowRevRef":"Allow reverse references"}),r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return g(e,t),e.prototype.defaults=function(){return{filter:null,showTree:!0,allowRevRefs:!1,canSelectReferences:!0,multiSelect:!1}},e}(o),u=".im-constraint-adder-options",e.exports=n=function(t){function e(){return this.showTree=y(this.showTree,this),e.__super__.constructor.apply(this,arguments)}return g(e,t),e.prototype.tagName="div",e.prototype.className="im-constraint-adder row-fluid",e.prototype.Model=r,e.prototype.initialize=function(t){var n;return this.query=t.query,this.buttonDelegate=t.buttonDelegate,e.__super__.initialize.apply(this,arguments),this.model.set({root:this.query.getPathInfo(this.query.root)}),this.chosenPaths=new h,this.view=new h(function(){var t,e,r,i;for(r=this.query.views,i=[],t=0,e=r.length;e>t;t++)n=r[t],i.push(this.query.makePath(n));return i}.call(this)),this.openNodes=new l(this.query.getViewNodes()),this.listenTo(this.query,"change:constraints",this.remove)},e.prototype.modelEvents=function(){return{approved:this.handleApproval,"change:showTree":this.toggleTree,"change:constraint":this.onChangeConstraint}},e.prototype.getTreeRoot=function(){return this.model.get("root")},e.prototype.handleApproval=function(){var t,e,n,r;return t=this.chosenPaths.toJSON()[0],null!=t?(n=this.model.get("constraint"),r=t.toString(),(null!=n?n.path:void 0)!==r?(e={path:r},this.model.set({constraint:e}),this.query.trigger("editing-constraint",e)):this.onChangeConstraint()):(console.debug("nothing chosen"),this.model.unset("constraint"))},e.prototype.renderConstraintEditor=function(){var t,e;return t=this.model.get("constraint"),e=new a({buttonDelegate:this.buttonDelegate,query:this.query,constraint:t}),this.renderChild("con",e,this.$(".im-new-constraint")),this.listenTo(e,"remove",function(){return this.model.set({showTree:!0})})},e.prototype.onChangeConstraint=function(){return this.rendered?this.model.get("constraint")?(this.model.set({showTree:!1}),this.renderConstraintEditor()):this.removeChild("con"):void 0},e.prototype.toggleTree=function(){return this.model.get("showTree")?this.showTree():this.hideTree()},e.prototype.hideTree=function(){return this.trigger("resetting:tree"),this.$(".im-path-finder").removeClass("open"),this.removeChild("tree")},e.prototype.showTree=function(t){var e;return this.trigger("showing:tree"),this.removeChild("con"),e=new c({model:this.model,query:this.query,chosenPaths:this.chosenPaths,openNodes:this.openNodes,view:this.view,trail:[]}),this.$(".im-path-finder").addClass("open"),this.renderChild("tree",e,this.$(".im-path-finder"))},e.prototype.template=p.template("constraint_adder"),e.prototype.renderOptions=function(){var t;return t={model:this.model,openNodes:this.openNodes,chosenPaths:this.chosenPaths,query:this.query},this.renderChild("opts",new i(t),this.$(u))},e.prototype.postRender=function(){return this.renderOptions(),this.toggleTree()},e}(f)}).call(this)},{"../core-model":32,"../core-view":33,"../messages":46,"../models/open-nodes":82,"../models/path-set":85,"../templates":97,"./constraint-adder-options":157,"./new-constraint":229,"./path-chooser":231,underscore:308}],159:[function(t,e,n){(function(){var n,r,i,o,s,a,u,l,c,h,p,f,d,m,g,y,v,b,_,w,x,C,T,S,E,N,k,M,P,O=[].indexOf||function(t){for(var e=0,n=this.length;n>e;e++)if(e in this&&this[e]===t)return e;return-1},A={}.hasOwnProperty,R=function(t,e){function n(){this.constructor=t}for(var r in e)A.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};M=t("underscore"),y=t("../messages"),h=t("../icons"),l=t("../core-view"),E=t("./type-value-controls"),i=t("./attribute-value-controls"),b=t("./multi-value-controls"),a=t("./boolean-value-controls"),d=t("./lookup-value-controls"),m=t("./loop-value-controls"),f=t("./list-value-controls"),c=t("./error-message"),P=t("imjs"),C=P.Query,v=P.Model,T=C.REFERENCE_OPS,p=C.LIST_OPS,g=C.MULTIVALUE_OPS,w=C.NULL_OPS,n=C.ATTRIBUTE_OPS,r=C.ATTRIBUTE_VALUE_OPS,x=v.NUMERIC_TYPES,s=v.BOOLEAN_TYPES,o=r.concat(w),N='<fieldset class="im-constraint-options form-group row">\n  <label class="col-sm-3 path-label"><%- data.con.displayName %></label>\n  <% if (data.con.op) { %>\n    <div class="im-operator col-sm-3">\n        <select class="form-control im-ops">\n        <option selected><%- data.con.op %></option>\n        <% data.otherOperators.forEach(function (op) { %>\n            <option><%- op %></option>\n        <% }); %>\n        </select>\n    </div>\n  <% } %>\n  <div class="col-sm-6 im-value-options im-value-section">\n  </div>\n</fieldset>\n\n<div class="btn-group im-con-buttons">\n  <% data.buttons.forEach(function (b, i) { %>\n  <button class="btn btn-<%= (i === 0) ? \'primary\' : \'default\' %> <%- b.classes %>">\n    <%- data.messages.getText(b.key) %>\n  </button>\n  <% }); %>\n</div>\n',S=M.template(N,{variable:"data"}),_=function(){},k=function(t){var e,r;if(e=t.path,!(null!=e?e.isReference:void 0))throw new Error("No path or wrong type");return e.isRoot()&&T.concat(C.RANGE_OPS),e.isReference()?T.concat(C.RANGE_OPS).concat(t["new"]?["ISA"]:[]):(r=e.getType(),O.call(s,r)>=0?["=","!="].concat(w):n)},e.exports=u=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return R(e,t),e.prototype.tagName="div",e.prototype.className="form",e.prototype.parameters=["query","model"],e.prototype.optionalParameters=["buttonDelegate"],e.prototype.initialize=function(){return e.__super__.initialize.apply(this,arguments),this.path=this.model.get("path")},e.prototype.invariants=function(){return{modelHasPath:"No path found on model"}},e.prototype.modelHasPath=function(){return this.model.get("path")},e.prototype.getType=function(){return this.model.get("path").getType()},e.prototype.modelEvents=function(){return{"change:op change:displayName":this.reRender,destroy:this.stopListening}},e.prototype.events=function(){return{submit:function(t){return t.preventDefault(),t.stopPropagation()},"click .btn-cancel":"cancelEditing","click .btn-primary":"applyChanges","change .im-ops":"setOperator"}},e.prototype.delegateButtonEvents=function(){return this.buttonDelegate.off("click.constraint-editor"),this.buttonDelegate.on("click.constraint-editor",".btn-cancel",function(t){return function(){return t.cancelEditing()}}(this)),this.buttonDelegate.on("click.constraint-editor",".btn-primary",function(t){return function(){return t.applyChanges()}}(this))},e.prototype.setOperator=function(){return this.model.set({op:this.$(".im-ops").val()})},e.prototype.cancelEditing=function(){return this.model.trigger("cancel");

},e.prototype.applyChanges=function(t){return null!=t&&t.preventDefault(),null!=t&&t.stopPropagation(),this.model.trigger("apply",this.getConstraint())},e.prototype.getConstraint=function(){var t,e,n;return t=this.model.pick(["path","op","value","values","code","type"]),e=t.op,O.call(g.concat(w),e)>=0&&delete t.value,n=t.op,O.call(r.concat(w),n)>=0&&delete t.values,"ISA"===t.op&&delete t.op,t},e.prototype.getValueControls=function(){return null==this.path?null:this.isNullConstraint()?null:this.isTypeConstraint()?new E({model:this.model,query:this.query}):this.isMultiValueConstraint()?new b({model:this.model,query:this.query}):this.isListConstraint()?new f({model:this.model,query:this.query}):this.isBooleanConstraint()?new a({model:this.model,query:this.query}):this.isLoopConstraint()?new m({model:this.model,query:this.query}):this.isLookupConstraint()?new d({model:this.model,query:this.query}):this.isRangeConstraint()?new b({model:this.model,query:this.query}):this.path.isAttribute()?new i({model:this.model,query:this.query}):(this.model.set({error:new Error("cannot handle this constaint type")}),null)},e.prototype.isNullConstraint=function(){var t;return t=this.model.get("op"),O.call(w,t)>=0},e.prototype.isLoopConstraint=function(){var t;return this.path.isClass()&&("="===(t=this.model.get("op"))||"!="===t)},e.prototype.isTypeConstraint=function(){return this.path.isReference()&&(!this.model.get("op")||"ISA"===this.model.get("op"))},e.prototype.isBooleanConstraint=function(){var t,e;return t=this.path.getType(),O.call(s,t)>=0&&(e=this.model.get("op"),!(O.call(w,e)>=0))},e.prototype.isMultiValueConstraint=function(){var t;return this.path.isAttribute()&&(t=this.model.get("op"),O.call(g,t)>=0)},e.prototype.isListConstraint=function(){var t;return this.path.isClass()&&(t=this.model.get("op"),O.call(p,t)>=0)},e.prototype.isLookupConstraint=function(){var t;return this.path.isClass()&&(t=this.model.get("op"),O.call(C.TERNARY_OPS,t)>=0)},e.prototype.isRangeConstraint=function(){var t;return this.path.isReference()&&(t=this.model.get("op"),O.call(C.RANGE_OPS,t)>=0)},e.prototype.getOtherOperators=function(){return M.without(k(this.model.pick("new","path")),this.model.get("op"))},e.prototype.buttons=function(){var t;return null!=this.buttonDelegate?[]:(t=[{key:"conbuilder.Update",classes:"im-update"},{key:"conbuilder.Cancel",classes:"btn-cancel"}],this.model.get("new")?(t[0].key="conbuilder.Add",t[1].classes="im-remove-constraint"):t.push({key:"conbuilder.Remove",classes:"btn btn-default im-remove-constraint"}),t)},e.prototype.getData=function(){var t,e,n,r,i;return t=this.buttons(),r=y,n=h,i=this.getOtherOperators(),e=this.model.toJSON(),{buttons:t,icons:n,messages:r,icons:n,otherOperators:i,con:e}},e.prototype.template=S,e.prototype.render=function(){return e.__super__.render.apply(this,arguments),this.renderChild("valuecontrols",this.getValueControls(),this.$(".im-value-options")),this.renderChild("error",new c({model:this.model})),null!=this.buttonDelegate&&this.delegateButtonEvents(),this},e.prototype.remove=function(){var t;return null!=(t=this.buttonDelegate)&&t.off("click.constraint-editor"),this.$el.slideUp({always:function(t){return function(){return e.__super__.remove.call(t)}}(this)})},e}(l)}).call(this)},{"../core-view":33,"../icons":44,"../messages":46,"./attribute-value-controls":143,"./boolean-value-controls":144,"./error-message":167,"./list-value-controls":223,"./lookup-value-controls":224,"./loop-value-controls":225,"./multi-value-controls":228,"./type-value-controls":258,imjs:286,underscore:308}],160:[function(t,e,n){(function(){var n,r,i,o,s,a,u,l,c,h={}.hasOwnProperty,p=function(t,e){function n(){this.constructor=t}for(var r in e)h.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},f=[].indexOf||function(t){for(var e=0,n=this.length;n>e;e++)if(e in this&&this[e]===t)return e;return-1},d=[].slice;l=t("underscore"),o=t("../messages"),u=t("../templates"),r=t("../core-view"),i=t("../patterns").IS_BLANK,c=t("imjs"),a=c.Query,s=c.Model,o.set({"consummary.IsA":"is a","consummary.NoValue":"no value"}),e.exports=n=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return p(e,t),e.prototype.tagName="ol",e.prototype.className="constraint-summary breadcrumb",e.prototype.initialize=function(){return e.__super__.initialize.apply(this,arguments),this.listenTo(o,"change",this.reRender)},e.prototype.getData=function(){return l.extend(e.__super__.getData.apply(this,arguments),{labels:this.getSummary()})},e.prototype.template=u.template("constraint-summary"),e.prototype.getTitleOp=function(){return this.model.get("op")||o.getText("consummary.IsA")},e.prototype.modelEvents=function(){return{change:this.reRender}},e.prototype.events=function(){return{"click .label-path":function(){return this.state.toggle("showFullPath")}}},e.prototype.stateEvents=function(){return{"change:showFullPath":this.toggleFullPath}},e.prototype.toggleFullPath=function(){return this.$(".label-path").toggleClass("im-show-full-path",!!this.state.get("showFullPath"))},e.prototype.postRender=function(){return this.toggleFullPath()},e.prototype.getTitleVal=function(){var t,e,n,r,i,o;return this.model.has("values")&&(i=this.model.get("op"),f.call(a.MULTIVALUE_OPS.concat(a.RANGE_OPS),i)>=0)?(n=this.model.get("values"))?1===n.length?n[0]:0===n.length?"[ ]":n.length>5?n.length+" values":(t=2<=n.length?d.call(n,0,r=n.length-1):(r=0,[]),e=n[r++],""+t.join(", ")+" and "+e):void 0:this.model.has("value")?this.model.get("value"):null!=(o=this.model.get("typeName"))?o:this.model.get("type")},e.prototype.isLookup=function(){return"LOOKUP"===this.model.get("op")},e.prototype.getPathLabel=function(){var t,e,n,r,i;return r=this.model.toJSON(),n=r.title,t=r.displayName,e=r.path,{content:String(null!=(i=null!=n?n:t)?i:e),type:"path"}},e.prototype.getSummary=function(){var t,e,n,r,o;return t=[],t.push(this.getPathLabel()),(n=this.getTitleOp())&&t.push({content:n,type:"op"}),o=this.model.get("op"),f.call(a.NULL_OPS,o)<0&&(r=this.getTitleVal(),null==r||i.test(r)?(e=this.model.get("new")?"warning":"error",t.push({content:"NoValue",type:e})):t.push({content:r,type:"value"}),this.isLookup()&&this.model.has("extraValue")&&t.push({content:this.model.get("extraValue"),type:"extra",icon:"ExtraValue"})),t},e}(r)}).call(this)},{"../core-view":33,"../messages":46,"../patterns":94,"../templates":97,imjs:286,underscore:308}],161:[function(t,e,n){(function(){var n,r,i,o,s,a,u={}.hasOwnProperty,l=function(t,e){function n(){this.constructor=t}for(var r in e)u.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};a=t("underscore"),o=t("../core-view"),s=t("../templates"),r=t("./constraint-adder"),n=t("./active-constraint"),t("../messages/constraints"),e.exports=i=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return l(e,t),e.prototype.className="im-constraints",e.prototype.initialize=function(t){return this.query=t.query,e.__super__.initialize.apply(this,arguments),this.listenTo(this.query,"change:constraints",this.reRender)},e.prototype.getData=function(){return a.extend(e.__super__.getData.apply(this,arguments),{constraints:this.getConstraints()})},e.prototype.events=function(){return{click:function(t){return null!=t?t.stopPropagation():void 0}}},e.prototype.template=s.templateFromParts(["constraints-heading","active-constraints"]),e.prototype.postRender=function(){var t,e,r,i,o,s;for(e=this.$(".im-active-constraints"),s=this.getConstraints(),r=i=0,o=s.length;o>i;r=++i)t=s[r],this.renderChild("con_"+r,new n({query:this.query,constraint:t}),e);return this.renderChild("conAdder",this.getConAdder())},e.prototype.getConstraints=function(){return this.query.constraints.slice()},e.prototype.getConAdder=function(){return new r({query:this.query})},e}(o)}).call(this)},{"../core-view":33,"../messages/constraints":51,"../templates":97,"./active-constraint":142,"./constraint-adder":158,underscore:308}],162:[function(t,e,n){(function(){var n,r,i,o,s,a={}.hasOwnProperty,u=function(t,e){function n(){this.constructor=t}for(var r in e)a.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};s=t("underscore"),r=t("../../core-view"),i=t("../../messages"),o=t("../../models/path"),t("../../messages/constraints"),e.exports=n=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return u(e,t),e.prototype.Model=o,e.prototype.tagName="button",e.prototype.className="btn btn-primary im-add-constraint",e.prototype.optionalParameters=["hideType"],e.prototype.hideType=!1,e.prototype.template=function(t){return s.escape(i.getText("constraints.AddConFor",t))},e.prototype.getData=function(){return s.extend(e.__super__.getData.apply(this,arguments),{hideType:this.hideType})},e.prototype.modelEvents=function(){return{change:this.reRender}},e.prototype.events=function(){return{click:function(){return this.trigger("chosen",this.model.get("path"))}}},e}(r)}).call(this)},{"../../core-view":33,"../../messages":46,"../../messages/constraints":51,"../../models/path":86,underscore:308}],163:[function(t,e,n){(function(){var n,r,i,o,s,a,u,l,c,h,p,f,d={}.hasOwnProperty,m=function(t,e){function n(){this.constructor=t}for(var r in e)d.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},g=[].slice;f=t("underscore"),o=t("../../core-view"),c=t("../../models/path"),h=t("../../templates"),a=t("../../messages"),i=t("../constraint-adder"),n=t("./column-adder-button"),t("../../messages/constraints"),u=".im-constraint-adder-options",s=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return m(e,t),e.prototype.className="btn-group",e.prototype.parameters=["main","options"],e.prototype.initState=function(){return this.state.set({open:!1})},e.prototype.stateEvents=function(){return{"change:open":this.toggleOpen}},e.prototype.toggleOpen=function(){return this.$el.toggleClass("open",this.state.get("open"))},e.prototype.ICONS="NONE",e.prototype.postRender=function(){var t,e,n,r,i,o;for(this.toggleOpen(),this.renderChild("main",this.main),this.renderChild("toggle",new p({state:this.state})),n=document.createElement("ul"),n.className="dropdown-menu",o=this.options,t=r=0,i=o.length;i>r;t=++r)e=o[t],this.renderChild(t,e,n);return this.$el.append(n)},e}(o),p=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return m(e,t),e.prototype.tagName="button",e.prototype.className="btn btn-primary dropdown-toggle",e.prototype.ICONS="NONE",e.prototype.template=f.template('<span class="caret"></span>\n<span class="sr-only"><%- Messages.getText(\'constraints.OtherPaths\') %></span>'),e.prototype.events=function(){return{click:function(){return this.state.toggle("open")}}},e}(o),l=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return m(e,t),e.prototype.tagName="li",e.prototype.className="",e.prototype.template=function(){return"<a>"+e.__super__.template.apply(this,arguments)+"</a>"},e}(n),e.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return m(e,t),e.prototype.parameters=["query","paths"],e.prototype.onChosen=function(t){return this.model.set({constraint:{path:t}})},e.prototype.renderOptions=function(){},e.prototype.showTree=function(){var t,e,r,i,o,a,h,p,f,d,m;for(d=this.paths,o=d[0],h=2<=d.length?g.call(d,1):[],r=new n({hideType:!0,model:new c(o)}),i=function(){var t,e,n;for(n=[],t=0,e=h.length;e>t;t++)a=h[t],n.push(new l({hideType:!0,model:new c(a)}));return n}(),e=new s({main:r,options:i}),m=[r].concat(g.call(i)),p=0,f=m.length;f>p;p++)t=m[p],this.listenTo(t,"chosen",this.onChosen);return this.renderChild("tree",e,this.$(u))},e}(i)}).call(this)},{"../../core-view":33,"../../messages":46,"../../messages/constraints":51,"../../models/path":86,"../../templates":97,"../constraint-adder":158,"./column-adder-button":162,underscore:308}],164:[function(t,e,n){(function(){var n,r,i,o,s,a,u,l,c,h={}.hasOwnProperty,p=function(t,e){function n(){this.constructor=t}for(var r in e)h.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};c=t("underscore"),i=t("../../core-view"),a=t("../../models/path"),l=t("../../templates"),o=t("../../messages"),r=t("../constraint-adder"),n=t("./column-adder-button"),t("../../messages/constraints"),s=".im-constraint-adder-options",e.exports=u=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return p(e,t),e.prototype.parameters=["query","path"],e.prototype.initialize=function(){var t;return e.__super__.initialize.apply(this,arguments),t={path:this.path},this.model.set({constraint:t})},e.prototype.events=function(){return{"click .im-add-constraint":this.act}},e.prototype.act=function(){return this.hideTree(),this.renderConstraintEditor()},e.prototype.renderOptions=function(){},e.prototype.showTree=function(){var t,e;return e=new a(this.query.makePath(this.path)),t=new n({model:e}),this.renderChild("tree",new n({model:e}),this.$(s))},e}(r)}).call(this)},{"../../core-view":33,"../../messages":46,"../../messages/constraints":51,"../../models/path":86,"../../templates":97,"../constraint-adder":158,"./column-adder-button":162,underscore:308}],165:[function(t,e,n){(function(){var n,r,i,o,s={}.hasOwnProperty,a=function(t,e){function n(){this.constructor=t}for(var r in e)s.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};r=t("../constraints"),i=t("./single-column-adder"),n=t("./composed-column-adder"),e.exports=o=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return a(e,t),e.prototype.getConAdder=function(){var t,e,r,o,s;return this.shouldShowAdder()?(s=this.model.attributes,o=s.replaces,t=s.isComposed,e=s.outerJoined,r=this.model.pathInfo(),t&&o.length>1?new n({query:this.query,paths:o}):e?new n({query:this.query,paths:[r].concat(o)}):new i({query:this.query,path:r})):void 0},e.prototype.shouldShowAdder=function(){var t,e,n,r;return r=this.model.attributes,e=r.numeric,t=r.isComposed,n=r.outerJoined,e||t||n||!this.getConstraints().length},e.prototype.getConstraints=function(){var t,e,n,r,i,o;for(e=this.model.get("path"),i=this.query.constraints,o=[],n=0,r=i.length;r>n;n++)t=i[n],t.path.match(e)&&o.push(t);return o},e}(r)}).call(this)},{"../constraints":161,"./composed-column-adder":163,"./single-column-adder":164}],166:[function(t,e,n){(function(){var n,r,i,o,s,a,u,l,c,h,p,f,d,m={}.hasOwnProperty,g=function(t,e){function n(){this.constructor=t}for(var r in e)m.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};d=t("underscore"),o=t("../core-view"),u=t("../models/history"),p=t("../models/table"),c=t("../models/selected-objects"),n=t("../utils/events").Bus,i=t("../utils/children"),f=t("../core/type-assertions"),h=t("./table"),l=t("./query-tools"),a="Bad arguments to Dashboard - {query :: imjs.Query} is required",r="consumerContainer provided as selector - but no matching element was found",e.exports=s=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return g(e,t),e.prototype.tagName="div",e.prototype.className="imtables-dashboard container-fluid",e.prototype.Model=p,e.prototype.optionalParameters=["consumerContainer","consumerBtnClass"],e.prototype.initialize=function(t){var i;if(i=t.query,!f.Query.test(i)&&null==i)throw new Error(a);return e.__super__.initialize.apply(this,arguments),this.history=new u,this.bus=new n,this.history.setInitialState(i),this.selectedObjects=new c(i.service),null!=this.consumerContainer&&d.isString(this.consumerContainer)&&(this.consumerContainer=document.querySelector(this.consumerContainer),!this.consumerContainer)?console.log(r):void 0},e.prototype.renderChildren=function(){return this.renderQueryTools(),this.renderTable()},e.prototype.renderTable=function(){var t;return t=i.createChild(this,h),this.renderChild("table",t)},e.prototype.renderQueryTools=function(){var t;return t=i.createChild(this,l,{tableState:this.model}),this.renderChild("tools",t)},e.prototype.remove=function(){return this.bus.destroy(),this.history.close(),e.__super__.remove.apply(this,arguments)},e}(o)}).call(this)},{"../core-view":33,"../core/type-assertions":40,"../models/history":75,"../models/selected-objects":88,"../models/table":91,"../utils/children":106,"../utils/events":111,"./query-tools":238,"./table":239,underscore:308}],167:[function(t,e,n){(function(){var n,r,i,o,s,a,u={}.hasOwnProperty,l=function(t,e){function n(){this.constructor=t}for(var r in e)u.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};a=t("underscore"),s=t("fs"),n=t("../core-view"),i=t("../icons"),o=t("../templates"),e.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return l(e,t),e.prototype.className="im-error-message",e.prototype.modelEvents=function(){return{"change:error":this.reRender}},e.prototype.getData=function(){return{icons:i,error:this.model.get("error")}},e.prototype.logError=function(){var t;return(t=this.model.get("error"))?console.error(t,t.stack):void 0},e.prototype.template=o.template("error-message"),e}(n)}).call(this)},{"../core-view":33,"../icons":44,"../templates":97,fs:5,underscore:308}],168:[function(t,e,n){(function(){var n,r,i,o,s,a,u,l,c,h,p,f,d,m,g,y,v,b,_,w,x,C,T,S,E,N,k,M,P,O,A,R={}.hasOwnProperty,I=function(t,e){function n(){this.constructor=t}for(var r in e)R.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},D=function(t,e){return function(){return t.apply(e,arguments)}};A=t("underscore"),n=t("jquery"),b=t("../core-model"),v=t("./modal"),o=t("./constraint-adder"),y=t("../messages"),T=t("../templates"),_=t("../options"),f=t("../models/export-formats"),C=t("../mixins/runs-query"),g=t("./export-dialogue/tab-menu"),p=t("./export-dialogue/format-controls"),x=t("./export-dialogue/row-controls"),r=t("./export-dialogue/column-controls"),i=t("./export-dialogue/compression-controls"),h=t("./export-dialogue/flat-file-options"),m=t("./export-dialogue/json-options"),c=t("./export-dialogue/fasta-options"),s=t("./export-dialogue/destination-options"),w=t("./export-dialogue/preview"),N=t("../utils/open-window-with-post"),k=t("../utils/send-to-dropbox"),O=t("../utils/send-to-google-drive"),M=t("../utils/send-to-galaxy"),P=t("../utils/send-to-genomespace"),d={doneness:null,tab:"dest",dest:"download",linkToFile:null},l=["progress_bar","modal_error","export_dialogue_footer"],S=function(){function t(t){this.key="export.error."+t,this.message=y.get(this.key)}return t.prototype.cannotDismiss=!0,t}(),u=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return I(e,t),e.prototype.defaults=function(){return{filename:"results",format:f.getFormat("tab"),tablePage:null,start:0,columns:[],size:null,max:null,compress:!1,compression:"gzip",headers:!1,jsonFormat:"rows",fastaExtension:null,headerType:"friendly"}},e}(b),E=function(t){return function(e){return e.isa(t)}},e.exports=a=function(t){function e(){return this.onUploadError=D(this.onUploadError,this),this.onUploadProgress=D(this.onUploadProgress,this),this.onUploadComplete=D(this.onUploadComplete,this),e.__super__.constructor.apply(this,arguments)}return I(e,t),e.include(C),e.prototype.Model=u,e.prototype.className=function(){return"im-export-dialogue "+e.__super__.className.apply(this,arguments)},e.prototype.parameters=["query"],e.prototype.initialize=function(){return e.__super__.initialize.apply(this,arguments),this.model.has("format")&&!this.model.get("format").ext&&this.model.set({format:f.getFormat(this.model.get("format"))}),this.state.set(d),this.listenTo(this.state,"change:tab",this.renderMain),this.listenTo(this.model,"change",this.updateState),this.listenTo(this.model,"change:columns",this.setMax),this.listenTo(this.model,"change:format",this.onChangeFormat),this.categoriseQuery(),this.model.set({columns:this.query.views}),null!=this.query.name&&this.model.set({filename:this.query.name.replace(/\s+/g,"_")}),this.updateState(),this.setMax(),this.readUserPreferences()},e.prototype.onChangeFormat=function(){return A.defer(function(t){return function(){var e,n,r,i,o,s,a,u,l,c,h,p,f;if(r=t.model.get("format"),e=t.model.get("columns"),null!=(p=r.needs)?p.length:void 0){for(a=e.slice(),o=[],f=t.query.views,c=0,h=f.length;h>c;c++)l=f[c],u=t.query.makePath(l).getParent(),A.any(r.needs,function(t){return u.isa(t)})&&o.push(u.append("id").toString());return s=A.uniq(o),t.model.set({nodecolumns:s}),i=r.maxColumns,n=i?A.first(s,i):s.slice(),t.model.set({columns:n}),t.model.once("change:format",function(){return t.model.set({columns:a}),t.model.unset("nodecolumns")})}}}(this))},e.prototype.readUserPreferences=function(){return this.query.service.whoami().then(function(t){return function(t){var e;if(t.hasPreferences)return(e=t.preferences["galaxy-url"])?_.set("Destination.Galaxy.Current",e):void 0}}(this))},e.prototype.setMax=function(){return this.getEstimatedSize().then(function(t){return function(e){return t.model.set({max:e})}}(this))},e.prototype.categoriseQuery=function(){var t,e,n,r,i;r=this.query.getViewNodes(),t={},i=this.query.model.classes;for(n in i)e=i[n],t[n]=A.any(r,E(n));return this.model.set({has:t})},e.prototype.title=function(){return y.getText("ExportTitle",{name:this.query.name})},e.prototype.modalSize="lg",e.prototype.primaryAction=function(){return y.getText(this.state.get("dest"))},e.prototype.primaryIcon=function(){return this.state.get("dest")},e.prototype.body=T.template("export_dialogue"),e.prototype.footer=T.templateFromParts(l),e.prototype.updateState=function(){var t,e,n,r,i,o,s,a,u,l,c;return c=this.model.toJSON(),n=c.compress,r=c.compression,l=c.start,u=c.size,s=c.max,o=c.format,e=c.columns,t=A.isEqual(e,this.query.views)?y.get("All"):e.length,a=this.getRowCount(),i=0===e.length?new S("NoColumnsSelected"):l>=s?new S("OffsetOutOfBounds"):null,this.state.set(this.model.pick("headers","headerType","jsonFormat","fastaExtension")),this.state.set({error:i,format:o,max:s,exportURI:this.getExportURI(),rowCount:this.getRowCount(),compression:n?r:null,columns:t})},e.prototype.getRowCount=function(){var t,e,n,r;return r=this.model.pick("start","size","max"),n=r.start,e=r.size,t=r.max,null==n&&(n=0),t-=null!=n?n:0,e=null!=e&&e>0?e:t,Math.min(t,e)},e.prototype.getMain=function(){switch(this.state.get("tab")){case"format":return p;case"columns":return r;case"compression":return i;case"column-headers":return h;case"opts-json":return m;case"opts-fasta":return c;case"dest":return s;case"rows":return x;case"preview":return w;default:return p}},e.prototype.onUploadComplete=function(t){return this.state.set({doneness:null,linkToFile:t})},e.prototype.onUploadProgress=function(t){return this.state.set({doneness:t})},e.prototype.onUploadError=function(t){return this.state.set({doneness:null,error:t}),console.error(t)},e.prototype.act=function(){var t,e,n,r,i,o,s,a,u,l;return this.onUploadProgress(0),e=this.getExporter(),i=this.model,u=this.state,a=this.query,t={model:i.toJSON(),state:u.toJSON(),query:a.clone()},l=this.getExportURI(),r=this.getFileName(),o=this.onUploadProgress,n=e.call(t,l,r,o),n.then(this.onUploadComplete,this.onUploadError),null!=e.after?(s=e.after.bind(t),n.then(s,s).then(null,function(t){return function(e){return t.state.set({error:e})}}(this))):void 0},e.prototype.getExporter=function(){switch(this.state.get("dest")){case"download":return function(){return Promise.resolve(null)};case"Dropbox":return k;case"Drive":return O;case"Galaxy":return M;case"GenomeSpace":return P;default:throw new Error("Cannot export to "+this.state.get("dest"))}},e.prototype.events=function(){var t;return t=e.__super__.events.apply(this,arguments),t.keyup="handleKeyup",t},e.prototype.handleKeyup=function(t){var e,n;if(!this.$(t.target).is("input"))switch(t.which){case 40:return null!=(e=this.children.menu)?e.next():void 0;case 38:return null!=(n=this.children.menu)?n.prev():void 0}},e.prototype.renderMain=function(){var t;return t=this.getMain(),this.renderChild("main",new t({model:this.model,query:this.query,state:this.state}),this.$("div.main"))},e.prototype.postRender=function(){return this.renderChild("menu",new g({model:this.state}),this.$("nav.menu")),this.renderMain(),this.$el.focus(),e.__super__.postRender.apply(this,arguments)},e}(v)}).call(this)},{"../core-model":32,"../messages":46,"../mixins/runs-query":63,"../models/export-formats":72,"../options":93,"../templates":97,"../utils/open-window-with-post":124,"../utils/send-to-dropbox":130,"../utils/send-to-galaxy":131,"../utils/send-to-genomespace":132,"../utils/send-to-google-drive":133,"./constraint-adder":158,"./export-dialogue/column-controls":170,"./export-dialogue/compression-controls":171,"./export-dialogue/destination-options":172,"./export-dialogue/fasta-options":173,"./export-dialogue/flat-file-options":174,"./export-dialogue/format-controls":175,"./export-dialogue/json-options":176,"./export-dialogue/preview":178,"./export-dialogue/row-controls":179,"./export-dialogue/tab-menu":180,"./modal":227,jquery:305,underscore:308}],169:[function(t,e,n){(function(){var n,r,i,o,s,a={}.hasOwnProperty,u=function(t,e){function n(){this.constructor=t}for(var r in e)a.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};s=t("underscore"),o=t("../query-dialogue-button"),r=t("../export-dialogue"),n=t("../../utils/count-executor"),e.exports=i=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return u(e,t),e.prototype.className="im-export-dialogue-button",e.prototype.longLabel="export.ExportQuery",e.prototype.shortLabel="export.Export",e.prototype.icon="Download",e.prototype.optionalParameters=["tableState"],e.prototype.initialize=function(){return e.__super__.initialize.apply(this,arguments),n.count(this.query).then(function(t){return function(e){return t.state.set({disabled:0===e})}}(this)).then(null,function(t){return function(e){return t.state.set({disabled:!0,error:e})}}(this))},e.prototype.initState=function(){return this.state.set({name:this.query.name})},e.prototype.dialogueOptions=function(){var t,e;return t=null!=(e=this.tableState)?e.pick("start","size"):void 0,{query:this.query,model:{tablePage:t}}},e.prototype.Dialogue=r,e}(o)}).call(this)},{"../../utils/count-executor":107,"../export-dialogue":168,"../query-dialogue-button":236,underscore:308}],170:[function(t,e,n){(function(){var n,r,i,o,s,a,u,l,c,h,p,f,d,m={}.hasOwnProperty,g=function(t,e){function n(){this.constructor=t}for(var r in e)m.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},y=[].indexOf||function(t){for(var e=0,n=this.length;n>e;e++)if(e in this&&this[e]===t)return e;return-1};d=t("underscore"),p=t("../../core-view"),l=t("../../models/path-set"),a=t("../label-view"),u=t("../../messages"),h=t("../../templates"),o=t("../../mixins/has-typeaheads"),f=t("../../utils/path-suggester"),s=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return g(e,t),e.prototype.template=d.partial(u.getText,"export.category.Columns"),e}(a),n=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return g(e,t),e.include(o),e.prototype.initialize=function(t){return this.columns=t.columns,this.query=t.query,e.__super__.initialize.apply(this,arguments),this.initSuggestions()},e.prototype.addSuggestion=function(t){var e;return this.columns.contains(t)?void 0:(this.suggestions.add(t),e=this.suggestions.get(t),t.getDisplayName(function(t,n){return e.set({error:t,name:n})}))},e.prototype.initSuggestions=function(){var t,e,n,r,i,o;for(this.suggestions=new l,n=this.query.getQueryNodes(),o=[],r=0,i=n.length;i>r;r++)e=n[r],o.push(function(){var n,r,i,o;for(i=e.getChildNodes(),o=[],n=0,r=i.length;r>n;n++)t=i[n],t.isAttribute()&&o.push(this.columns.contains(t)?void 0:this.addSuggestion(t));return o}.call(this));return o},e.prototype.postRender=function(){var t,e,n;return e=this.$("input"),n={minLength:1,highlight:!0},t={name:"view_suggestions",source:f(this.suggestions),displayKey:"name"},this.activateTypeahead(e,n,t,"Additional paths",function(t){return function(e,n){var r;return r=n.item,t.columns.add(r,{active:!0})}}(this)),this.$(".im-help").tooltip()},e.prototype.className="col-sm-8",e.prototype.template=h.template("export_add_column_control"),e}(p),c=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return g(e,t),e.prototype.className="col-sm-4",e.prototype.RERENDER_EVENT="change:isAll",e.prototype.initialize=function(t){return this.query=t.query,this.columns=t.columns,e.__super__.initialize.apply(this,arguments),this.setIsAll(),this.listenTo(this.columns,"change:active",this.setIsAll)},e.prototype.setIsAll=function(){var t,e,n;return n=this.query.views,e=function(){var e,n,r,i;for(r=this.columns.where({active:!0}),i=[],e=0,n=r.length;n>e;e++)t=r[e],i.push(t.get("item").toString());return i}.call(this),this.model.set({isAll:d.isEqual(n,e)})},e.prototype.template=h.template("reset_button"),e.prototype.events=function(){return{"click button":"reset"}},e.prototype.reset=function(){var t;return t=this.query.views,this.columns.each(function(e){var n;return n=e.get("item").toString(),e.set({active:d.any(t,function(t){return t===n})})})},e}(p),i=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return g(e,t),e.prototype.RERENDER_EVENT="change",e.prototype.initialize=function(){var t,n;return e.__super__.initialize.apply(this,arguments),this.model.has("active")||this.model.set({active:!0}),this.model.has("name")?void 0:(this.model.set({name:null}),t=this.model.get("item"),"id"===(null!=(n=this.model.get("item").end)?n.name:void 0)&&(t=t.getParent()),t.getDisplayName(function(t){return function(e,n){return t.model.set({error:e,name:n})}}(this)))},e.prototype.className="list-group-item",e.prototype.events=function(){return{"click .im-active-state":function(t){return function(){return t.model.toggle("active")}}(this)}},e.prototype.tagName="li",e.prototype.template=h.template("export_column_control"),e}(p),e.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return g(e,t),e.prototype.className="container-fluid",e.prototype.initialize=function(t){var n,r,i,o,s,a,u,c,h,p,f,m,g,y,v;if(this.query=t.query,e.__super__.initialize.apply(this,arguments),this.columns=new l,i=this.model.get("format"),n=this.model.get("columns"),!(null!=(y=i.needs)?y.length:void 0))for(v=this.query.views,c=0,f=v.length;f>c;c++)u=v[c],a=this.query.makePath(u),this.columns.add(a,{active:d.any(n,function(t){return t===u})});for(h=0,m=n.length;m>h;h++)r=n[h],this.columns.add(this.query.makePath(r),{active:!0});if(s=this.model.get("nodecolumns"))for(p=0,g=s.length;g>p;p++)o=s[p],this.columns.add(this.query.makePath(o),{active:!1});return this.listenTo(this.columns,"add remove reset change:active",this.setColumns),this.listenTo(this.columns,"add remove reset",this.reRender)},e.prototype.setColumns=function(t){var e,n,r,i,o;return n=function(){var t,n,r,i;for(r=this.columns.where({active:!0}),i=[],t=0,n=r.length;n>t;t++)e=r[t],i.push(e.get("item").toString());return i}.call(this),(r=this.model.get("format").maxColumns)&&null!=t&&n.length>r&&(i=t.get("item").toString(),o=function(){var t,r,o;for(o=[],t=0,r=n.length;r>t;t++)e=n[t],e!==i&&o.push(e);return o}(),n=[i].concat(d.first(o,r-1)),d.defer(function(t){return function(){var r,i,o,s,a;for(o=t.columns.where({active:!0}),a=[],r=0,i=o.length;i>r;r++)e=o[r],a.push(e.set({active:(s=e.get("item").toString(),y.call(n,s)>=0)}));return a}}(this))),this.model.set({columns:n})},e.prototype.tagName="form",e.prototype.template=h.template("export_column_controls"),e.prototype.postRender=function(){var t,e;return e=this.$("ul"),t=this.$(".controls"),this.columns.each(function(t){
return function(n,r){return t.renderChild(r,new i({model:n}),e)}}(this)),this.renderChild("reset",new c({query:this.query,columns:this.columns}),t),this.renderChild("add",new n({query:this.query,columns:this.columns}),t)},e}(p)}).call(this)},{"../../core-view":33,"../../messages":46,"../../mixins/has-typeaheads":62,"../../models/path-set":85,"../../templates":97,"../../utils/path-suggester":126,"../label-view":209,underscore:308}],171:[function(t,e,n){(function(){var n,r,i,o,s={}.hasOwnProperty,a=function(t,e){function n(){this.constructor=t}for(var r in e)s.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};o=t("underscore"),r=t("./main"),i=t("../../templates"),e.exports=n=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return a(e,t),e.prototype.RERENDER_EVENT="change",e.prototype.tagName="form",e.prototype.template=i.template("export_compression_controls"),e.prototype.setCompression=function(t){return function(e){return function(){return e.model.set({compression:t})}}(this)},e.prototype.events=function(){return{"click .im-compress":function(t){return function(){return t.model.toggle("compress")}}(this),"click input[name=gzip]":this.setCompression("gzip"),"click input[name=zip]":this.setCompression("zip")}},e}(r)}).call(this)},{"../../templates":97,"./main":177,underscore:308}],172:[function(t,e,n){(function(){var n,r,i,o,s,a,u,l,c={}.hasOwnProperty,h=function(t,e){function n(){this.constructor=t}for(var r in e)c.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};l=t("underscore"),n=t("../../core-view"),u=t("../../templates"),s=t("../../options"),o=t("../../models/export-formats"),i=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return h(e,t),e.prototype.RERENDER_EVENT="change:dest",e.prototype.initialize=function(){return e.__super__.initialize.apply(this,arguments),this.listenTo(s,"change:Destination.Galaxy.*",this.reRender)},e.prototype.getData=function(){return l.extend(e.__super__.getData.apply(this,arguments),{Galaxy:s.get("Destination.Galaxy")})},e.prototype.getTemplate=function(){switch(this.model.get("dest")){case"Galaxy":return this.galaxyTemplate;default:return function(){return""}}},e.prototype.galaxyTemplate=u.template("export_destination_galaxy_options"),e.prototype.template=function(t){return this.getTemplate()(t)},e.prototype.events=function(){return{"change .im-galaxy-uri-param":"setGalaxyUri","change .im-save-galaxy input":"toggleSaveGalaxy"}},e.prototype.setGalaxyUri=function(t){var e;return e=t.target,s.set("Destination.Galaxy.Current",e.value)},e.prototype.toggleSaveGalaxy=function(){var t,e;return e="Destination.Galaxy.Save",t=s.get(e),s.set(e,!t)},e}(n),a=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return h(e,t),e.prototype.RERENDER_EVENT="change:dest",e.prototype.destinations=function(){var t,e,n,r,i;for(r=s.get("Destinations"),i=[],e=0,n=r.length;n>e;e++)t=r[e],s.get(["Destination",t,"Enabled"])&&i.push(t);return i},e.prototype.getData=function(){return l.extend({destinations:this.destinations()},e.__super__.getData.apply(this,arguments))},e.prototype.template=u.template("export_destination_radios"),e.prototype.setDest=function(t){return function(e){return function(){return e.model.set({dest:t})}}(this)},e.prototype.events=function(){var t;return l.object(function(){var e,n,r,i;for(r=this.destinations(),i=[],e=0,n=r.length;n>e;e++)t=r[e],i.push(["click .im-dest-"+t,this.setDest(t)]);return i}.call(this))},e}(n),e.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return h(e,t),e.prototype.RERENDER_EVENT="change:format",e.prototype.getData=function(){var t,n;return n=this.model.get("has"),t=o.getFormats(n),l.extend({formats:t},e.__super__.getData.apply(this,arguments))},e.prototype.template=u.template("export_destination_options"),e.prototype.postRender=function(){return this.renderChildAt(".im-param-dest",new a({model:this.state})),this.renderChildAt(".im-dest-opts",new i({model:this.state}))},e.prototype.events=function(){var t,e,n,r,i,s;for(t={".change .im-param-name input":"setName"},n=this.model.get("has"),s=o.getFormats(n),r=0,i=s.length;i>r;r++)e=s[r],t["click .im-fmt-"+e.id]=this.setFormat.bind(this,e);return t},e.prototype.setName=function(t){return this.model.set({filename:t.target.value})},e.prototype.setFormat=function(t){return this.model.set({format:t})},e}(n)}).call(this)},{"../../core-view":33,"../../models/export-formats":72,"../../options":93,"../../templates":97,underscore:308}],173:[function(t,e,n){(function(){var n,r,i,o,s,a,u={}.hasOwnProperty,l=function(t,e){function n(){this.constructor=t}for(var r in e)u.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};a=t("underscore"),s=t("../../core-view"),r=t("../label-view"),i=t("../../messages"),o=t("../../templates"),e.exports=n=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return l(e,t),e.prototype.RERENDER_EVENT="change",e.prototype.tagName="form",e.prototype.template=o.template("export_fasta_options"),e.prototype.setFastaExtension=function(t){return this.model.set({fastaExtension:t})},e.prototype.events=function(){return{"change .im-fasta-ext":function(t){return function(e){return t.setFastaExtension(e.target.value)}}(this)}},e}(s)}).call(this)},{"../../core-view":33,"../../messages":46,"../../templates":97,"../label-view":209,underscore:308}],174:[function(t,e,n){(function(){var n,r,i,o,s={}.hasOwnProperty,a=function(t,e){function n(){this.constructor=t}for(var r in e)s.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};o=t("underscore"),i=t("../../core-view"),r=t("../../templates"),e.exports=n=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return a(e,t),e.prototype.RERENDER_EVENT="change",e.prototype.tagName="form",e.prototype.template=r.template("export_flat_file_options"),e.prototype.setHeaderType=function(t){return function(e){return function(){return e.model.set({headerType:t})}}(this)},e.prototype.events=function(){return{"click .im-headers":function(t){return function(){return t.model.toggle("headers")}}(this),"click input[name=hdrs-friendly]":this.setHeaderType("friendly"),"click input[name=hdrs-path]":this.setHeaderType("path")}},e}(i)}).call(this)},{"../../core-view":33,"../../templates":97,underscore:308}],175:[function(t,e,n){(function(){var n,r,i,o,s,a,u,l,c={}.hasOwnProperty,h=function(t,e){function n(){this.constructor=t}for(var r in e)c.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};l=t("underscore"),u=t("../../core-view"),s=t("../../messages"),a=t("../../templates"),o=t("../label-view"),r=t("../../models/export-formats"),i=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return h(e,t),e.prototype.template=l.partial(s.getText,"export.category.Format"),e}(o),e.exports=n=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return h(e,t),e.prototype.tagName="form",e.prototype.template=a.template("export_format_controls"),e.prototype.getData=function(){var t,n;return n=this.model.get("has"),t=r.getFormats(n),l.extend({formats:t},e.__super__.getData.apply(this,arguments))},e.prototype.events=function(){return{"change input:radio":"onChangeFormat"}},e.prototype.onChangeFormat=function(){return this.model.set({format:this.$("input:radio:checked").val()})},e.prototype.postRender=function(){return this.renderChild("heading",new i({model:this.model}),this.$(".im-title"))},e}(u)}).call(this)},{"../../core-view":33,"../../messages":46,"../../models/export-formats":72,"../../templates":97,"../label-view":209,underscore:308}],176:[function(t,e,n){(function(){var n,r,i,o,s,a,u={}.hasOwnProperty,l=function(t,e){function n(){this.constructor=t}for(var r in e)u.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};a=t("underscore"),s=t("../../core-view"),r=t("../label-view"),i=t("../../messages"),o=t("../../templates"),e.exports=n=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return l(e,t),e.prototype.RERENDER_EVENT="change",e.prototype.tagName="form",e.prototype.template=o.template("export_json_options"),e.prototype.setJSONFormat=function(t){return function(e){return function(){return e.model.set({jsonFormat:t})}}(this)},e.prototype.events=function(){return{"click input[name=rows]":this.setJSONFormat("rows"),"click input[name=objects]":this.setJSONFormat("objects")}},e}(s)}).call(this)},{"../../core-view":33,"../../messages":46,"../../templates":97,"../label-view":209,underscore:308}],177:[function(t,e,n){(function(){var n,r,i={}.hasOwnProperty,o=function(t,e){function n(){this.constructor=t}for(var r in e)i.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};r=t("../../core-view"),e.exports=n=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return o(e,t),e.prototype.initialize=function(t){return this.query=t.query,e.__super__.initialize.apply(this,arguments)},e}(r)}).call(this)},{"../../core-view":33}],178:[function(t,e,n){(function(){var n,r,i,o,s,a,u,l,c={}.hasOwnProperty,h=function(t,e){function n(){this.constructor=t}for(var r in e)c.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};l=t("underscore"),n=t("../../core-view"),i=t("../../messages"),u=t("../../templates"),r=t("../../models/export-formats"),a=t("../../mixins/runs-query"),o={compress:null,size:3},e.exports=s=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return h(e,t),e.include(a),e.prototype.initialize=function(t){return this.query=t.query,e.__super__.initialize.apply(this,arguments),this.state.set({preview:""}),this.setPreview(),this.listenTo(this.state,"change:preview",this.reRender),this.listenTo(this.model,"change:format",this.setPreview)},e.prototype.setPreview=function(){var t;return t=this.model.get("format"),"bio"===t.group?this.state.set({preview:"Previews are not supported for bio-informatics formats"}):this.runQuery(o).then(function(t){return function(e){return t.state.set(l.isString(e)?{preview:e}:{preview:JSON.stringify(e,null,2)})}}(this))},e.prototype.template=u.template("export_preview"),e.prototype.getData=function(){var t,n;return n=this.model.get("has"),t=r.getFormats(n),l.extend({formats:t},e.__super__.getData.apply(this,arguments))},e.prototype.events=function(){return{"change .im-export-formats select":"setFormat"}},e.prototype.setFormat=function(t){return this.model.set({format:r.getFormat(t.target.value)})},e}(n)}).call(this)},{"../../core-view":33,"../../messages":46,"../../mixins/runs-query":63,"../../models/export-formats":72,"../../templates":97,underscore:308}],179:[function(t,e,n){(function(){var n,r,i,o,s,a,u,l,c,h,p={}.hasOwnProperty,f=function(t,e){function n(){this.constructor=t}for(var r in e)p.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};h=t("underscore"),c=t("../../core-view"),r=t("../label-view"),i=t("../../messages"),l=t("../../templates"),u=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return f(e,t),e.prototype.getData=function(){return{size:this.model.get("size")||i.getText("rows.All")}},e.prototype.template=h.partial(i.getText,"export.param.Size"),e}(r),o=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return f(e,t),e.prototype.template=h.partial(i.getText,"export.param.Start"),e}(r),n=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return f(e,t),e.prototype.template=h.partial(i.getText,"export.category.Rows"),e}(r),s=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return f(e,t),e.prototype.RERENDER_EVENT="change",e.prototype.getData=function(){return h.extend(e.__super__.getData.apply(this,arguments),{isAll:!(this.model.get("start")||this.model.get("size"))})},e.prototype.template=l.template("export_rows_reset_button"),e.prototype.events=function(){return{"click .btn-reset":"reset","click .im-set-table-page":"setTablePage"}},e.prototype.reset=function(){return this.model.set({start:0,size:null})},e.prototype.setTablePage=function(){return this.model.set(this.model.get("tablePage"))},e}(c),e.exports=a=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return f(e,t),e.prototype.RERENDER_EVENT="change:max",e.prototype.initialize=function(){return e.__super__.initialize.apply(this,arguments),this.model.has("max")||this.model.set({max:null}),this.listenTo(this.model,"change:size",this.updateLabels),this.listenTo(this.model,"change:size change:start",this.updateInputs)},e.prototype.tagName="form",e.prototype.template=l.template("export_row_controls"),e.prototype.events=function(){return{"input input[name=size]":"onChangeSize","input input[name=start]":"onChangeStart"}},e.prototype.updateInputs=function(){var t,e,n,r;return r=this.model.toJSON(),n=r.start,e=r.size,t=r.max,this.$("input[name=size]").val(e||t),this.$("input[name=start]").val(n)},e.prototype.onChangeSize=function(){var t;return t=parseInt(this.$("input[name=size]").val(),10),this.model.set(t&&t!==this.model.get("max")?{size:t}:{size:null})},e.prototype.onChangeStart=function(){return this.model.set({start:parseInt(this.$("input[name=start]").val(),10)})},e.prototype.postRender=function(){return this.renderChild("heading",new n({model:this.state}),this.$(".im-title")),this.renderChild("size",new u({model:this.model}),this.$(".size-label")),this.renderChild("start",new o({model:this.model}),this.$(".start-label")),this.renderChild("reset",new s({model:this.model}),this.$(".im-reset"))},e}(c)}).call(this)},{"../../core-view":33,"../../messages":46,"../../templates":97,"../label-view":209,underscore:308}],180:[function(t,e,n){(function(){var n,r,i,o,s,a,u,l=[].indexOf||function(t){for(var e=0,n=this.length;n>e;e++)if(e in this&&this[e]===t)return e;return-1},c={}.hasOwnProperty,h=function(t,e){function n(){this.constructor=t}for(var r in e)c.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};u=t("underscore"),a=t("../../core-view"),n=t("../../options"),s=t("../../templates"),i=function(){function t(t,e,n,r){this.ident=t,this.formats=null!=n?n:[],this.groups=null!=r?r:null,this.key="export.category."+e}return t.prototype.isFor=function(t){var e;return this.formats.length?(e=t.ext,l.call(this.formats,e)>=0):null!=this.groups?this.groups[t.group]:!0},t}(),r=[new i("dest","Destination"),new i("opts-json","JsonFormat",["json"]),new i("opts-fasta","FastaFormat",["fasta"]),new i("columns","Columns"),new i("rows","Rows",[],{flat:!0,machine:!0}),new i("compression","Compression"),new i("column-headers","ColumnHeaders",["tsv","csv"]),new i("preview","Preview")],e.exports=o=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return h(e,t),e.prototype.tagName="ul",e.prototype.RERENDER_EVENT="change",e.prototype.className="nav nav-pills nav-stacked im-export-tab-menu",e.prototype.template=s.template("export_tab_menu",{variable:"data"}),e.prototype.getTabs=function(){var t,e,n,i;for(i=[],e=0,n=r.length;n>e;e++)t=r[e],t.isFor(this.model.get("format"))&&i.push(t);return i},e.prototype.getData=function(){var t;return t=this.getTabs(),u.extend({tabs:t},e.__super__.getData.apply(this,arguments))},e.prototype.setTab=function(t){return function(e){return function(){return e.state.get("pinned")?void 0:e.model.set({tab:t})}}(this)},e.prototype.setPinned=function(t){return function(e){return function(){return e.state.set(e.state.get("pinned")===t?{pinned:!1}:{pinned:t}),e.model.set({tab:t})}}(this)},e.prototype.next=function(){var t,e,n,r;return r=function(){var t,e,r,i;for(r=this.getTabs(),i=[],t=0,e=r.length;e>t;t++)n=r[t],i.push(n.ident);return i}.call(this),t=u.indexOf(r,this.model.get("tab")),e=t+1,e===r.length&&(e=0),this.model.set({tab:r[e]})},e.prototype.prev=function(){var t,e,n,r;return r=function(){var t,e,r,i;for(r=this.getTabs(),i=[],t=0,e=r.length;e>t;t++)n=r[t],i.push(n.ident);return i}.call(this),t=u.indexOf(r,this.model.get("tab")),e=0===t?r.length-1:t-1,this.model.set({tab:r[e]})},e.prototype.events=function(){var t,e,i;return e=n.get("Events.ActivateTab"),t=u.object(function(){var t,n,o;for(o=[],t=0,n=r.length;n>t;t++)i=r[t].ident,o.push([""+e+" .im-tab-"+i,this.setTab(i)]);return o}.call(this)),"mouseenter"===e&&u.extend(t,u.object(function(){var t,e,n;for(n=[],t=0,e=r.length;e>t;t++)i=r[t].ident,n.push(["click .im-tab-"+i,this.setPinned(i)]);return n}.call(this))),t},e}(a)}).call(this)},{"../../core-view":33,"../../options":93,"../../templates":97,underscore:308}],181:[function(t,e,n){(function(){var n,r,i,o,s,a,u,l,c,h,p,f=function(t,e){return function(){return t.apply(e,arguments)}},d={}.hasOwnProperty,m=function(t,e){function n(){this.constructor=t}for(var r in e)d.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};r=t("../../event"),n=t("../../core-view"),u=t("../../options"),c=t("../../mixins/sets-path-names"),p=t("../../models/summary-items"),a=t("../../models/numeric-range"),h=t("./summary-heading"),i=t("./items"),l=t("./selected-count"),s=t("./visualisation"),e.exports=o=function(t){function e(){return this.Model=f(this.Model,this),e.__super__.constructor.apply(this,arguments)}return m(e,t),e.include(c),e.prototype.className=function(){return"im-facet-view"},e.prototype.modelEvents=function(){return{"change:min change:max":this.setLimits}},e.prototype.stateEvents=function(){return{"change:open":this.honourOpenness}},e.prototype.parameters=["query","view"],e.prototype.optionalParameters=["noTitle"],e.prototype.Model=function(){return new p({query:this.query,view:this.view})},e.prototype.initialize=function(){return e.__super__.initialize.apply(this,arguments),this.range=new a,this.setPathNames(),this.setLimits()},e.prototype.initState=function(){return this.state.has("open")?void 0:this.state.set({open:u.get("Facets.Initally.Open")})},e.prototype.setLimits=function(){return this.model.get("numeric")?this.range.setLimits(this.model.pick("min","max")):void 0},e.prototype.invariants=function(){return{hasQuery:"No query",hasAttrView:"The view is not an attribute: "+this.view,modelIsSummaryItemsModel:"The model is not a summary items model: "+this.model}},e.prototype.modelIsSummaryItemsModel=function(){return this.model instanceof p},e.prototype.hasQuery=function(){return null!=this.query},e.prototype.hasAttrView=function(){var t;return null!=(t=this.view)&&"function"==typeof t.isAttribute?t.isAttribute():void 0},e.prototype.postRender=function(){return this.renderTitle(),this.renderVisualisation(),this.renderSelectedCount(),this.renderItems(),this.honourOpenness()},e.prototype.renderTitle=function(){return this.noTitle?void 0:this.renderChild("title",new h({model:this.model,state:this.state}))},e.prototype.renderVisualisation=function(){return this.renderChild("viz",new s({model:this.model,state:this.state,range:this.range}))},e.prototype.renderSelectedCount=function(){return this.renderChild("count",new l({model:this.model,range:this.range}))},e.prototype.renderItems=function(){return this.renderChild("facet",new i({model:this.model,state:this.state,range:this.range}))},e.prototype.honourOpenness=function(){var t,e,n;return e=this.state.get("open"),n=this.state.previous("open"),t=this.$("dd.im-facet"),e?(t.slideDown(),this.trigger("opened",this)):(t.slideUp(),this.trigger("closed",this)),null!=n&&e!==n?this.trigger("toggled",this):void 0},e.prototype.events=function(){return{"click .im-summary-heading":"toggle"}},e.prototype.toggle=function(){return this.state.toggle("open")},e.prototype.close=function(){return this.state.set({open:!1})},e.prototype.open=function(){return this.state.set({open:!0})},e}(n)}).call(this)},{"../../core-view":33,"../../event":41,"../../mixins/sets-path-names":64,"../../models/numeric-range":80,"../../models/summary-items":90,"../../options":93,"./items":183,"./selected-count":190,"./summary-heading":191,"./visualisation":196}],182:[function(t,e,n){(function(){var n,r,i,o,s,a,u,l,c={}.hasOwnProperty,h=function(t,e){function n(){this.constructor=t}for(var r in e)c.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};a=t("d3-browserify"),l=t("underscore"),i=t("../../options"),r=t("../../messages"),o=t("./visualisation-base"),t("../../messages/summary"),s=t("../../utils/casts").bool,u=function(t,e){return a.scale.linear().domain(t).range(e)},e.exports=n=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return h(e,t),e.prototype.className="im-summary-histogram",e.prototype.chartHeight=50,e.prototype.leftMargin=25,e.prototype.rightMargin=25,e.prototype.bottomMargin=.5,e.prototype.stepWidth=0,e.prototype.allCountsAreOne=function(){return 1===this.model.get("maxCount")},e.prototype.initialize=function(){return e.__super__.initialize.apply(this,arguments),this.listenTo(this.model.items,"add remove change:selected",function(t){return function(){return t.updateChart()}}(this))},e.prototype.invariants=function(){return{hasItems:"No items, or not the right thing: "+this.model.items}},e.prototype.hasItems=function(){var t,e;return null!=(null!=(t=this.model)&&null!=(e=t.items)?e.models:void 0)},e.prototype.initChart=function(){return e.__super__.initChart.apply(this,arguments),this.stepWidth=(this.chartWidth-(this.leftMargin+this.rightMargin+1))/this.model.items.size()},e.prototype.shouldNotDrawChart=function(){return this.allCountsAreOne()},e.prototype.getScales=function(){var t,e,n,r,i,o;return e=[0,this.model.items.size()],t=[0,this.model.get("maxCount")],o=[0,this.chartHeight-this.bottomMargin],r=[this.leftMargin,this.chartWidth-this.rightMargin],n=u(e,r),i=u(t,o),{x:n,y:i}},e.prototype.selectNodes=function(t){return t.selectAll("rect")},e.prototype.getChartData=function(t){return this.model.items.models.slice()},e.prototype.enter=function(t,e){return t.append("rect").classed("im-item-bar",!0).classed("squashed",this.stepWidth<4).attr("width",this.stepWidth).attr("y",this.chartHeight).attr("height",0).attr("x",function(t,n){return e.x(n)}).on("click",function(t){return t.toggle("selected")}).on("mouseover",function(t){return t.mousein()}).on("mouseout",function(t){return t.mouseout()})},e.prototype.update=function(t,e){var n,r,o,s,a;return a=i.get("D3.Transition"),n=a.Duration,r=a.Easing,o=this.chartHeight-this.bottomMargin,s=function(t){return e.y(t.get("count"))},t.classed("selected",function(t){return t.get("selected")}),t.transition().duration(n).ease(r).attr("height",s).attr("y",function(t){return o-s(t)})},e.prototype.drawAxes=function(t,e){var n;return n=this.chartHeight-this.bottomMargin,t.append("line").classed("x-axis",!0).attr("x1",0).attr("x2",this.chartWidth).attr("y1",n).attr("y2",n)},e}(o)}).call(this)},{"../../messages":46,"../../messages/summary":57,"../../options":93,"../../utils/casts":104,"./visualisation-base":195,"d3-browserify":276,underscore:308}],183:[function(t,e,n){(function(){var n,r,i,o,s,a,u,l,c,h={}.hasOwnProperty,p=function(t,e){function n(){this.constructor=t}for(var r in e)h.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};c=t("underscore"),n=t("../../core-view"),l=t("../../templates"),u=t("./summary-stats"),a=t("./summary-items"),o=t("./only-one-item"),i=t("./no-results"),s=["error","initialized"],e.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return p(e,t),e.prototype.className="im-facet-items",e.prototype.initialize=function(t){return this.range=t.range,e.__super__.initialize.apply(this,arguments)},e.prototype.invariants=function(){return{modelHasRequiredAttrs:"Model only has the following attributes: "+c.keys(this.model.attributes)}},e.prototype.modelHasRequiredAttrs=function(){return 2===c.intersection(s,c.keys(this.model.attributes)).length},e.prototype.modelEvents=function(){return{destroy:this.stopListening}},e.prototype.template=l.template("facet_frequency"),e.prototype.RERENDER_EVENT="change:error change:numeric change:uniqueValues change:initialized",e.prototype.postRender=function(){return this.model.get("initialized")?this.renderChild("items",this.getItems()):void 0},e.prototype.getItems=function(){switch(!1){case!this.model.get("numeric"):return new u({model:this.model,range:this.range});case!(this.model.get("uniqueValues")>1):return new a({model:this.model});case 1!==this.model.get("uniqueValues"):return new o({model:this.model,state:this.state});default:return new i({model:this.state})}},e}(n)}).call(this)},{"../../core-view":33,"../../templates":97,"./no-results":184,"./only-one-item":186,"./summary-items":193,"./summary-stats":194,underscore:308}],184:[function(t,e,n){(function(){var n,r,i,o={}.hasOwnProperty,s=function(t,e){function n(){this.constructor=t}for(var r in e)o.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};n=t("../../core-view"),i=t("../../templates"),t("../../messages/summary"),e.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return s(e,t),e.prototype.className="im-no-results",e.prototype.stateEvents=function(){return{"change:pathName":this.reRender}},e.prototype.renderRequires=["pathName"],e.prototype.template=i.template("summary_no_results"),e}(n)}).call(this)},{"../../core-view":33,"../../messages/summary":57,"../../templates":97}],185:[function(t,e,n){(function(){var n,r,i,o,s,a,u,l,c,h,p,f={}.hasOwnProperty,d=function(t,e){function n(){this.constructor=t}for(var r in e)f.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};l=t("d3-browserify"),n=t("jquery"),p=t("underscore"),s=t("../../options"),r=t("../../messages"),t("../../messages/summary"),a=t("./visualisation-base"),i=25,h=function(t,e){return l.scale.linear().domain(t).range(e)},u=function(t,e){var n,r,i,o;return o=function(){var r,i,o,s;for(o=[0,1],s=[],r=0,i=o.length;i>r;r++)n=o[r],s.push(t(e+n));return s}(),i=o[0],r=o[1],{min:i,max:r}},c=function(t,e){return function(n){return t>n?t:n>e?e:n}},e.exports=o=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return d(e,t),e.prototype.className="im-numeric-distribution",e.prototype.leftMargin=25,e.prototype.bottomMargin=18,e.prototype.rightMargin=14,e.prototype.chartHeight=70,e.prototype.__selecting_paths=!1,e.prototype.selection=null,e.prototype.initialize=function(t){return this.range=t.range,e.__super__.initialize.apply(this,arguments),this.listenTo(this.range,"change reset",this.onChangeRange)},e.prototype.invariants=function(){return{hasRange:"No range",hasHistogramModel:"Wrong model: "+this.model}},e.prototype.hasRange=function(){return null!=this.range},e.prototype.hasHistogramModel=function(){var t;return null!=(null!=(t=this.model)?t.getHistogram:void 0)},e.prototype.selectNodes=function(t){return t.selectAll("rect")},e.prototype.getChartData=function(t){var e,n,r,i,o,s;for(null==t&&(t=this.getScales()),o=this.model.getHistogram(),s=[],n=r=0,i=o.length;i>r;n=++r)e=o[n],s.push({count:e,bucket:n+1,range:u(t.bucketToVal,n+1)});return s},e.prototype.initChart=function(){return e.__super__.initChart.apply(this,arguments),this.bucketWidth=(this.model.get("max")-this.model.get("min"))/this.model.get("buckets"),this.stepWidth=(this.chartWidth-(this.leftMargin+1))/this.model.get("buckets")},e.prototype.getScales=function(){var t,e,n,r,i,o,s,a,u,f,d,m,g;return g=this.model.pick("min","max"),i=g.min,r=g.max,s=this.model.get("buckets"),n=this.model.getHistogram(),o=l.max(n),e=[0,o],f=[i,r],t=[1,s+1],d=[this.leftMargin,this.chartWidth-this.rightMargin],m=[0,this.chartHeight-this.bottomMargin],u=function(t){return p.compose(c(i,r),h(t,f))},a={x:h(t,d),y:h(e,m),valToX:h(f,d),xToVal:u(d),bucketToVal:u(t)}},e.prototype.isIntish=function(){var t;return"int"===(t=this.model.get("type"))||"Integer"===t||"long"===t||"Long"===t||"short"===t||"Short"===t},e.prototype.getRounder=function(){return this.isIntish()?Math.round:p.identity},e.prototype.enter=function(t,e){var i,o,s,a,u;return null==e&&(e=this.getScales()),o=this.el,u=this.getRounder(),a=this.chartHeight,i=function(t){return function(e,n){return e.count>0?t.range.set(e.range):t.range.nullify()}}(this),s=function(t){var e,n,i,o;return o=t.range,i=o.min,n=o.max,e=t.count,r.getText("summary.Bucket",{count:e,range:{min:u(i),max:u(n)}})},t.append("rect").attr("x",function(t,n){return e.x(t.bucket)}).attr("width",function(t){return Math.max(0,e.x(t.bucket+1)-e.x(t.bucket))}).attr("y",a-this.bottomMargin).attr("height",0).classed("im-bucket",!0).classed("im-null-bucket",function(t){return null===t.bucket}).on("click",i).each(function(t){return n(this).tooltip({container:o,title:s(t)})})},e.prototype.update=function(t,e){var n,r,i,o,a,u;return null==e&&(e=this.getScales()),o=this.chartHeight,i=this.bottomMargin,u=s.get("D3.Transition"),n=u.Duration,r=u.Easing,a=function(t){return e.y(t.count)},t.transition().duration(n).ease(r).attr("height",a).attr("y",function(t){return o-i-a(t)-.5})},e.prototype.drawAxes=function(t,e){var i,o,a,u;return null==t&&(t=this.getCanvas()),null==e&&(e=this.getScales()),o=this.chartHeight-this.bottomMargin-.5,a=this.el,s.get("Facets.DrawAverageLine")&&t.append("line").classed("average",!0).attr("x1",e.valToX(this.model.get("average"))).attr("x2",e.valToX(this.model.get("average"))).attr("y1",0).attr("y2",o).each(function(){return n(this).tooltip({container:a,title:r.getText("summary.Average")})}),t.append("line").classed("axis",!0).attr("x1",0).attr("x2",this.chartWidth).attr("y1",o).attr("y2",o),i=t.append("svg:g"),u=e.x.ticks(this.model.get("buckets")),i.selectAll("line").data(u).enter().append("svg:line").classed("tick-line",!0).attr("x1",e.x).attr("x2",e.x).attr("y1",this.chartHeight-.75*this.bottomMargin).attr("y2",this.chartHeight-this.bottomMargin)},e.prototype.events=function(){return{mouseout:function(t){return function(){return t.__selecting_paths=!1}}(this)}},e.prototype.drawSelection=function(t,e){return null==t||0>=t||e>=this.chartWidth?this.removeSelection():(null==this.selection&&(this.selection=this.getCanvas().append("svg:rect").attr("y",0).attr("height",.9*this.chartHeight).classed("rubberband-selection",!0)),this.selection.attr("x",t).attr("width",e))},e.prototype.onChangeRange=function(){var t,e,n,r,i,o;return this.shouldDrawBox()?(n=this.getScales(),o=this.range.toJSON(),e=o.min,t=o.max,r=n.valToX(e),i=n.valToX(t)-r,this.drawSelection(r,i)):this.removeSelection()},e.prototype.removeSelection=function(){var t;return null!=(t=this.selection)&&t.remove(),this.selection=null},e.prototype.shouldDrawBox=function(){return this.range.isNotAll()},e.prototype.remove=function(){var t;return this.removeSelection(),null!=(t=this.paper)&&t.remove(),e.__super__.remove.apply(this,arguments)},e}(a)}).call(this)},{"../../messages":46,"../../messages/summary":57,"../../options":93,"./visualisation-base":195,"d3-browserify":276,jquery:305,underscore:308}],186:[function(t,e,n){(function(){var n,r,i,o={}.hasOwnProperty,s=function(t,e){function n(){this.constructor=t}for(var r in e)o.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};n=t("../../core-view"),i=t("../../templates"),e.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return s(e,t),e.prototype.className="im-only-one",e.prototype.modelEvents=function(){return{change:this.reRender}},e.prototype.stateEvents=function(){return{change:this.reRender}},e.prototype.template=i.template("only_one_item"),e}(n)}).call(this)},{"../../core-view":33,"../../templates":97}],187:[function(t,e,n){
(function(){var n,r,i,o,s,a,u,l,c,h,p,f,d,m,g,y,v={}.hasOwnProperty,b=function(t,e){function n(){this.constructor=t}for(var r in e)v.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};y=t("underscore"),n=t("jquery"),l=t("d3-browserify"),o=t("../../options"),u=t("./visualisation-base"),i=function(t){return t.data.get("id")},r=l.layout.pie().value(function(t){return t.get("count")}),a={startAngle:0,endAngle:0},p=function(){var t,e;return t=o.get("PieColors"),e=y.isFunction(t)?t:l.scale[t](),function(t){return e(t.data.get("id"))}},d=function(t){var e;return null!=(e=t.get("currentPieCoords"))?e:a},g=function(t){return t.data.get("visible")?1:.25},f=function(t,e,n){return{startAngle:t,endAngle:e,selected:n.get("selected")?1:0}},h=function(t){return function(e){var n,r,i,o,s,a,u;return u=e.startAngle,i=e.endAngle,n=e.data,s=n,a=d(s),r=f(u,i,s),o=l.interpolateObject(a,r),s.set({currentPieCoords:o(1)}),function(e){return t(o(e))}}},m=function(t){return(t.endAngle+t.startAngle)/2>Math.PI},c=function(t,e,n){return l.svg.arc().startAngle(function(t){return t.startAngle}).endAngle(function(t){return t.endAngle}).innerRadius(function(t){return e+t.selected*n}).outerRadius(function(e){return t+e.selected*n})},e.exports=s=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return b(e,t),e.prototype.chartWidth=120,e.prototype.chartHeight=120,e.prototype.className="im-pie-chart",e.prototype.initialize=function(){return e.__super__.initialize.apply(this,arguments),this.listenTo(this.model.items,"change:selected change:visible",this.update),this.listenTo(o,"change:PieColors",this.onChangePalette),this.onChangePalette()},e.prototype.onChangePalette=function(){return this.colour=p(),this.update()},e.prototype._drawD3Chart=function(){var t,e,n,r,i,o,s,a,u;return n=this.chartHeight,a=this.$el.closest(":visible").width(),o=.4*n,r=.1*n,s=.08*n,e=l.select(this.el).append("svg").attr("class","chart").attr("height",n).attr("width",a),this.arc=c(o,r,s),this.arc_group=e.append("svg:g").attr("class","arc").attr("transform","translate("+a/2+","+n/2+")"),t=e.append("svg:g").attr("class","center_group").attr("transform","translate("+a/2+","+n/2+")"),i=e.append("svg:g").attr("class","label_group").attr("transform","translate("+a/2+","+n/2+")"),u=t.append("svg:circle").attr("fill","white").attr("r",r),this.update()},e.prototype.enter=function(t){var e,r,i,o;return r=this.el,o=this.model.items.reduce(function(t,e){return t+e.get("count")},0),i=function(t){return(t.data.get("count")/o*100).toFixed(1)},e=function(t){var e,o,s;return e=n(this),s=""+t.data.get("item")+": "+i(t)+"%",o=m(t)?"left":"right",e.tooltip({title:s,placement:o,container:r})},t.append("svg:path").attr("class","donut-arc").on("click",function(t){return t.data.toggle("selected")}).on("mouseover",function(t){return t.data.mousein()}).on("mouseout",function(t){return t.data.mouseout()}).each(e)},e.prototype.exit=function(t){return t.remove()},e.prototype.getChartData=function(){return this.model.items.models.slice()},e.prototype.update=function(){var t,e,n,s;if(null!=this.arc_group)return n=this.arc_group.selectAll("path").data(r(this.getChartData()),i),this.exit(n.exit()),this.enter(n.enter()),s=o.get("D3.Transition"),t=s.DurationShort,e=s.Easing,n.attr("fill",this.colour),n.transition().duration(t).ease(e).style("opacity",g).attrTween("d",h(this.arc))},e}(u)}).call(this)},{"../../options":93,"./visualisation-base":195,"d3-browserify":276,jquery:305,underscore:308}],188:[function(t,e,n){(function(){var n,r,i,o,s={}.hasOwnProperty,a=function(t,e){function n(){this.constructor=t}for(var r in e)s.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};o=t("underscore"),n=t("../../core-view"),i=t("../../templates"),e.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return a(e,t),e.prototype.className="im-facet-surrogate",e.prototype.initialize=function(t){return this.above=t.above,e.__super__.initialize.apply(this,arguments)},e.prototype.template=i.template("row_surrogate"),e.prototype.getData=function(){return o.extend(e.__super__.getData.apply(this,arguments),{above:this.above})},e.prototype.postRender=function(){return this.$el.addClass(this.above?"above":"below")},e.prototype.remove=function(){return this.$el.fadeOut("fast",function(t){return function(){return e.__super__.remove.call(t)}}(this))},e}(n)}).call(this)},{"../../core-view":33,"../../templates":97,underscore:308}],189:[function(t,e,n){(function(){var n,r,i,o,s,a,u,l={}.hasOwnProperty,c=function(t,e){function n(){this.constructor=t}for(var r in e)l.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};u=t("underscore"),r=t("../../core-view"),s=t("../../templates"),n=t("../../core/checkbox"),o=t("./row-surrogate"),t("../../messages/summary"),a=function(t){return!!t},e.exports=i=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return c(e,t),e.prototype.RERENDER_EVENT="change:count change:item change:symbol change:share",e.prototype.tagName="tr",e.prototype.className="im-facet-row",e.prototype.modelEvents=function(){return{"change:visible":this.onChangeVisibility,"change:hover":this.onChangeHover,"change:selected":this.onChangeSelected}},e.prototype.invariants=function(){return{modelHasCollection:"No collection on model"}},e.prototype.modelHasCollection=function(){var t;return null!=(null!=(t=this.model)?t.collection:void 0)},e.prototype.template=s.template("facet_row"),e.prototype.getData=function(){var t,n,r,i;return t=this.model.collection.getMaxCount(),i=this.model.get("count")/t,n=(i/2+.5).toFixed(),r=(100*i).toFixed(),u.extend(e.__super__.getData.apply(this,arguments),{percent:r,opacity:n,max:t})},e.prototype.onRenderError=function(t){return console.error(t)},e.prototype.postRender=function(){return this.addCheckbox(),this.onChangeVisibility(),this.onChangeHover(),this.onChangeSelected()},e.prototype.addCheckbox=function(){return this.renderChildAt(".checkbox",new n({model:this.model,attr:"selected"}))},e.prototype.onChangeVisibility=function(){return this.$el.toggleClass("im-hidden",!this.model.get("visible"))},e.prototype.onChangeHover=function(){var t;return t=a(this.model.get("hover")),this.$el.toggleClass("hover",t),t?this.showSurrogateUnlessVisible():this.removeSurrogate()},e.prototype.onChangeSelected=function(){return this.$el.toggleClass("im-selected",this.model.get("selected"))},e.prototype.removeSurrogate=function(){return this.removeChild("surrogate")},e.prototype.showSurrogateUnlessVisible=function(){var t,e,n,r,i;return this.removeSurrogate(),this.isVisible()?void 0:(e=this.isAbove(),r=new o({model:this.model,above:e}),t=r.$el,i=this.getTable(),this.renderChild("surrogate",r,i),n=t.css(e?{top:i.scrollTop()}:{bottom:0-i.scrollTop()}))},e.prototype.getTable=function(){return this.$el.closest(".im-item-table")},e.prototype.events=function(){return{click:"handleClick"}},e.prototype.handleClick=function(t){return t.stopPropagation(),this.model.toggle("selected")},e.prototype.isBelow=function(){var t;return t=this.getTable(),this.$el.offset().top+this.$el.outerHeight()>t.offset().top+t.outerHeight()},e.prototype.isAbove=function(){var t;return t=this.getTable(),this.$el.offset().top<t.offset().top},e.prototype.isVisible=function(){return!(this.isAbove()||this.isBelow())},e}(r)}).call(this)},{"../../core-view":33,"../../core/checkbox":34,"../../messages/summary":57,"../../templates":97,"./row-surrogate":188,underscore:308}],190:[function(t,e,n){(function(){var n,r,i,o,s,a,u,l,c,h,p,f={}.hasOwnProperty,d=function(t,e){function n(){this.constructor=t}for(var r in e)f.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};p=t("underscore"),n=t("../../core-view"),i=t("../../templates"),t("../../messages/summary"),l=function(t,e){return null==t&&(t=p.identity),p.reduce(e,function(e,n){return e+t(n)},0)},c=p.partial(l,function(t){return t.count}),h=function(t,e,n){return l(p.partial(a,t,e),n)},o=function(t,e,n){var r,i;return t?(i=t.max-t.min,r=t.min<e?Math.min(t.max,n)-e:n-Math.max(t.min,e),r/i):0},s=function(t,e){return function(n){return n.min>=t&&n.max<=e}},u=function(t,e){return function(n){return n.min<t&&n.max>t||n.max>e&&n.min<e}},a=function(t,e,n){return n.count*o(n,t,e)},e.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return d(e,t),e.prototype.className="im-summary-selected-count",e.prototype.template=i.template("summary-selected-count"),e.prototype.stateEvents=function(){return{"change:selectedCount change:isApprox":this.reRender}},e.prototype.initialize=function(t){return this.range=t.range,e.__super__.initialize.apply(this,arguments),this.listenTo(this.model.items,"change:selected",this.estimateSelectionSize),this.listenTo(this.range,"change",this.estimateSelectionSize)},e.prototype.estimateSelectionSize=function(){return this.model.get("initialized")?this.model.get("numeric")?this.estimateSelectedInRange():this.sumSelectedItems():void 0},e.prototype.preRender=function(){return this.rendered?this.state.get("selectedCount")?void 0:this.$el.slideUp():this.$el.hide()},e.prototype.postRender=function(){return this.state.get("selectedCount")?this.$el.slideDown():void 0},e.prototype.sumSelectedItems=function(){var t,e;return e=this.model.items.where({selected:!0}),t=l(function(t){return t.get("count")},e),this.state.set({isApprox:!1,selectedCount:t})},e.prototype.estimateSelectedInRange=function(){var t,e,n,r,i,o,a;return this.range.isAll()?this.state.unset("selectedCount"):(a=this.range.toJSON(),i=a.min,r=a.max,n=this.getHistogram(),e=n.filter(s(i,r)),o=n.filter(u(i,r)),t=Math.round(c(e)+h(i,r,o)),this.state.set({isApprox:!0,selectedCount:t}))},e.prototype.getHistogram=function(){var t,e,n,r,i,o,s,a,u;for(t=this.model.getHistogram(),r=this.model.get("max"),i=this.model.get("min"),o=(r-i)/t.length,u=[],n=s=0,a=t.length;a>s;n=++s)e=t[n],u.push({count:e,min:i+n*o,max:i+o+n*o});return u},e}(n)}).call(this)},{"../../core-view":33,"../../messages/summary":57,"../../templates":97,underscore:308}],191:[function(t,e,n){(function(){var n,r,i,o,s={}.hasOwnProperty,a=function(t,e){function n(){this.constructor=t}for(var r in e)s.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};o=t("underscore"),n=t("../../core-view"),i=t("../../templates"),t("../../messages/summary"),e.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return a(e,t),e.prototype.className="im-summary-heading",e.prototype.modelEvents=function(){return{change:this.reRender,destroy:this.stopListening}},e.prototype.stateEvents=function(){return{change:this.reRender}},e.prototype.renderRequires=["numeric","available","got","uniqueValues"],e.prototype.template=i.template("summary_heading"),e.prototype.getData=function(){return o.extend(e.__super__.getData.apply(this,arguments),{filtered:null!=this.model.get("filteredCount")})},e}(n)}).call(this)},{"../../core-view":33,"../../messages/summary":57,"../../templates":97,underscore:308}],192:[function(t,e,n){(function(){var n,r,i,o,s,a,u,l,c,h,p,f={}.hasOwnProperty,d=function(t,e){function n(){this.constructor=t}for(var r in e)f.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};p=t("underscore"),r=t("../../core-view"),l=t("../../templates"),s=t("../../messages"),t("../../messages/summary"),c=function(t){return!!t},h=function(t){var e;return e={},e.multi="ONE OF"===t.multi?"NONE OF":"ONE OF",e.single="=="===t.single?"!=":"==",e.absent="IS NULL"===t.absent?"IS NOT NULL":"IS NULL",e},i=function(t){return null!=t?(t.preventDefault(),t.stopPropagation()):void 0},n={single:"==",multi:"ONE OF",absent:"IS NULL"},a={tab:"tsv",csv:"csv",xml:"xml",json:"json"},o=10,e.exports=u=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return d(e,t),e.prototype.RERENDER_EVT="change",e.prototype.initialize=function(){return e.__super__.initialize.apply(this,arguments),this.listenTo(this.model.items,"change:selected",this.reRender)},e.prototype.invariants=function(){return{viewIsAttribute:"No view, or view not Attribute: "+this.view,hasCollection:"No collection"}},e.prototype.viewIsAttribute=function(){var t,e;return null!=(t=this.model)&&null!=(e=t.view)&&"function"==typeof e.isAttribute?e.isAttribute():void 0},e.prototype.hasCollection=function(){var t;return null!=(null!=(t=this.model)?t.items:void 0)},e.prototype.template=l.template("summary_items_controls"),e.prototype.getData=function(){var t;return t=c(this.model.items.findWhere({selected:!0})),p.extend(e.__super__.getData.apply(this,arguments),{anyItemSelected:t})},e.prototype.postRender=function(){return this.activateTooltips(),this.activatePopovers()},e.prototype.activateTooltips=function(){return this.$btns=this.$(".btn[title]").tooltip({placement:"top",container:this.el})},e.prototype.activatePopovers=function(){return this.$(".im-download").popover({placement:"top",html:!0,container:this.el,title:s.getText("summary.DownloadFormat"),content:this.getDownloadPopover(),trigger:"manual"})},e.prototype.downloadPopoverTemplate=l.template("download_popover"),e.prototype.getDownloadPopover=function(){return this.downloadPopoverTemplate(p.extend(this.getBaseData(),{query:this.model.query,path:this.model.view.toString(),formats:a}))},e.prototype.events=function(){return{"click .im-export-summary":"exportSummary",click:"hideTooltips","click .btn-cancel":"unsetSelection","click .btn-toggle-selection":"toggleSelection","click .im-filter-group .dropdown-toggle":"toggleDropdown","click .im-download":"toggleDownloadPopover","click .im-filter-in":p.bind(this.addConstraint,this,n),"click .im-filter-out":p.bind(this.addConstraint,this,h(n))}},e.prototype.exportSummary=function(t){return t.stopImmediatePropagation(),!0},e.prototype.hideTooltips=function(){var t;return null!=(t=this.$btns)?t.tooltip("hide"):void 0},e.prototype.unsetSelection=function(t){return this.changeSelection(function(t){return t.set({selected:!1})})},e.prototype.toggleSelection=function(t){return this.changeSelection(function(t){return t.get("visible")?t.toggle("selected"):void 0})},e.prototype.toggleDropdown=function(){return this.$(".im-filter-group").toggleClass("open")},e.prototype.toggleDownloadPopover=function(){return this.$(".im-download").popover("toggle")},e.prototype.addConstraint=function(t,e){var n,r,s,a,u;return i(e),a=function(){var t,e,n,i;for(n=this.model.items.where({selected:!0}),i=[],t=0,e=n.length;e>t;t++)r=n[t],i.push(r.get("item"));return i}.call(this),s=this.model.items.where({selected:!1}),0===s.length?this.model.set({error:new Error("All items are selected")}):(n=p.any(a,function(t){return null==t}),!n&&this.model.hasAll()&&o>(u=a.length)&&u>s.length?this.constrainTo(h(t),function(){var t,e,n;for(n=[],t=0,e=s.length;e>t;t++)r=s[t],n.push(r.get("item"));return n}()):this.constrainTo(t,a))},e.prototype.constrainTo=function(t,e){var n,r,i,o,s;return(null!=e?e.length:void 0)?(o=this.model.query,i=this.model.view.toString(),s=e[0],r=function(){switch(!1){case!(e.length>1):return{op:t.multi,values:e};case null==s:return{op:t.single,value:String(s)};default:return{op:t.absent}}}(),!/or/.test(o.constraintLogic)&&"ONE OF"===r.op&&(n=p.findWhere(o.constraints,{path:i,op:"ONE OF"}))?(n.values=r.values,o.trigger("change:constraints",o.constraints)):o.addConstraint(p.extend(r,{path:i}))):this.model.set({error:new Error("No values are selected")})},e.prototype.changeSelection=function(t){return this.model.items.each(function(e){return p.defer(t,e)})},e}(r)}).call(this)},{"../../core-view":33,"../../messages":46,"../../messages/summary":57,"../../templates":97,underscore:308}],193:[function(t,e,n){(function(){var n,r,i,o,s,a,u,l,c,h,p,f=function(t,e){return function(){return t.apply(e,arguments)}},d={}.hasOwnProperty,m=function(t,e){function n(){this.constructor=t}for(var r in e)d.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};p=t("underscore"),n=t("backbone"),r=t("../../core-view"),c=t("../../templates"),s=t("../../messages"),a=t("../../mixins/sets-path-names"),l=t("./summary-items-controls"),i=t("./row"),t("../../messages/summary"),o=function(t){return null!=t?(t.preventDefault(),t.stopPropagation()):void 0},h=function(t){return"row_"+t.get("id")},e.exports=u=function(t){function e(){return this.filterItems=f(this.filterItems,this),e.__super__.constructor.apply(this,arguments)}return m(e,t),e.include(a),e.prototype.tagName="div",e.prototype.className="im-summary-items",e.prototype.stateEvents=function(){return{"change:error":this.setErrOnModel}},e.prototype.setErrOnModel=function(){return this.model.set(this.state.pick("error"))},e.prototype.initialize=function(){return e.__super__.initialize.apply(this,arguments),this.listenTo(this.model.items,"add",this.addItem),this.listenTo(this.model.items,"remove",this.removeItem),this.listenTo(this.state,"change:typeName change:endName",this.reRender),this.setPathNames()},e.prototype.invariants=function(){return{modelHasItems:"expected a SummaryItems model, got: "+this.model,modelCanHasMore:"expected the correct model methods, got: "+this.model}},e.prototype.modelHasItems=function(){var t;return(null!=(t=this.model)?t.items:void 0)instanceof n.Collection},e.prototype.modelCanHasMore=function(){var t;return p.isFunction(null!=(t=this.model)?t.hasMore:void 0)},e.prototype.template=c.template("summary_items"),e.prototype.getData=function(){return p.extend(e.__super__.getData.apply(this,arguments),{hasMore:this.model.hasMore(),colClasses:p.result(this,"colClasses"),colHeaders:p.result(this,"colHeaders")})},e.prototype.colClasses=["im-item-selector","im-item-value","im-item-count"],e.prototype.colHeaders=function(){var t;return t=this.state.has("typeName")?""+this.state.get("typeName")+" "+this.state.get("endName"):s.getText("summary.Item"),[" ",t,s.getText("summary.Count")]},e.prototype.postRender=function(){if(this.tbody=this.$(".im-item-table tbody"),!this.tbody.length)throw new Error("Could not find table");return this.addControls(),this.addItems()},e.prototype.addControls=function(){return this.renderChildAt(".im-summary-controls",new l({model:this.model}))},e.prototype.addItems=function(t){var e;return null==t&&(t=0),this.rendered&&t<this.model.items.length?(e=t+100,p.defer(function(n){return function(){var r;return r=document.createDocumentFragment(),n.model.items.slice(t,e).forEach(function(t){return n.addItem(t,r)}),n.tbody.append(r),n.addItems(e)}}(this))):void 0},e.prototype.addItem=function(t,e){return this.rendered?this.renderChild(h(t),new i({model:t}),null!=e?e:this.tbody):void 0},e.prototype.removeItem=function(t){return this.removeChild(h(t))},e.prototype.events=function(){return{"click .im-load-more":"loadMoreItems","click .im-clear-value-filter":"clearValueFilter","keyup .im-filter-values":p.throttle(this.filterItems,250,{leading:!1}),submit:o,click:o}},e.prototype.loadMoreItems=function(){return this.model.get("loading")?void 0:this.model.increaseLimit(2)},e.prototype.clearValueFilter=function(){var t;return t=this.$(".im-filter-values"),t.val(null),this.model.setFilterTerm(null)},e.prototype.filterItems=function(t){var e,n;return e=this.$(".im-filter-values"),n=e.val(),this.model.setFilterTerm(e.val())},e}(r)}).call(this)},{"../../core-view":33,"../../messages":46,"../../messages/summary":57,"../../mixins/sets-path-names":64,"../../templates":97,"./row":189,"./summary-items-controls":192,backbone:262,underscore:308}],194:[function(t,e,n){(function(){var n,r,i,o,s,a,u,l={}.hasOwnProperty,c=function(t,e){function n(){this.constructor=t}for(var r in e)l.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};u=t("underscore"),n=t("../../core-view"),s=t("../../templates"),r=40,a=38,i={min:0,max:0,average:0,stdev:0},e.exports=o=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return c(e,t),e.prototype.RERENDER_EVENT="change",e.prototype.className="im-summary-stats",e.prototype.template=s.template("summary_stats"),e.prototype.getData=function(){return u.extend({},i,e.__super__.getData.apply(this,arguments))},e.prototype.initialize=function(t){return this.range=t.range,e.__super__.initialize.apply(this,arguments),this.listenTo(this.range,"change",this.setSliderValues),this.listenTo(this.range,"change",this.setButtonDisabledness),this.listenTo(this.range,"change:min",this.onChangeMin),this.listenTo(this.range,"change:max",this.onChangeMax),this.listenForChange(this.model,this.initType,"integral","min","max"),this.initType()},e.prototype.invariants=function(){return{hasRange:"No range"}},e.prototype.hasRange=function(){return null!=this.range},e.prototype.setSliderValues=function(){var t,e,n,r;return n=this.range.toJSON(),e=n.min,t=n.max,null!=(r=this.$slider)?r.slider("option","values",[e,t]):void 0},e.prototype.onChangeMin=function(){var t;return t=this.range.get("min"),this.$("input.im-range-min").val(t),null!=this.$slider&&this.$slider.slider("values",0)!==t?this.$slider.slider("values",0,t):void 0},e.prototype.onChangeMax=function(){var t;return t=this.range.get("max"),this.$("input.im-range-max").val(t),null!=this.$slider&&this.$slider.slider("values",1)!==t?this.$slider.slider("values",1,t):void 0},e.prototype.setButtonDisabledness=function(){var t;return t=this.range.isNotAll(),this.$(".btn").toggleClass("disabled",!t)},e.prototype.events=function(){return{click:function(t){return t.stopPropagation()},"keyup input.im-range-min":"maybeIncrementMin","keyup input.im-range-max":"maybeIncrementMax","change input.im-range-min":"setRangeMin","change input.im-range-max":"setRangeMax","click .btn-primary":"changeConstraints","click .btn-cancel":"clearRange"}},e.prototype.clearRange=function(){return this.range.set(this.model.pick("min","max"))},e.prototype.maybeIncrementMin=function(t){return this.maybeIncrement("min",t)},e.prototype.maybeIncrementMax=function(t){return this.maybeIncrement("max",t)},e.prototype.maybeIncrement=function(t,e){var n;switch(n=this.range.get(t),e.keyCode){case r:n-=this.step;break;case a:n+=this.step}return this.range.set(t,n)},e.prototype.setRangeMin=function(){return this.range.set({min:this.parse(this.$(".im-range-min").val())})},e.prototype.setRangeMax=function(){return this.range.set({max:this.parse(this.$(".im-range-max").val())})},e.prototype.changeConstraints=function(t){var e,n,r,i,o,s,a;for(t.preventDefault(),t.stopPropagation(),i=this.model.view.toString(),o=this.model.query,n=u.where(o.constraints,{path:i}),r=this.range.nulled?[{path:i,op:"IS NULL"}]:[{path:i,op:">=",value:this.range.get("min")},{path:i,op:"<=",value:this.range.get("max")}],s=0,a=n.length;a>s;s++)e=n[s],o.removeConstraint(e,{silent:!0});return o.addConstraints(r)},e.prototype.postRender=function(){return this.drawSlider()},e.prototype.parse=function(t){var e;try{return 1===this.step?parseInt(t,10):parseFloat(t)}catch(n){return e=n,this.model.set({error:new Error("Could not parse '"+t+"' as a number")}),null}},e.prototype.initType=function(){var t,e,n,r;return r=this.model.toJSON(),t=r.integral,n=r.min,e=r.max,this.step=t?1:Math.abs((e-n)/100),this.round=t?Math.round:u.identity},e.prototype.drawSlider=function(){var t,e,n;return n=this.model.pick("min","max"),t=n.max,e=n.min,this.activateSlider({range:!0,min:e,max:t,values:[e,t],step:this.step,slide:function(t){return function(e,n){var r;return null!=(r=t.range)?r.set({min:n.values[0],max:n.values[1]}):void 0}}(this)})},e.prototype.reRender=function(){return this.destroySlider(),e.__super__.reRender.apply(this,arguments)},e.prototype.activateSlider=function(t){return this.destroySlider(),this.$slider=this.$(".slider"),this.$slider.slider(t)},e.prototype.destroySlider=function(){return null!=this.$slider?(this.$slider.slider("destroy"),this.$slider=null):void 0},e.prototype.remove=function(){return this.destroySlider(),e.__super__.remove.apply(this,arguments)},e}(n)}).call(this)},{"../../core-view":33,"../../templates":97,underscore:308}],195:[function(t,e,n){(function(){var n,r,i,o,s={}.hasOwnProperty,a=function(t,e){function n(){this.constructor=t}for(var r in e)s.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};i=t("d3-browserify"),o=t("underscore"),n=t("../../core-view"),e.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return a(e,t),e.prototype.chartHeight=0,e.prototype.chartWidth=0,e.prototype.initialize=function(){return e.__super__.initialize.apply(this,arguments),this.listenTo(this.model,"change:loading",this.reRender)},e.prototype.postRender=function(){return this.model.get("loading")?void 0:this.addChart()},e.prototype.addChart=function(){return o.defer(function(t){return function(){var e;try{return t._drawD3Chart()}catch(n){return e=n,t.model.set({error:e})}}}(this))},e.prototype.getScales=function(){throw new Error("Not implemented")},e.prototype.selectNodes=function(t){throw new Error("not implemented")},e.prototype.getChartData=function(t){throw new Error("not implemented")},e.prototype.exit=function(t){return t.remove()},e.prototype.enter=function(t,e){throw new Error("not implemented")},e.prototype.update=function(t,e){throw new Error("not implemented")},e.prototype.drawAxes=function(t,e){},e.prototype.shouldNotDrawChart=function(){return!1},e.prototype._drawD3Chart=function(){var t,e;if(!this.shouldNotDrawChart())return this.initChart(),e=this.getScales(),t=this.getCanvas(),this.updateChart(t,e),this.drawAxes(t,e)},e.prototype.updateChart=function(t,e){var n;if(!this.shouldNotDrawChart())return null==t&&(t=this.getCanvas()),null==e&&(e=this.getScales()),n=this.selectNodes(t).data(this.getChartData(e)),this.exit(n.exit()),this.enter(n.enter(),e),this.update(n,e)},e.prototype.initChart=function(){return this.chartWidth=this.$el.closest(":visible").width()},e.prototype.getCanvas=function(){return null!=this.paper?this.paper:this.paper=i.select(this.el).append("svg").attr("class","im-summary-chart").attr("width",this.chartWidth).attr("height",this.chartHeight)},e}(n)}).call(this)},{"../../core-view":33,"d3-browserify":276,underscore:308}],196:[function(t,e,n){(function(){var n,r,i,o,s,a,u,l={}.hasOwnProperty,c=function(t,e){function n(){this.constructor=t}for(var r in e)l.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};s=t("../../options"),n=t("../../core-view"),o=t("./numeric"),a=t("./pie"),i=t("./histogram"),u=t("./summary-items"),e.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return c(e,t),e.prototype.className="im-facet-vis",e.prototype.initialize=function(t){return this.range=t.range,e.__super__.initialize.apply(this,arguments)},e.prototype.RERENDER_EVENT="change:loading change:numeric change:canHaveMultipleValues",e.prototype.postRender=function(){return this.model.get("initialized")?this.renderChild("vis",this.getVisualization()):void 0},e.prototype.getVisualization=function(t){var e,n,r,u,l,c;switch(c=this.model.toJSON(),l=c.uniqueValues,r=c.numeric,e=c.canHaveMultipleValues,u=c.type,n=c.got,!1){case!r:return new o({model:this.model,range:this.range});case 1!==l:return null;case!e:return new i({model:this.model});case!(l>0&&l<=s.get("MAX_PIE_SLICES")):return new a({model:this.model});case!n:return new i({model:this.model});default:return null}},e}(n)}).call(this)},{"../../core-view":33,"../../options":93,"./histogram":182,"./numeric":185,"./pie":187,"./summary-items":193}],197:[function(t,e,n){(function(){var n,r,i,o,s,a,u,l,c,h={}.hasOwnProperty,p=function(t,e){function n(){this.constructor=t}for(var r in e)h.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};c=t("underscore"),i=t("../core-view"),u=t("./modal"),a=t("../messages"),l=t("../templates"),r=t("./constraints"),t("../messages/constraints"),t("../messages/logic"),s=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return p(e,t),e.prototype.className="form im-evenly-spaced im-constraint-logic",e.prototype.tagName="form",e.prototype.template=l.template("logic-manager-body"),e.prototype.parameters=["query"],e.prototype.initialize=function(){var t,n;return e.__super__.initialize.apply(this,arguments),n=function(){var e,n,r,i;for(r=this.query.constraints,i=[],e=0,n=r.length;n>e;e++)t=r[e],t.code&&i.push(t.code);return i}.call(this),this.model.set({logic:this.query.constraintLogic}),this.state.set({disabled:!0,defaultLogic:n.join(" and ")})},e.prototype.events=function(){return{"change .im-logic":this.setLogic,submit:this.applyChanges}},e.prototype.modelEvents=function(){return{"change:logic":this.setDisabled}},e.prototype.stateEvents=function(){return{"change:disabled":this.reRender}},e.prototype.setDisabled=function(){var t,e;return e=this.model.get("logic"),t=this.query.constraintLogic,this.state.set({disabled:e===t})},e.prototype.setLogic=function(t){return this.model.set({logic:t.target.value})},e.prototype.applyChanges=function(t){var e;return null!=t&&t.preventDefault(),null!=t&&t.stopPropagation(),this.state.get("disabled")?void 0:(e=this.model.get("logic"),this.query.constraintLogic=e,this.query.trigger("change:logic",e))},e}(i),n=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}var n;return p(e,t),e.prototype.template=l.template("active-constraints"),e.prototype.initialize=function(){return e.__super__.initialize.apply(this,arguments),this.assignCodes()},e.prototype.stateEvents=function(){return{"change:adding":this.reRender}},n="ABCDEFGHIJKLMNOPQRSTUVWXYZ",e.prototype.assignCodes=function(){var t,e,r,i,o,s,a;if(i=function(){var e,n,r,i;for(r=this.query.constraints,i=[],e=0,n=r.length;n>e;e++)t=r[e],null!=t.op&&i.push(t);return i}.call(this),!(i.length<2)){for(r=n.split(""),a=[],o=0,s=i.length;s>o;o++)t=i[o],null==t.code&&a.push(function(){var n;for(n=[];null==t.code&&(e=r.shift());)n.push(c.any(i,function(t){return t.code===e})?void 0:t.code=e);return n}());return a}},e.prototype.postRender=function(){var t,n;return e.__super__.postRender.apply(this,arguments),t=this.getConstraints(),t.length>1&&this.renderChild("logic",new s({query:this.query})),n=this.state.get("adding")?"slideUp":"slideDown",this.$(".im-current-constraints")[n](400)},e.prototype.getConAdder=function(){return this.state.get("adding")?e.__super__.getConAdder.apply(this,arguments):void 0},e}(r),e.exports=o=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return p(e,t),e.prototype.parameters=["query"],e.prototype.modalSize=function(){return"lg"},e.prototype.className=function(){return e.__super__.className.apply(this,arguments)+" im-filter-manager"},e.prototype.title=function(){return a.getText("constraints.Heading",{n:this.query.constraints.length})},e.prototype.initState=function(){return this.state.set({adding:!1,disabled:!1})},e.prototype.act=function(){return this.state.set({adding:!0,disabled:!0})},e.prototype.dismissAction=function(){return a.getText("Cancel")},e.prototype.primaryAction=function(){return a.getText("constraints.DefineNew")},e.prototype.initialize=function(){return e.__super__.initialize.apply(this,arguments),this.listenTo(this,"shown",this.renderBodyContent),this.listenTo(this.query,"change:constraints",this.onChangeConstraints)},e.prototype.onChangeConstraints=function(){return this.initState(),this.renderTitle()},e.prototype.renderBodyContent=function(){var t;return this.shown?(t=this.$(".modal-body"),c.defer(function(e){return function(){return e.renderChild("cons",new n({state:e.state,query:e.query}),t)}}(this))):void 0},e}(u)}).call(this)},{"../core-view":33,"../messages":46,"../messages/constraints":51,"../messages/logic":55,"../templates":97,"./constraints":161,"./modal":227,underscore:308}],198:[function(t,e,n){
(function(){var n,r,i,o={}.hasOwnProperty,s=function(t,e){function n(){this.constructor=t}for(var r in e)o.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};i=t("../query-dialogue-button"),n=t("../filter-dialogue"),t("../../messages/constraints"),e.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return s(e,t),e.prototype.className="im-filter-dialogue-button",e.prototype.longLabel="constraints.ManageFilters",e.prototype.shortLabel="constraints.ManageFiltersShort",e.prototype.icon="Filter",e.prototype.Dialogue=n,e}(i)}).call(this)},{"../../messages/constraints":51,"../filter-dialogue":197,"../query-dialogue-button":236}],199:[function(t,e,n){(function(){var n,r,i,o,s,a={}.hasOwnProperty,u=function(t,e){function n(){this.constructor=t}for(var r in e)a.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};n=t("../core-view"),o=t("../templates"),i=t("./formatted/sorting-path"),s=t("../utils/sort-query-by-path"),e.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return u(e,t),e.prototype.className="im-col-sort-menu no-margins",e.prototype.tagName="ul",e.prototype.initialize=function(t){return this.query=t.query,e.__super__.initialize.apply(this,arguments),this.setPathNames()},e.prototype.modelEvents=function(){return{"change:displayName":this.initState,"change:replaces":this.setPathNames}},e.prototype.initState=function(){return this.state.set({group:this.model.get("displayName")})},e.prototype.setPathNames=function(){var t,e,n,r,i;for(r=this.getPaths(),i=[],e=0,n=r.length;n>e;e++)t=r[e],i.push(function(t){return function(e){var n;return n=e.toString(),t.state.has(n)||t.state.set(n,""),e.getDisplayName().then(function(e){return t.state.set(n,e)})}}(this)(t));return i},e.prototype.getPaths=function(){var t;return t=this.model.get("replaces"),t.length?t.slice():[this.query.makePath(this.model.get("path"))]},e.prototype.preRender=function(t){var e,n;return e=(n=this.getPaths())[0],1===n.length?(t.cancel(),s(this.query,e)):void 0},e.prototype.postRender=function(){var t,e,n,r,o,s;for(o=this.getPaths(),s=[],t=n=0,r=o.length;r>n;t=++n)e=o[t],s.push(this.renderChild(t,new i({model:this.model,state:this.state,query:this.query,path:e})));return s},e}(n)}).call(this)},{"../core-view":33,"../templates":97,"../utils/sort-query-by-path":135,"./formatted/sorting-path":200}],200:[function(t,e,n){(function(){var n,r,i,o,s,a,u={}.hasOwnProperty,l=function(t,e){function n(){this.constructor=t}for(var r in e)u.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};n=t("../../core-view"),s=t("../../templates"),i=t("../../icons"),a=t("../../utils/sort-query-by-path"),r=/^\s*>\s*/,e.exports=o=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return l(e,t),e.prototype.tagName="li",e.prototype.className="im-formatted-path im-subpath",e.prototype.parameters=["query","path"],e.prototype.stateEvents=function(){return{change:this.reRender}},e.prototype.getData=function(){var t,e,n,o;return n=this.state.toJSON(),e=null!=(o=n[this.path])?o.replace(n.group,"").replace(r,""):void 0,t=this.query.getSortDirection(this.path),{Icons:i,name:e,direction:t}},e.prototype.template=s.template("formatted_sorting"),e.prototype.events=function(){return{click:"sortByPath"}},e.prototype.sortByPath=function(){return a(this.query,this.path)},e}(n)}).call(this)},{"../../core-view":33,"../../icons":44,"../../templates":97,"../../utils/sort-query-by-path":135}],201:[function(t,e,n){(function(){n.openDialogue=function(t){return this.renderChild("__dialogue__",t),t.show()},n.getDialogue=function(){var t;return null!=(t=this.children)?t.__dialogue__:void 0}}).call(this)},{}],202:[function(t,e,n){(function(){var n,r,i,o,s,a,u,l,c,h,p,f,d,m,g,y,v,b,_,w,x,C,T,S,E,N,k={}.hasOwnProperty,M=function(t,e){function n(){this.constructor=t}for(var r in e)k.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},P=[].indexOf||function(t){for(var e=0,n=this.length;n>e;e++)if(e in this&&this[e]===t)return e;return-1},O=function(t,e){return function(){return t.apply(e,arguments)}};N=t("underscore"),m=t("es6-promise").Promise,_=t("../templates"),o=t("../core-view"),i=t("../core-model"),h=t("../options"),r=t("../core/collection"),p=t("../models/path"),E=t("../core/type-assertions"),S=t("../utils/get-leaves"),c=t("./item-preview/details"),y=t("./item-preview/reference-counts"),s=t("./item-preview/counts-title"),C=function(t,e){return"Could not determine origin of "+t+" from ["+e.join(", ")+"]"},a=function(t){function e(t){e.__super__.constructor.call(this,t.path),this.set(N.omit(t,"path"))}return M(e,t),e}(p),n=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return M(e,t),e.prototype.defaults=function(){return N.extend(e.__super__.defaults.apply(this,arguments),{fieldType:"ATTR",valueOverspill:null,tooLong:!1,value:null})},e}(a),g=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return M(e,t),e.prototype.defaults=function(){return N.extend(e.__super__.defaults.apply(this,arguments),{fieldType:"REF",values:[]})},e}(a),b=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return M(e,t),e.prototype.comparator="displayName",e.prototype.initialize=function(){return this.listenTo(this,"change:displayName",this.sort)},e}(r),d=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return M(e,t),e.prototype.defaults=function(){return{types:[],id:null,error:null,phase:"FETCHING"}},e}(i),u=_.template("cell-preview-error"),l=["class","objectId"],T=function(t,e){return t.concat(e)},w=function(){return function(t,e){return null!=e&&!e.objectId&&P.call(l,t)<0}},x=function(){return function(t,e){return null!=e?e.objectId:void 0}},v=new E.Structure("ServiceType",{root:E.String,count:E.Function,findById:E.Function,fetchModel:E.Function}),e.exports=f=function(t){function e(){return this.handleItem=O(this.handleItem,this),e.__super__.constructor.apply(this,arguments)}return M(e,t),e.prototype.Model=d,e.prototype.className="im-cell-preview-inner",e.prototype.parameters=["service"],e.prototype.parameterTypes={service:v},e.prototype.initialize=function(){return e.__super__.initialize.apply(this,arguments),this.fieldDetails=new b,this.referenceFields=new b},e.prototype.modelEvents=function(){return{"change:phase":this.reRender,"change:error":this.reRender}},e.prototype.remove=function(){return this.removeAllChildren(),this.fieldDetails.close(),this.referenceFields.close(),delete this.fieldDetails,delete this.referenceFields,e.__super__.remove.apply(this,arguments)},e.prototype.fetching=null,e.prototype.template=function(t){var e,n;switch(n=t.phase,e=t.error,n){case"FETCHING":return this.helpers().IndeterminateProgressBar;case"ERROR":return u(e);default:return null}},e.prototype.preRender=function(){var t;return t=this.model,null==this.fetching&&(this.fetching=this.fetchData()),this.fetching.then(function(){return t.set({phase:"SUCCESS"})},function(e){return console.error(e),t.set({phase:"ERROR",error:e})})},e.prototype.postRender=function(){var t,e,n,r,i;if("SUCCESS"===this.model.get("phase")){for(r=this.model.get("types"),i=[],e=0,n=r.length;n>e;e++)t=r[e],i.push(this.$el.addClass(t));return i}},e.prototype.renderChildren=function(){var t,e,n;return e=new c({collection:this.fieldDetails}),this.renderChild("details",e),t=new s({collection:this.referenceFields}),this.renderChild("counttitle",t),n=new y({collection:this.referenceFields}),this.renderChild("counts",n),this.$el.append(_.clear)},e.prototype.fetchData=function(){return this.service.fetchModel().then(function(t){return function(e){var n,r;return t.schema=e,r=t.getAllDetails(),h.get("ItemDetails.ShowReferenceCounts")?(n=t.getRelationCounts(),m.all(r.concat(n))):m.all(r)}}(this))},e.prototype.getAllDetails=function(){var t,e,n,r,i;for(r=this.model.get("types"),i=[],e=0,n=r.length;n>e;e++)t=r[e],i.push(this.getDetails(t));return i},e.prototype.getDetails=function(t){var e,n;return n=this.model.get("id"),e=h.get(["ItemDetails","Fields",this.schema.name,t]),this.service.findById(t,n,e).then(this.handleItem)},e.prototype.handleItem=function(t){var e,n,r,i,o,s,a;n=this.fieldDetails,o=w(n),s=x(n),e=function(){var t,e,n,r;for(n=this.model.get("types"),r=[],t=0,e=n.length;e>t;t++)i=n[t],r.push(this.schema.classes[i]);return r}.call(this);for(r in t)a=t[r],o(r,a)&&this.handleAttribute(t,e,r,a);for(r in t)a=t[r],s(r,a)&&this.handleSubObj(t,e,r,a);return null},e.prototype.getPathForField=function(t,e){var n,r;if(n=N.find(t,function(t){return null!=t.fields[e]}),null==n)throw new Error(C(e,N.pick(t,"name")));return r=this.schema.makePath(""+n.name+"."+e)},e.prototype.handleSubObj=function(t,e,n,r){var i,o,s;return o=this.getPathForField(e,n),s=S(r,l),i={path:o,field:n,values:s},this.fieldDetails.add(new g(i))},e.prototype.handleAttribute=function(t,e,r,i){var o,s,a,u,l,c;return a=this.getPathForField(e,r),s={path:a,field:r,value:i},(null!=i&&"String"===a.getType()||/Clob/.test(a.getType()))&&(o=h.get("CellCutoff"),c=String(i),l=i.length>o,l&&(u=c.indexOf(" ",.9*o),-1===u&&(u=o),s.tooLong=!0,s.valueOverspill=c.substring(u),s.value=c.substring(0,u))),this.fieldDetails.add(new n(s))},e.prototype.getRelationCounts=function(){var t,e,n,r,i,o,s,a;return E=this.model.get("types"),i=this.service.root,r=null!=(a=h.get(["ItemDetails","Count",i]))?a:{},n=function(){var n,i,a;for(a=[],n=0,i=E.length;i>n;n++)s=E[n],e=this.schema.classes[s],a.push(function(){var n,i,a,u,l;for(u=null!=(a=r[s])?a:function(){var n;n=[];for(t in e.collections)n.push(t);return n}(),l=[],n=0,i=u.length;i>n;n++)o=u[n],l.push(this.getRelationCount(o,s));return l}.call(this));return a}.call(this),n.reduce(T,[])},e.prototype.getRelationCount=function(t,e){var n,r,o,s,u,l,c;if(o=this.model.get("id"),N.isObject(t))l=t.query,s=t.label,n=l(o),r=function(t){return new i({parts:[s],id:s,displayName:s,count:t})};else{if(u=this.schema.makePath(""+e+"."+t),!(null!=(c=u.getType())?c.attributes.id:void 0))return m.resolve(!0);n={select:[t+".id"],from:e,where:{id:o}},r=function(t){return new a({path:u,count:t})}}return this.service.count(n).then(r).then(function(t){return function(e){return e.get("count")?t.referenceFields.add(e):void 0}}(this))},e}(o)}).call(this)},{"../core-model":32,"../core-view":33,"../core/collection":35,"../core/type-assertions":40,"../models/path":86,"../options":93,"../templates":97,"../utils/get-leaves":113,"./item-preview/counts-title":203,"./item-preview/details":204,"./item-preview/reference-counts":205,"es6-promise":277,underscore:308}],203:[function(t,e,n){(function(){var n,r,i,o,s={}.hasOwnProperty,a=function(t,e){function n(){this.constructor=t}for(var r in e)s.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};o=t("underscore"),n=t("../../core-view"),i=t("../../messages"),i.setWithPrefix("preview",{RelatedItemsHeading:"Related Items"}),e.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return a(e,t),e.prototype.tagName="h4",e.prototype.collectionEvents=function(){return{"add remove reset":this.setVisibility}},e.prototype.setVisibility=function(){return this.$el.toggleClass("im-hidden",this.collection.isEmpty())},e.prototype.template=function(){return o.escape(i.getText("preview.RelatedItemsHeading"))},e.prototype.postRender=function(){return this.setVisibility()},e}(n)}).call(this)},{"../../core-view":33,"../../messages":46,underscore:308}],204:[function(t,e,n){(function(){var n,r,i,o,s,a,u,l,c={}.hasOwnProperty,h=function(t,e){function n(){this.constructor=t}for(var r in e)c.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};l=t("underscore"),a=t("../../templates"),r=t("../../core-view"),u=t("../../utils/events").ignore,i=a.template("cell-preview-items"),s=a.template("cell-preview-reference"),n=a.template("cell-preview-attribute"),e.exports=o=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return h(e,t),e.prototype.tagName="table",e.prototype.className="im-item-details table table-condensed table-bordered",e.prototype.template=i,e.prototype.collectionEvents=function(){return{sort:this.reRender,add:this.addDetail}},e.prototype.events=function(){return{"click .im-too-long":this.revealLongField}},e.prototype.postRender=function(){return this.collection.each(function(t){return function(e){return t.addDetail(e)}}(this))},e.prototype.addDetail=function(t){return this.$el.append(this["render"+t.get("fieldType")](t.toJSON()))},e.prototype.renderATTR=function(t){return n(l.extend(this.getBaseData(),t))},e.prototype.renderREF=s,e.prototype.revealLongField=function(t){var e,n;return u(t),n=this.$(".im-too-long"),e=this.$(".im-overspill"),n.remove(),e.slideDown(250)},e}(r)}).call(this)},{"../../core-view":33,"../../templates":97,"../../utils/events":111,underscore:308}],205:[function(t,e,n){(function(){var n,r,i,o={}.hasOwnProperty,s=function(t,e){function n(){this.constructor=t}for(var r in e)o.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};i=t("../../templates"),n=t("../../core-view"),e.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return s(e,t),e.prototype.className="im-related-counts",e.prototype.tagName="ul",e.prototype.collectionEvents=function(){return{"add change sort":this.reRender}},e.prototype.template=i.template("cell-preview-reference-relation"),e}(n)}).call(this)},{"../../core-view":33,"../../templates":97}],206:[function(t,e,n){(function(){var n,r,i,o,s,a,u,l,c={}.hasOwnProperty,h=function(t,e){function n(){this.constructor=t}for(var r in e)c.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};l=t("underscore"),r=t("../core-view"),s=t("../messages"),a=t("./modal"),n=t("./join-manager/body"),o=t("../models/joins"),t("../messages/joins"),u=function(t,e){return t.length===e.length&&l.all(t,function(t,n){return t===e[n]})},e.exports=i=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return h(e,t),e.prototype.parameters=["query"],e.prototype.className=function(){return e.__super__.className.apply(this,arguments)+" im-join-manager"},e.prototype.title=function(){return s.getText("joins.Heading")},e.prototype.dismissAction=function(){return s.getText("Cancel")},e.prototype.primaryAction=function(){return s.getText("modal.ApplyChanges")},e.prototype.initialize=function(){return e.__super__.initialize.apply(this,arguments),this.joins=o.fromQuery(this.query),this.listenTo(this.joins,"change:style",this.setDisabled)},e.prototype.initState=function(){return this.state.set({disabled:!0})},e.prototype.act=function(){var t;return this.state.get("disabled")?void 0:(t=this.joins.getJoins(),this.query.joins=t,this.query.trigger("change:joins",t),this.resolve(t))},e.prototype.setDisabled=function(){var t,e,n,r;return t=l.keys(this.joins.getJoins()),e=function(){var t,e;t=this.query.joins,e=[];for(n in t)r=t[n],"OUTER"===r&&e.push(n);return e}.call(this),t.sort(),e.sort(),this.state.set({disabled:u(t,e)})},e.prototype.postRender=function(){var t;return e.__super__.postRender.apply(this,arguments),t=this.$(".modal-body"),this.renderChild("cons",new n({collection:this.joins}),t)},e}(a)}).call(this)},{"../core-view":33,"../messages":46,"../messages/joins":53,"../models/joins":77,"./join-manager/body":207,"./modal":227,underscore:308}],207:[function(t,e,n){(function(){var n,r,i,o,s,a,u,l,c,h={}.hasOwnProperty,p=function(t,e){function n(){this.constructor=t}for(var r in e)h.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};c=t("underscore"),i=t("../../core-view"),u=t("../../templates"),r=t("../../utils/css-class-set"),t("../../messages/joins"),a=["join-style","column-manager-path-name","clear"],n=function(t){function e(t,n){e.__super__.constructor.call(this,{"btn btn-default":!0,active:function(){return n===t.get("style")}})}return p(e,t),e}(r),l=function(t){switch(t){case"INNER":return"OUTER";case"OUTER":return"INNER";default:return"INNER"}},o=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return p(e,t),e.prototype.tagName="li",e.prototype.className="list-group-item",e.prototype.template=u.templateFromParts(a),e.prototype.modelEvents=function(){return{"change:style change:parts":this.reRender}},e.prototype.initialize=function(){return e.__super__.initialize.apply(this,arguments),this.classSets={innerJoinBtn:new n(this.model,"INNER"),outerJoinBtn:new n(this.model,"OUTER")}},e.prototype.getData=function(){return c.extend(e.__super__.getData.apply(this,arguments),this.classSets)},e.prototype.events=function(){return{"click button":this.onButtonClick}},e.prototype.onButtonClick=function(t){return/active/.test(t.target.className)?void 0:this.model.swap("style",l)},e}(i),e.exports=s=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return p(e,t),e.prototype.template=u.template("join-manager-body"),e.prototype.initState=function(){return this.state.set({explaining:!1})},e.prototype.postRender=function(){return this.$group=this.$(".list-group"),this.collection.each(function(t){return function(e){return t.addJoin(e)}}(this))},e.prototype.addJoin=function(t){return this.rendered?this.renderChild(t.id,new o({model:t}),this.$group):void 0},e.prototype.removeJoin=function(t){return this.removeChild(t.id)},e.prototype.events=function(){return{"click .alert-info strong":function(){return this.state.toggle("explaining")}}},e.prototype.stateEvents=function(){return{"change:explaining":this.onChangeExplaining}},e.prototype.collectionEvents=function(){return{add:this.addJoin,remove:this.removeJoin,sort:this.reRender}},e.prototype.onChangeExplaining=function(){var t,e;return this.rendered?(e=this.$(".alert-info p"),t=this.state.get("explaining")?"slideDown":"slideUp",e[t]()):void 0},e}(i)}).call(this)},{"../../core-view":33,"../../messages/joins":53,"../../templates":97,"../../utils/css-class-set":109,underscore:308}],208:[function(t,e,n){(function(){var n,r,i,o={}.hasOwnProperty,s=function(t,e){function n(){this.constructor=t}for(var r in e)o.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};i=t("../query-dialogue-button"),n=t("../join-manager"),t("../../messages/joins"),e.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return s(e,t),e.prototype.className="im-join-manager-button",e.prototype.longLabel="joins.Manage",e.prototype.shortLabel="joins.ManageShort",e.prototype.icon="Joins",e.prototype.Dialogue=n,e}(i)}).call(this)},{"../../messages/joins":53,"../join-manager":206,"../query-dialogue-button":236}],209:[function(t,e,n){(function(){var n,r,i={}.hasOwnProperty,o=function(t,e){function n(){this.constructor=t}for(var r in e)i.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};r=t("../core-view"),e.exports=n=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return o(e,t),e.prototype.RERENDER_EVENT="change",e.prototype.tagName="span",e}(r)}).call(this)},{"../core-view":33}],210:[function(t,e,n){(function(){var n,r,i,o,s={}.hasOwnProperty,a=function(t,e){function n(){this.constructor=t}for(var r in e)s.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};o=t("es6-promise").Promise,r=t("./base-append-dialogue"),i=t("./from-path-mixin"),e.exports=n=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return a(e,t),e.include(i(r)),e}(r)}).call(this)},{"./base-append-dialogue":213,"./from-path-mixin":219,"es6-promise":277}],211:[function(t,e,n){(function(){var n,r,i,o,s,a={}.hasOwnProperty,u=function(t,e){function n(){this.constructor=t}for(var r in e)a.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};s=t("es6-promise").Promise,r=t("./base-append-dialogue"),i=t("../../mixins/floating-dialogue"),o=t("./from-selection-mixin"),e.exports=n=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return u(e,t),e.include(i),e.include(o(r)),e}(r)}).call(this)},{"../../mixins/floating-dialogue":60,"./base-append-dialogue":213,"./from-selection-mixin":220,"es6-promise":277}],212:[function(t,e,n){(function(){var n,r,i,o,s,a,u={}.hasOwnProperty,l=function(t,e){function n(){this.constructor=t}for(var r in e)u.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};a=t("underscore"),r=t("../../core-view"),s=t("../../templates"),i=t("../../messages"),o=t("../../core/select-with-label"),t("../../messages/lists"),e.exports=n=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return l(e,t),e.prototype.parameters=["model","collection"],e.prototype.postRender=function(){return this.renderListSelector()},e.prototype.renderListSelector=function(){var t;return t=new o({model:this.model,collection:this.collection,attr:"target",label:"lists.params.Target",optionLabel:"lists.PossibleAppendTarget",helpMessage:"lists.params.help.Target",noOptionsMessage:"lists.append.NoSuitableLists",getProblem:function(t){return!(null!=t?t.length:void 0)}}),this.listenTo(t.state,"change:error",console.error.bind(console)),this.renderChild("list-selector",t)},e}(r)}).call(this)},{"../../core-view":33,"../../core/select-with-label":39,"../../messages":46,"../../messages/lists":54,"../../templates":97,underscore:308}],213:[function(t,e,n){(function(){var n,r,i,o,s,a,u,l,c,h,p,f,d,m,g,y,v,b,_={}.hasOwnProperty,w=function(t,e){function n(){this.constructor=t}for(var r in e)_.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};b=t("underscore"),d=t("es6-promise").Promise,s=t("../../core/collection"),a=t("../../core-model"),l=t("../../messages"),o=t("./base-dialogue"),n=t("./append-to-list-body"),r=t("../../models/append-to-list"),c={key:"lists.NoSuitableLists",level:"Warning",cannotDismiss:!0},u={key:"lists.TargetNotCorrectType",level:"Error",cannotDismiss:!0},m={key:"lists.TargetDoesNotExist",level:"Error",cannotDismiss:!0},h={key:"lists.NoTargetSelected",level:"Info",cannotDismiss:!0},y=function(t){return function(e){return t.isa(e.type)?void 0:d.reject(u)}},g=function(t){return b.where(t,{status:"CURRENT"})},v=function(t){var e,n,r,i,o,s,a;for(a=[],i=0,o=t.length;o>i;i++)s=t[i],e=s.name,r=s.type,n=s.size,a.push({name:e,type:r,size:n,id:e});return a},p=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return w(e,t),e.prototype.defaults=function(){return{typeName:null,name:null,size:0}},e.prototype.initialize=function(){return e.__super__.initialize.apply(this,arguments),this.fetchTypeName()},e.prototype.fetchTypeName=function(){var t,e;return t=this.collection.service,e=this.get("type"),t.fetchModel().then(function(t){return t.makePath(e)}).then(function(t){return t.getDisplayName()}).then(function(t){return function(e){return t.set({typeName:e})}}(this))},e}(a),f=function(t){function e(t){this.service=t.service,e.__super__.constructor.call(this)}return w(e,t),e.prototype.model=p,e}(s),e.exports=i=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return w(e,t),e.prototype.Body=n,e.prototype.Model=r,e.prototype.title=function(){return l.getText("lists.AppendToListTitle",this.getData())},e.prototype.primaryAction=function(){return l.getText("lists.Append")},e.prototype.initialize=function(){return e.__super__.initialize.apply(this,arguments),this.listenTo(this.getPossibleLists(),"remove reset",this.verifyState),this.listenTo(this.getPossibleLists(),"add reset",this.setTargetIfOnlyOne)},e.prototype.getPossibleLists=function(){return null!=this.possibleLists?this.possibleLists:this.possibleLists=new f({service:this.getService()})},e.prototype.processQuery=function(t){return t.appendToList(this.model.get("target"))},e.prototype.modelEvents=function(){return b.extend(e.__super__.modelEvents.apply(this,arguments),{"change:target":"onChangeTarget"})},e.prototype.initState=function(){return e.__super__.initState.apply(this,arguments),this.fetchSuitableLists(),this.verifyState()},e.prototype.checkThereAreLists=function(){return this.getPossibleLists().size()?void 0:this.state.set({error:c})},e.prototype.onChangeTarget=function(){return this.setTitle(),this.verifyState()},e.prototype.verifyState=function(){return this.state.unset("error"),this.checkThereAreLists(),this.verifyTarget(),this.verifyTargetExistsAndIsSuitable()},e.prototype.setTargetIfOnlyOne=function(){var t;return t=this.getPossibleLists(),1===t.length?this.model.set({target:t.at(0).get("name")}):void 0},e.prototype.verifyTarget=function(){return this.model.get("target")?void 0:this.state.set({error:h})},e.prototype.onChangeType=function(){return e.__super__.onChangeType.apply(this,arguments),this.fetchSuitableLists()},e.prototype.getBodyOptions=function(){return b.extend(e.__super__.getBodyOptions.apply(this,arguments),{collection:this.getPossibleLists()})},e.prototype.verifyTargetExistsAndIsSuitable=function(){var t,e,n;return n=this.getType(),null!=n&&(e=this.model.get("target"),null!=e)?(t=n.model.makePath(n.name),this.getService().fetchList(e).then(y(t),function(){return m}).then(null,function(t){return function(e){return t.state.set({error:e})}}(this))):void 0},e.prototype.fetchSuitableLists=function(){var t,e;return e=this.getType(),null==e?this.getPossibleLists().reset():(t=e.model.makePath(e.name),this.getService().fetchLists().then(function(e){return b.filter(e,function(e){return t.isa(e.type)})}).then(g).then(v).then(function(t){return function(e){return t.getPossibleLists().reset(e)}}(this)).then(null,function(t){return function(e){return t.state.set({error:e})}}(this)))},e}(o)}).call(this)},{"../../core-model":32,"../../core/collection":35,"../../messages":46,"../../models/append-to-list":65,"./append-to-list-body":212,"./base-dialogue":214,"es6-promise":277,underscore:308}],214:[function(t,e,n){(function(){var n,r,i,o,s,a,u,l={}.hasOwnProperty,c=function(t,e){function n(){this.constructor=t}for(var r in e)l.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};u=t("underscore"),a=t("../modal"),s=t("../../messages"),i=t("../../models/create-list"),o=t("./body"),t("../../messages/lists"),n=function(){throw new Error("not implemented")},e.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return c(e,t),e.prototype.getQuery=n,e.prototype.fetchCount=n,e.prototype.getType=n,e.prototype.getService=function(){return n},e.prototype.Model=i,e.prototype.Body=o,e.prototype.className=function(){return e.__super__.className.apply(this,arguments)+" im-list-dialogue im-create-list"},e.prototype.title=function(){return s.getText("lists.CreateListTitle",this.getData())},e.prototype.primaryAction=function(){return s.getText("lists.Create")},e.prototype.act=function(){return this.getQuery().then(function(t){return function(e){return t.processQuery(e)}}(this)).then(this.resolve,function(t){return function(e){return t.state.set({error:e})}}(this))},e.prototype.verifyState=function(){return this.state.set({error:null})},e.prototype.processQuery=function(t){return t.saveAsList(this.model.toJSON())},e.prototype.modelEvents=function(){return{"change:type":"onChangeType"}},e.prototype.onChangeType=function(){return this.setTypeName()},e.prototype.stateEvents=function(){return{"change:typeName change:count":"setTitle","change:typeName":"setListName","change:error":function(){return console.log(this.state.get("error"))}}},e.prototype.setTitle=function(){return this.$(".modal-title").text(this.title())},e.prototype.setListName=function(){return this.model.set({name:s.getText("lists.DefaultName",this.state.toJSON())})},e.prototype.initState=function(){return this.state.set({existingLists:{},minimised:u.result(this,"initiallyMinimised")}),this.setTypeName(),this.setCount(),this.checkAuth(),this.getService().fetchLists().then(function(t){return u.where(t,{authorized:!0})}).then(function(t){return u.groupBy(t,"name")}).then(function(t){return function(e){return t.state.set({existingLists:e})}}(this))},e.prototype.setCount=function(){return this.fetchCount().then(function(t){return function(e){return t.state.set({count:e})}}(this)).then(null,function(t){return function(e){return t.state.set({error:e})}}(this))},e.prototype.setTypeName=function(){var t;return null!=(t=this.getType())?t.getDisplayName().then(function(t){return function(e){return t.state.set({typeName:e})}}(this)).then(null,function(t){return function(e){return t.state.set({error:e})}}(this)):void 0},e.prototype.checkAuth=function(){return this.getService().whoami().then(null,function(t){return function(){return t.state.set({error:{level:"Error",key:"lists.error.MustBeLoggedIn"}})}}(this))},e.prototype.getBodyOptions=function(){return{model:this.model,state:this.state}},e.prototype.postRender=function(){return e.__super__.postRender.apply(this,arguments),this.renderChild("body",new this.Body(this.getBodyOptions()),this.$(".modal-body"))},e}(a)}).call(this)},{"../../messages":46,"../../messages/lists":54,"../../models/create-list":71,"../modal":227,"./body":215,underscore:308}],215:[function(t,e,n){(function(){var n,r,i,o,s,a,u,l,c,h,p={}.hasOwnProperty,f=function(t,e){function n(){this.constructor=t}for(var r in e)p.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};h=t("underscore"),n=t("../../core-view"),c=t("../../templates"),u=t("../../messages"),r=t("../../models/create-list"),o=t("../../core/input-with-label"),i=t("../../core/input-with-button"),a=t("./tag"),l=t("./tags-apology"),t("../../messages/lists"),e.exports=s=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return f(e,t),e.prototype.Model=r,e.prototype.template=c.template("list-dialogue-body"),e.prototype.getData=function(){return h.extend(e.__super__.getData.apply(this,arguments))},e.prototype.modelEvents=function(){return{"add:tag":"addTag"}},e.prototype.stateEvents=function(){return{"change:minimised":"toggleOptionalAttributes"}},e.prototype.events=function(){return{"click .im-more-options":function(t){return function(){return t.state.toggle("minimised")}}(this)}},e.prototype.$tags=null,e.prototype.postRender=function(){return this.renderListNameInput(),this.renderListDescInput(),this.renderTags()},e.prototype.renderTags=function(){return this.$tags=this.$(".im-active-tags"),this.addTags(),this.renderApology(),this.renderTagAdder()},e.prototype.renderTagAdder=function(){var t;return t=new i({model:this.model,placeholder:"lists.AddTag",button:"lists.AddTagBtn",sets:"nextTag"}),this.listenTo(t,"act",this.addNextTag),this.renderChildAt(".im-next-tag",t)},e.prototype.addTags=function(){return this.model.tags.each(function(t){return function(e){return t.addTag(e)}}(this))},e.prototype.addTag=function(t){return this.rendered?this.renderChild("tag-"+t.get("id"),new a({model:t}),this.$tags):void 0},e.prototype.toggleOptionalAttributes=function(){var t,e,n;return n=this.state.toJSON(),t=this.$(".im-optional-attributes"),n.minimised?t.slideUp():t.slideDown(),e=u.getText("lists.ShowExtraOptions",n),this.$(".im-more-options .msg").text(e)},e.prototype.renderApology=function(){return this.renderChildAt(".im-apology",new l({collection:this.model.tags}))},e.prototype.renderListNameInput=function(){var t;return t=new o({model:this.model,attr:"name",label:"lists.params.Name",helpMessage:"lists.params.help.Name",placeholder:"lists.params.NamePlaceholder",getProblem:function(t){return function(e){return t.validateName(e)}}(this)}),this.listenTo(t.state,"change:problem",function(){
var e;return e=t.state.get("problem"),this.state.set({disabled:!!e})}),this.renderChildAt(".im-list-name",t)},e.prototype.validateName=function(t){var e;return e=null!=t?t.replace(/(^\s+|\s+$)/g,""):void 0,!e||this.state.get("existingLists")[e]},e.prototype.renderListDescInput=function(){return this.renderChildAt(".im-list-desc",new o({model:this.model,attr:"description",label:"lists.params.Desc",placeholder:"lists.params.DescPlaceholder"}))},e.prototype.addNextTag=function(){return this.model.addTag()},e}(n)}).call(this)},{"../../core-view":33,"../../core/input-with-button":36,"../../core/input-with-label":37,"../../messages":46,"../../messages/lists":54,"../../models/create-list":71,"../../templates":97,"./tag":221,"./tags-apology":222,underscore:308}],216:[function(t,e,n){(function(){var n,r,i,o,s,a,u,l,c,h,p,f,d,m,g,y={}.hasOwnProperty,v=function(t,e){function n(){this.constructor=t}for(var r in e)y.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};g=t("underscore"),a=t("../../core-view"),s=t("../../core-model"),o=t("../../core/collection"),m=t("../../templates"),i=t("../../utils/css-class-set"),u=t("../../utils/count-executor"),p=t("../../models/path"),r=t("./append-from-selection"),c=t("./create-from-selection"),n=t("./append-from-path"),l=t("./create-from-path"),t("../../messages/lists"),f=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return v(e,t),e.prototype.model=p,e}(o),d=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return v(e,t),e.prototype.parameters=["query","model","showDialogue","highLight"],e.prototype.tagName="li",e.prototype.modelEvents=function(){return{"change:displayName change:typeName":this.reRender}},e.prototype.stateEvents=function(){return{"change:count":this.reRender}},e.prototype.Model=p,e.prototype.template=m.template("list-dialogue-button-node"),e.prototype.events=function(){return{click:this.openDialogue,"mouseenter a":function(){return g.defer(function(t){return function(){return t.highLight(t.model.get("path"))}}(this))},"mouseout a":function(){return this.highLight(null)}}},e.prototype.initialize=function(){return e.__super__.initialize.apply(this,arguments),this.query.summarise(this.model.get("id")).then(function(t){return function(e){var n;return n=e.stats,t.state.set({count:n.uniqueValues})}}(this))},e.prototype.openDialogue=function(){var t;return t={query:this.query,path:this.model.get("id")},this.showDialogue(t)},e}(a),e.exports=h=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return v(e,t),e.prototype.tagName="div",e.prototype.className="btn-group list-dialogue-button",e.prototype.template=m.template("list-dialogue-button"),e.prototype.parameters=["query","selected"],e.prototype.optionalParameters=["tableState"],e.prototype.tableState=new s,e.prototype.initState=function(){return this.state.set({action:"create",authenticated:!1,disabled:!1})},e.prototype.stateEvents=function(){return{"change:action":this.setActionButtonState,"change:authenticated":this.setVisible,"change:disabled":this.onChangeDisabled}},e.prototype.events=function(){return{"click .im-create-action":this.setActionIsCreate,"click .im-append-action":this.setActionIsAppend,"click .im-pick-items":this.startPicking}},e.prototype.initialize=function(){return e.__super__.initialize.apply(this,arguments),this.initBtnClasses(),this.paths=new f,this.query.getQueryNodes().reverse().forEach(function(t){return function(e){return t.paths.add(new p(e))}}(this)),this.query.service.whoami().then(function(t){return function(e){return t.state.set({authenticated:!!e})}}(this)),u.count(this.query).then(function(t){return function(e){return t.state.set({disabled:0===e})}}(this)).then(null,function(t){return function(e){return t.state.set({disabled:!0,error:e})}}(this))},e.prototype.getData=function(){return g.extend(e.__super__.getData.apply(this,arguments),this.classSets,{paths:this.paths.toJSON()})},e.prototype.postRender=function(){var t,e,n;return this.setVisible(),this.onChangeDisabled(),e=this.$(".dropdown-menu"),t=function(t){return function(e){return t.tableState.set({highlitNode:e})}}(this),n=function(t){return function(e){return t.showPathDialogue(e)}}(this),this.paths.each(function(r){return function(i,o){var s;return s=new d({query:r.query,model:i,showDialogue:n,highLight:t}),r.renderChild("path-"+o,s,e,"prepend")}}(this))},e.prototype.onChangeDisabled=function(){return this.$(".btn").toggleClass("disabled",this.state.get("disabled"))},e.prototype.setVisible=function(){return this.$el.toggleClass("im-hidden",!this.state.get("authenticated"))},e.prototype.setActionIsCreate=function(t){return t.stopPropagation(),t.preventDefault(),this.state.set({action:"create"})},e.prototype.setActionIsAppend=function(t){return t.stopPropagation(),t.preventDefault(),this.state.set({action:"append"})},e.prototype.showDialogue=function(t,e){var n,r,i;return r=new t(e),this.renderChild("dialogue",r),n=this.state.get("action"),i=function(t){return function(e){return function(r){return t.trigger(""+e+":"+n,r),t.trigger(e,n,r)}}}(this),r.show().then(i("success"),i("failure"))},e.prototype.showPathDialogue=function(t){var e,r;return r=this.state.get("action"),e=function(){switch(r){case"append":return n;case"create":return l;default:throw new Error("Unknown action: "+r)}}(),this.showDialogue(e,t)},e.prototype.startPicking=function(){var t,e,n,i;return e=this.state.get("action"),n={collection:this.selected,service:this.query.service},t=function(){switch(e){case"append":return r;case"create":return c;default:throw new Error("Unknown action: "+e)}}(),this.tableState.set({selecting:!0}),i=function(t){return function(){return t.tableState.set({selecting:!1}),t.selected.reset()}}(this),this.showDialogue(t,n).then(i,i)},e.prototype.setActionButtonState=function(){var t;return t=this.state.get("action"),this.$(".im-create-action").toggleClass("active","create"===t),this.$(".im-append-action").toggleClass("active","append"===t)},e.prototype.initBtnClasses=function(){return this.classSets={},this.classSets.createBtnClasses=new i({"im-create-action":!0,"btn btn-default":!0,active:function(t){return function(){return"create"===t.state.get("action")}}(this)}),this.classSets.appendBtnClasses=new i({"im-append-action":!0,"btn btn-default":!0,active:function(t){return function(){return"append"===t.state.get("action")}}(this)})},e}(a)}).call(this)},{"../../core-model":32,"../../core-view":33,"../../core/collection":35,"../../messages/lists":54,"../../models/path":86,"../../templates":97,"../../utils/count-executor":107,"../../utils/css-class-set":109,"./append-from-path":210,"./append-from-selection":211,"./create-from-path":217,"./create-from-selection":218,underscore:308}],217:[function(t,e,n){(function(){var n,r,i,o,s={}.hasOwnProperty,a=function(t,e){function n(){this.constructor=t}for(var r in e)s.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};o=t("es6-promise").Promise,n=t("./base-dialogue"),i=t("./from-path-mixin"),e.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return a(e,t),e.include(i(n)),e}(n)}).call(this)},{"./base-dialogue":214,"./from-path-mixin":219,"es6-promise":277}],218:[function(t,e,n){(function(){var n,r,i,o,s,a,u={}.hasOwnProperty,l=function(t,e){function n(){this.constructor=t}for(var r in e)u.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};a=t("underscore"),s=t("es6-promise").Promise,n=t("./base-dialogue"),i=t("../../mixins/floating-dialogue"),o=t("./from-selection-mixin"),e.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return l(e,t),e.include(i),e.include(o(n)),e}(n)}).call(this)},{"../../mixins/floating-dialogue":60,"./base-dialogue":214,"./from-selection-mixin":220,"es6-promise":277,underscore:308}],219:[function(t,e,n){(function(){var n;n=t("es6-promise").Promise,e.exports=function(t){return{parameters:["query","path"],className:function(){return t.prototype.className.call(this)+" im-from-path"},getQuery:function(){return n.resolve(this.query.selectPreservingImpliedConstraints([this.path]))},fetchCount:function(){return this.query.summarise(this.path).then(function(t){var e;return e=t.stats.uniqueValues})},getType:function(){return this.query.makePath(this.path).getParent().getType()},getService:function(){return this.query.service}}}}).call(this)},{"es6-promise":277}],220:[function(t,e,n){(function(){var n,r,i,o;i=t("../../models/selected-objects"),o=t("../../core/type-assertions"),n={level:"Error",key:"lists.NoCommonType",cannotDismiss:!0},r={level:"Info",key:"lists.NoObjectsSelected",cannotDismiss:!0},e.exports=function(t){return{parameters:["service","collection"],parameterTypes:{collection:o.InstanceOf(i,"SelectedObjects")},className:function(){return t.prototype.className.call(this)+" im-list-picker"},getQuery:function(){return this.service.query({from:this.model.get("type"),select:["id"],where:[{path:this.model.get("type"),op:"IN",ids:this.getIds()}]})},fetchCount:function(){return Promise.resolve(this.collection.size())},getType:function(){var t;return this.model.get("type")&&null!=(t=this.schema)?t.makePath(this.model.get("type")).getType():void 0},getService:function(){return this.service},collectionEvents:function(){return{"change:commonType change:typeName":this.setType,"add remove":this.setCount}},initiallyMinimised:!0,getIds:function(){return this.collection.map(function(t){return t.get("id")})},onChangeType:function(){return t.prototype.onChangeType.call(this),this.verifyState()},verifyState:function(){var e;return null!=(e=t.prototype.verifyState)&&e.call(this),this.collection.size()?this.model.get("type")?void 0:this.state.set({error:n}):this.state.set({error:r})},setType:function(){return this.model.set({type:this.collection.state.get("commonType")}),this.state.set({typeName:this.collection.state.get("typeName")})}}}}).call(this)},{"../../core/type-assertions":40,"../../models/selected-objects":88}],221:[function(t,e,n){(function(){var n,r,i,o={}.hasOwnProperty,s=function(t,e){function n(){this.constructor=t}for(var r in e)o.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};n=t("../../core-view"),i=t("../../templates"),e.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return s(e,t),e.prototype.className="im-list-tag label label-primary",e.prototype.template=i.template("list-tag"),e.prototype.events=function(){return{"click .im-remove":"removeAndDestroy"}},e.prototype.postRender=function(){return this.activateTooltip()},e.prototype.activateTooltip=function(){return this.$("[title]").tooltip()},e.prototype.removeAndDestroy=function(){return this.model.collection.remove(this.model),this.model.destroy(),this.$el.fadeOut(400,function(t){return function(){return t.remove()}}(this))},e}(n)}).call(this)},{"../../core-view":33,"../../templates":97}],222:[function(t,e,n){(function(){var n,r,i,o,s={}.hasOwnProperty,a=function(t,e){function n(){this.constructor=t}for(var r in e)s.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};o=t("underscore"),n=t("../../core-view"),i=t("../../templates"),t("../../messages/lists"),e.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return a(e,t),e.prototype.collectionEvents=function(){return{"add remove reset":this.reRender}},e.prototype.template=i.template("list-tags-apology"),e.prototype.getData=function(){return o.extend(e.__super__.getData.apply(this,arguments),{hasTags:this.collection.size()})},e}(n)}).call(this)},{"../../core-view":33,"../../messages/lists":54,"../../templates":97,underscore:308}],223:[function(t,e,n){(function(){var n,r,i,o,s,a,u,l,c,h,p,f,d={}.hasOwnProperty,m=function(t,e){function n(){this.constructor=t}for(var r in e)d.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};f=t("underscore"),i=t("es6-promise").Promise,r=t("../messages"),o=t("../core-view"),r.set({"convalue.BadType":"<%- name %> is of the wrong type (<%- type %>).","convalue.EmptyList":"<%- name %> is empty. This query will always return 0 results","convalue.BadList":'You do not have access to list called "<%- name %>". Choose one from the list.'}),u=t("../templates/helpers"),c=t("../templates/mustache-settings"),l="<% if (suitableLists.length) { %>\n    <%= select(suitableLists, isSelected, 'span7 im-value-options im-con-value im-con-value-list form-control', formatList, getOptionValue) %>\n<% } else { %>\n    <%- messages.getText('conbuilder.NoSuitableLists') %>\n<% } %>\n",h=f.template(l),a=function(t){return t.name},s=function(t){return t.size?""+t.name+" ("+t.size+" "+t.typeName+"s)":t.name},p=function(t){return function(e){var n;return n=t.makePath(e.type),n.getDisplayName().then(function(t){return f.extend(e,{typeName:t})})}},e.exports=n=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return m(e,t),e.prototype.className="im-list-value-controls",e.prototype.initialize=function(t){return this.query=t.query,e.__super__.initialize.apply(this,arguments),this.initialValue=this.model.get("value"),this.path=this.model.get("path"),this.setSuitableLists(),this.listenTo(this.model,"change",this.reRender),this.listenTo(this.model,"change:value",this.checkCurrentValue),this.checkCurrentValue()},e.prototype.checkCurrentValue=function(){var t,e,n;return n=this.model.get("value"),t=function(t){return function(e){return t.model.set({error:new Error(r.getText("convalue.BadList",{name:n}))}),t.listenToOnce(t.model,"change:value",function(){return t.model.unset("error")})}}(this),e=function(t){var e;return e=t.size?this.path.isa(t.type)?void 0:"convalue.BadType":"convalue.EmptyList",null!=e?(this.model.set({error:new Error(r.getText(e,t))}),this.listenToOnce(this.model,"change:value",function(t){return function(){return t.model.unset("error")}}(this))):void 0},this.query.service.fetchList(n).then(e,t)},e.prototype.events=function(){return{"change select":"setList"}},e.prototype.setList=function(){return this.model.set({value:this.$("select").val()})},e.prototype.setSuitableLists=function(){var t,e;return this.model.has("suitableLists")?void 0:(e=function(t){return function(e){return t.model.set({suitableLists:e})}}(this),t=function(t){return function(e){return t.model.set({error:e})}}(this),this.fetchSuitableLists().then(e,t))},e.prototype.fetchSuitableLists=function(){return null!=this.__suitable_lists?this.__suitable_lists:this.__suitable_lists=this.query.service.fetchLists().then(function(t){return function(e){var n,r;return r=function(){var t,r,i;for(i=[],t=0,r=e.length;r>t;t++)n=e[t],n.size&&this.path.isa(n.type)&&i.push(n);return i}.call(t),i.all(r.map(p(t.query.model)))}}(this))},e.prototype.getSuitableLists=function(){var t,e,n;return t={name:this.initialValue},n=this.model.get("suitableLists")||[],e=f.findWhere(n,t),null==e&&(e=t),f.uniq([e].concat(n),!1,"name")},e.prototype.template=function(t){return t=f.extend({formatList:s,getOptionValue:a,messages:r},u,t),h(t)},e.prototype.getData=function(){var t,e,n;return t=this.model.get("value"),n=this.getSuitableLists(),e=function(e){return e.name===t},{suitableLists:n,isSelected:e}},e}(o)}).call(this)},{"../core-view":33,"../messages":46,"../templates/helpers":98,"../templates/mustache-settings":99,"es6-promise":277,underscore:308}],224:[function(t,e,n){(function(){var n,r,i,o,s,a,u,l,c={}.hasOwnProperty,h=function(t,e){function n(){this.constructor=t}for(var r in e)c.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};l=t("underscore"),o=t("es6-promise").Promise,s=t("../utils/suggestion-source"),i=t("../messages"),n=t("./attribute-value-controls"),a='<label class="im-value-options">\n    <%- messages.getText(\'conbuilder.ExtraLabel\') %>\n    <input type="text" class="im-extra-value form-control"\n            placeholder="<%- state.extraPlaceholder %>"\n            value="<%- con.extraValue %>">\n</label>\n\n',u=l.template(a),e.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return h(e,t),e.prototype.initialize=function(){return e.__super__.initialize.apply(this,arguments),this.state.set({extraPlaceholder:i.get("conbuilder.ExtraPlaceholder")}),this.listenTo(this.branding,"change:defaults.extraValue.path",this.reRender),this.listenTo(this.branding,"change:defaults.extraValue.value",function(){return this.state.set({extraPlaceholder:this.branding.get("defaults.extraValue.value")})}),this.listenTo(this.model,"change",this.reRender)},e.prototype.stateEvents=function(){return l.extend(e.__super__.stateEvents.apply(this,arguments),{"change:extraPlaceholder":this.reRender})},e.prototype.template=function(t){var n;return n=e.__super__.template.apply(this,arguments),n+u(t)},e.prototype.events=function(){return{"change .im-con-value-attr":"setValue","change .im-extra-value":"setExtraValue"}},e.prototype.setExtraValue=function(){var t,e;return t=this.$("input.im-extra-value.tt-input"),t.length||(t=this.$("input.im-extra-value")),e=t.val(),e?this.model.set({extraValue:e}):this.model.unset("extraValue")},e.prototype.setBoth=function(){return this.setValue(),this.setExtraValue()},e.prototype.suggestExtra=function(){var t,e,n,r,i,s;return e=this.branding.get("defaults.extraValue.path"),s=this.branding.get("defaults.extraValue.extraFor"),r=null!=e&&this.model.get("path").isa(s)?(i=""+this.model.get("path")+"."+e,n=null!=this.__extra_suggestions?this.__extra_suggestions:this.__extra_suggestions=this.query.summarise(i),t=this.handleSuggestionSet.bind(this,this.$("input.im-extra-value"),"extraValue"),n.then(function(t){var e;return e=t.results}).then(t)):o.resolve(!0)},e.prototype.suggestValue=function(){var t,e,n,r,i;return r=this.model.get("path"),i=this.query.service,t=r.getEndClass().name,e=i.fetchClassKeys().then(function(e){return e[t]}),null==this.__value_suggestions&&(this.__value_suggestions=e.then(function(t){return function(e){var n,i;return(null!=e?e.length:void 0)?(i=function(){var t,i,o;for(o=[],t=0,i=e.length;i>t;t++)n=e[t],o.push(this.query.summarise(r+n.replace(/^[^\.]+/,"")));return o}.call(t),o.all(i).then(function(t){return t.reduce(function(t,e){return t.concat(e.results)},[])})):[]}}(this))),n=this.handleSuggestionSet.bind(this,this.$("input.im-con-value-attr"),"value"),this.__value_suggestions.then(n)},e.prototype.handleSuggestionSet=function(t,e,n){var r,i,o,a,u,l;return l=n.length,0!==l?(u=new s(n,l),a={minLength:0,highlight:!0},r={name:""+e+"_suggestions",source:u.suggest,displayKey:"item",templates:{footer:u.tooMany}},i=function(t){return function(n){return function(n,r){return t.model.set(e,r.item)}}}(this),o=n[0].item,this.activateTypeahead(t,a,r,o,i(t),function(t){return function(){return t.setBoth()}}(this))):void 0},e.prototype.provideSuggestions=function(){var t,e;return this.removeTypeAheads(),e=this.suggestValue(),t=this.suggestExtra(),o.all([t,e])},e.prototype.remove=function(){return e.__super__.remove.apply(this,arguments),this.branding.destroy()},e}(n)}).call(this)},{"../messages":46,"../utils/suggestion-source":137,"./attribute-value-controls":143,"es6-promise":277,underscore:308}],225:[function(t,e,n){(function(){var n,r,i,o,s,a,u,l,c,h,p,f={}.hasOwnProperty,d=function(t,e){function n(){this.constructor=t}for(var r in e)f.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};p=t("underscore"),i=t("es6-promise").Promise,r=t("../messages"),o=t("../core-view"),s=t("../templates/helpers"),u=t("../templates/mustache-settings"),c=t("../utils/to-named-path"),a="<% if (candidateLoops.length) { %>\n    <%= select(candidateLoops, isSelected, 'form-control im-value-options im-con-value') %>\n<% } else { %>\n    <%- messages.getText('conbuilder.NoSuitableLoops') %>\n<% } %>\n",l=p.template(a),h=function(t){var e,n;return n=t.path,e=t.name,{value:n.toString(),text:e}},e.exports=n=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return d(e,t),e.prototype.initialize=function(t){return this.query=t.query,e.__super__.initialize.apply(this,arguments),this.path=this.model.get("path"),this.type=this.path.getType(),this.setCandidateLoops(),this.listenTo(this.model,"change",this.reRender)},e.prototype.events=function(){return{"change select":"setLoop"}},e.prototype.setLoop=function(){return this.model.set({value:this.$("select").val()})},e.prototype.setCandidateLoops=function(){return this.model.has("candidateLoops")?void 0:this.getCandidateLoops().then(function(t){return function(e){return t.model.set({candidateLoops:e})}}(this))},e.prototype.isSuitable=function(t){return(t.isa(this.type)||this.path.isa(t.getType()))&&this.path.toString()!==t.toString()},e.prototype.getCandidateLoops=function(){return null!=this.__candidate_loops?this.__candidate_loops:this.__candidate_loops=function(t){return function(){var e,n;return e=function(){var t,e,r,i;for(r=this.query.getQueryNodes(),i=[],t=0,e=r.length;e>t;t++)n=r[t],this.isSuitable(n)&&i.push(n);return i}.call(t),i.all(e.map(c))}}(this)()},e.prototype.template=function(t){return l(p.extend({messages:r},s,t))},e.prototype.getData=function(){var t,e,n,r;return n=this.model.get("value"),e=function(){var e,n,r,i;for(r=this.model.get("candidateLoops")||[],i=[],e=0,n=r.length;n>e;e++)t=r[e],i.push(h(t));return i}.call(this),r=function(t){return t.value===n},{candidateLoops:e,isSelected:r}},e}(o)}).call(this)},{"../core-view":33,"../messages":46,"../templates/helpers":98,"../templates/mustache-settings":99,"../utils/to-named-path":139,"es6-promise":277,underscore:308}],226:[function(t,e,n){(function(){var n,r,i,o,s,a={}.hasOwnProperty,u=function(t,e){function n(){this.constructor=t}for(var r in e)a.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};s=t("underscore"),n=t("../core-view"),i=t("../templates"),o=function(){return{error:null,exportLink:null,disabled:!1,disabledReason:null}},e.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return u(e,t),e.prototype.tagName="div",e.prototype.className="modal-footer",e.prototype.RERENDER_EVENT="change:error change:exportLink",e.prototype.parameters=["template","actionNames","actionIcons"],e.prototype.getData=function(){return s.extend(o(),this.actionNames,this.actionIcons,e.__super__.getData.apply(this,arguments))},e.prototype.postRender=function(){return this.$("[title]").tooltip()},e}(n)}).call(this)},{"../core-view":33,"../templates":97,underscore:308}],227:[function(t,e,n){(function(){var n,r,i,o,s,a,u,l,c={}.hasOwnProperty,h=function(t,e){function n(){this.constructor=t}for(var r in e)c.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};o=t("es6-promise").Promise,l=t("underscore"),a=t("../core-view"),n=t("../messages"),s=t("../templates"),u=s.template("modal_base"),i=t("./modal-footer"),e.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return h(e,t),e.prototype.className=function(){return"modal fade"},e.prototype.initialize=function(){return e.__super__.initialize.apply(this,arguments),this._promise=new o(function(t){return function(e,n){t.resolve=e,t.reject=n}}(this)),this.listenTo(this.state,"change",this.renderFooter)},e.prototype.resolve=function(){throw new Error("resolved before initialisation")},e.prototype.reject=function(){throw new Error("rejected before initialisation")},e.prototype.dismissError=function(){return this.$(".modal-footer .alert").slideUp(250,function(t){return function(){return t.state.set({error:null})}}(this))},e.prototype.events=function(){return{"click .modal-footer .alert .dismiss":"dismissError","click .modal-footer .btn-cancel":"hide","click .modal-footer button.btn-primary":"act","hidden.bs.modal":"onHidden","click .close":"hide"}},e.prototype.promise=function(){return this._promise},e.prototype.hide=function(){return this.resolve("dismiss")},e.prototype.act=function(){throw new Error("Not implemented.")},e.prototype.primaryIcon=function(){return null},e.prototype.Footer=i,e.prototype.renderFooter=function(){var t,e,n,r;if(this.rendered)return t=l.result(this,"dismissAction"),n=l.result(this,"primaryAction"),r=l.result(this,"primaryIcon"),e={template:this.footer,model:this.state,actionNames:{dismissAction:t,primaryAction:n},actionIcons:{primaryIcon:r}},this.renderChild("footer",new this.Footer(e),this.$(".modal-content"))},e.prototype.postRender=function(){return this.renderFooter()},e.prototype.onHidden=function(t){return null!=t&&t.target!==this.el?!1:(this.resolve("dismiss"),this.shown=!1,this.remove())},e.prototype.remove=function(){return this.reject(new Error("unresolved before removal")),this.shown?this._hideModal():e.__super__.remove.call(this)},e.prototype.title=function(){return n.getText("modal.DefaultTitle")},e.prototype.dismissAction=function(){return n.getText("modal.Dismiss")},e.prototype.primaryAction=function(){return n.getText("modal.OK")},e.prototype.modalSize=function(){},e.prototype.body=function(){},e.prototype.renderTitle=function(){return this.rendered?this.$(".modal-title").text(l.result(this,"title")):void 0},e.prototype.footer=s.templateFromParts(["modal_error","modal_footer"]),e.prototype.template=function(t){var e,n,r;return r=l.result(this,"title"),e=this.body(t),n="modal-"+l.result(this,"modalSize"),u({title:r,body:e,modalSize:n})},e.prototype.shown=!1,e.prototype.show=function(){var t,e;e=this.promise(),e.then(function(t){return function(){return t.remove()}}(this),function(t){return function(){return t.remove()}}(this));try{this._showModal(),this.trigger("shown",this.shown=!0)}catch(n){t=n,this.reject(t)}return e},e.prototype._showModal=function(){return this.$el.modal().modal("show")},e.prototype._hideModal=function(){return this.$el.modal("hide")},e}(a)}).call(this)},{"../core-view":33,"../messages":46,"../templates":97,"./modal-footer":226,"es6-promise":277,underscore:308}],228:[function(t,e,n){(function(){var n,r,i,o,s,a,u,l,c,h,p,f,d,g,y,v={}.hasOwnProperty,b=function(t,e){function n(){this.constructor=t}for(var r in e)v.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};y=t("underscore"),n=t("backbone").Collection,o=t("../messages"),l=t("../templates"),i=t("../icons"),f=t("../core-view"),s=t("../core-model"),n=t("../core/collection"),u=t("../options"),r=t("../patterns").IS_BLANK,d=t("../utils/events").ignore,o.setWithPrefix("multivalue",{AddValue:"Add value",AddValueShort:"+",SaveValue:"Save changes"}),g=t("../templates/mustache-settings"),h=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return b(e,t),e.prototype.defaults=function(){return{editing:!1,scratch:null,selected:!0}},e.prototype.idAttribute="value",e}(s),p=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return b(e,t),e.prototype.model=h,e}(n),c=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return b(e,t),e.prototype.Model=h,e.prototype.tagName="tr",e.prototype.initialize=function(){return this.model.set({editing:!1,scratch:this.model.get("value")}),this.listenTo(this.model,"change:editing change:value change:selected",this.reRender)},e.prototype.events=function(){return{"click .input-group":function(t){return null!=t?t.stopPropagation():void 0},"click .im-edit":"editValue","keyup input":"updateScratch","change input":"updateScratch","click .im-save":"saveValue","click .im-cancel":"cancelEditing",click:"toggleSelected"}},e.prototype.updateScratch=function(t){return d(t),this.model.set({scratch:t.target.value})},e.prototype.saveValue=function(t){return d(t),this.model.set({editing:!1,value:this.model.get("scratch")})},e.prototype.cancelEditing=function(t){return d(t),this.model.set({editing:!1,scratch:this.model.get("value")})},e.prototype.editValue=function(t){return d(t),this.model.toggle("editing")},e.prototype.toggleSelected=function(t){return d(t),this.model.toggle("selected")},e.prototype.getData=function(){return y.extend({icons:i,messages:o},this.model.toJSON())},e.prototype.template=l.template("value-control-row",g),e}(f),e.exports=a=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return b(e,t),e.prototype.className="im-value-options im-multi-value-table",e.prototype.initialize=function(){var t,n,r,i;for(e.__super__.initialize.apply(this,arguments),this.values=new p,i=this.model.get("values")||[],n=0,r=i.length;r>n;n++)t=i[n],this.values.add({value:t});return this.listenTo(this.values,"change:selected change:value add",this.updateModel),this.listenTo(this.values,"add",this.renderValue),this.listenTo(this.values,"remove",this.removeValue)},e.prototype.stateEvents=function(){return{"change:value":this.onChangeNewValue}},e.prototype.modelEvents=function(){return{"change:op":this.onChangeOp,"change:values":this.onChangeValues}},e.prototype.onChangeValues=function(){var t,e;if(null==this.model.previous("values"))return t=this.model.get("values"),this.values.set(function(){var n,r,i,o;for(i=null!=t?t:[],o=[],n=0,r=i.length;r>n;n++)e=i[n],o.push({value:e});return o}())},e.prototype.onChangeOp=function(){var t;return t=this.model.get("op"),"="!==t&&"!="!==t||this.model.has("value")?void 0:this.model.set({values:null,value:this.values.first().get("value")})},e.prototype.events=function(){return{"keyup .im-new-multi-value":this.updateNewValue,"click .im-add":this.addValue}},e.prototype.onChangeNewValue=function(){return this.$(".im-new-multi-value").val(this.state.get("value"))},e.prototype.updateNewValue=function(){return this.state.set({value:this.$(".im-new-multi-value").val()})},e.prototype.addValue=function(t){var e;return d(t),e=this.state.get("value"),null==e||r.test(e)?(this.model.set({error:new Error("please enter a value")}),this.listenToOnce(this.state,"change:value",function(t){return function(){return t.model.unset("error")}}(this))):(this.values.add({value:e}),this.state.unset("value"))},e.prototype.updateModel=function(){var t;return this.model.set({values:function(){var e,n,r,i;for(r=this.values.where({selected:!0}),i=[],e=0,n=r.length;n>e;e++)t=r[e],i.push(t.get("value"));return i}.call(this)})},e.prototype.getData=function(){return{messages:o}},e.prototype.template=l.template("add-value-control"),e.prototype.postRender=function(){return this.$table=this.$("table"),this.renderRows()},e.prototype.renderRows=function(){return this.values.each(function(t){return function(e){return t.renderValue(e)}}(this))},e.prototype.removeValue=function(){return this.removeChild(m.id)},e.prototype.renderValue=function(t){return this.renderChild(t.id,new c({model:t}),this.$table)},e.prototype.remove=function(){return this.values.close(),e.__super__.remove.apply(this,arguments)},e}(f)}).call(this)},{"../core-model":32,"../core-view":33,"../core/collection":35,"../icons":44,"../messages":46,"../options":93,"../patterns":94,"../templates":97,"../templates/mustache-settings":99,"../utils/events":111,backbone:262,underscore:308}],229:[function(t,e,n){(function(){var n,r,i,o={}.hasOwnProperty,s=function(t,e){function n(){this.constructor=t}for(var r in e)o.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};r=t("../messages"),n=t("./active-constraint"),r.set({"conbuilder.Apply":"Apply"}),e.exports=i=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return s(e,t),e.prototype.initialize=function(){return e.__super__.initialize.apply(this,arguments),this.model.set({"new":!0,op:this.model.get("path").isAttribute()?"=":"LOOKUP"}),this.state.set({editing:!0})},e.prototype.render=function(){return e.__super__.render.apply(this,arguments),this.$el.addClass("im-new"),this},e}(n)}).call(this);

},{"../messages":46,"./active-constraint":142}],230:[function(t,e,n){(function(){var n,r,i,o,s,a,u={}.hasOwnProperty,l=function(t,e){function n(){this.constructor=t}for(var r in e)u.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};a=t("underscore"),i=t("./modal"),n=t("./constraint-adder"),s=t("../templates"),r=t("../messages"),e.exports=o=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return l(e,t),e.prototype.className=function(){return"im-constraint-dialogue "+e.__super__.className.apply(this,arguments)},e.prototype.modalSize="lg",e.prototype.initialize=function(t){return this.query=t.query,e.__super__.initialize.apply(this,arguments),this.listenTo(this.query,"change:constraints",this.resolve),this.listenTo(this.query,"editing-constraint",function(t){return function(){return t.$(".im-add-constraint").removeClass("disabled")}}(this))},e.prototype.events=function(){return a.extend(e.__super__.events.apply(this,arguments),{"click .im-add-constraint":"addConstraint",childremoved:function(t){return function(e,r){return r instanceof n?t.hide():void 0}}(this)})},e.prototype.title=function(){return r.getText("constraints.AddNewFilter")},e.prototype.primaryAction=function(){return r.getText("constraints.AddFilter")},e.prototype.postRender=function(){var t,r;return r=this.$(".modal-footer"),t=this.$(".modal-body"),this.renderChild("adder",new n({buttonDelegate:r,query:this.query}),t),e.__super__.postRender.apply(this,arguments)},e}(i)}).call(this)},{"../messages":46,"../templates":97,"./constraint-adder":158,"./modal":227,underscore:308}],231:[function(t,e,n){(function(){var n,r,i,o,s,a,u,l,c,h=function(t,e){return function(){return t.apply(e,arguments)}},p={}.hasOwnProperty,f=function(t,e){function n(){this.constructor=t}for(var r in e)p.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};c=t("underscore"),i=t("../options"),r=t("../core-view"),n=t("./pathtree/attribute"),u=t("./pathtree/root"),s=t("./pathtree/reference"),a=t("./pathtree/reverse-reference"),l=function(t,e){return t.append(e)},e.exports=o=function(t){function e(){return this.createSubFinder=h(this.createSubFinder,this),e.__super__.constructor.apply(this,arguments)}return f(e,t),e.prototype.parameters=["model","query","chosenPaths","openNodes","view","trail"],e.prototype.tagName="ul",e.prototype.className="im-path-chooser",e.prototype.initialize=function(){var t,n,r,i,o,s,a;for(e.__super__.initialize.apply(this,arguments),this.path=c.last(this.trail)||this.model.get("root")||this.query.makePath(this.query.root),this.cd=this.path.getEndClass(),i=l.bind(null,this.path),a=["attributes","references","collections"],o=0,s=a.length;s>o;o++)n=a[o],this[n]=function(){var e,o;e=this.cd[n],o=[];for(r in e)t=e[r],o.push(i(t));return o}.call(this);return this.listenTo(this.model,"change:allowRevRefs",this.render),this.listenTo(this.openNodes,"reset",this.render)},e.prototype.getDepth=function(){return this.trail.length},e.prototype.showRoot=function(){return 0===this.getDepth()&&this.model.get("canSelectReferences")},e.prototype.events=function(){return{scroll:this.onScroll}},e.prototype.onScroll=function(){var t,e;return this.state.get("ignoreScroll")?void 0:(e=this.el.scrollTop,t=this.state.has("scroll")?Math.abs(this.state.get("scroll")-e):0,0!==e||50>t?this.state.set({scroll:e}):c.defer(function(t){return function(){return t.el.scrollTop=t.state.get("scroll")}}(this)))},e.prototype.startIgnoringScroll=function(){return this.state.set({ignoreScroll:!0})},e.prototype.startListeningForScroll=function(){return this.state.has("scroll")&&(this.el.scrollTop=this.state.get("scroll")),this.state.set({ignoreScroll:!1})},e.prototype.preRender=function(){return this.startIgnoringScroll()},e.prototype.postRender=function(){var t,e,n,r,o,s,a,u,l,c,h;for(o=i.get("ShowId"),this.showRoot()&&(r=this.createRoot(),this.renderChild("root",r)),c=this.attributes,s=0,u=c.length;u>s;s++)e=c[s],(o||"id"!==e.end.name)&&(t=this.createAttribute(e),this.renderChild(e.toString(),t));for(h=this.references.concat(this.collections),a=0,l=h.length;l>a;a++)e=h[a],n=this.createReference(e),this.renderChild(e.toString(),n);return this.startListeningForScroll()},e.prototype.createRoot=function(){return new u({query:this.query,model:this.model,chosenPaths:this.chosenPaths,openNodes:this.openNodes,cd:this.cd})},e.prototype.createAttribute=function(t){return new n({model:this.model,chosenPaths:this.chosenPaths,view:this.view,query:this.query,trail:this.trail,path:t})},e.prototype.createReference=function(t){var e,n,r;return r=this.isLoop(t),n=this.model.get("allowRevRefs"),new(e=r&&!n?a:s)({model:this.model,chosenPaths:this.chosenPaths,query:this.query,trail:this.trail,path:t,view:this.view,openNodes:this.openNodes,createSubFinder:this.createSubFinder})},e.prototype.createSubFinder=function(t){return new e(c.extend({model:this.model,query:this.query,chosenPaths:this.chosenPaths,view:this.view,openNodes:this.openNodes},t))},e.prototype.isLoop=function(t){return null!=t.end.reverseReference&&this.path.isReference()&&this.path.getParent().isa(t.end.referencedType)&&this.path.end.name===t.end.reverseReference?!0:!1},e}(r)}).call(this)},{"../core-view":33,"../options":93,"./pathtree/attribute":232,"./pathtree/reference":233,"./pathtree/reverse-reference":234,"./pathtree/root":235,underscore:308}],232:[function(t,e,n){(function(){var n,r,i,o,s,a,u,l,c={}.hasOwnProperty,h=function(t,e){function n(){this.constructor=t}for(var r in e)c.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};l=t("underscore"),o=t("../../core-view"),i=t("../../options"),r=t("../../icons"),a=function(t){return null!=t&&/\w/.test(t)},u=function(t){return null!=t?t.replace(/^.*\s*>/,""):void 0},s=function(t){return"<strong>"+t+"</strong>"},e.exports=n=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return h(e,t),e.prototype.tagName="li",e.prototype.events=function(){return{"click a":"handleClick"}},e.prototype.initialize=function(t){return this.chosenPaths=t.chosenPaths,this.view=t.view,this.query=t.query,this.path=t.path,this.trail=t.trail,e.__super__.initialize.apply(this,arguments),this.depth=this.trail.length+1,this.state.set({visible:!0,highlitName:null,name:this.path.toString()}),this.listenTo(this.chosenPaths,"add remove reset",this.handleChoice),this.listenTo(this.state,"change:visible",this.onChangeVisible),this.listenTo(this.state,"change:highlitName",this.render),this.listenTo(this.state,"change:displayName",this.render),this.path.getDisplayName().then(function(t){return function(e){return t.state.set({displayName:e,name:u(e)})}}(this))},e.prototype.onChangeVisible=function(){return this.$el.toggle(this.state.get("visible"))},e.prototype.getFilterPatterns=function(){var t,e,n,r,i,o;if(t=this.model.get("filter"),a(t)){for(i=t.split(/\s+/),o=[],n=0,r=i.length;r>n;n++)e=i[n],e&&o.push(new RegExp(e,"i"));return o}return[]},e.prototype.handleClick=function(t){var e;return t.stopPropagation(),t.preventDefault(),this.model.get("dontSelectView")&&(null!=(e=this.view)?e.contains(this.path):void 0)?void 0:this.chosenPaths.contains(this.path)?this.chosenPaths.remove(this.path):this.choose()},e.prototype.choose=function(){return this.model.get("multiSelect")?this.chosenPaths.add(this.path):this.chosenPaths.reset([this.path])},e.prototype.handleChoice=function(){return this.$el.toggleClass("active",this.chosenPaths.contains(this.path))},e.prototype.setHighlitName=function(t){return this.state.has("name")?this.state.set({highlitName:this.getHighlitName(t)}):this.state.once("change:name",function(e){return function(){return e.state.set({highlitName:e.getHighlitName(t)})}}(this))},e.prototype.getHighlitName=function(t){var e,n,r,i,o,a,u;for(n=this.state.get("name"),r=null!=(u=this.path.end)?u.name:void 0,e=n,o=0,a=t.length;a>o;o++)i=t[o],e=e.replace(i,s);return/strong/.test(e)?e:s(e)},e.prototype.getDisabled=function(){return!1},e.prototype.getData=function(){var t,e,n;return n=i.get("ShowId")?""+this.path+" ("+this.path.getType()+")":"",e=this.state.get("highlitName")?this.state.get("highlitName"):this.state.escape("name"),t=r.icon("Attribute"),{icon:t,title:n,name:e}},e.prototype.template=l.template('<a href="#" title="<%- title %>">\n  <%= icon %>\n  <span>\n    <%= name %>\n  </span>\n</a>'),e.prototype.render=function(){return e.__super__.render.apply(this,arguments),this.$el.toggleClass("disabled",this.getDisabled()),i.get("ShowId")&&this.$("a").tooltip({placement:"bottom"}),this.handleChoice(),null!=this.view&&this.$el.toggleClass("in-view",this.view.contains(this.path)),this},e}(o)}).call(this)},{"../../core-view":33,"../../icons":44,"../../options":93,underscore:308}],233:[function(t,e,n){(function(){var n,r,i,o,s={}.hasOwnProperty,a=function(t,e){function n(){this.constructor=t}for(var r in e)s.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};r=t("../../icons"),n=t("./attribute"),o=t("../../utils/events").ignore,e.exports=i=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return a(e,t),e.prototype.initialize=function(t){return this.openNodes=t.openNodes,this.createSubFinder=t.createSubFinder,e.__super__.initialize.apply(this,arguments),this.state.set({collapsed:!0}),this.listenTo(this.openNodes,"add remove",this.setCollapsed),this.listenTo(this.state,"change:collapsed",this.onChangeCollapsed),this.setCollapsed()},e.prototype.setCollapsed=function(){var t;return null!=(t=this.state)?t.set({collapsed:!this.openNodes.contains(this.path)}):void 0},e.prototype.handleClick=function(t){return o(t),this.$(t.target).is("i")||!this.model.get("canSelectReferences")?this.openNodes.togglePresence(this.path):e.__super__.handleClick.call(this,t)},e.prototype.getData=function(){var t;return t=e.__super__.getData.apply(this,arguments),t.icon=r.icon(this.state.get("collapsed")?"ClosedReference":"OpenReference"),t},e.prototype.postRender=function(){return this.onChangeCollapsed()},e.prototype.onChangeCollapsed=function(){var t,e;return this.state.get("collapsed")?this.removeChild("subfinder"):(e=this.trail.concat([this.path]),t=this.createSubFinder({trail:e}),this.renderChild("subfinder",t))},e}(n)}).call(this)},{"../../icons":44,"../../utils/events":111,"./attribute":232}],234:[function(t,e,n){(function(){var n,r,i,o={}.hasOwnProperty,s=function(t,e){function n(){this.constructor=t}for(var r in e)o.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};n=t("../../icons"),r=t("./reference"),e.exports=i=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return s(e,t),e.prototype.className="im-reverse-reference",e.prototype.getData=function(){var t;return t=e.__super__.getData.apply(this,arguments),t.icon+=" "+n.icon("ReverseRef"),t},e.prototype.handleClick=function(t){return t.preventDefault(),t.stopPropagation(),this.$el.tooltip("hide")},e.prototype.render=function(){return e.__super__.render.apply(this,arguments),this.$el.attr({title:"Refers back to "+this.path.getParent().getParent()}).tooltip(),this},e}(r)}).call(this)},{"../../icons":44,"./reference":233}],235:[function(t,e,n){(function(){var n,r,i,o,s={}.hasOwnProperty,a=function(t,e){function n(){this.constructor=t}for(var r in e)s.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};o=t("underscore"),r=t("../../icons"),n=t("./attribute"),e.exports=i=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return a(e,t),e.prototype.className="im-rootclass",e.prototype.initialize=function(t){var n;return n=t.cd,this.openNodes=t.openNodes,t.trail=[],t.path=t.query.getPathInfo(n.name),e.__super__.initialize.call(this,t)},e.prototype.getData=function(){return o.extend(e.__super__.getData.call(this),{icon:r.icon("RootClass")})},e.prototype.handleClick=function(t){var n,r,i,s,a;return null!=t&&t.preventDefault(),null!=t&&t.stopPropagation(),this.$(t.target).is("i")||!this.model.get("canSelectReferences")?this.openNodes.size()?this.openNodes.reset([]):(a=this.path.getType(),n=a.collections,s=a.references,r=function(){var t,e,r,a;for(r=o.values(s).concat(o.values(n)),a=[],t=0,e=r.length;e>t;t++)i=r[t],a.push(this.path.append(i.name));return a}.call(this),this.openNodes.reset(r)):e.__super__.handleClick.call(this,t)},e}(n)}).call(this)},{"../../icons":44,"./attribute":232,underscore:308}],236:[function(t,e,n){(function(){var n,r,i,o,s={}.hasOwnProperty,a=function(t,e){function n(){this.constructor=t}for(var r in e)s.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};o=t("underscore"),n=t("../core-view"),i=t("../templates"),e.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return a(e,t),e.prototype.Dialogue=function(){throw new Error("Not implemented")},e.prototype.longLabel=function(){throw new Error("Not implemented")},e.prototype.shortLabel=function(){throw new Error("Not implemented")},e.prototype.icon=function(){throw new Error("Not implemented")},e.prototype.template=i.template("modal-dialogue-opener"),e.prototype.labels=function(){return{ICON:o.result(this,"icon"),LONG:o.result(this,"longLabel"),SHORT:o.result(this,"shortLabel")}},e.prototype.parameters=["query"],e.prototype.initState=function(){return this.state.set({disabled:!1})},e.prototype.events=function(){return{click:this.onClick}},e.prototype.createDialogue=function(){return new this.Dialogue(this.dialogueOptions())},e.prototype.dialogueOptions=function(){return{query:this.query}},e.prototype.stateEvents=function(){return{"change:disabled":function(){return this.$(".btn.im-open-dialogue").toggleClass("disabled",this.state.get("disabled"))}}},e.prototype.onClick=function(t){var e,n;return this.state.get("disabled")?void 0:(e=this.createDialogue(),this.renderChild("dialogue",e),this.state.set({disabled:!0}),n=function(t){return function(){return t.removeChild("dialogue"),document.body.classList.remove("modal-open"),o.defer(function(){return t.state.set({disabled:!1})})}}(this),e.show().then(n,n))},e}(n)}).call(this)},{"../core-view":33,"../templates":97,underscore:308}],237:[function(t,e,n){(function(){var n,r,i,o,s,a,u,l,c,h,p,f={}.hasOwnProperty,d=function(t,e){function n(){this.constructor=t}for(var r in e)f.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};r=t("../core-view"),p=c=t("../core/type-assertions"),h=p.UnionOf,a=p.Listenable,l=p.Structure,n=t("./column-manager/button"),i=t("./filter-dialogue/button"),s=t("./join-manager/button"),o=h(a,new l("History",{getCurrentQuery:c.Function})),e.exports=u=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return d(e,t),e.prototype.className="im-query-management",e.prototype.parameters=["history"],e.prototype.parameterTypes={history:o},e.prototype.initialize=function(){return e.__super__.initialize.apply(this,arguments),this.listenTo(this.history,"changed:current",this.reRender)},e.prototype.renderChildren=function(){var t;return t=this.history.getCurrentQuery(),this.renderChild("cols",new n({query:t})),this.renderChild("cons",new i({query:t})),this.renderChild("joins",new s({query:t}))},e}(r)}).call(this)},{"../core-view":33,"../core/type-assertions":40,"./column-manager/button":149,"./filter-dialogue/button":198,"./join-manager/button":208}],238:[function(t,e,n){(function(){var n,r,i,o,s,a,u,l,c,h,p,f,d,m,g={}.hasOwnProperty,y=function(t,e){function n(){this.constructor=t}for(var r in e)g.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},v=[].slice;m=t("underscore"),n=t("jquery"),o=t("../core-view"),p=t("../templates"),u=t("../options"),l=t("./query-management-tools"),f=t("./undo-history"),a=t("./list-dialogue/button"),i=t("./code-gen-button"),s=t("./export-dialogue/button"),r=t("../utils/events").Bus,h=["im-query-management","im-history","im-query-consumers"],d=function(t){return'<div class="'+t+' clearfix"></div>'},e.exports=c=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return y(e,t),e.prototype.className="im-query-tools",e.prototype.parameters=["tableState","history","selectedObjects"],e.prototype.optionalParameters=["bus","consumerContainer","consumerBtnClass"],e.prototype.bus=new r,e.prototype.template=function(){return h.map(d).join("")},e.prototype.initialize=function(){return e.__super__.initialize.apply(this,arguments),this.listenTo(this.history,"changed:current",this.renderQueryConsumers)},e.prototype.renderChildren=function(){return this.renderManagementTools(),this.renderUndo(),this.renderQueryConsumers()},e.prototype.renderManagementTools=function(){return this.renderChildAt(".im-query-management",new l({history:this.history}))},e.prototype.renderUndo=function(){var t;return t=this.$(".im-history"),this.renderChild("undo",new f({collection:this.history}),t)},e.prototype.getConsumerContainer=function(){var t;return null!=this.consumerContainer?(this.consumerContainer.classList.add(u.get("StylePrefix")),this.consumerContainer.classList.add("im-query-consumers"),this.$(".im-query-management").addClass("im-has-more-space"),this.$(".im-history").addClass("im-has-more-space"),this.consumerContainer):(t=this.$(".im-query-consumers").empty(),t.length?t:void 0)},e.prototype.renderQueryConsumers=function(){var t,e,n,r,o,u,l,c;if(t=this.getConsumerContainer()){if(r=this.history.getCurrentQuery(),o=this.selectedObjects,n=new a({query:r,tableState:this.tableState,selected:o}),this.listenTo(n,"all",function(t){return function(){var e,n,r,i;return n=arguments[0],e=2<=arguments.length?v.call(arguments,1):[],(r=t.bus).trigger.apply(r,["list-action:"+n].concat(v.call(e))),(i=t.bus).trigger.apply(i,["list-action",n].concat(v.call(e)))}}(this)),this.renderChild("save",new s({query:r,tableState:this.tableState}),t),this.renderChild("code",new i({query:r,tableState:this.tableState}),t),this.renderChild("lists",n,t),this.consumerContainer&&this.consumerBtnClass)for(c=["save","code","lists"],u=0,l=c.length;l>u;u++)e=c[u],this.listenTo(this.children[e],"rendered",this.setButtonStyle);return this.setButtonStyle()}},e.prototype.setButtonStyle=function(){var t,e;return(e=this.consumerContainer)&&(t=this.consumerBtnClass)?n(".btn",e).addClass(t):void 0},e}(o)}).call(this)},{"../core-view":33,"../options":93,"../templates":97,"../utils/events":111,"./code-gen-button":145,"./export-dialogue/button":169,"./list-dialogue/button":216,"./query-management-tools":237,"./undo-history":259,jquery:305,underscore:308}],239:[function(t,e,n){(function(){var n,r,i,o,s,a,u,l,c,h,p,f,d,m,g,y,v,b,_,w,x,C,T,S=function(t,e){return function(){return t.apply(e,arguments)}},E={}.hasOwnProperty,N=function(t,e){function n(){this.constructor=t}for(var r in e)E.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};T=t("underscore"),s=t("../core-view"),c=t("../options"),_=t("../templates"),l=t("../messages"),r=t("../core/collection"),o=t("../core-model"),w=t("../core/type-assertions"),y=t("../models/table"),i=t("../models/column-headers"),C=t("../models/uniq-items"),d=t("../models/rows"),m=t("../models/selected-objects"),u=t("../models/history"),n=t("../utils/cell-model-factory"),v=t("../utils/table-results"),f=t("./table/inner"),a=t("./table/error-notice"),p=t("./table/pagination"),h=t("./table/page-sizer"),b=t("./table/summary"),t("../messages/table"),x={message:"Unknown error",key:"error.Unknown"},e.exports=g=function(t){function e(){return this.canUseFormatter=S(this.canUseFormatter,this),this.unsetSelecting=S(this.unsetSelecting,this),this.setSelecting=S(this.setSelecting,this),e.__super__.constructor.apply(this,arguments)}return N(e,t),e.create=function(t){var n,r,i,o;return i=t.query,r=t.model,w.assertMatch(w.Query,i),null==r&&(r=new y),n=new u,o=new m(i.service),n.setInitialState(i),new e({history:n,model:r,selectedObjects:o})},e.prototype.Model=y,e.prototype.className="im-table-container",e.prototype.parameters=["history","selectedObjects"],e.prototype.optionalParameters=["model","columnHeaders","blacklistedFormatters"],e.prototype.parameterTypes={history:w.InstanceOf(u,"History"),selectedObjects:w.InstanceOf(m,"SelectedObjects")},e.prototype.cellModelFactory=null,e.prototype.initialize=function(){return e.__super__.initialize.apply(this,arguments),null==this.columnHeaders&&(this.columnHeaders=new i),null==this.blacklistedFormatters&&(this.blacklistedFormatters=new C),this.rows=new d,this.listenTo(this.history,"changed:current",this.onChangeQuery),this.listenTo(this.blacklistedFormatters,"reset add remove",this.buildColumnHeaders),this.listenTo(this.columnHeaders,"change:minimised",this.onChangeHeaderMinimised),this.onChangeQuery()},e.prototype.onChangeQuery=function(){var t,e,r;return r=this.query=this.history.getCurrentQuery(),e=r.service,t=r.model,null==this.cellModelFactory&&(this.cellModelFactory=new n(e,t)),this.buildColumnHeaders(),this.fetchVersion().then(function(t){return function(){return t.query.count(function(e,n){return t.model.set({error:e,count:n})}),t.setFreshness()}}(this))},e.prototype.fetchVersion=function(){return this.query.service.fetchVersion().then(function(t){return function(e){return t.model.set({version:e})}}(this)).then(null,function(t){return function(t){return onConnectionError(t)}}(this))},e.prototype.onConnectionError=function(t){var e;return e=new Error("Could not connect to server"),e.key="error.ConnectionError",this.model.set({error:e})},e.prototype.modelEvents=function(){return{"change:freshness change:start change:size":this.fillRows,"change:start change:size":this.overlayTable,"change:fill":this.removeOverlay,"change:freshness":this.resetPhase,"change:phase":this.onChangePhase,"change:error":this.onChangeError,"change:count":this.onChangeCount}},e.prototype.onChangePhase=function(){return this.removeOverlay(),this.reRender()},e.prototype.onChangeCount=function(){var t,e,n,r;return r=this.model.pick("start","count","size"),n=r.start,e=r.size,t=r.count,n>=t?this.model.set({start:Math.max(0,t-e)}):void 0},e.prototype.resetPhase=function(){return this.model.set({phase:"FETCHING"})},e.prototype.onChangeError=function(){return this.model.get("error")?this.model.set({phase:"ERROR"}):void 0},e.prototype.remove=function(){return this.cellModelFactory.destroy(),delete this.cellModelFactory,e.__super__.remove.apply(this,arguments)},e.prototype.onChangeHeaderMinimised=function(t){var e,n;return n=this.query.makePath(t.get("path")),e=this.model.get("minimisedColumns"),t.get("minimised")?e.add(n):e.remove(n)},e.prototype.setSelecting=function(){return this.model.set({selecting:!0})},e.prototype.unsetSelecting=function(){return this.model.set({selecting:!1})},e.prototype.canUseFormatter=function(t){return null!=t&&!this.blacklistedFormatters.contains(t)},e.prototype.setFreshness=function(){return this.model.set({freshness:this.query.toXML()})},e.prototype.buildColumnHeaders=function(){var t,e,n;return n={silent:!0},e=this.model.get("minimisedColumns"),t=function(t){return function(n){return e.contains(t.query.makePath(n.get("path")))}}(this),this.columnHeaders.setHeaders(this.query,this.blacklistedFormatters),this.columnHeaders.forEach(function(e){return function(e){return e.set({minimised:t(e)},n)}}(this))},e.prototype.fillRows=function(){var t,e,n,r,i;return i=this.model.pick("start","size"),n=i.start,e=i.size,r=function(t){return function(){return t.model.set({phase:"SUCCESS"})}}(this),t=function(t){return function(e){return null==e&&(e=x),t.model.set({phase:"ERROR",error:e})}}(this),v.getCache(this.query).fetchRows(n,e).then(function(t){return function(e){return t.fillRowsCollection(e)}}(this)).then(r,t).then(this.model.filled,this.model.filled)},e.prototype.fillRowsCollection=function(t){var e,n,r;return e=this.cellModelFactory.getCreator(this.query),r=this.model.get("start"),n=t.map(function(t){return function(n,i){var o;return{id:""+t.query.toXML()+"#"+(r+i),index:r+i,query:t.query.toXML(),cells:function(){var t,r,i;for(i=[],t=0,r=n.length;r>t;t++)o=n[t],i.push(e(o));return i}()}}}(this)),this.rows.set(n)},e.prototype.overlayTable=function(){var t,e,n,r,i;if(null!=(i=this.children.inner)?i.rendered:void 0)return n=this.children.inner.$el,t=this.$el.offset(),r=n.offset(),this.removeOverlay(),this.overlay=document.createElement("div"),this.overlay.className="im-table-overlay im-hidden",e=this.make("h1",{},l.getText("table.OverlayText")),e.style.top=""+n.height()/2+"px",this.overlay.appendChild(e),this.el.appendChild(this.overlay),T.delay(function(t){return function(){var e;return null!=(e=t.overlay)?e.classList.remove("im-hidden"):void 0}}(this),100)},e.prototype.removeOverlay=function(){return null!=this.overlay&&this.el.removeChild(this.overlay),delete this.overlay},e.prototype.template=function(){switch(this.model.get("phase")){case"FETCHING":return this.renderFetching();case"ERROR":return this.renderError();case"SUCCESS":return this.renderTable();default:throw new Error("Unknown phase: "+this.model.get("phase"))}},e.prototype.renderFetching=function(){return _.template("table-building")(this.getBaseData())},e.prototype.renderError=function(){var t;return this.removeChild("error"),this.children.error=t=new a({query:this.query,model:this.model}),t.render().el},e.prototype.renderTable=function(){var t,e;return t=document.createDocumentFragment(),this.renderWidgets(t),e=new f(T.extend(T.pick(this,f.prototype.parameters),{tableState:this.model})),this.renderChild("inner",e,t),t},e.prototype.renderWidgets=function(t){var e,n,r,i,o,s,a;if(null==t&&(t=this.el),o=T.chain(c.get("TableWidgets")).map(function(t,e){var n,r;return n=t.enabled,r=t.index,{name:e,index:r,enabled:n}}).where({enabled:!0}).sortBy("index").pluck("name").value(),o.length){for(r=document.createElement("div"),r.className="im-table-controls",e=document.createElement("div"),e.style.clear="both",s=0,a=o.length;a>s;s++)i=o[s],"place"+i in this&&(n="place"+i,this[n](r));return r.appendChild(e),t.appendChild(r)}},e.prototype.renderWidget=function(t,e,n){var r;return r=new n({model:this.model,getQuery:function(t){return function(){return t.history.getCurrentQuery()}}(this)}),this.renderChild(t,r,e)},e.prototype.placePagination=function(t){return this.renderWidget("pagination",t,p)},e.prototype.placePageSizer=function(t){return this.renderWidget("pagesizer",t,h)},e.prototype.placeTableSummary=function(t){return this.renderWidget("tablesummary",t,b)},e}(s)}).call(this)},{"../core-model":32,"../core-view":33,"../core/collection":35,"../core/type-assertions":40,"../messages":46,"../messages/table":58,"../models/column-headers":69,"../models/history":75,"../models/rows":87,"../models/selected-objects":88,"../models/table":91,"../models/uniq-items":92,"../options":93,"../templates":97,"../utils/cell-model-factory":105,"../utils/table-results":138,"./table/error-notice":244,"./table/inner":247,"./table/page-sizer":250,"./table/pagination":251,"./table/summary":257,underscore:308}],240:[function(t,e,n){(function(){var n,r,i,o,s,a,u,l={}.hasOwnProperty,c=function(t,e){function n(){this.constructor=t}for(var r in e)l.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};u=t("underscore"),n=t("../../core-view"),s=t("../../templates"),a=t("../../utils/build-skipset"),t("../../messages/table"),e.exports=o=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return c(e,t),e.prototype.tagName="tbody",e.prototype.parameters=["makeCell","collection","history"],e.prototype.collectionEvents=function(){return{reset:this.reRender,add:this.onRowAdded,remove:this.onRowRemoved}},e.prototype.template=function(){},e.prototype.initialize=function(){return e.__super__.initialize.apply(this,arguments),this._skipSets={}},e.prototype.renderChildren=function(){var t;return this.collection.isEmpty()?this.handleEmptyTable():(t=document.createDocumentFragment("tbody"),this.collection.forEach(function(e){return function(n){return e.addRow(n,t)}}(this)),this.el.appendChild(t))},e.prototype.onRowAdded=function(t){return this.removeChild("apology"),this.addRow(t)},e.prototype.onRowRemoved=function(t){return this.removeChild(t.id),this.collection.isEmpty()?this.handleEmptyTable():void 0},e.prototype.addRow=function(t,e){var n,r;return null==e&&(e=this.el),n=this.skipped(t),r=new i({model:t,makeCell:this.makeCell,skipped:n}),this.renderChild(t.id,r,e)},e.prototype.handleEmptyTable=function(){return this.renderChild("apology",new r({history:this.history}))},e.prototype.skipped=function(t){var e,n;return null!=(e=this._skipSets)[n=t.get("query")]?e[n]:e[n]=function(e){return function(){var n,r;return r=t.get("cells").map(e.makeCell),n=a(r),r.forEach(function(t){return t.remove()}),n}}(this)()},e}(n),i=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return c(e,t),e.prototype.tagName="tr",e.prototype.parameters=["makeCell","skipped"],e.prototype.postRender=function(){var t,e,n,r,i,o;for(e=this.model.get("cells").map(this.makeCell),o=[],n=r=0,i=e.length;i>r;n=++r)t=e[n],this.skipped[t.model.get("column")]||o.push(this.renderChild(n,t));return o},e}(n),r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return c(e,t),e.prototype.tagName="tr",e.prototype.className="im-empty-apology",e.prototype.template=s.template("no-results"),e.prototype.parameters=["history"],e.prototype.events=function(){return{"click .btn-undo":function(){return this.history.popState()}}},e.prototype.getData=function(){return u.extend(e.__super__.getData.apply(this,arguments),{selectList:this.history.getCurrentQuery().views,canUndo:this.history.length>1})},e}(n)}).call(this)},{"../../core-view":33,"../../messages/table":58,"../../templates":97,"../../utils/build-skipset":102,underscore:308}],241:[function(t,e,n){(function(){var n,r,i;r=t("../../models/nested-table"),i=t("./subtable"),n=t("./cell"),e.exports=function(t,e){var o,s,a;return o=t.root.replace(/\/service\/?$/,""),a=function(t){var n;return n=e.getFormatter(t.get("node"),t.get("column")),null!=n&&e.canUseFormatter(n)?n:null},s=function(o){return o instanceof r?new i({query:e.query,model:o,cellify:s,expandedSubtables:e.expandedSubtables}):new n({model:o,service:t,popovers:e.popoverFactory,selectedObjects:e.selectedObjects,tableState:e.tableState,formatter:a(o)})}}}).call(this)},{"../../models/nested-table":78,"./cell":242,"./subtable":256}],242:[function(t,e,n){(function(n){(function(){var r,i,o,s,a,u,l,c,h,p,f,d,m,g,y={}.hasOwnProperty,v=function(t,e){function n(){this.constructor=t}for(var r in e)y.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},b=[].indexOf||function(t){for(var e=0,n=this.length;n>e;e++)if(e in this&&this[e]===t)return e;return-1};m=t("underscore"),r=t("jquery"),s=t("../../core-view"),h=t("../../templates"),l=t("../../options"),u=t("../../messages"),o=t("../../models/cell"),a=t("../../formatting"),u.setWithPrefix("table.cell",{Link:"link",NullEntity:"No <%= type %>",PreviewTitle:function(t){var e;return e=t.types,e.join(l.get("DynamicObjects.NameDelimiter"))}}),c=t("../../models/selected-objects"),d=t("../../core/type-assertions"),f=h.template("classy-popover")({classes:"item-preview"}),g=function(t,e){return null!=e?null!=t.model.findSharedAncestor(t,e):!1},p=m.memoize(g,function(t,e){return""+t+"<"+(null!=e?e:"!")}),e.exports=i=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return v(e,t),e.prototype.Model=o,e.prototype.tagName="td",e.prototype.className="im-result-field",e.prototype.id=function(){return m.uniqueId("im_table_cell_")},e.prototype.formatter=a.defaultFormatter,e.prototype.parameters=["model","service","selectedObjects","tableState","popovers"],e.prototype.optionalParameters=["formatter"],
e.prototype.parameterTypes={model:d.InstanceOf(o,"models/cell"),selectedObjects:d.InstanceOf(c,"SelectedObjects"),formatter:d.Callable,tableState:d.Model,service:d.Service,popovers:new d.Structure("HasGet",{get:d.Function})},e.prototype.initialize=function(){return e.__super__.initialize.apply(this,arguments),this.listen()},e.prototype.initState=function(){return this.setSelected(),this.setSelectable(),this.setHighlit(),this.setMinimised()},e.prototype.getPath=function(){return this.model.get("column")},e.prototype.getTypes=function(){var t,e,n,r,i,o;if(n=this.model.get("node"),e=this.model.get("entity").get("classes"),null!=e){for(o=[],r=0,i=e.length;i>r;r++)t=e[r],o.push(n.model.makePath(t));return o}return[n]},e.prototype.listen=function(){return this.listenToEntity(),this.listenToSelectedObjects(),this.listenToOptions(),this.listenToTableState()},e.prototype.listenToOptions=function(){return this.listenTo(l,"change:TableCell.IndicateOffHostLinks",this.reRender),this.listenTo(l,"change:TableCell.ExternalLinkIcons",this.reRender),this.listenTo(l,"change:TableCell.PreviewTrigger",this.onChangeTrigger)},e.prototype.listenToTableState=function(){var t;return t=this.tableState,this.listenTo(t,"change:selecting",this.setInputDisplay),this.listenTo(t,"change:previewOwner",this.closeOwnPreview),this.listenTo(t,"change:highlitNode",this.setHighlit),this.listenTo(t,"change:minimisedColumns",this.setMinimised)},e.prototype.listenToSelectedObjects=function(){var t;return t=this.selectedObjects,this.listenTo(t,"add remove reset",this.setSelected),this.listenTo(t,"add remove reset change:commonType change:node",this.setSelectable)},e.prototype.modelEvents=function(){return{"change:entity":this.onChangeEntity}},e.prototype.stateEvents=function(){return{"change:highlit change:selected":this.setActiveClass,"change:selectable":this.onChangeSelectable,"change:selected":this.setInputChecked,"change:showPreview":this.onChangeShowPreview,"change:minimised":this.reRender}},e.prototype.events=function(){var t,e,n;if(t={"show.bs.popover":this.onShowPreview,"hide.bs.popover":this.onHidePreview,"click a.im-cell-link":this.onClickCellLink},e=l.get("TableCell"),n=e.PreviewTrigger,"hover"===n)t["mouseover .im-cell-link"]=this.showPreview,t["mouseout .im-cell-link"]=this.hidePreview,t.click=this.activateChooser;else{if("click"!==n)throw new Error("Unknown cell preview: "+n);t.click=this.clickTogglePreview}return t},e.prototype.onChangeTrigger=function(){return this.destroyPreview(),this.initPreview(),this.delegateEvents()},e.prototype.onClickCellLink=function(t){var e;return this.tableState.get("selecting")?void t.preventDefault():(e=r.Event("view.im.object"),e.object=this.model.get("entity").toJSON(),this.$el.trigger(e),e.isDefaultPrevented()?t.preventDefault():void 0)},e.prototype.closeOwnPreview=function(){var t,e;return e=this.el.id,t=this.tableState.get("previewOwner"),e!==t?(this.hidePreview(),this._hidePreview()):void 0},e.prototype.listenToEntity=function(){return this.listenTo(this.model.get("entity"),"change",this.updateValue)},e.prototype.onShowPreview=function(){return this.tableState.set({previewOwner:this.el.id})},e.prototype.onHidePreview=function(){var t,e;return e=this.el.id,t=this.tableState.get("previewOwner"),e===t?this.tableState.set({previewOwner:null}):void 0},e.prototype.toggleSelection=function(){var t,e,n,r;if(t=this.model.get("entity"),n=t.get("id"),null!=t){if(e=this.selectedObjects.get(n))return this.selectedObjects.remove(e);if(r=this.getMostSuitableIdentity(),null==r)throw new Error("None of our identities is a compatible");return this.selectedObjects.add(r)}},e.prototype.getMostSuitableIdentity=function(){var t,e,n,r,i,o,s,a;return i=this.model.get("node"),t=i.model.getSubclassesOf(i.getType()),n=this.model.get("entity").get("id"),r=function(){var t,e,r,i;for(r=this.getTypes(),i=[],t=0,e=r.length;e>t;t++)a=r[t],i.push({"class":String(a),id:n});return i}.call(this),this.selectedObjects.isEmpty()?m.find(r,function(e){var n;return n=e["class"],b.call(t,n)>=0}):(e=i.model.makePath(this.selectedObjects.state.get("commonType")),s=m.all(r,function(t){return p(e,t["class"])}),o=m.sortBy(r,function(t){return i.model.getAncestorsOf(t["class"]).length}),m.last(o))},e.prototype.setSelected=function(){return this.state.set({selected:null!=this.selectedObjects.get(this.model.get("entity"))})},e.prototype.setSelectable=function(){var t,e,n,r;return t=this.selectedObjects.state.get("commonType"),e=this.selectedObjects.state.get("node"),r=this.selectedObjects.size(),n=(null==e||e===String(this.model.get("node")))&&(0===r||this.isCompatibleWith(t)),this.state.set({selectable:n})},e.prototype.isCompatibleWith=function(t){return this.getTypes().some(function(e){return p(e,t)})},e.prototype.setHighlit=function(){var t,e;return e=this.model.get("node"),t=this.tableState.get("highlitNode"),this.state.set({highlit:null!=t&&String(e)===String(t)})},e.prototype.setMinimised=function(){var t,e;return e=this.model.get("column"),t=this.tableState.get("minimisedColumns").contains(e),this.state.set({minimised:t})},e.prototype.onChangeEntity=function(){var t;return t=this.model.previous("entity"),delete this._has_id,null!=t&&this.stopListening(t),this.listenToEntity()},e.prototype.clickTogglePreview=function(){return this.activateChooser()||this.state.toggle("showPreview")},e.prototype.activateChooser=function(){var t,e;if(this.hasID())return e=this.tableState.get("selecting"),t=this.state.get("selectable"),t&&e?this.toggleSelection():void 0},e.prototype.hasID=function(){return null!=this._has_id?this._has_id:this._has_id=null!=this.model.get("entity").get("id")},e.prototype.showPreview=function(){return this.state.set({showPreview:!0})},e.prototype.hidePreview=function(){return this.state.set({showPreview:!1})},e.prototype._showPreview=function(){var t,e;if(this.rendered){if(this.tableState.get("selecting"))return;return t=l.get("TableCell"),e=function(t){return function(){var e;return t.state.get("showPreview")&&null!=(e=t.children.popover)?e.render():void 0}}(this),"hover"===t.PreviewTrigger?m.delay(e,t.HoverDelay):e()}},e.prototype._hidePreview=function(){var t,e;return(null!=(t=this.children.popover)?t.rendered:void 0)&&null!=(e=this.popoverTarget)?e.popover("hide"):void 0},e.prototype.onChangeShowPreview=function(){return this.state.get("showPreview")?this._showPreview():this._hidePreview()},e.prototype.onChangeSelectable=function(){return this.setDisabledCellClass(),this.setInputDisabled()},e.prototype.updateValue=function(){return m.defer(function(t){return function(){return t.$(".im-displayed-value").html(t.getFormattedValue())}}(this))},e.prototype.setActiveClass=function(){var t,e,n;return n=this.state.pick("highlit","selected"),t=n.highlit,e=n.selected,this.$el.toggleClass("active",t||e)},e.prototype.setInputChecked=function(){return this.$("input").prop({checked:this.getInputState().checked})},e.prototype.setInputDisplay=function(){return this.$("input").css({display:this.getInputState().display})},e.prototype.setDisabledCellClass=function(){return this.$el.toggleClass("im-not-selectable",!this.state.get("selectable"))},e.prototype.setInputDisabled=function(){return this.$("input").prop({disabled:this.getInputState().disabled})},e.prototype.template=h.template("table-cell"),e.prototype.getData=function(){var t,e,r,i,o,s,a;i=l.get("TableCell"),r=i.IndicateOffHostLinks?n.location.host:/.*/,t=this.model.toJSON(),t.formattedValue=this.getFormattedValue(),t.input=this.getInputState(),t.icon=null,t.url=o=t.entity["report:uri"],t.isForeign=o&&!o.match(r),t.target=t.isForeign?"_blank":"",t.NULL_VALUE=h.null_value,a=i.ExternalLinkIcons;for(e in a)s=a[e],(null!=o?o.match(e):void 0)&&null==t.icon&&(t.icon=s);return m.extend(this.getBaseData(),t)},e.prototype.getFormattedValue=function(){var t,e,n;return n=this.model.pick("entity","value"),t=n.entity,e=n.value,null!=e?this.formatter.call(null,t,this.service,e):null},e.prototype.getInputState=function(){var t,e,n,r,i,o,s;return o=this.tableState.get("selecting"),s=this.state.pick("selected","selectable"),i=s.selected,r=s.selectable,t=i,e=!r,n=o?"inline":"none",{checked:t,disabled:e,display:n}},e.prototype.canHavePreview=function(){return this.hasID()&&!this.state.get("minimised")},e.prototype.postRender=function(){return this.setAttrClass(),this.setActiveClass(),this.setMinimisedClass(),this.setDisabledCellClass(),this.setFormatterClasses(),this.initPreview()},e.prototype.setAttrClass=function(){var t,e,n,r,i;if(l.get("TableCell.AddDataClasses")){for(t=this.model.get("column").getType(),this.$el.addClass("im-type-"+t.toLowerCase()),i=this.getTypes(),n=0,r=i.length;r>n;n++)e=i[n],this.$el.addClass(String(e));return this.$el.addClass(this.model.get("column").end.name)}},e.prototype.setMinimisedClass=function(){return this.$el.toggleClass("im-minimised",this.state.get("minimised"))},e.prototype.setFormatterClasses=function(){var t,e;return t=this.formatter.classes,null!=t&&this.$el.addClass(t),e=this.formatter.target,null!=e?this.$el.addClass(e):void 0},e.prototype.getPreviewContainer=function(){var t,e;for(e=[],t=[".im-query-results",".im-table-container",".panel","table","body"];t.length&&0===e.length;)e=this.$el.closest(t.shift());return e},e.prototype.removeAllChildren=function(){return this.destroyPreview(),null!=this.children.popover&&(this.stopListeningTo(this.children.popover),this.children.popover.rendered&&this.$el.popover("destroy")),e.__super__.removeAllChildren.apply(this,arguments)},e.prototype.destroyPreview=function(){var t;return null!=this.children.popover?(this.stopListeningTo(this.children.popover),this.children.popover.rendered&&null!=(t=this.popoverTarget)&&t.popover("destroy"),delete this.popoverTarget,this.removeChild("popover")):void 0},e.prototype.popoverTarget=null,e.prototype.initPreview=function(){var t,e,n;if(null==this.children.popover&&this.canHavePreview())return t=this.popovers.get(this.model.get("entity")),n=l.get("TableCell.PreviewTrigger"),this.popoverTarget="hover"===n?this.$(".im-cell-link"):this.$el,e=u.getText.bind(u,"table.cell.PreviewTitle"),this.listenToOnce(t,"rendered",function(n){return function(){var r;return r=n.getPreviewContainer(),n.popoverTarget.popover({trigger:"manual",template:f,placement:"auto left",container:r,html:!0,title:function(){return e({types:n.model.get("typeNames")})},content:t.el})}}(this)),this.listenTo(t,"rendered",function(t){return function(){return t.popoverTarget.popover("show")}}(this)),this.children.popover=t},e}(s)}).call(this)}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../../core-view":33,"../../core/type-assertions":40,"../../formatting":43,"../../messages":46,"../../models/cell":67,"../../models/selected-objects":88,"../../options":93,"../../templates":97,jquery:305,underscore:308}],243:[function(t,e,n){(function(){var n,r,i,o,s,a,u,l={}.hasOwnProperty,c=function(t,e){function n(){this.constructor=t}for(var r in e)l.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};u=t("underscore"),i=t("../facets/facet-view"),s=t("../../models/path"),a=t("../../utils/events").ignore,o="No query in call to new DropDownColumnSummary",n="No PathModel in call to new DropDownColumnSummary",e.exports=r=function(t){function e(t){var r,i;if(i=t.query,r=t.model,!i)throw new Error(o);if(!(r instanceof s))throw new Error(n);e.__super__.constructor.call(this,{query:i,view:r.pathInfo()})}return c(e,t),e.prototype.className=function(){return""+e.__super__.className.apply(this,arguments)+" im-dropdown-summary"},e.prototype.events=function(){return u.extend(e.__super__.events.apply(this,arguments),{click:a})},e.prototype.postRender=function(){return e.__super__.postRender.apply(this,arguments),this.$el.addClass(this.className())},e}(i)}).call(this)},{"../../models/path":86,"../../utils/events":111,"../facets/facet-view":181,underscore:308}],244:[function(t,e,n){(function(n){(function(){var r,i,o,s,a,u,l,c,h,p,f,d,m,g={}.hasOwnProperty,y=function(t,e){function n(){this.constructor=t}for(var r in e)g.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};m=t("underscore"),c=t("imjs"),s=t("../../options"),r=t("../../core-view"),a=t("../../templates"),o=t("../../messages"),h=t("../../utils/indent-xml"),p=t("../../utils/mailto"),d=t("../../utils/with-cdn-resource"),u=t("../../version"),t("../../messages/error"),f=m.partial(d,"prettify","prettyPrintOne"),l=function(t){return/(Type|Reference)Error/.test(String(t))?"client":"server"},e.exports=i=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return y(e,t),e.prototype.className="im-error-notice",e.prototype.parameters=["model","query"],e.prototype.helpers=function(){return m.extend(e.__super__.helpers.apply(this,arguments),{indent:h})},e.prototype.template=a.template("table-error"),e.prototype.getData=function(){var t,r,i,s,a,h;return i=this.model.get("error"),h=new Date,a=o.getText("error.mail.Subject"),t=this.query.service.help,r=l(i),console.error(i),s=p.href(t,a,"We encountered an error running a query from an\nembedded result table.\n\npage:       "+n.location+"\nservice:    "+this.query.service.root+"\nerror:      "+i+"\ndate-stamp: "+h+"\n\n-------------------------------\nIMJS:       "+c.VERSION+"\n-------------------------------\nIMTABLES:   "+u+"\n-------------------------------\nQUERY:      "+this.query.toXML()+"\n-------------------------------\nSTACK:      "+(null!=i?i.stack:void 0)),m.extend(e.__super__.getData.apply(this,arguments),{domain:r,mailto:s,query:this.query.toXML()})},e.prototype.postRender=function(){var t,e;return e=h(this.query.toXML()),t=this.$(".query-xml"),f(function(n){return t.html(n(m.escape(e)))})},e.prototype.events=function(){return{"click .im-show-query":function(){return this.$(".query-xml").slideToggle(),this.$(".im-show-query").toggleClass("active")},"click .im-show-error":function(){return this.$(".error-message").slideToggle(),this.$(".im-show-error").toggleClass("active")}}},e}(r)}).call(this)}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{"../../core-view":33,"../../messages":46,"../../messages/error":52,"../../options":93,"../../templates":97,"../../utils/indent-xml":118,"../../utils/mailto":122,"../../utils/with-cdn-resource":140,"../../version":141,imjs:286,underscore:308}],245:[function(t,e,n){(function(){var n,r,i,o,s={}.hasOwnProperty,a=function(t,e){function n(){this.constructor=t}for(var r in e)s.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};o=t("underscore"),r=t("../../core-view"),n=t("./header"),e.exports=i=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return a(e,t),e.prototype.tagName="thead",e.prototype.parameters=["history","expandedSubtables","blacklistedFormatters","columnHeaders"],e.prototype.template=function(){},e.prototype.initialize=function(){return e.__super__.initialize.apply(this,arguments),this.listenTo(this.columnHeaders,"add reset sort",this.reRender),this.listenTo(this.columnHeaders,"remove",function(t){return this.removeChild(t.id)}),this},e.prototype.renderChildren=function(){var t,e,n,r;return t=document.createDocumentFragment(),r=document.createElement("tr"),t.appendChild(r),n=this.history.getCurrentQuery(),e={query:n,expandedSubtables:this.expandedSubtables,blacklistedFormatters:this.blacklistedFormatters},this.columnHeaders.each(this.renderHeader(r,e)),this.$el.html(t)},e.prototype.renderHeader=function(t,e){return function(t){return function(e,n){return t}}(this)},e}(r)}).call(this)},{"../../core-view":33,"./header":246,underscore:308}],246:[function(t,e,n){(function(){var n,r,i,o,s,a,u,l,c,h,p,f,d,m,g,y,v,b,_,w=function(t,e){return function(){return t.apply(e,arguments)}},x={}.hasOwnProperty,C=function(t,e){function n(){this.constructor=t}for(var r in e)x.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},T=[].slice;_=t("underscore"),o=t("../../core-view"),r=t("../../core/collection"),d=t("../../templates"),l=t("../../messages"),h=t("../../options"),n=t("../../utils/css-class-set"),b=t("../../utils/sort-query-by-path"),v=t("../../utils/on-change"),u=t("../../models/header"),a=t("../formatted-sorting"),f=t("../constraints/single-column"),s=t("./column-summary"),p=t("./outer-join-summary"),y=t("../../utils/events").ignore,t("../../messages/table"),c=function(t,e){return function(){return t.get(e)}},m=function(){return Math.max(document.documentElement.clientHeight,window.innerHeight||0)},g=function(){return Math.max(document.documentElement.clientWidth,window.innerWidth||0)},e.exports=i=function(t){function e(){return this.toggleColumnVisibility=w(this.toggleColumnVisibility,this),this.showFilterSummary=w(this.showFilterSummary,this),this.showColumnSummary=w(this.showColumnSummary,this),this.showSummary=w(this.showSummary,this),e.__super__.constructor.apply(this,arguments)}return C(e,t),e.prototype.Model=u,e.prototype.tagName="th",e.prototype.className="im-column-th",e.prototype.RERENDER_EVENT=v(["composed","expanded","minimised","numOfCons","outerJoined","parts","path","sortable","sortDirection"]),e.prototype.template=d.template("column-header"),e.prototype.namePopoverTemplate=d.template("column_name_popover"),e.prototype.parameters=["query"],e.prototype.optionalParameters=["blacklistedFormatters","expandedSubtables"],e.prototype.expandedSubtables=new r,e.prototype.blacklistedFormatters=new r,e.prototype.initialize=function(){return e.__super__.initialize.apply(this,arguments),this.listenTo(this.query,"showing:column-summary",this.removeMySummary),this.listenTo(h,"change:icons",this.reRender),this.createClassSets()},e.prototype.path=function(){return this.model.pathInfo()},e.prototype.createClassSets=function(){return this.classSets={},this.classSets.headerClasses=new n({"im-column-header":!1,"im-minimised-th":c(this.model,"minimised"),"im-is-composed":c(this.model,"composed"),"im-has-constraint":c(this.model,"numOfCons")}),this.classSets.colTitleClasses=new n({"im-col-title":!0,"im-hidden":c(this.model,"minimised")})},e.prototype.removeMySummary=function(t){return t.equals(this.model.pathInfo())?void 0:(this.removeChild("summary"),this.$(".dropdown.open").removeClass("open"))},e.prototype.onSubtableExpanded=function(t){return t.toString().match(this.model.getView())?this.model.set({expanded:!0}):void 0},e.prototype.onSubtableCollapsed=function(t){return t.toString().match(this.model.getView())?this.model.set({expanded:!1}):void 0},e.prototype.getData=function(){var t,r,i,o,s,a,u,l,c;return c=s=this.model.get("parts"),t=3<=c.length?T.call(c,0,l=c.length-2):(l=0,[]),a=c[l++],i=c[l++],r=t.length,o=r?"non-root":"root",u=new n({"im-title-part im-parent":!0,"im-root-parent":!r,"im-non-root-parent":r,"im-last":!i}),_.extend({penultClasses:u,last:i,penult:a},this.classSets,e.__super__.getData.apply(this,arguments))},e.prototype.events=function(){return{"click .im-col-sort":"setSortOrder","click .im-col-minumaximiser":"toggleColumnVisibility","click .im-col-filters":"showFilterSummary","click .im-subtable-expander":this.toggleSubTable,"click .im-col-remover":"removeColumn","hidden.bs.dropdown":function(){return this.removeChild("summary")},"shown.bs.dropdown":"onDropdownShown","toggle .im-th-button":"summaryToggled","click .summary-img":this.showColumnSummary,"click .im-col-composed":this.addFormatterToBlacklist}},e.prototype.postRender=function(){return this.setTitlePopover(),this.announceExpandedState(),this.activateTooltips()},e.prototype.activateTooltips=function(){return this.$(".im-th-button").tooltip({placement:"top",container:this.el})},e.prototype.onDropdownShown=function(t){return _.defer(function(){var e,n;return delete t.target.style.right,e=t.target.getBoundingClientRect(),e.left<0?(n=""+e.left+"px",t.target.style.right=n):void 0})},e.prototype.addFormatterToBlacklist=function(){return this.blacklistedFormatters.add({formatter:this.model.get("formatter")})},e.prototype.announceExpandedState=function(){return this.model.get("expanded")?this.query.trigger("expand:subtables",this.model.get("path")):void 0},e.prototype.setTitlePopover=function(){return h.get("TableHeader.FullPathPopoverEnabled")?this.$(".im-col-title").popover({content:function(t){return function(){return t.namePopoverTemplate(t.getData())}}(this),container:this.el,placement:"bottom",html:!0}):void 0},e.prototype.summaryToggled=function(t,e){return y(t),t.target===t.currentTarget?e?void 0:this.removeChild("summary"):void 0},e.prototype.hideTooltips=function(){return this.$(".im-th-button").tooltip("hide")},e.prototype.removeColumn=function(t){var e,n;return y(t),this.hideTooltips(),n=this.model.getView(),this.query.removeFromSelect(function(){var t,r,i,o;for(i=this.query.views,o=[],t=0,r=i.length;r>t;t++)e=i[t],e.match(n)&&o.push(e);return o}.call(this))},e.prototype.checkHowFarOver=function(t){var e;return e=this.$el.closest(".im-table-container"),t.offset().left+350>=e.offset().left+e.width()?this.$el.addClass("too-far-over"):void 0},e.prototype.showSummary=function(t,e,n){var r,i,o,s,a;if(y(n),i=this.$(t),o=this.path(),i.hasClass("open"))return this.query.trigger("hiding:column-summary",o),i.removeClass("open"),null!=(a=this.children.summary)&&a.$el.hide(),this.removeChild("summary"),!1;if(this.$(".dropdown.open").removeClass("open"),this.query.trigger("showing:column-summary",o),s=new e({query:this.query,model:this.model}),r=this.$(t+" .dropdown-menu"),!r.length)throw new Error(""+t+" not found");return r.empty(),this.renderChild("summary",s,r),i.addClass("open"),this.onDropdownShown({target:r[0]}),!0},e.prototype.ensureDropdownIsWithinTable=function(t,e,n){var r,i,o,s,a;if(null==n&&(n=360),i=t.getBoundingClientRect(),s=this.$el.closest("table")[0],null!=s){if(o=g(),r=this.$(e+" .dropdown-menu"),n>=o)return r.addClass("im-fullwidth-dropdown").css({width:o});if(r.css({width:null}),!(n>=g()))return a=s.getBoundingClientRect(),i.left+n>a.right?this.$(e+" .dropdown-menu").addClass("dropdown-menu-right"):void 0}},e.prototype.showColumnSummary=function(t){var e,n,r;return e=this.model.get("isReference")?p:s,(r=this.showSummary(".im-summary",e,t))?(n=m(),this.$(".im-item-table").css({"max-height":Math.max(350,n/2)}),this.ensureDropdownIsWithinTable(t.target,".im-summary")):void 0},e.prototype.showFilterSummary=function(t){var e;return(e=this.showSummary(".im-filter-summary",f,t))?this.ensureDropdownIsWithinTable(t.target,".im-filter-summary",500):void 0},e.prototype.toggleColumnVisibility=function(t){return y(t),this.model.toggle("minimised")},e.prototype.setSortOrder=function(t){return y(t),this.model.get("replaces").length?this.showSummary(".im-col-sort",a,t):(b(this.query,this.model.getView()),this.$(".im-col-sort").removeClass("open"))},e.prototype.toggleSubTable=function(t){return y(t),this.expandedSubtables.toggle(this.model.pathInfo())},e}(o)}).call(this)},{"../../core-view":33,"../../core/collection":35,"../../messages":46,"../../messages/table":58,"../../models/header":74,"../../options":93,"../../templates":97,"../../utils/css-class-set":109,"../../utils/events":111,"../../utils/on-change":123,"../../utils/sort-query-by-path":135,"../constraints/single-column":165,"../formatted-sorting":199,"./column-summary":243,"./outer-join-summary":249,underscore:308}],247:[function(t,e,n){(function(){var n,r,i,o,s,a,u,l,c,h,p,f,d,m,g,y,v,b=function(t,e){return function(){return t.apply(e,arguments)}},_={}.hasOwnProperty,w=function(t,e){function n(){this.constructor=t}for(var r in e)_.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};v=t("underscore"),i=t("../../core-view"),m=t("../../templates"),o=t("../../formatting"),a=t("../../models/path-set"),r=t("../../models/column-headers"),u=t("../../utils/popover-factory"),s=t("../../models/history"),d=t("../../models/table"),h=t("../../models/selected-objects"),l=t("../item-preview"),g=t("../../core/type-assertions"),n=t("./cell-factory"),p=t("./body"),f=t("./head"),y=function(t){return function(e,n){return t(n,e)}},e.exports=c=function(t){function e(){return this.canUseFormatter=b(this.canUseFormatter,this),e.__super__.constructor.apply(this,arguments)}return w(e,t),e.prototype.className="im-results-table table table-striped table-bordered",e.prototype.tagName="table",e.prototype.throbber=m.template("table-throbber"),e.prototype.parameters=["history","columnHeaders","rows","tableState","blacklistedFormatters","selectedObjects"],e.prototype.parameterTypes={history:g.InstanceOf(s,"History"),blacklistedFormatters:g.Collection,rows:g.Collection,tableState:g.InstanceOf(d,"TableModel"),columnHeaders:g.InstanceOf(r,"ColumnHeaders"),selectedObjects:g.InstanceOf(h,"SelectedObjects")},e.prototype.initialize=function(){var t;return e.__super__.initialize.apply(this,arguments),t=(this.query=this.history.getCurrentQuery()).service,this.expandedSubtables=new a,this.popoverFactory=new u(t,l),this.cellFactory=n(t,this),this.listenTo(this.blacklistedFormatters,"reset add remove",this.renderBody),this.listenTo(this.history,"changed:current",this.setQuery)},e.prototype.setQuery=function(){return this.query=this.history.getCurrentQuery()},e.prototype.getFormatter=y(o.getFormatter),e.prototype.canUseFormatter=function(t){return null!=t&&!this.blacklistedFormatters.findWhere({formatter:t})},e.prototype.renderChildren=function(){return this.renderHeaders(),this.renderBody()},e.prototype.renderHeaders=function(){return this.renderChild("head",new f(v.pick(this,f.prototype.parameters)))},e.prototype.renderBody=function(){return this.renderChild("body",new p({collection:this.rows,history:this.history,makeCell:this.cellFactory}))},e.prototype.remove=function(){return this.expandedSubtables.close(),delete this.expandedSubtables,this.popoverFactory.destroy(),delete this.popoverFactory,delete this.cellFactory,e.__super__.remove.apply(this,arguments)},e}(i)}).call(this)},{"../../core-view":33,"../../core/type-assertions":40,"../../formatting":43,"../../models/column-headers":69,"../../models/history":75,"../../models/path-set":85,"../../models/selected-objects":88,"../../models/table":91,"../../templates":97,"../../utils/popover-factory":128,"../item-preview":202,"./body":240,"./cell-factory":241,"./head":245,underscore:308}],248:[function(t,e,n){(function(){var n,r,i,o,s,a={}.hasOwnProperty,u=function(t,e){function n(){this.constructor=t}for(var r in e)a.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};s=t("underscore"),i=t("../modal"),o=t("../../templates").large_table_disuader,n={ACCEPT:"accept",CONSTRAIN:"constrain",BACK:"back",FWD:"forward",EXPORT:"export",DISMISS:"dismiss"},e.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return u(e,t),e.prototype.className=function(){return"im-page-size-sanity-check fade "+e.__super__.className.apply(this,arguments)},e.prototype.template=s.template(o),e.prototype.act=function(){return this.resolve("accept")},e.prototype.events=function(){return s.extend(e.__super__.events.apply(this,arguments),{"click .btn-primary":function(t){return function(){return t.resolve(n.ACCEPT)}}(this),"click .add-filter-dialogue":function(t){return function(){return t.resolve(n.CONSTRAIN)}}(this),"click .page-backwards":function(t){return function(){return t.resolve(n.BACK)}}(this),"click .page-forwards":function(t){return function(){return t.resolve(n.FWD)}}(this),"click .download-menu":function(t){return function(){return t.resolve(n.EXPORT)}}(this)})},e}(i)}).call(this)},{"../../templates":97,"../modal":227,underscore:308}],249:[function(t,e,n){(function(){var n,r,i,o,s,a,u,l,c,h={}.hasOwnProperty,p=function(t,e){function n(){this.constructor=t}for(var r in e)h.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};c=t("underscore"),r=t("../../core-view"),l=t("../../templates"),n=t("../../core/collection"),s=t("../../models/path"),i=t("./column-summary"),u=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return p(e,t),e.prototype.model=s,e}(n),a=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return p(e,t),e.prototype.parameters=["showPathSummary"],e.prototype.className="im-subpath im-outer-joined-path",e.prototype.tagName="li",e.prototype.template=c.template('<a href="#">'+l.column_manager_path_name+"</a>"),e.prototype.modelEvents=function(){return{change:this.reRender}},e.prototype.events=function(){return{click:this.onClick}},e.prototype.onClick=function(t){return t.stopPropagation(),t.preventDefault(),this.showPathSummary(this.model)},e}(r),e.exports=o=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return p(e,t),e.prototype.parameters=["query"],e.prototype.className="im-summary-selector",e.prototype.tagName="ul",e.prototype.initialize=function(){var t,n,r,i;for(e.__super__.initialize.apply(this,arguments),this.subColumns=new u,i=this.model.get("replaces"),n=0,r=i.length;r>n;n++)t=i[n],this.subColumns.add(this.query.makePath(t));return this.path=new s(this.query.makePath(this.model.get("path")))},e.prototype.getSubpaths=function(){return this.subColumns},e.prototype.postRender=function(){var t,e;return t=this.getSubpaths(),1===t.length?this.showPathSummary(t.first()):(e=function(t){return function(e){return t.showPathSummary(e)}}(this),this.getSubpaths().each(function(t){return function(n,r){return t.renderChild(r,new a({model:n,showPathSummary:e}))}}(this)))},e.prototype.showPathSummary=function(t){var e;return this.undelegateEvents(),this.removeAllChildren(),e=new i({query:this.query,model:t}),this.children.summ=e,e.setElement(this.el),e.render()},e}(r)}).call(this)},{"../../core-view":33,"../../core/collection":35,"../../models/path":86,"../../templates":97,"./column-summary":243,underscore:308}],250:[function(t,e,n){(function(){var n,r,i,o,s,a,u,l,c,h,p={}.hasOwnProperty,f=function(t,e){function n(){this.constructor=t}for(var r in e)p.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},d=[].indexOf||function(t){for(var e=0,n=this.length;n>e;e++)if(e in this&&this[e]===t)return e;return-1};h=t("underscore"),l=t("./paging"),o=t("../has-dialogues"),n=t("../../core-view"),c=t("../../templates"),r=t("../../events"),a=t("../new-filter-dialogue"),i=t("../export-dialogue"),s=t("./large-table-disuader"),e.exports=u=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return f(e,t),e.include(l),e.include(o),e.prototype.tagName="form",e.prototype.className="im-page-sizer im-table-control form-inline",e.prototype.sizes=[[10],[25],[50],[100],[250]],e.prototype.parameters=["getQuery"],e.prototype.initialize=function(){var t,n;return e.__super__.initialize.apply(this,arguments),n=this.model.get("size"),null!=n&&d.call(function(){var e,n,r,i;for(r=this.sizes,i=[],e=0,n=r.length;n>e;e++)t=r[e][0],i.push(t);return i}.call(this),n)<0?this.sizes=[[n,n]].concat(this.sizes):void 0},e.prototype.events=function(){return{submit:r.suppress,"change select":"changePageSize"}},e.prototype.modelEvents=function(){return{"change:size":function(t,e){return this.$("select").val(e)},"change:count":this.reRender}},e.prototype.changePageSize=function(t){var e,n,r,o,s;return n=this.$(t.target),s=parseInt(n.val(),10),r=this.model.get("size"),e=function(t){return function(){return t.model.set({size:s})}}(this),this.aboveSizeThreshold(s)?(o=this.whenAcceptable(s).then(function(t){return function(o){if("accept"===o)return e();switch(n.val(r),o){case"back":return t.goBack(1);case"forward":return t.goForward(1);case"constrain":return t.openDialogue(new a({query:t.getQuery()}));case"export":return t.openDialogue(i({query:t.getQuery()}));default:return console.debug("dismissed dialogue",o)}}}(this)),o.then(null,function(t){return console.error("Error handling dialogues",t);

})):e()},e.prototype.whenAcceptable=function(t){return this.openDialogue(new s({model:{size:t}}))},e.prototype.template=c.template("page_sizer"),e.prototype.getData=function(){var t,e,n,r,i;return t=this.model.get("count"),r=this.model.get("size"),i=function(){var e,r,i,o;for(i=this.sizes,o=[],e=0,r=i.length;r>e;e++)n=i[e],(null==t||n[0]<t)&&o.push(n);return o}.call(this),i.length&&t<this.sizes[this.sizes.length-1][0]&&(e=h.find(i,function(e){return e[0]===t}),e?e[1]+=e[0]+" (All)":i.push([t,""+t+" (All)"])),{size:r,sizes:i}},e.prototype.pageSizeFeasibilityThreshold=250,e.prototype.aboveSizeThreshold=function(t){var e;return t&&t>=this.pageSizeFeasibilityThreshold?!0:t?!1:(e=this.model.get("count"),e>=this.pageSizeFeasibilityThreshold)},e}(n)}).call(this)},{"../../core-view":33,"../../events":42,"../../templates":97,"../export-dialogue":168,"../has-dialogues":201,"../new-filter-dialogue":230,"./large-table-disuader":248,"./paging":252,underscore:308}],251:[function(t,e,n){(function(){var n,r,i,o,s,a,u,l,c={}.hasOwnProperty,h=function(t,e){function n(){this.constructor=t}for(var r in e)c.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};i=200,l=t("underscore"),o=t("../../core-view"),r=t("./paging"),a='<ul class="pagination">\n    <li class="hidden-xs <%= gotoStart || \'im-goto-start\' %>" title="Go to start">\n        <a class="im-pagination-button">&#x21e4;</a>\n    </li>\n    <li class="hidden-xs hidden-sm <%= goFiveBack || \'im-go-back-5\' %>"\n        title="Go back five pages"\n        class="visible-desktop">\n        <a class="im-pagination-button">&#x219e;</a>\n    </li>\n    <li class="<%= goOneBack || \'im-go-back-1\' %>"\n        title="Go to previous page">\n        <a class="im-pagination-button">&larr;</a>\n    </li>\n    <li class="im-current-page">\n        <% if (useSelect) { %>\n          <form class="im-page-form form form-inline">\n            <select class="form-control">\n              <% for (i = 0; i < max; i++) { %>\n                <option\n                  <%= selected(i) ? \'selected\' : void 0 %>\n                  value="<%= i * size %>">\n                  page <%= i + 1 %>\n                </option>\n              <% } %>\n            </select>\n          </form>\n        <% } else { %>\n          <a href="#">&hellip;</a>\n          <form class="im-page-form form form-inline"\n                style="display:none;">\n            <div class="control-group">\n                <input type="number"\n                       value="<%= currentPage %>"\n                       max="<%= max %>"\n                       min="<%= min %>"\n                       class="form-control im-page-number">\n            </div>\n          </form>\n        <% } %>\n    </li>\n    <li class="<%= goOneForward || \'im-go-fwd-1\' %>"\n        title="Go to next page">\n        <a class="im-pagination-button">&rarr;</a>\n    </li>\n    <li class="hidden-xs hidden-sm <%= goFiveForward || \'im-go-fwd-5\' %>"\n        title="Go forward five pages"\n        class="visible-desktop">\n        <a class="im-pagination-button">&#x21a0;</a>\n    </li>\n    <li class="hidden-xs <%= gotoEnd || \'im-goto-end\' %>"\n        title="Go to last page">\n        <a class="im-pagination-button">&#x21e5;</a>\n    </li>\n</ul>\n',u=function(t){return t.replace(/\s+/g,"")},s=function(t){return"string"==typeof t?parseInt(u(t),10):t},e.exports=n=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return h(e,t),e.include(r),e.prototype.tagName="nav",e.prototype.className="im-table-pagination im-table-control",e.prototype.RERENDER_EVENT="change:start change:count change:size",e.prototype.template=l.template(a),e.prototype.modelEvents=function(){return{"change:count":this.setVisible}},e.prototype.getData=function(){var t,e,n,r,o,s;return s=this.model.toJSON(),o=s.start,r=s.size,t=s.count,n=this.getMaxPage(),e={max:n,min:1,size:r,currentPage:this.getCurrentPage(),gotoStart:0===o?"disabled":void 0,goFiveBack:5*r>o?"disabled":void 0,goOneBack:r>o?"disabled":void 0,gotoEnd:o>=t-r?"disabled":void 0,goFiveForward:o>=t-6*r?"disabled":void 0,goOneForward:o>=t-r?"disabled":void 0,selected:function(t){return o===t*r},useSelect:i>=n}},e.prototype.postRender=function(){return this.$("li").tooltip({placement:"top"}),this.setVisible()},e.prototype.setVisible=function(){var t;return t=this.getMaxPage(),this.$el.toggleClass("im-hidden",2>t)},e.prototype.events=function(){return{"submit .im-page-form":"pageFormSubmit","click .im-current-page a":"clickCurrentPage","change .im-page-form select":"goToChosenPage","blur .im-page-form input":"pageFormSubmit","click .im-goto-start":function(t){return function(){return t.goTo(0)}}(this),"click .im-go-back-5":function(t){return function(){return t.goBack(5)}}(this),"click .im-go-back-1":function(t){return function(){return t.goBack(1)}}(this),"click .im-go-fwd-5":function(t){return function(){return t.goForward(5)}}(this),"click .im-go-fwd-1":function(t){return function(){return t.goForward(1)}}(this),"click .im-goto-end":function(t){return function(){return t.goTo((t.getMaxPage()-1)*t.model.get("size"))}}(this)}},e.prototype.goToChosenPage=function(t){var e;return e=s(this.$(t.target).val()),this.goTo(e)},e.prototype.clickCurrentPage=function(t){var e,n;return e=this.model.get("size"),n=this.model.get("count"),e>=n?void 0:(this.$(t.target).hide(),this.$("form").show().find("input").focus())},e.prototype.pageFormSubmit=function(t){var e,n,r,i;return null!=t&&t.stopPropagation(),null!=t&&t.preventDefault(),i=this.$(".im-page-form"),n=this.$(".im-page-form input"),n.size()?(e=s(n[0].value),e>=1?(r=Math.min(this.getMaxPage(),e),this.goTo((r-1)*this.model.get("size")),this.$(".im-current-page > a").show(),i.hide()):(i.find(".control-group").addClass("error"),inp.val(null))):void 0},e}(o)}).call(this)},{"../../core-view":33,"./paging":252,underscore:308}],252:[function(t,e,n){(function(){n.getCurrentPage=function(){var t,e,n;return n=this.model.toJSON(),e=n.start,t=n.size,Math.floor(e/t)+1},n.getMaxPage=function(){var t,e,n,r;return r=this.model.toJSON(),e=r.count,n=r.size,t=e%n===0?0:1,Math.floor(e/n)+t},n.goTo=function(t){return this.model.set({start:t})},n.goToPage=function(t){return this.model.set({start:(t-1)*this.model.get("size")})},n.goBack=function(t){var e,n,r;return r=this.model.toJSON(),n=r.start,e=r.size,this.goTo(Math.max(0,n-t*e))},n.goForward=function(t){var e,n,r;return r=this.model.toJSON(),n=r.start,e=r.size,this.goTo(Math.min(this.getMaxPage()*e,n+t*e))}}).call(this)},{}],253:[function(t,e,n){(function(){var n,r,i,o,s,a={}.hasOwnProperty,u=function(t,e){function n(){this.constructor=t}for(var r in e)a.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};s=t("underscore"),n=t("../../core-view"),o=t("../../templates"),t("../../messages/subtables"),r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return u(e,t),e.prototype.tagName="th",e.prototype.parameters=["columnModel","model","query"],e.prototype.template=o.template("table-subtables-header"),e.prototype.getData=function(){return s.extend(e.__super__.getData.apply(this,arguments),this.columnModel.pick("columnName"))},e.prototype.modelEvents=function(){return{"change:displayName":this.reRender}},e.prototype.events=function(){return{"click a":this.removeView}},e.prototype.removeView=function(){var t;return this.query.removeFromSelect(null!=(t=this.model.get("replaces"))?t:this.model.get("path"))},e.prototype.postRender=function(){return this.$("[title]").tooltip()},e.prototype.initialize=function(){return e.__super__.initialize.apply(this,arguments),this.listenTo(this.columnModel,"change:columnName",this.reRender)},e.prototype.remove=function(){return delete this.columnModel,e.__super__.remove.apply(this,arguments)},e}(n),e.exports=i=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return u(e,t),e.prototype.tagName="thead",e.prototype.template=function(){return"<tr></tr>"},e.prototype.parameters=["collection","columnModel","query"],e.prototype.collectionEvents=function(){return{"add remove":this.reRender}},e.prototype.renderChildren=function(){var t;return t=this.el.querySelector("tr"),this.collection.forEach(function(e){return function(n,i){return e.renderChild(i,new r({model:n,query:e.query,columnModel:e.columnModel}),t)}}(this))},e.prototype.remove=function(){return delete this.columnModel,e.__super__.remove.apply(this,arguments)},e}(n)}).call(this)},{"../../core-view":33,"../../messages/subtables":56,"../../templates":97,underscore:308}],254:[function(t,e,n){(function(){var n,r,i,o,s={}.hasOwnProperty,a=function(t,e){function n(){this.constructor=t}for(var r in e)s.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};n=t("../../core-view"),r=t("./subtable-header"),o=t("../../utils/build-skipset"),e.exports=i=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return a(e,t),e.prototype.tagName="table",e.prototype.className="im-subtable table table-condensed table-striped",e.prototype.parameters=["query","headers","model","rows","cellify"],e.prototype.render=function(){var t,e,n,r,i,o;for(this.removeAllChildren(),this.rendered&&(this.el.innerHTML=""),this.headers.length>1&&this.renderHead(),n=document.createElement("tbody"),o=this.rows,t=r=0,i=o.length;i>r;t=++r)e=o[t],this.appendRow(e,t,n);return this.el.appendChild(n),this.trigger("rendered",this.rendered=!0),this},e.prototype.renderHead=function(t){var e;return e=new r({query:this.query,collection:this.headers,columnModel:this.model}),this.renderChild("thead",e,t)},e.prototype.buildSkipped=function(t){return null!=this._skipped?this._skipped:this._skipped=o(t,this.headers)},e.prototype.appendRow=function(t,e,n){var r,i,o,s,a,u,l,c,h;for(u=document.createElement("tr"),n.appendChild(u),o=function(){var e,n,i;for(i=[],e=0,n=t.length;n>e;e++)r=t[e],i.push(this.cellify(r));return i}.call(this),a=this.buildSkipped(o),h=[],s=l=0,c=o.length;c>l;s=++l)i=o[s],a[i.model.get("column")]||h.push(this.renderChild("cell-"+e+"-"+s,i,u));return h},e}(n)}).call(this)},{"../../core-view":33,"../../utils/build-skipset":102,"./subtable-header":253}],255:[function(t,e,n){(function(){var n,r,i,o,s={}.hasOwnProperty,a=function(t,e){function n(){this.constructor=t}for(var r in e)s.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};n=t("../../core-view"),r=t("../../messages"),o=t("../../templates"),t("../../messages/subtables"),e.exports=i=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return a(e,t),e.prototype.className="im-subtable-summary",e.prototype.tagName="span",e.prototype.template=o.template("table-subtable-summary"),e.prototype.parameters=["model","state"],e.prototype.modelEvents=function(){return{"change:contentName":this.reRender}},e.prototype.events=function(){return{click:this.onClick}},e.prototype.onClick=function(t){return null!=t&&t.stopPropagation(),this.$el.tooltip("hide"),this.state.toggle("open")},e.prototype.postRender=function(){return this.$el.tooltip({title:this.model.get("rows").length?r.getText("subtables.OpenHint"):void 0,placement:"auto right"})},e}(n)}).call(this)},{"../../core-view":33,"../../messages":46,"../../messages/subtables":56,"../../templates":97}],256:[function(t,e,n){(function(){var n,r,i,o,s,a,u,l,c,h,p,f,d,m,g={}.hasOwnProperty,y=function(t,e){function n(){this.constructor=t}for(var r in e)g.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};m=t("underscore"),r=t("../../core-view"),s=t("../../options"),n=t("../../core/collection"),p=t("../../templates"),f=t("../../core/type-assertions"),o=t("../../models/nested-table"),u=t("../../models/path"),h=t("./subtable-summary"),c=t("./subtable-inner"),d=t("../../utils/events").ignore,a=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return y(e,t),e.prototype.model=u,e}(n),i="Subtables.Initially.expanded",e.exports=l=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return y(e,t),e.prototype.tagName="td",e.prototype.className="im-result-subtable",e.prototype.Model=o,e.prototype.parameters=["query","cellify","expandedSubtables"],e.prototype.parameterTypes={query:f.Query,cellify:f.Function,expandedSubtables:f.Collection},e.prototype.initialize=function(){return e.__super__.initialize.apply(this,arguments),this.headers=new a,this.listenTo(this.expandedSubtables,"add remove reset",this.onChangeExpandedSubtables),this.buildHeaders()},e.prototype.getPath=function(){return this.model.get("column")},e.prototype.initState=function(){var t;return t=s.get(i)||this.expandedSubtables.contains(this.getPath()),this.state.set({open:t})},e.prototype.stateEvents=function(){return{"change:open":this.onChangeOpen}},e.prototype.onChangeOpen=function(){var t;return t=this.el.querySelector(".im-table-wrapper"),this.state.get("open")?this.renderTable(t)?this.$(t).slideDown():void 0:this.$(t).slideUp()},e.prototype.onChangeExpandedSubtables=function(){return this.state.set({open:this.expandedSubtables.contains(this.getPath())})},e.prototype.template=p.template("table-subtable"),e.prototype.renderChildren=function(){return this.renderChildAt(".im-subtable-summary",new h({model:this.model,state:this.state})),this.onChangeOpen()},e.prototype.tableRendered=!1,e.prototype.renderTable=function(t){var e,n;return n=this.model.get("rows"),this.tableRendered||0===n.length?this.tableRendered:(e=new c(m.extend({rows:n},m.pick(this,c.prototype.parameters))),this.renderChild("inner",e,t),this.tableRendered=!0)},e.prototype.buildHeaders=function(){var t,e;return e=this.model.get("rows")[0],null!=e?this.headers.set(function(){var n,r,i;for(i=[],n=0,r=e.length;r>n;n++)t=e[n],i.push(new u(t.get("column")));return i}()):void 0},e}(r)}).call(this)},{"../../core-view":33,"../../core/collection":35,"../../core/type-assertions":40,"../../models/nested-table":78,"../../models/path":86,"../../options":93,"../../templates":97,"../../utils/events":111,"./subtable-inner":254,"./subtable-summary":255,underscore:308}],257:[function(t,e,n){(function(){var n,r,i,o,s={}.hasOwnProperty,a=function(t,e){function n(){this.constructor=t}for(var r in e)s.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};o=t("underscore"),n=t("../../core-view"),i=t("../../templates"),t("../../messages/table"),e.exports=r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return a(e,t),e.prototype.className="im-table-summary hidden-phone",e.prototype.RERENDER_EVENT="change:start change:size change:count",e.prototype.getData=function(){var t,n,r,i,s;return s=n=e.__super__.getData.apply(this,arguments),i=s.start,r=s.size,t=s.count,o.extend(n,{page:{count:t,first:i+1,last:0===r?0:Math.min(i+r,t)}})},e.prototype.template=i.template("count_summary"),e}(n)}).call(this)},{"../../core-view":33,"../../messages/table":58,"../../templates":97,underscore:308}],258:[function(t,e,n){(function(){var n,r,i,o,s,a,u,l,c,h={}.hasOwnProperty,p=function(t,e){function n(){this.constructor=t}for(var r in e)h.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},f=[].indexOf||function(t){for(var e=0,n=this.length;n>e;e++)if(e in this&&this[e]===t)return e;return-1};c=t("underscore"),r=t("es6-promise").Promise,n=t("../messages"),o=t("../core-view"),n.set({"typeconstraints.BadType":"<%- type %> is not a legal value for this constraint. Choose another from the list.","typeconstraints.OneClass":"<%- name %> is the only legal value this constraint can have. You can always remove it though."}),l=t("../utils/to-named-path"),a=t("../templates/helpers"),u="<label class=\"span4\">\n    <%- messages.getText('conbuilder.IsA') %>\n</label>\n<% if (subclasses.length == 1) { %>\n  <select disabled class=\"form-control\">\n      <option><%- subclasses[0].text %></option>\n  </select>\n<% } else { %>\n  <%= select(subclasses, isSelected, 'form-control im-value-type') %>\n<% } %>\n  \n",s=function(t){var e,n;return n=t.path,e=t.name,{value:n,text:e}},e.exports=i=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return p(e,t),e.prototype.parameters=["query","model"],e.prototype.initialize=function(){return e.__super__.initialize.apply(this,arguments),this.model.swap("type",function(t){return function(e){return null!=e?e:t.model.get("path").getType().name}}(this)),this.listenTo(n,"change",this.reRender),this.listenTo(this.state,"change:subclasses",this.reRender),this.setSubclasses()},e.prototype.getData=function(){var t,e,r;return r=this.model.get("type"),t={select:a.select,messages:n,subclasses:function(){var t,n,r,i,o;for(i=null!=(r=this.state.get("subclasses"))?r:[],o=[],t=0,n=i.length;n>t;t++)e=i[t],o.push(s(e));return o}.call(this),isSelected:function(t){return r===t.value}}},e.prototype.events=function(){return{"change .im-value-type":"setType"}},e.prototype.setType=function(){return this.model.set({type:this.$(".im-value-type").val()})},e.prototype.template=c.template(u),e.prototype.setSubclasses=function(){return this.model.has("subclasses")?void 0:this.getPossibleTypes().then(function(t){return function(e){var r;return 1===e.length&&(r=n.getText("typeconstraints.OneClass",e[0]),t.model.set({error:{message:r,level:"warning"}})),t.state.set({subclasses:e})}}(this))},e.prototype.getPossibleTypes=function(){var t,e,i,o,s,a,u,c,h,p;return p=this.model.toJSON(),e=p.path,h=p.type,a=this.query.getSubclasses(),s=this.query.model,delete a[e],t=s.getPathInfo(e.toString(),a).getType(),u=function(){var e,n,r,i;for(r=s.getSubclassesOf(t),i=[],e=0,n=r.length;n>e;e++)c=r[e],c!==t.name&&i.push(c);return i}(),i=function(){var t,e,n;for(n=[],t=0,e=u.length;e>t;t++)c=u[t],n.push(s.makePath(c));return n}(),o=i.map(l),f.call(u,h)<0&&(this.model.set({error:new Error(n.getText("typeconstraints.BadType",this.model.toJSON()))}),o.push(r.resolve({path:h,name:this.model.get("typeName")}))),r.all(o)},e}(o)}).call(this)},{"../core-view":33,"../messages":46,"../templates/helpers":98,"../utils/to-named-path":139,"es6-promise":277,underscore:308}],259:[function(t,e,n){(function(){var n,r,i,o,s,a,u,l,c,h,p,f={}.hasOwnProperty,d=function(t,e){function n(){this.constructor=t}for(var r in e)f.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};p=t("underscore"),n=t("../core-view"),u=t("../templates"),o=t("../messages"),s=t("../options"),a=t("./undo-history/step"),c=function(t){return"state-"+t.get("revision")},r=-1,t("../messages/undo"),i=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return d(e,t),e.prototype.parameters=["more"],e.prototype.tagName="li",e.prototype.className="im-step im-ellipsis",e.prototype.template=function(){return p.escape(""+o.getText("undo.MoreSteps",{more:this.more})+" ...")},e.prototype.attributes=function(){return{title:o.getText("undo.ShowAllStates",{n:this.more})}},e.prototype.postRender=function(){return this.$el.tooltip({placement:"right"})},e.prototype.events=function(){return{click:function(t){return t.preventDefault(),t.stopPropagation(),this.state.toggle("showAll")}}},e}(n),h=function(t,e,n){var r;return r=n[e-1],0===e||e===n.length-1||t.get("count")!==r.get("count")},e.exports=l=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return d(e,t),e.prototype.parameters=["collection"],e.prototype.className="btn-group im-undo-history",e.prototype.template=u.template("undo-history"),e.prototype.events=function(){return{"click .btn.im-undo":"revertToPreviousState","click .im-toggle-trivial":"toggleTrivial"}},e.prototype.initState=function(){return this.state.set({showAll:!1,hideTrivial:!1})},e.prototype.stateEvents=function(){return{"change:showAll":this.reRender,"change:hideTrivial":this.reRender}},e.prototype.collectionEvents=function(){return{remove:this.removeStep,"add remove":this.reRender,"change:count":this.reRenderIfHidingTrivial}},e.prototype.toggleTrivial=function(t){return t.preventDefault(),t.stopPropagation(),this.state.toggle("hideTrivial")},e.prototype.revertToPreviousState=function(){return this.collection.popState()},e.prototype.reRenderIfHidingTrivial=function(){return this.state.get("hideTrivial")?this.reRender():void 0},e.prototype.postRender=function(){return this.$(".im-toggle-trivial").tooltip({placement:"right"}),this.$list=this.$(".im-state-list"),this.renderStates(),this.$el.toggleClass("im-has-history",this.collection.size()>1),this.$el.toggleClass("im-hidden",this.collection.size()<=1)},e.prototype.renderStates=function(){var t,e,n,i,o,a,u,l,c,p,f,d,m,g,y,v;for(f=this.state.toJSON(),u=f.showAll,n=f.hideTrivial,t=this.collection,o=n?t.filter(h):t.models.slice(),l=o.length,e=s.get("UndoHistory.ShowAllStatesCutOff"),a=u||e>=l?function(){g=[];for(var t=d=l-1;0>=d?0>=t:t>=0;0>=d?t++:t--)g.push(t);return g}.apply(this):function(){y=[];for(var t=m=l-1,n=l-(e-1);n>=m?n>=t:t>=n;n>=m?t++:t--)y.push(t);return y}.apply(this).concat([r,0]),v=[],c=0,p=a.length;p>c;c++)i=a[c],v.push(i===r?this.renderEllipsis(l-e):this.renderState(o[i]));return v},e.prototype.renderEllipsis=function(t){return this.renderChild("...",new i({more:t,state:this.state}),this.$list)},e.prototype.renderState=function(t){return this.renderChild(c(t),new a({model:t}),this.$list)},e.prototype.removeStep=function(t){return this.removeChild(c(t))},e}(n)}).call(this)},{"../core-view":33,"../messages":46,"../messages/undo":59,"../options":93,"../templates":97,"./undo-history/step":261,underscore:308}],260:[function(t,e,n){(function(){var n,r,i,o,s,a={}.hasOwnProperty,u=function(t,e){function n(){this.constructor=t}for(var r in e)a.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t};s=t("underscore"),r=t("../../core-view"),o=t("../../templates"),n=t("../../utils/css-class-set"),e.exports=i=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return u(e,t),e.prototype.template=o.template("undo-history-step-section"),e.prototype.labelContent=function(){throw new Error("NOT IMPLEMENTED")},e.prototype.summaryLabel=function(){return thow(new Error("NOT IMPLEMENTED"))},e.prototype.initState=function(){return this.state.set({open:!1})},e.prototype.initialize=function(){return e.__super__.initialize.apply(this,arguments),this.collectionClasses=new n({"well well-sm":!0,"im-hidden":function(t){return function(){return!t.state.get("open")}}(this)})},e.prototype.getData=function(){var t,n;return n=s.result(this,"summaryLabel"),t=this.collection.where({removed:!1}).length,s.extend(e.__super__.getData.apply(this,arguments),{count:t,summaryLabel:n,labelContent:this.labelContent,collectionClasses:this.collectionClasses})},e.prototype.events=function(){return{"click .im-section-summary":"toggleOpen"}},e.prototype.stateEvents=function(){return{"change:open":this.reRender}},e.prototype.collectionEvents=function(){return{change:this.reRender}},e.prototype.toggleOpen=function(t){return t.stopPropagation(),t.preventDefault(),this.state.toggle("open")},e}(r)}).call(this)},{"../../core-view":33,"../../templates":97,"../../utils/css-class-set":109,underscore:308}],261:[function(t,e,n){(function(){var n,r,i,o,s,a,u,l,c,h,p,f,d,m,g,y,v,b,_,w,x,C={}.hasOwnProperty,T=function(t,e){function n(){this.constructor=t}for(var r in e)C.call(e,r)&&(t[r]=e[r]);return n.prototype=e.prototype,t.prototype=new n,t.__super__=e.prototype,t},S=[].indexOf||function(t){for(var e=0,n=this.length;n>e;e++)if(e in this&&this[e]===t)return e;return-1};x=t("underscore"),s=t("../../core-view"),n=t("../../core/collection"),m=t("../../templates"),a=t("../../messages"),c=t("../../models/path"),i=t("../../models/constraint"),l=t("../../models/order-element"),h=t("./query-property-section"),t("../../messages/undo"),t("../../messages/constraints"),w=function(t){var e;return e=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return T(e,t),e.prototype.defaults=function(){return x.extend(e.__super__.defaults.apply(this,arguments),{added:!1,removed:!1})},e}(t)},u=function(t){function e(t){var n;n=t.path,e.__super__.constructor.call(this,n)}return T(e,t),e}(c),y=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return T(e,t),e.prototype.model=w(u),e}(n),r=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return T(e,t),e.prototype.model=w(i),e}(n),f=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return T(e,t),e.prototype.model=w(l),e}(n),b=function(t){return function(e){var n;return e=x.isString(e)?{path:e}:e,n={path:t.makePath(e.path)},e.type&&(n.type=t.model.makePath(e.type)),x.extend(n,x.omit(e,"path","type"))}},e.exports=g=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return T(e,t),e.prototype.className="im-step",e.prototype.tagName="li",e.prototype.template=m.template("undo-history-step"),e.prototype.getData=function(){return x.extend(e.__super__.getData.apply(this,arguments),{diff:this.getCountDiff()})},e.prototype.getCountDiff=function(){return this.state.has("prevCount")?this.model.get("count")-this.state.get("prevCount"):null},e.prototype.initialize=function(){var t,n,i,o;if(e.__super__.initialize.apply(this,arguments),n=this.model.get("query"),this.initPrevCount(),t=b(n),this.listenTo(this.model.collection,"add remove",this.setCurrent),this.views=new y(n.views.map(t)),this.constraints=new r(n.constraints.map(t)),this.sortOrder=new f(n.sortOrder.map(t)),i=this.model.get("title"),"Added"===(o=i.verb)||"Removed"===o||"Changed"===o)switch(i.label){case"column":return this.diffView();case"sort order element":return this.diffSortOrder();case"filter":return this.diffConstraints();case"Initial":return null;default:return console.error("Cannot diff",i.label)}},e.prototype.initPrevCount=function(){var t;return(t=this.getPrevModel())?(this.state.set({prevCount:t.get("count")}),this.listenTo(t,"change:count",function(e){return function(){return e.state.set({prevCount:t.get("count")})}}(this))):void 0},e.prototype.getPrevModel=function(){var t;return t=this.model.collection.indexOf(this.model),0===t?null:this.model.collection.at(t-1)},e.prototype.diff=function(t,e,n){var r,i,o,s,a,u,l,c,h,p,f,d,m;for(a=this.getPrevModel(),r=this.model.get("query"),u=a.get("query"),f=r[t],o=l=0,h=f.length;h>l;o=++l)i=f[o],n(i,u)&&e.at(o).set({added:!0});for(s=b(u),d=u[t],m=[],o=c=0,p=d.length;p>c;o=++c)i=d[o],n(i,r)&&m.push(e.add(s(i),{at:o}).set({removed:!0}));return m},e.prototype.diffView=function(){return this.diff("views",this.views,function(t,e){var n;return n=e.views,S.call(n,t)<0})},e.prototype.diffSortOrder=function(){return this.diff("sortOrder",this.sortOrder,function(t,e){return!x.findWhere(e.sortOrder,t)})},e.prototype.diffConstraints=function(){return this.diff("constraints",this.constraints,function(t,e){return!x.findWhere(e.constraints,t)})},e.prototype.initState=function(){return this.setCurrent()},e.prototype.setCurrent=function(){var t,e,n;if(null!=(n=this.model)?n.collection:void 0)return t=this.model.collection.indexOf(this.model),e=this.model.collection.size(),this.state.set({current:t===e-1})},e.prototype.stateEvents=function(){return{change:this.reRender}},e.prototype.modelEvents=function(){return{change:this.reRender}},e.prototype.events=function(){return{"click .btn.im-state-revert":"revertToState",click:function(t){return t.preventDefault(),t.stopPropagation()}}},e.prototype.revertToState=function(){return this.model.collection.revertTo(this.model)},e.prototype.postRender=function(){var t;if(this.$details=this.$(".im-step-details"),this.$el.toggleClass("im-current-state",this.state.get("current")),this.$(".btn[title]").tooltip({placement:"right"}),this.state.get("current"))return this.renderAllSections();switch(t=this.model.get("title"),t.label){case"column":return this.renderViews();case"filter":return this.renderConstraints();case"sort order element":return this.renderSortOrder();case"Initial":return null;default:return console.error("Cannot render",t.label)}},e.prototype.renderAllSections=function(){return this.renderViews(),this.renderConstraints(),this.renderSortOrder()},e.prototype.renderViews=function(){return this.renderChild("views",new p({collection:this.views}),this.$details)},e.prototype.renderSortOrder=function(){return this.renderChild("so",new d({collection:this.sortOrder}),this.$details)},e.prototype.renderConstraints=function(){return this.renderChild("cons",new o({collection:this.constraints}),this.$details)},e}(s),p=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return T(e,t),e.prototype.summaryLabel="undo.ViewCount",e.prototype.labelContent=function(t){return t.displayName},e}(h),d=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return T(e,t),e.prototype.summaryLabel="undo.OrderElemCount",e.prototype.labelContent=function(t){return""+t.displayName+" "+t.direction},e}(h),_=function(t){return a.getText("constraints.NoOfValues",{n:t.values.length})},v=function(t){return a.getText("constraints.NoOfIds",{n:t.ids.length})},o=function(t){function e(){return e.__super__.constructor.apply(this,arguments)}return T(e,t),e.prototype.summaryLabel="undo.ConstraintCount",e.prototype.labelContent=function(t){var e;return e=function(){switch(t.CONSTRAINT_TYPE){case"MULTI_VALUE":return[t.displayName,t.op,t.values.length,_(t)];case"TYPE":return[t.displayName,a.getText("constraints.ISA"),t.typeName];case"IDS":return[t.displayName,t.op,v(t)];case"LOOKUP":return[t.displayName,t.op,t.value,a.getText("constraints.LookupIn"),t.extraValue];default:return[t.displayName,t.op,t.value]}}(),e.join(" ")},e}(h)}).call(this)},{"../../core-view":33,"../../core/collection":35,"../../messages":46,"../../messages/constraints":51,"../../messages/undo":59,"../../models/constraint":70,"../../models/order-element":83,"../../models/path":86,"../../templates":97,"./query-property-section":260,underscore:308}],262:[function(t,e,n){(function(e){!function(r){var i="object"==typeof self&&self.self==self&&self||"object"==typeof e&&e.global==e&&e;if("function"==typeof define&&define.amd)define(["underscore","jquery","exports"],function(t,e,n){i.Backbone=r(i,n,t,e)});else if("undefined"!=typeof n){var o,s=t("underscore");try{o=t("jquery")}catch(a){}r(i,n,s,o)}else i.Backbone=r(i,{},i._,i.jQuery||i.Zepto||i.ender||i.$)}(function(t,e,n,r){var i=t.Backbone,o=Array.prototype.slice;e.VERSION="1.2.2",e.$=r,e.noConflict=function(){return t.Backbone=i,this},e.emulateHTTP=!1,e.emulateJSON=!1;var s=function(t,e,r){switch(t){case 1:return function(){return n[e](this[r])};case 2:return function(t){return n[e](this[r],t)};case 3:return function(t,i){return n[e](this[r],u(t,this),i)};case 4:return function(t,i,o){return n[e](this[r],u(t,this),i,o)};default:return function(){var t=o.call(arguments);return t.unshift(this[r]),n[e].apply(n,t)}}},a=function(t,e,r){n.each(e,function(e,i){n[i]&&(t.prototype[i]=s(e,i,r))})},u=function(t,e){return n.isFunction(t)?t:n.isObject(t)&&!e._isModel(t)?l(t):n.isString(t)?function(e){return e.get(t)}:t},l=function(t){var e=n.matches(t);return function(t){return e(t.attributes)}},c=e.Events={},h=/\s+/,p=function(t,e,r,i,o){var s,a=0;if(r&&"object"==typeof r){void 0!==i&&"context"in o&&void 0===o.context&&(o.context=i);for(s=n.keys(r);a<s.length;a++)e=p(t,e,s[a],r[s[a]],o)}else if(r&&h.test(r))for(s=r.split(h);a<s.length;a++)e=t(e,s[a],i,o);else e=t(e,r,i,o);return e};c.on=function(t,e,n){return f(this,t,e,n)};var f=function(t,e,n,r,i){if(t._events=p(d,t._events||{},e,n,{context:r,ctx:t,listening:i}),i){var o=t._listeners||(t._listeners={});o[i.id]=i}return t};c.listenTo=function(t,e,r){if(!t)return this;var i=t._listenId||(t._listenId=n.uniqueId("l")),o=this._listeningTo||(this._listeningTo={}),s=o[i];

if(!s){var a=this._listenId||(this._listenId=n.uniqueId("l"));s=o[i]={obj:t,objId:i,id:a,listeningTo:o,count:0}}return f(t,e,r,this,s),this};var d=function(t,e,n,r){if(n){var i=t[e]||(t[e]=[]),o=r.context,s=r.ctx,a=r.listening;a&&a.count++,i.push({callback:n,context:o,ctx:o||s,listening:a})}return t};c.off=function(t,e,n){return this._events?(this._events=p(m,this._events,t,e,{context:n,listeners:this._listeners}),this):this},c.stopListening=function(t,e,r){var i=this._listeningTo;if(!i)return this;for(var o=t?[t._listenId]:n.keys(i),s=0;s<o.length;s++){var a=i[o[s]];if(!a)break;a.obj.off(e,r,this)}return n.isEmpty(i)&&(this._listeningTo=void 0),this};var m=function(t,e,r,i){if(t){var o,s=0,a=i.context,u=i.listeners;if(e||r||a){for(var l=e?[e]:n.keys(t);s<l.length;s++){e=l[s];var c=t[e];if(!c)break;for(var h=[],p=0;p<c.length;p++){var f=c[p];r&&r!==f.callback&&r!==f.callback._callback||a&&a!==f.context?h.push(f):(o=f.listening,o&&0===--o.count&&(delete u[o.id],delete o.listeningTo[o.objId]))}h.length?t[e]=h:delete t[e]}return n.size(t)?t:void 0}for(var d=n.keys(u);s<d.length;s++)o=u[d[s]],delete u[o.id],delete o.listeningTo[o.objId]}};c.once=function(t,e,r){var i=p(g,{},t,e,n.bind(this.off,this));return this.on(i,void 0,r)},c.listenToOnce=function(t,e,r){var i=p(g,{},e,r,n.bind(this.stopListening,this,t));return this.listenTo(t,i)};var g=function(t,e,r,i){if(r){var o=t[e]=n.once(function(){i(e,o),r.apply(this,arguments)});o._callback=r}return t};c.trigger=function(t){if(!this._events)return this;for(var e=Math.max(0,arguments.length-1),n=Array(e),r=0;e>r;r++)n[r]=arguments[r+1];return p(y,this._events,t,void 0,n),this};var y=function(t,e,n,r){if(t){var i=t[e],o=t.all;i&&o&&(o=o.slice()),i&&v(i,r),o&&v(o,[e].concat(r))}return t},v=function(t,e){var n,r=-1,i=t.length,o=e[0],s=e[1],a=e[2];switch(e.length){case 0:for(;++r<i;)(n=t[r]).callback.call(n.ctx);return;case 1:for(;++r<i;)(n=t[r]).callback.call(n.ctx,o);return;case 2:for(;++r<i;)(n=t[r]).callback.call(n.ctx,o,s);return;case 3:for(;++r<i;)(n=t[r]).callback.call(n.ctx,o,s,a);return;default:for(;++r<i;)(n=t[r]).callback.apply(n.ctx,e);return}};c.bind=c.on,c.unbind=c.off,n.extend(e,c);var b=e.Model=function(t,e){var r=t||{};e||(e={}),this.cid=n.uniqueId(this.cidPrefix),this.attributes={},e.collection&&(this.collection=e.collection),e.parse&&(r=this.parse(r,e)||{}),r=n.defaults({},r,n.result(this,"defaults")),this.set(r,e),this.changed={},this.initialize.apply(this,arguments)};n.extend(b.prototype,c,{changed:null,validationError:null,idAttribute:"id",cidPrefix:"c",initialize:function(){},toJSON:function(t){return n.clone(this.attributes)},sync:function(){return e.sync.apply(this,arguments)},get:function(t){return this.attributes[t]},escape:function(t){return n.escape(this.get(t))},has:function(t){return null!=this.get(t)},matches:function(t){return!!n.iteratee(t,this)(this.attributes)},set:function(t,e,r){if(null==t)return this;var i;if("object"==typeof t?(i=t,r=e):(i={})[t]=e,r||(r={}),!this._validate(i,r))return!1;var o=r.unset,s=r.silent,a=[],u=this._changing;this._changing=!0,u||(this._previousAttributes=n.clone(this.attributes),this.changed={});var l=this.attributes,c=this.changed,h=this._previousAttributes;for(var p in i)e=i[p],n.isEqual(l[p],e)||a.push(p),n.isEqual(h[p],e)?delete c[p]:c[p]=e,o?delete l[p]:l[p]=e;if(this.id=this.get(this.idAttribute),!s){a.length&&(this._pending=r);for(var f=0;f<a.length;f++)this.trigger("change:"+a[f],this,l[a[f]],r)}if(u)return this;if(!s)for(;this._pending;)r=this._pending,this._pending=!1,this.trigger("change",this,r);return this._pending=!1,this._changing=!1,this},unset:function(t,e){return this.set(t,void 0,n.extend({},e,{unset:!0}))},clear:function(t){var e={};for(var r in this.attributes)e[r]=void 0;return this.set(e,n.extend({},t,{unset:!0}))},hasChanged:function(t){return null==t?!n.isEmpty(this.changed):n.has(this.changed,t)},changedAttributes:function(t){if(!t)return this.hasChanged()?n.clone(this.changed):!1;var e=this._changing?this._previousAttributes:this.attributes,r={};for(var i in t){var o=t[i];n.isEqual(e[i],o)||(r[i]=o)}return n.size(r)?r:!1},previous:function(t){return null!=t&&this._previousAttributes?this._previousAttributes[t]:null},previousAttributes:function(){return n.clone(this._previousAttributes)},fetch:function(t){t=n.extend({parse:!0},t);var e=this,r=t.success;return t.success=function(n){var i=t.parse?e.parse(n,t):n;return e.set(i,t)?(r&&r.call(t.context,e,n,t),void e.trigger("sync",e,n,t)):!1},z(this,t),this.sync("read",this,t)},save:function(t,e,r){var i;null==t||"object"==typeof t?(i=t,r=e):(i={})[t]=e,r=n.extend({validate:!0,parse:!0},r);var o=r.wait;if(i&&!o){if(!this.set(i,r))return!1}else if(!this._validate(i,r))return!1;var s=this,a=r.success,u=this.attributes;r.success=function(t){s.attributes=u;var e=r.parse?s.parse(t,r):t;return o&&(e=n.extend({},i,e)),e&&!s.set(e,r)?!1:(a&&a.call(r.context,s,t,r),void s.trigger("sync",s,t,r))},z(this,r),i&&o&&(this.attributes=n.extend({},u,i));var l=this.isNew()?"create":r.patch?"patch":"update";"patch"!==l||r.attrs||(r.attrs=i);var c=this.sync(l,this,r);return this.attributes=u,c},destroy:function(t){t=t?n.clone(t):{};var e=this,r=t.success,i=t.wait,o=function(){e.stopListening(),e.trigger("destroy",e,e.collection,t)};t.success=function(n){i&&o(),r&&r.call(t.context,e,n,t),e.isNew()||e.trigger("sync",e,n,t)};var s=!1;return this.isNew()?n.defer(t.success):(z(this,t),s=this.sync("delete",this,t)),i||o(),s},url:function(){var t=n.result(this,"urlRoot")||n.result(this.collection,"url")||F();if(this.isNew())return t;var e=this.get(this.idAttribute);return t.replace(/[^\/]$/,"$&/")+encodeURIComponent(e)},parse:function(t,e){return t},clone:function(){return new this.constructor(this.attributes)},isNew:function(){return!this.has(this.idAttribute)},isValid:function(t){return this._validate({},n.defaults({validate:!0},t))},_validate:function(t,e){if(!e.validate||!this.validate)return!0;t=n.extend({},this.attributes,t);var r=this.validationError=this.validate(t,e)||null;return r?(this.trigger("invalid",this,r,n.extend(e,{validationError:r})),!1):!0}});var _={keys:1,values:1,pairs:1,invert:1,pick:0,omit:0,chain:1,isEmpty:1};a(b,_,"attributes");var w=e.Collection=function(t,e){e||(e={}),e.model&&(this.model=e.model),void 0!==e.comparator&&(this.comparator=e.comparator),this._reset(),this.initialize.apply(this,arguments),t&&this.reset(t,n.extend({silent:!0},e))},x={add:!0,remove:!0,merge:!0},C={add:!0,remove:!1},T=function(t,e,n){for(var r=Array(t.length-n),i=e.length,o=0;o<r.length;o++)r[o]=t[o+n];for(o=0;i>o;o++)t[o+n]=e[o];for(o=0;o<r.length;o++)t[o+i+n]=r[o]};n.extend(w.prototype,c,{model:b,initialize:function(){},toJSON:function(t){return this.map(function(e){return e.toJSON(t)})},sync:function(){return e.sync.apply(this,arguments)},add:function(t,e){return this.set(t,n.extend({merge:!1},e,C))},remove:function(t,e){e=n.extend({},e);var r=!n.isArray(t);t=r?[t]:n.clone(t);var i=this._removeModels(t,e);return!e.silent&&i&&this.trigger("update",this,e),r?i[0]:i},set:function(t,e){if(null!=t){e=n.defaults({},e,x),e.parse&&!this._isModel(t)&&(t=this.parse(t,e));var r=!n.isArray(t);t=r?[t]:t.slice();var i=e.at;null!=i&&(i=+i),0>i&&(i+=this.length+1);for(var o,s=[],a=[],u=[],l={},c=e.add,h=e.merge,p=e.remove,f=!1,d=this.comparator&&null==i&&e.sort!==!1,m=n.isString(this.comparator)?this.comparator:null,g=0;g<t.length;g++){o=t[g];var y=this.get(o);if(y){if(h&&o!==y){var v=this._isModel(o)?o.attributes:o;e.parse&&(v=y.parse(v,e)),y.set(v,e),d&&!f&&(f=y.hasChanged(m))}l[y.cid]||(l[y.cid]=!0,s.push(y)),t[g]=y}else c&&(o=t[g]=this._prepareModel(o,e),o&&(a.push(o),this._addReference(o,e),l[o.cid]=!0,s.push(o)))}if(p){for(g=0;g<this.length;g++)o=this.models[g],l[o.cid]||u.push(o);u.length&&this._removeModels(u,e)}var b=!1,_=!d&&c&&p;if(s.length&&_?(b=this.length!=s.length||n.some(this.models,function(t,e){return t!==s[e]}),this.models.length=0,T(this.models,s,0),this.length=this.models.length):a.length&&(d&&(f=!0),T(this.models,a,null==i?this.length:i),this.length=this.models.length),f&&this.sort({silent:!0}),!e.silent){for(g=0;g<a.length;g++)null!=i&&(e.index=i+g),o=a[g],o.trigger("add",o,this,e);(f||b)&&this.trigger("sort",this,e),(a.length||u.length)&&this.trigger("update",this,e)}return r?t[0]:t}},reset:function(t,e){e=e?n.clone(e):{};for(var r=0;r<this.models.length;r++)this._removeReference(this.models[r],e);return e.previousModels=this.models,this._reset(),t=this.add(t,n.extend({silent:!0},e)),e.silent||this.trigger("reset",this,e),t},push:function(t,e){return this.add(t,n.extend({at:this.length},e))},pop:function(t){var e=this.at(this.length-1);return this.remove(e,t)},unshift:function(t,e){return this.add(t,n.extend({at:0},e))},shift:function(t){var e=this.at(0);return this.remove(e,t)},slice:function(){return o.apply(this.models,arguments)},get:function(t){if(null==t)return void 0;var e=this.modelId(this._isModel(t)?t.attributes:t);return this._byId[t]||this._byId[e]||this._byId[t.cid]},at:function(t){return 0>t&&(t+=this.length),this.models[t]},where:function(t,e){return this[e?"find":"filter"](t)},findWhere:function(t){return this.where(t,!0)},sort:function(t){var e=this.comparator;if(!e)throw new Error("Cannot sort a set without a comparator");t||(t={});var r=e.length;return n.isFunction(e)&&(e=n.bind(e,this)),1===r||n.isString(e)?this.models=this.sortBy(e):this.models.sort(e),t.silent||this.trigger("sort",this,t),this},pluck:function(t){return n.invoke(this.models,"get",t)},fetch:function(t){t=n.extend({parse:!0},t);var e=t.success,r=this;return t.success=function(n){var i=t.reset?"reset":"set";r[i](n,t),e&&e.call(t.context,r,n,t),r.trigger("sync",r,n,t)},z(this,t),this.sync("read",this,t)},create:function(t,e){e=e?n.clone(e):{};var r=e.wait;if(t=this._prepareModel(t,e),!t)return!1;r||this.add(t,e);var i=this,o=e.success;return e.success=function(t,e,n){r&&i.add(t,n),o&&o.call(n.context,t,e,n)},t.save(null,e),t},parse:function(t,e){return t},clone:function(){return new this.constructor(this.models,{model:this.model,comparator:this.comparator})},modelId:function(t){return t[this.model.prototype.idAttribute||"id"]},_reset:function(){this.length=0,this.models=[],this._byId={}},_prepareModel:function(t,e){if(this._isModel(t))return t.collection||(t.collection=this),t;e=e?n.clone(e):{},e.collection=this;var r=new this.model(t,e);return r.validationError?(this.trigger("invalid",this,r.validationError,e),!1):r},_removeModels:function(t,e){for(var n=[],r=0;r<t.length;r++){var i=this.get(t[r]);if(i){var o=this.indexOf(i);this.models.splice(o,1),this.length--,e.silent||(e.index=o,i.trigger("remove",i,this,e)),n.push(i),this._removeReference(i,e)}}return n.length?n:!1},_isModel:function(t){return t instanceof b},_addReference:function(t,e){this._byId[t.cid]=t;var n=this.modelId(t.attributes);null!=n&&(this._byId[n]=t),t.on("all",this._onModelEvent,this)},_removeReference:function(t,e){delete this._byId[t.cid];var n=this.modelId(t.attributes);null!=n&&delete this._byId[n],this===t.collection&&delete t.collection,t.off("all",this._onModelEvent,this)},_onModelEvent:function(t,e,n,r){if("add"!==t&&"remove"!==t||n===this){if("destroy"===t&&this.remove(e,r),"change"===t){var i=this.modelId(e.previousAttributes()),o=this.modelId(e.attributes);i!==o&&(null!=i&&delete this._byId[i],null!=o&&(this._byId[o]=e))}this.trigger.apply(this,arguments)}}});var S={forEach:3,each:3,map:3,collect:3,reduce:4,foldl:4,inject:4,reduceRight:4,foldr:4,find:3,detect:3,filter:3,select:3,reject:3,every:3,all:3,some:3,any:3,include:3,includes:3,contains:3,invoke:0,max:3,min:3,toArray:1,size:1,first:3,head:3,take:3,initial:3,rest:3,tail:3,drop:3,last:3,without:0,difference:0,indexOf:3,shuffle:1,lastIndexOf:3,isEmpty:1,chain:1,sample:3,partition:3,groupBy:3,countBy:3,sortBy:3,indexBy:3};a(w,S,"models");var E=e.View=function(t){this.cid=n.uniqueId("view"),n.extend(this,n.pick(t,k)),this._ensureElement(),this.initialize.apply(this,arguments)},N=/^(\S+)\s*(.*)$/,k=["model","collection","el","id","attributes","className","tagName","events"];n.extend(E.prototype,c,{tagName:"div",$:function(t){return this.$el.find(t)},initialize:function(){},render:function(){return this},remove:function(){return this._removeElement(),this.stopListening(),this},_removeElement:function(){this.$el.remove()},setElement:function(t){return this.undelegateEvents(),this._setElement(t),this.delegateEvents(),this},_setElement:function(t){this.$el=t instanceof e.$?t:e.$(t),this.el=this.$el[0]},delegateEvents:function(t){if(t||(t=n.result(this,"events")),!t)return this;this.undelegateEvents();for(var e in t){var r=t[e];if(n.isFunction(r)||(r=this[r]),r){var i=e.match(N);this.delegate(i[1],i[2],n.bind(r,this))}}return this},delegate:function(t,e,n){return this.$el.on(t+".delegateEvents"+this.cid,e,n),this},undelegateEvents:function(){return this.$el&&this.$el.off(".delegateEvents"+this.cid),this},undelegate:function(t,e,n){return this.$el.off(t+".delegateEvents"+this.cid,e,n),this},_createElement:function(t){return document.createElement(t)},_ensureElement:function(){if(this.el)this.setElement(n.result(this,"el"));else{var t=n.extend({},n.result(this,"attributes"));this.id&&(t.id=n.result(this,"id")),this.className&&(t["class"]=n.result(this,"className")),this.setElement(this._createElement(n.result(this,"tagName"))),this._setAttributes(t)}},_setAttributes:function(t){this.$el.attr(t)}}),e.sync=function(t,r,i){var o=M[t];n.defaults(i||(i={}),{emulateHTTP:e.emulateHTTP,emulateJSON:e.emulateJSON});var s={type:o,dataType:"json"};if(i.url||(s.url=n.result(r,"url")||F()),null!=i.data||!r||"create"!==t&&"update"!==t&&"patch"!==t||(s.contentType="application/json",s.data=JSON.stringify(i.attrs||r.toJSON(i))),i.emulateJSON&&(s.contentType="application/x-www-form-urlencoded",s.data=s.data?{model:s.data}:{}),i.emulateHTTP&&("PUT"===o||"DELETE"===o||"PATCH"===o)){s.type="POST",i.emulateJSON&&(s.data._method=o);var a=i.beforeSend;i.beforeSend=function(t){return t.setRequestHeader("X-HTTP-Method-Override",o),a?a.apply(this,arguments):void 0}}"GET"===s.type||i.emulateJSON||(s.processData=!1);var u=i.error;i.error=function(t,e,n){i.textStatus=e,i.errorThrown=n,u&&u.call(i.context,t,e,n)};var l=i.xhr=e.ajax(n.extend(s,i));return r.trigger("request",r,l,i),l};var M={create:"POST",update:"PUT",patch:"PATCH","delete":"DELETE",read:"GET"};e.ajax=function(){return e.$.ajax.apply(e.$,arguments)};var P=e.Router=function(t){t||(t={}),t.routes&&(this.routes=t.routes),this._bindRoutes(),this.initialize.apply(this,arguments)},O=/\((.*?)\)/g,A=/(\(\?)?:\w+/g,R=/\*\w+/g,I=/[\-{}\[\]+?.,\\\^$|#\s]/g;n.extend(P.prototype,c,{initialize:function(){},route:function(t,r,i){n.isRegExp(t)||(t=this._routeToRegExp(t)),n.isFunction(r)&&(i=r,r=""),i||(i=this[r]);var o=this;return e.history.route(t,function(n){var s=o._extractParameters(t,n);o.execute(i,s,r)!==!1&&(o.trigger.apply(o,["route:"+r].concat(s)),o.trigger("route",r,s),e.history.trigger("route",o,r,s))}),this},execute:function(t,e,n){t&&t.apply(this,e)},navigate:function(t,n){return e.history.navigate(t,n),this},_bindRoutes:function(){if(this.routes){this.routes=n.result(this,"routes");for(var t,e=n.keys(this.routes);null!=(t=e.pop());)this.route(t,this.routes[t])}},_routeToRegExp:function(t){return t=t.replace(I,"\\$&").replace(O,"(?:$1)?").replace(A,function(t,e){return e?t:"([^/?]+)"}).replace(R,"([^?]*?)"),new RegExp("^"+t+"(?:\\?([\\s\\S]*))?$")},_extractParameters:function(t,e){var r=t.exec(e).slice(1);return n.map(r,function(t,e){return e===r.length-1?t||null:t?decodeURIComponent(t):null})}});var D=e.History=function(){this.handlers=[],this.checkUrl=n.bind(this.checkUrl,this),"undefined"!=typeof window&&(this.location=window.location,this.history=window.history)},L=/^[#\/]|\s+$/g,q=/^\/+|\/+$/g,j=/#.*$/;D.started=!1,n.extend(D.prototype,c,{interval:50,atRoot:function(){var t=this.location.pathname.replace(/[^\/]$/,"$&/");return t===this.root&&!this.getSearch()},matchRoot:function(){var t=this.decodeFragment(this.location.pathname),e=t.slice(0,this.root.length-1)+"/";return e===this.root},decodeFragment:function(t){return decodeURI(t.replace(/%25/g,"%2525"))},getSearch:function(){var t=this.location.href.replace(/#.*/,"").match(/\?.+/);return t?t[0]:""},getHash:function(t){var e=(t||this).location.href.match(/#(.*)$/);return e?e[1]:""},getPath:function(){var t=this.decodeFragment(this.location.pathname+this.getSearch()).slice(this.root.length-1);return"/"===t.charAt(0)?t.slice(1):t},getFragment:function(t){return null==t&&(t=this._usePushState||!this._wantsHashChange?this.getPath():this.getHash()),t.replace(L,"")},start:function(t){if(D.started)throw new Error("Backbone.history has already been started");if(D.started=!0,this.options=n.extend({root:"/"},this.options,t),this.root=this.options.root,this._wantsHashChange=this.options.hashChange!==!1,this._hasHashChange="onhashchange"in window&&(void 0===document.documentMode||document.documentMode>7),this._useHashChange=this._wantsHashChange&&this._hasHashChange,this._wantsPushState=!!this.options.pushState,this._hasPushState=!(!this.history||!this.history.pushState),this._usePushState=this._wantsPushState&&this._hasPushState,this.fragment=this.getFragment(),this.root=("/"+this.root+"/").replace(q,"/"),this._wantsHashChange&&this._wantsPushState){if(!this._hasPushState&&!this.atRoot()){var e=this.root.slice(0,-1)||"/";return this.location.replace(e+"#"+this.getPath()),!0}this._hasPushState&&this.atRoot()&&this.navigate(this.getHash(),{replace:!0})}if(!this._hasHashChange&&this._wantsHashChange&&!this._usePushState){this.iframe=document.createElement("iframe"),this.iframe.src="javascript:0",this.iframe.style.display="none",this.iframe.tabIndex=-1;var r=document.body,i=r.insertBefore(this.iframe,r.firstChild).contentWindow;i.document.open(),i.document.close(),i.location.hash="#"+this.fragment}var o=window.addEventListener||function(t,e){return attachEvent("on"+t,e)};return this._usePushState?o("popstate",this.checkUrl,!1):this._useHashChange&&!this.iframe?o("hashchange",this.checkUrl,!1):this._wantsHashChange&&(this._checkUrlInterval=setInterval(this.checkUrl,this.interval)),this.options.silent?void 0:this.loadUrl()},stop:function(){var t=window.removeEventListener||function(t,e){return detachEvent("on"+t,e)};this._usePushState?t("popstate",this.checkUrl,!1):this._useHashChange&&!this.iframe&&t("hashchange",this.checkUrl,!1),this.iframe&&(document.body.removeChild(this.iframe),this.iframe=null),this._checkUrlInterval&&clearInterval(this._checkUrlInterval),D.started=!1},route:function(t,e){this.handlers.unshift({route:t,callback:e})},checkUrl:function(t){var e=this.getFragment();return e===this.fragment&&this.iframe&&(e=this.getHash(this.iframe.contentWindow)),e===this.fragment?!1:(this.iframe&&this.navigate(e),void this.loadUrl())},loadUrl:function(t){return this.matchRoot()?(t=this.fragment=this.getFragment(t),n.some(this.handlers,function(e){return e.route.test(t)?(e.callback(t),!0):void 0})):!1},navigate:function(t,e){if(!D.started)return!1;e&&e!==!0||(e={trigger:!!e}),t=this.getFragment(t||"");var n=this.root;(""===t||"?"===t.charAt(0))&&(n=n.slice(0,-1)||"/");var r=n+t;if(t=this.decodeFragment(t.replace(j,"")),this.fragment!==t){if(this.fragment=t,this._usePushState)this.history[e.replace?"replaceState":"pushState"]({},document.title,r);else{if(!this._wantsHashChange)return this.location.assign(r);if(this._updateHash(this.location,t,e.replace),this.iframe&&t!==this.getHash(this.iframe.contentWindow)){var i=this.iframe.contentWindow;e.replace||(i.document.open(),i.document.close()),this._updateHash(i.location,t,e.replace)}}return e.trigger?this.loadUrl(t):void 0}},_updateHash:function(t,e,n){if(n){var r=t.href.replace(/(javascript:|#).*$/,"");t.replace(r+"#"+e)}else t.hash="#"+e}}),e.history=new D;var $=function(t,e){var r,i=this;r=t&&n.has(t,"constructor")?t.constructor:function(){return i.apply(this,arguments)},n.extend(r,i,e);var o=function(){this.constructor=r};return o.prototype=i.prototype,r.prototype=new o,t&&n.extend(r.prototype,t),r.__super__=i.prototype,r};b.extend=w.extend=P.extend=E.extend=D.extend=$;var F=function(){throw new Error('A "url" property or function must be specified')},z=function(t,e){var n=e.error;e.error=function(r){n&&n.call(e.context,t,r,e),t.trigger("error",t,r,e)}};return e})}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{jquery:305,underscore:308}],263:[function(t,e,n){t("../../js/transition.js"),t("../../js/alert.js"),t("../../js/button.js"),t("../../js/carousel.js"),t("../../js/collapse.js"),t("../../js/dropdown.js"),t("../../js/modal.js"),t("../../js/tooltip.js"),t("../../js/popover.js"),t("../../js/scrollspy.js"),t("../../js/tab.js"),t("../../js/affix.js")},{"../../js/affix.js":264,"../../js/alert.js":265,"../../js/button.js":266,"../../js/carousel.js":267,"../../js/collapse.js":268,"../../js/dropdown.js":269,"../../js/modal.js":270,"../../js/popover.js":271,"../../js/scrollspy.js":272,"../../js/tab.js":273,"../../js/tooltip.js":274,"../../js/transition.js":275}],264:[function(t,e,n){+function(t){"use strict";function e(e){return this.each(function(){var r=t(this),i=r.data("bs.affix"),o="object"==typeof e&&e;i||r.data("bs.affix",i=new n(this,o)),"string"==typeof e&&i[e]()})}var n=function(e,r){this.options=t.extend({},n.DEFAULTS,r),this.$target=t(this.options.target).on("scroll.bs.affix.data-api",t.proxy(this.checkPosition,this)).on("click.bs.affix.data-api",t.proxy(this.checkPositionWithEventLoop,this)),this.$element=t(e),this.affixed=null,this.unpin=null,this.pinnedOffset=null,this.checkPosition()};n.VERSION="3.3.5",n.RESET="affix affix-top affix-bottom",n.DEFAULTS={offset:0,target:window},n.prototype.getState=function(t,e,n,r){var i=this.$target.scrollTop(),o=this.$element.offset(),s=this.$target.height();if(null!=n&&"top"==this.affixed)return n>i?"top":!1;if("bottom"==this.affixed)return null!=n?i+this.unpin<=o.top?!1:"bottom":t-r>=i+s?!1:"bottom";var a=null==this.affixed,u=a?i:o.top,l=a?s:e;return null!=n&&n>=i?"top":null!=r&&u+l>=t-r?"bottom":!1},n.prototype.getPinnedOffset=function(){if(this.pinnedOffset)return this.pinnedOffset;this.$element.removeClass(n.RESET).addClass("affix");var t=this.$target.scrollTop(),e=this.$element.offset();return this.pinnedOffset=e.top-t},n.prototype.checkPositionWithEventLoop=function(){setTimeout(t.proxy(this.checkPosition,this),1)},n.prototype.checkPosition=function(){if(this.$element.is(":visible")){var e=this.$element.height(),r=this.options.offset,i=r.top,o=r.bottom,s=Math.max(t(document).height(),t(document.body).height());"object"!=typeof r&&(o=i=r),"function"==typeof i&&(i=r.top(this.$element)),"function"==typeof o&&(o=r.bottom(this.$element));var a=this.getState(s,e,i,o);if(this.affixed!=a){null!=this.unpin&&this.$element.css("top","");var u="affix"+(a?"-"+a:""),l=t.Event(u+".bs.affix");if(this.$element.trigger(l),l.isDefaultPrevented())return;this.affixed=a,this.unpin="bottom"==a?this.getPinnedOffset():null,this.$element.removeClass(n.RESET).addClass(u).trigger(u.replace("affix","affixed")+".bs.affix")}"bottom"==a&&this.$element.offset({top:s-e-o})}};var r=t.fn.affix;t.fn.affix=e,t.fn.affix.Constructor=n,t.fn.affix.noConflict=function(){return t.fn.affix=r,this},t(window).on("load",function(){t('[data-spy="affix"]').each(function(){var n=t(this),r=n.data();r.offset=r.offset||{},null!=r.offsetBottom&&(r.offset.bottom=r.offsetBottom),null!=r.offsetTop&&(r.offset.top=r.offsetTop),e.call(n,r)})})}(jQuery)},{}],265:[function(t,e,n){+function(t){"use strict";function e(e){return this.each(function(){var n=t(this),i=n.data("bs.alert");i||n.data("bs.alert",i=new r(this)),"string"==typeof e&&i[e].call(n)})}var n='[data-dismiss="alert"]',r=function(e){t(e).on("click",n,this.close)};r.VERSION="3.3.5",r.TRANSITION_DURATION=150,r.prototype.close=function(e){function n(){s.detach().trigger("closed.bs.alert").remove()}var i=t(this),o=i.attr("data-target");o||(o=i.attr("href"),o=o&&o.replace(/.*(?=#[^\s]*$)/,""));var s=t(o);e&&e.preventDefault(),s.length||(s=i.closest(".alert")),s.trigger(e=t.Event("close.bs.alert")),e.isDefaultPrevented()||(s.removeClass("in"),t.support.transition&&s.hasClass("fade")?s.one("bsTransitionEnd",n).emulateTransitionEnd(r.TRANSITION_DURATION):n())};var i=t.fn.alert;t.fn.alert=e,t.fn.alert.Constructor=r,t.fn.alert.noConflict=function(){return t.fn.alert=i,this},t(document).on("click.bs.alert.data-api",n,r.prototype.close)}(jQuery)},{}],266:[function(t,e,n){+function(t){"use strict";function e(e){return this.each(function(){var r=t(this),i=r.data("bs.button"),o="object"==typeof e&&e;i||r.data("bs.button",i=new n(this,o)),"toggle"==e?i.toggle():e&&i.setState(e)})}var n=function(e,r){this.$element=t(e),this.options=t.extend({},n.DEFAULTS,r),this.isLoading=!1};n.VERSION="3.3.5",n.DEFAULTS={loadingText:"loading..."},n.prototype.setState=function(e){var n="disabled",r=this.$element,i=r.is("input")?"val":"html",o=r.data();e+="Text",null==o.resetText&&r.data("resetText",r[i]()),setTimeout(t.proxy(function(){r[i](null==o[e]?this.options[e]:o[e]),"loadingText"==e?(this.isLoading=!0,r.addClass(n).attr(n,n)):this.isLoading&&(this.isLoading=!1,r.removeClass(n).removeAttr(n))},this),0)},n.prototype.toggle=function(){var t=!0,e=this.$element.closest('[data-toggle="buttons"]');if(e.length){var n=this.$element.find("input");"radio"==n.prop("type")?(n.prop("checked")&&(t=!1),e.find(".active").removeClass("active"),this.$element.addClass("active")):"checkbox"==n.prop("type")&&(n.prop("checked")!==this.$element.hasClass("active")&&(t=!1),this.$element.toggleClass("active")),n.prop("checked",this.$element.hasClass("active")),t&&n.trigger("change")}else this.$element.attr("aria-pressed",!this.$element.hasClass("active")),this.$element.toggleClass("active")};var r=t.fn.button;t.fn.button=e,t.fn.button.Constructor=n,t.fn.button.noConflict=function(){return t.fn.button=r,this},t(document).on("click.bs.button.data-api",'[data-toggle^="button"]',function(n){var r=t(n.target);r.hasClass("btn")||(r=r.closest(".btn")),e.call(r,"toggle"),t(n.target).is('input[type="radio"]')||t(n.target).is('input[type="checkbox"]')||n.preventDefault()}).on("focus.bs.button.data-api blur.bs.button.data-api",'[data-toggle^="button"]',function(e){t(e.target).closest(".btn").toggleClass("focus",/^focus(in)?$/.test(e.type))})}(jQuery)},{}],267:[function(t,e,n){+function(t){"use strict";function e(e){return this.each(function(){var r=t(this),i=r.data("bs.carousel"),o=t.extend({},n.DEFAULTS,r.data(),"object"==typeof e&&e),s="string"==typeof e?e:o.slide;i||r.data("bs.carousel",i=new n(this,o)),"number"==typeof e?i.to(e):s?i[s]():o.interval&&i.pause().cycle()})}var n=function(e,n){this.$element=t(e),this.$indicators=this.$element.find(".carousel-indicators"),this.options=n,this.paused=null,this.sliding=null,this.interval=null,this.$active=null,this.$items=null,this.options.keyboard&&this.$element.on("keydown.bs.carousel",t.proxy(this.keydown,this)),"hover"==this.options.pause&&!("ontouchstart"in document.documentElement)&&this.$element.on("mouseenter.bs.carousel",t.proxy(this.pause,this)).on("mouseleave.bs.carousel",t.proxy(this.cycle,this))};n.VERSION="3.3.5",n.TRANSITION_DURATION=600,n.DEFAULTS={interval:5e3,pause:"hover",wrap:!0,keyboard:!0},n.prototype.keydown=function(t){if(!/input|textarea/i.test(t.target.tagName)){switch(t.which){case 37:this.prev();break;case 39:this.next();break;default:return}t.preventDefault()}},n.prototype.cycle=function(e){return e||(this.paused=!1),this.interval&&clearInterval(this.interval),this.options.interval&&!this.paused&&(this.interval=setInterval(t.proxy(this.next,this),this.options.interval)),this},n.prototype.getItemIndex=function(t){return this.$items=t.parent().children(".item"),this.$items.index(t||this.$active)},n.prototype.getItemForDirection=function(t,e){var n=this.getItemIndex(e),r="prev"==t&&0===n||"next"==t&&n==this.$items.length-1;if(r&&!this.options.wrap)return e;var i="prev"==t?-1:1,o=(n+i)%this.$items.length;return this.$items.eq(o)},n.prototype.to=function(t){var e=this,n=this.getItemIndex(this.$active=this.$element.find(".item.active"));return t>this.$items.length-1||0>t?void 0:this.sliding?this.$element.one("slid.bs.carousel",function(){e.to(t)}):n==t?this.pause().cycle():this.slide(t>n?"next":"prev",this.$items.eq(t))},n.prototype.pause=function(e){return e||(this.paused=!0),this.$element.find(".next, .prev").length&&t.support.transition&&(this.$element.trigger(t.support.transition.end),this.cycle(!0)),this.interval=clearInterval(this.interval),this},n.prototype.next=function(){return this.sliding?void 0:this.slide("next")},n.prototype.prev=function(){return this.sliding?void 0:this.slide("prev")},n.prototype.slide=function(e,r){var i=this.$element.find(".item.active"),o=r||this.getItemForDirection(e,i),s=this.interval,a="next"==e?"left":"right",u=this;if(o.hasClass("active"))return this.sliding=!1;var l=o[0],c=t.Event("slide.bs.carousel",{relatedTarget:l,direction:a});if(this.$element.trigger(c),!c.isDefaultPrevented()){if(this.sliding=!0,s&&this.pause(),this.$indicators.length){this.$indicators.find(".active").removeClass("active");var h=t(this.$indicators.children()[this.getItemIndex(o)]);h&&h.addClass("active")}var p=t.Event("slid.bs.carousel",{relatedTarget:l,direction:a});return t.support.transition&&this.$element.hasClass("slide")?(o.addClass(e),o[0].offsetWidth,i.addClass(a),o.addClass(a),i.one("bsTransitionEnd",function(){o.removeClass([e,a].join(" ")).addClass("active"),i.removeClass(["active",a].join(" ")),u.sliding=!1,setTimeout(function(){u.$element.trigger(p)},0)}).emulateTransitionEnd(n.TRANSITION_DURATION)):(i.removeClass("active"),o.addClass("active"),this.sliding=!1,this.$element.trigger(p)),s&&this.cycle(),this}};var r=t.fn.carousel;t.fn.carousel=e,t.fn.carousel.Constructor=n,t.fn.carousel.noConflict=function(){return t.fn.carousel=r,this};var i=function(n){var r,i=t(this),o=t(i.attr("data-target")||(r=i.attr("href"))&&r.replace(/.*(?=#[^\s]+$)/,""));if(o.hasClass("carousel")){var s=t.extend({},o.data(),i.data()),a=i.attr("data-slide-to");a&&(s.interval=!1),e.call(o,s),a&&o.data("bs.carousel").to(a),n.preventDefault()}};t(document).on("click.bs.carousel.data-api","[data-slide]",i).on("click.bs.carousel.data-api","[data-slide-to]",i),t(window).on("load",function(){t('[data-ride="carousel"]').each(function(){var n=t(this);e.call(n,n.data())})})}(jQuery)},{}],268:[function(t,e,n){+function(t){"use strict";function e(e){var n,r=e.attr("data-target")||(n=e.attr("href"))&&n.replace(/.*(?=#[^\s]+$)/,"");return t(r)}function n(e){return this.each(function(){var n=t(this),i=n.data("bs.collapse"),o=t.extend({},r.DEFAULTS,n.data(),"object"==typeof e&&e);!i&&o.toggle&&/show|hide/.test(e)&&(o.toggle=!1),i||n.data("bs.collapse",i=new r(this,o)),"string"==typeof e&&i[e]()})}var r=function(e,n){this.$element=t(e),this.options=t.extend({},r.DEFAULTS,n),this.$trigger=t('[data-toggle="collapse"][href="#'+e.id+'"],[data-toggle="collapse"][data-target="#'+e.id+'"]'),this.transitioning=null,this.options.parent?this.$parent=this.getParent():this.addAriaAndCollapsedClass(this.$element,this.$trigger),this.options.toggle&&this.toggle()};r.VERSION="3.3.5",r.TRANSITION_DURATION=350,r.DEFAULTS={toggle:!0},r.prototype.dimension=function(){var t=this.$element.hasClass("width");return t?"width":"height"},r.prototype.show=function(){if(!this.transitioning&&!this.$element.hasClass("in")){var e,i=this.$parent&&this.$parent.children(".panel").children(".in, .collapsing");if(!(i&&i.length&&(e=i.data("bs.collapse"),e&&e.transitioning))){var o=t.Event("show.bs.collapse");if(this.$element.trigger(o),!o.isDefaultPrevented()){i&&i.length&&(n.call(i,"hide"),e||i.data("bs.collapse",null));var s=this.dimension();this.$element.removeClass("collapse").addClass("collapsing")[s](0).attr("aria-expanded",!0),this.$trigger.removeClass("collapsed").attr("aria-expanded",!0),this.transitioning=1;var a=function(){this.$element.removeClass("collapsing").addClass("collapse in")[s](""),
this.transitioning=0,this.$element.trigger("shown.bs.collapse")};if(!t.support.transition)return a.call(this);var u=t.camelCase(["scroll",s].join("-"));this.$element.one("bsTransitionEnd",t.proxy(a,this)).emulateTransitionEnd(r.TRANSITION_DURATION)[s](this.$element[0][u])}}}},r.prototype.hide=function(){if(!this.transitioning&&this.$element.hasClass("in")){var e=t.Event("hide.bs.collapse");if(this.$element.trigger(e),!e.isDefaultPrevented()){var n=this.dimension();this.$element[n](this.$element[n]())[0].offsetHeight,this.$element.addClass("collapsing").removeClass("collapse in").attr("aria-expanded",!1),this.$trigger.addClass("collapsed").attr("aria-expanded",!1),this.transitioning=1;var i=function(){this.transitioning=0,this.$element.removeClass("collapsing").addClass("collapse").trigger("hidden.bs.collapse")};return t.support.transition?void this.$element[n](0).one("bsTransitionEnd",t.proxy(i,this)).emulateTransitionEnd(r.TRANSITION_DURATION):i.call(this)}}},r.prototype.toggle=function(){this[this.$element.hasClass("in")?"hide":"show"]()},r.prototype.getParent=function(){return t(this.options.parent).find('[data-toggle="collapse"][data-parent="'+this.options.parent+'"]').each(t.proxy(function(n,r){var i=t(r);this.addAriaAndCollapsedClass(e(i),i)},this)).end()},r.prototype.addAriaAndCollapsedClass=function(t,e){var n=t.hasClass("in");t.attr("aria-expanded",n),e.toggleClass("collapsed",!n).attr("aria-expanded",n)};var i=t.fn.collapse;t.fn.collapse=n,t.fn.collapse.Constructor=r,t.fn.collapse.noConflict=function(){return t.fn.collapse=i,this},t(document).on("click.bs.collapse.data-api",'[data-toggle="collapse"]',function(r){var i=t(this);i.attr("data-target")||r.preventDefault();var o=e(i),s=o.data("bs.collapse"),a=s?"toggle":i.data();n.call(o,a)})}(jQuery)},{}],269:[function(t,e,n){+function(t){"use strict";function e(e){var n=e.attr("data-target");n||(n=e.attr("href"),n=n&&/#[A-Za-z]/.test(n)&&n.replace(/.*(?=#[^\s]*$)/,""));var r=n&&t(n);return r&&r.length?r:e.parent()}function n(n){n&&3===n.which||(t(i).remove(),t(o).each(function(){var r=t(this),i=e(r),o={relatedTarget:this};i.hasClass("open")&&(n&&"click"==n.type&&/input|textarea/i.test(n.target.tagName)&&t.contains(i[0],n.target)||(i.trigger(n=t.Event("hide.bs.dropdown",o)),n.isDefaultPrevented()||(r.attr("aria-expanded","false"),i.removeClass("open").trigger("hidden.bs.dropdown",o))))}))}function r(e){return this.each(function(){var n=t(this),r=n.data("bs.dropdown");r||n.data("bs.dropdown",r=new s(this)),"string"==typeof e&&r[e].call(n)})}var i=".dropdown-backdrop",o='[data-toggle="dropdown"]',s=function(e){t(e).on("click.bs.dropdown",this.toggle)};s.VERSION="3.3.5",s.prototype.toggle=function(r){var i=t(this);if(!i.is(".disabled, :disabled")){var o=e(i),s=o.hasClass("open");if(n(),!s){"ontouchstart"in document.documentElement&&!o.closest(".navbar-nav").length&&t(document.createElement("div")).addClass("dropdown-backdrop").insertAfter(t(this)).on("click",n);var a={relatedTarget:this};if(o.trigger(r=t.Event("show.bs.dropdown",a)),r.isDefaultPrevented())return;i.trigger("focus").attr("aria-expanded","true"),o.toggleClass("open").trigger("shown.bs.dropdown",a)}return!1}},s.prototype.keydown=function(n){if(/(38|40|27|32)/.test(n.which)&&!/input|textarea/i.test(n.target.tagName)){var r=t(this);if(n.preventDefault(),n.stopPropagation(),!r.is(".disabled, :disabled")){var i=e(r),s=i.hasClass("open");if(!s&&27!=n.which||s&&27==n.which)return 27==n.which&&i.find(o).trigger("focus"),r.trigger("click");var a=" li:not(.disabled):visible a",u=i.find(".dropdown-menu"+a);if(u.length){var l=u.index(n.target);38==n.which&&l>0&&l--,40==n.which&&l<u.length-1&&l++,~l||(l=0),u.eq(l).trigger("focus")}}}};var a=t.fn.dropdown;t.fn.dropdown=r,t.fn.dropdown.Constructor=s,t.fn.dropdown.noConflict=function(){return t.fn.dropdown=a,this},t(document).on("click.bs.dropdown.data-api",n).on("click.bs.dropdown.data-api",".dropdown form",function(t){t.stopPropagation()}).on("click.bs.dropdown.data-api",o,s.prototype.toggle).on("keydown.bs.dropdown.data-api",o,s.prototype.keydown).on("keydown.bs.dropdown.data-api",".dropdown-menu",s.prototype.keydown)}(jQuery)},{}],270:[function(t,e,n){+function(t){"use strict";function e(e,r){return this.each(function(){var i=t(this),o=i.data("bs.modal"),s=t.extend({},n.DEFAULTS,i.data(),"object"==typeof e&&e);o||i.data("bs.modal",o=new n(this,s)),"string"==typeof e?o[e](r):s.show&&o.show(r)})}var n=function(e,n){this.options=n,this.$body=t(document.body),this.$element=t(e),this.$dialog=this.$element.find(".modal-dialog"),this.$backdrop=null,this.isShown=null,this.originalBodyPad=null,this.scrollbarWidth=0,this.ignoreBackdropClick=!1,this.options.remote&&this.$element.find(".modal-content").load(this.options.remote,t.proxy(function(){this.$element.trigger("loaded.bs.modal")},this))};n.VERSION="3.3.5",n.TRANSITION_DURATION=300,n.BACKDROP_TRANSITION_DURATION=150,n.DEFAULTS={backdrop:!0,keyboard:!0,show:!0},n.prototype.toggle=function(t){return this.isShown?this.hide():this.show(t)},n.prototype.show=function(e){var r=this,i=t.Event("show.bs.modal",{relatedTarget:e});this.$element.trigger(i),this.isShown||i.isDefaultPrevented()||(this.isShown=!0,this.checkScrollbar(),this.setScrollbar(),this.$body.addClass("modal-open"),this.escape(),this.resize(),this.$element.on("click.dismiss.bs.modal",'[data-dismiss="modal"]',t.proxy(this.hide,this)),this.$dialog.on("mousedown.dismiss.bs.modal",function(){r.$element.one("mouseup.dismiss.bs.modal",function(e){t(e.target).is(r.$element)&&(r.ignoreBackdropClick=!0)})}),this.backdrop(function(){var i=t.support.transition&&r.$element.hasClass("fade");r.$element.parent().length||r.$element.appendTo(r.$body),r.$element.show().scrollTop(0),r.adjustDialog(),i&&r.$element[0].offsetWidth,r.$element.addClass("in"),r.enforceFocus();var o=t.Event("shown.bs.modal",{relatedTarget:e});i?r.$dialog.one("bsTransitionEnd",function(){r.$element.trigger("focus").trigger(o)}).emulateTransitionEnd(n.TRANSITION_DURATION):r.$element.trigger("focus").trigger(o)}))},n.prototype.hide=function(e){e&&e.preventDefault(),e=t.Event("hide.bs.modal"),this.$element.trigger(e),this.isShown&&!e.isDefaultPrevented()&&(this.isShown=!1,this.escape(),this.resize(),t(document).off("focusin.bs.modal"),this.$element.removeClass("in").off("click.dismiss.bs.modal").off("mouseup.dismiss.bs.modal"),this.$dialog.off("mousedown.dismiss.bs.modal"),t.support.transition&&this.$element.hasClass("fade")?this.$element.one("bsTransitionEnd",t.proxy(this.hideModal,this)).emulateTransitionEnd(n.TRANSITION_DURATION):this.hideModal())},n.prototype.enforceFocus=function(){t(document).off("focusin.bs.modal").on("focusin.bs.modal",t.proxy(function(t){this.$element[0]===t.target||this.$element.has(t.target).length||this.$element.trigger("focus")},this))},n.prototype.escape=function(){this.isShown&&this.options.keyboard?this.$element.on("keydown.dismiss.bs.modal",t.proxy(function(t){27==t.which&&this.hide()},this)):this.isShown||this.$element.off("keydown.dismiss.bs.modal")},n.prototype.resize=function(){this.isShown?t(window).on("resize.bs.modal",t.proxy(this.handleUpdate,this)):t(window).off("resize.bs.modal")},n.prototype.hideModal=function(){var t=this;this.$element.hide(),this.backdrop(function(){t.$body.removeClass("modal-open"),t.resetAdjustments(),t.resetScrollbar(),t.$element.trigger("hidden.bs.modal")})},n.prototype.removeBackdrop=function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},n.prototype.backdrop=function(e){var r=this,i=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var o=t.support.transition&&i;if(this.$backdrop=t(document.createElement("div")).addClass("modal-backdrop "+i).appendTo(this.$body),this.$element.on("click.dismiss.bs.modal",t.proxy(function(t){return this.ignoreBackdropClick?void(this.ignoreBackdropClick=!1):void(t.target===t.currentTarget&&("static"==this.options.backdrop?this.$element[0].focus():this.hide()))},this)),o&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),!e)return;o?this.$backdrop.one("bsTransitionEnd",e).emulateTransitionEnd(n.BACKDROP_TRANSITION_DURATION):e()}else if(!this.isShown&&this.$backdrop){this.$backdrop.removeClass("in");var s=function(){r.removeBackdrop(),e&&e()};t.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one("bsTransitionEnd",s).emulateTransitionEnd(n.BACKDROP_TRANSITION_DURATION):s()}else e&&e()},n.prototype.handleUpdate=function(){this.adjustDialog()},n.prototype.adjustDialog=function(){var t=this.$element[0].scrollHeight>document.documentElement.clientHeight;this.$element.css({paddingLeft:!this.bodyIsOverflowing&&t?this.scrollbarWidth:"",paddingRight:this.bodyIsOverflowing&&!t?this.scrollbarWidth:""})},n.prototype.resetAdjustments=function(){this.$element.css({paddingLeft:"",paddingRight:""})},n.prototype.checkScrollbar=function(){var t=window.innerWidth;if(!t){var e=document.documentElement.getBoundingClientRect();t=e.right-Math.abs(e.left)}this.bodyIsOverflowing=document.body.clientWidth<t,this.scrollbarWidth=this.measureScrollbar()},n.prototype.setScrollbar=function(){var t=parseInt(this.$body.css("padding-right")||0,10);this.originalBodyPad=document.body.style.paddingRight||"",this.bodyIsOverflowing&&this.$body.css("padding-right",t+this.scrollbarWidth)},n.prototype.resetScrollbar=function(){this.$body.css("padding-right",this.originalBodyPad)},n.prototype.measureScrollbar=function(){var t=document.createElement("div");t.className="modal-scrollbar-measure",this.$body.append(t);var e=t.offsetWidth-t.clientWidth;return this.$body[0].removeChild(t),e};var r=t.fn.modal;t.fn.modal=e,t.fn.modal.Constructor=n,t.fn.modal.noConflict=function(){return t.fn.modal=r,this},t(document).on("click.bs.modal.data-api",'[data-toggle="modal"]',function(n){var r=t(this),i=r.attr("href"),o=t(r.attr("data-target")||i&&i.replace(/.*(?=#[^\s]+$)/,"")),s=o.data("bs.modal")?"toggle":t.extend({remote:!/#/.test(i)&&i},o.data(),r.data());r.is("a")&&n.preventDefault(),o.one("show.bs.modal",function(t){t.isDefaultPrevented()||o.one("hidden.bs.modal",function(){r.is(":visible")&&r.trigger("focus")})}),e.call(o,s,this)})}(jQuery)},{}],271:[function(t,e,n){+function(t){"use strict";function e(e){return this.each(function(){var r=t(this),i=r.data("bs.popover"),o="object"==typeof e&&e;(i||!/destroy|hide/.test(e))&&(i||r.data("bs.popover",i=new n(this,o)),"string"==typeof e&&i[e]())})}var n=function(t,e){this.init("popover",t,e)};if(!t.fn.tooltip)throw new Error("Popover requires tooltip.js");n.VERSION="3.3.5",n.DEFAULTS=t.extend({},t.fn.tooltip.Constructor.DEFAULTS,{placement:"right",trigger:"click",content:"",template:'<div class="popover" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>'}),n.prototype=t.extend({},t.fn.tooltip.Constructor.prototype),n.prototype.constructor=n,n.prototype.getDefaults=function(){return n.DEFAULTS},n.prototype.setContent=function(){var t=this.tip(),e=this.getTitle(),n=this.getContent();t.find(".popover-title")[this.options.html?"html":"text"](e),t.find(".popover-content").children().detach().end()[this.options.html?"string"==typeof n?"html":"append":"text"](n),t.removeClass("fade top bottom left right in"),t.find(".popover-title").html()||t.find(".popover-title").hide()},n.prototype.hasContent=function(){return this.getTitle()||this.getContent()},n.prototype.getContent=function(){var t=this.$element,e=this.options;return t.attr("data-content")||("function"==typeof e.content?e.content.call(t[0]):e.content)},n.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".arrow")};var r=t.fn.popover;t.fn.popover=e,t.fn.popover.Constructor=n,t.fn.popover.noConflict=function(){return t.fn.popover=r,this}}(jQuery)},{}],272:[function(t,e,n){+function(t){"use strict";function e(n,r){this.$body=t(document.body),this.$scrollElement=t(t(n).is(document.body)?window:n),this.options=t.extend({},e.DEFAULTS,r),this.selector=(this.options.target||"")+" .nav li > a",this.offsets=[],this.targets=[],this.activeTarget=null,this.scrollHeight=0,this.$scrollElement.on("scroll.bs.scrollspy",t.proxy(this.process,this)),this.refresh(),this.process()}function n(n){return this.each(function(){var r=t(this),i=r.data("bs.scrollspy"),o="object"==typeof n&&n;i||r.data("bs.scrollspy",i=new e(this,o)),"string"==typeof n&&i[n]()})}e.VERSION="3.3.5",e.DEFAULTS={offset:10},e.prototype.getScrollHeight=function(){return this.$scrollElement[0].scrollHeight||Math.max(this.$body[0].scrollHeight,document.documentElement.scrollHeight)},e.prototype.refresh=function(){var e=this,n="offset",r=0;this.offsets=[],this.targets=[],this.scrollHeight=this.getScrollHeight(),t.isWindow(this.$scrollElement[0])||(n="position",r=this.$scrollElement.scrollTop()),this.$body.find(this.selector).map(function(){var e=t(this),i=e.data("target")||e.attr("href"),o=/^#./.test(i)&&t(i);return o&&o.length&&o.is(":visible")&&[[o[n]().top+r,i]]||null}).sort(function(t,e){return t[0]-e[0]}).each(function(){e.offsets.push(this[0]),e.targets.push(this[1])})},e.prototype.process=function(){var t,e=this.$scrollElement.scrollTop()+this.options.offset,n=this.getScrollHeight(),r=this.options.offset+n-this.$scrollElement.height(),i=this.offsets,o=this.targets,s=this.activeTarget;if(this.scrollHeight!=n&&this.refresh(),e>=r)return s!=(t=o[o.length-1])&&this.activate(t);if(s&&e<i[0])return this.activeTarget=null,this.clear();for(t=i.length;t--;)s!=o[t]&&e>=i[t]&&(void 0===i[t+1]||e<i[t+1])&&this.activate(o[t])},e.prototype.activate=function(e){this.activeTarget=e,this.clear();var n=this.selector+'[data-target="'+e+'"],'+this.selector+'[href="'+e+'"]',r=t(n).parents("li").addClass("active");r.parent(".dropdown-menu").length&&(r=r.closest("li.dropdown").addClass("active")),r.trigger("activate.bs.scrollspy")},e.prototype.clear=function(){t(this.selector).parentsUntil(this.options.target,".active").removeClass("active")};var r=t.fn.scrollspy;t.fn.scrollspy=n,t.fn.scrollspy.Constructor=e,t.fn.scrollspy.noConflict=function(){return t.fn.scrollspy=r,this},t(window).on("load.bs.scrollspy.data-api",function(){t('[data-spy="scroll"]').each(function(){var e=t(this);n.call(e,e.data())})})}(jQuery)},{}],273:[function(t,e,n){+function(t){"use strict";function e(e){return this.each(function(){var r=t(this),i=r.data("bs.tab");i||r.data("bs.tab",i=new n(this)),"string"==typeof e&&i[e]()})}var n=function(e){this.element=t(e)};n.VERSION="3.3.5",n.TRANSITION_DURATION=150,n.prototype.show=function(){var e=this.element,n=e.closest("ul:not(.dropdown-menu)"),r=e.data("target");if(r||(r=e.attr("href"),r=r&&r.replace(/.*(?=#[^\s]*$)/,"")),!e.parent("li").hasClass("active")){var i=n.find(".active:last a"),o=t.Event("hide.bs.tab",{relatedTarget:e[0]}),s=t.Event("show.bs.tab",{relatedTarget:i[0]});if(i.trigger(o),e.trigger(s),!s.isDefaultPrevented()&&!o.isDefaultPrevented()){var a=t(r);this.activate(e.closest("li"),n),this.activate(a,a.parent(),function(){i.trigger({type:"hidden.bs.tab",relatedTarget:e[0]}),e.trigger({type:"shown.bs.tab",relatedTarget:i[0]})})}}},n.prototype.activate=function(e,r,i){function o(){s.removeClass("active").find("> .dropdown-menu > .active").removeClass("active").end().find('[data-toggle="tab"]').attr("aria-expanded",!1),e.addClass("active").find('[data-toggle="tab"]').attr("aria-expanded",!0),a?(e[0].offsetWidth,e.addClass("in")):e.removeClass("fade"),e.parent(".dropdown-menu").length&&e.closest("li.dropdown").addClass("active").end().find('[data-toggle="tab"]').attr("aria-expanded",!0),i&&i()}var s=r.find("> .active"),a=i&&t.support.transition&&(s.length&&s.hasClass("fade")||!!r.find("> .fade").length);s.length&&a?s.one("bsTransitionEnd",o).emulateTransitionEnd(n.TRANSITION_DURATION):o(),s.removeClass("in")};var r=t.fn.tab;t.fn.tab=e,t.fn.tab.Constructor=n,t.fn.tab.noConflict=function(){return t.fn.tab=r,this};var i=function(n){n.preventDefault(),e.call(t(this),"show")};t(document).on("click.bs.tab.data-api",'[data-toggle="tab"]',i).on("click.bs.tab.data-api",'[data-toggle="pill"]',i)}(jQuery)},{}],274:[function(t,e,n){+function(t){"use strict";function e(e){return this.each(function(){var r=t(this),i=r.data("bs.tooltip"),o="object"==typeof e&&e;(i||!/destroy|hide/.test(e))&&(i||r.data("bs.tooltip",i=new n(this,o)),"string"==typeof e&&i[e]())})}var n=function(t,e){this.type=null,this.options=null,this.enabled=null,this.timeout=null,this.hoverState=null,this.$element=null,this.inState=null,this.init("tooltip",t,e)};n.VERSION="3.3.5",n.TRANSITION_DURATION=150,n.DEFAULTS={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1,viewport:{selector:"body",padding:0}},n.prototype.init=function(e,n,r){if(this.enabled=!0,this.type=e,this.$element=t(n),this.options=this.getOptions(r),this.$viewport=this.options.viewport&&t(t.isFunction(this.options.viewport)?this.options.viewport.call(this,this.$element):this.options.viewport.selector||this.options.viewport),this.inState={click:!1,hover:!1,focus:!1},this.$element[0]instanceof document.constructor&&!this.options.selector)throw new Error("`selector` option must be specified when initializing "+this.type+" on the window.document object!");for(var i=this.options.trigger.split(" "),o=i.length;o--;){var s=i[o];if("click"==s)this.$element.on("click."+this.type,this.options.selector,t.proxy(this.toggle,this));else if("manual"!=s){var a="hover"==s?"mouseenter":"focusin",u="hover"==s?"mouseleave":"focusout";this.$element.on(a+"."+this.type,this.options.selector,t.proxy(this.enter,this)),this.$element.on(u+"."+this.type,this.options.selector,t.proxy(this.leave,this))}}this.options.selector?this._options=t.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},n.prototype.getDefaults=function(){return n.DEFAULTS},n.prototype.getOptions=function(e){return e=t.extend({},this.getDefaults(),this.$element.data(),e),e.delay&&"number"==typeof e.delay&&(e.delay={show:e.delay,hide:e.delay}),e},n.prototype.getDelegateOptions=function(){var e={},n=this.getDefaults();return this._options&&t.each(this._options,function(t,r){n[t]!=r&&(e[t]=r)}),e},n.prototype.enter=function(e){var n=e instanceof this.constructor?e:t(e.currentTarget).data("bs."+this.type);return n||(n=new this.constructor(e.currentTarget,this.getDelegateOptions()),t(e.currentTarget).data("bs."+this.type,n)),e instanceof t.Event&&(n.inState["focusin"==e.type?"focus":"hover"]=!0),n.tip().hasClass("in")||"in"==n.hoverState?void(n.hoverState="in"):(clearTimeout(n.timeout),n.hoverState="in",n.options.delay&&n.options.delay.show?void(n.timeout=setTimeout(function(){"in"==n.hoverState&&n.show()},n.options.delay.show)):n.show())},n.prototype.isInStateTrue=function(){for(var t in this.inState)if(this.inState[t])return!0;return!1},n.prototype.leave=function(e){var n=e instanceof this.constructor?e:t(e.currentTarget).data("bs."+this.type);return n||(n=new this.constructor(e.currentTarget,this.getDelegateOptions()),t(e.currentTarget).data("bs."+this.type,n)),e instanceof t.Event&&(n.inState["focusout"==e.type?"focus":"hover"]=!1),n.isInStateTrue()?void 0:(clearTimeout(n.timeout),n.hoverState="out",n.options.delay&&n.options.delay.hide?void(n.timeout=setTimeout(function(){"out"==n.hoverState&&n.hide()},n.options.delay.hide)):n.hide())},n.prototype.show=function(){var e=t.Event("show.bs."+this.type);if(this.hasContent()&&this.enabled){this.$element.trigger(e);var r=t.contains(this.$element[0].ownerDocument.documentElement,this.$element[0]);if(e.isDefaultPrevented()||!r)return;var i=this,o=this.tip(),s=this.getUID(this.type);this.setContent(),o.attr("id",s),this.$element.attr("aria-describedby",s),this.options.animation&&o.addClass("fade");var a="function"==typeof this.options.placement?this.options.placement.call(this,o[0],this.$element[0]):this.options.placement,u=/\s?auto?\s?/i,l=u.test(a);l&&(a=a.replace(u,"")||"top"),o.detach().css({top:0,left:0,display:"block"}).addClass(a).data("bs."+this.type,this),this.options.container?o.appendTo(this.options.container):o.insertAfter(this.$element),this.$element.trigger("inserted.bs."+this.type);var c=this.getPosition(),h=o[0].offsetWidth,p=o[0].offsetHeight;if(l){var f=a,d=this.getPosition(this.$viewport);a="bottom"==a&&c.bottom+p>d.bottom?"top":"top"==a&&c.top-p<d.top?"bottom":"right"==a&&c.right+h>d.width?"left":"left"==a&&c.left-h<d.left?"right":a,o.removeClass(f).addClass(a)}var m=this.getCalculatedOffset(a,c,h,p);this.applyPlacement(m,a);var g=function(){var t=i.hoverState;i.$element.trigger("shown.bs."+i.type),i.hoverState=null,"out"==t&&i.leave(i)};t.support.transition&&this.$tip.hasClass("fade")?o.one("bsTransitionEnd",g).emulateTransitionEnd(n.TRANSITION_DURATION):g()}},n.prototype.applyPlacement=function(e,n){var r=this.tip(),i=r[0].offsetWidth,o=r[0].offsetHeight,s=parseInt(r.css("margin-top"),10),a=parseInt(r.css("margin-left"),10);isNaN(s)&&(s=0),isNaN(a)&&(a=0),e.top+=s,e.left+=a,t.offset.setOffset(r[0],t.extend({using:function(t){r.css({top:Math.round(t.top),left:Math.round(t.left)})}},e),0),r.addClass("in");var u=r[0].offsetWidth,l=r[0].offsetHeight;"top"==n&&l!=o&&(e.top=e.top+o-l);var c=this.getViewportAdjustedDelta(n,e,u,l);c.left?e.left+=c.left:e.top+=c.top;var h=/top|bottom/.test(n),p=h?2*c.left-i+u:2*c.top-o+l,f=h?"offsetWidth":"offsetHeight";r.offset(e),this.replaceArrow(p,r[0][f],h)},n.prototype.replaceArrow=function(t,e,n){this.arrow().css(n?"left":"top",50*(1-t/e)+"%").css(n?"top":"left","")},n.prototype.setContent=function(){var t=this.tip(),e=this.getTitle();t.find(".tooltip-inner")[this.options.html?"html":"text"](e),t.removeClass("fade in top bottom left right")},n.prototype.hide=function(e){function r(){"in"!=i.hoverState&&o.detach(),i.$element.removeAttr("aria-describedby").trigger("hidden.bs."+i.type),e&&e()}var i=this,o=t(this.$tip),s=t.Event("hide.bs."+this.type);return this.$element.trigger(s),s.isDefaultPrevented()?void 0:(o.removeClass("in"),t.support.transition&&o.hasClass("fade")?o.one("bsTransitionEnd",r).emulateTransitionEnd(n.TRANSITION_DURATION):r(),this.hoverState=null,this)},n.prototype.fixTitle=function(){var t=this.$element;(t.attr("title")||"string"!=typeof t.attr("data-original-title"))&&t.attr("data-original-title",t.attr("title")||"").attr("title","")},n.prototype.hasContent=function(){return this.getTitle()},n.prototype.getPosition=function(e){e=e||this.$element;var n=e[0],r="BODY"==n.tagName,i=n.getBoundingClientRect();null==i.width&&(i=t.extend({},i,{width:i.right-i.left,height:i.bottom-i.top}));var o=r?{top:0,left:0}:e.offset(),s={scroll:r?document.documentElement.scrollTop||document.body.scrollTop:e.scrollTop()},a=r?{width:t(window).width(),height:t(window).height()}:null;return t.extend({},i,s,a,o)},n.prototype.getCalculatedOffset=function(t,e,n,r){return"bottom"==t?{top:e.top+e.height,left:e.left+e.width/2-n/2}:"top"==t?{top:e.top-r,left:e.left+e.width/2-n/2}:"left"==t?{top:e.top+e.height/2-r/2,left:e.left-n}:{top:e.top+e.height/2-r/2,left:e.left+e.width}},n.prototype.getViewportAdjustedDelta=function(t,e,n,r){var i={top:0,left:0};if(!this.$viewport)return i;var o=this.options.viewport&&this.options.viewport.padding||0,s=this.getPosition(this.$viewport);if(/right|left/.test(t)){var a=e.top-o-s.scroll,u=e.top+o-s.scroll+r;a<s.top?i.top=s.top-a:u>s.top+s.height&&(i.top=s.top+s.height-u)}else{var l=e.left-o,c=e.left+o+n;l<s.left?i.left=s.left-l:c>s.right&&(i.left=s.left+s.width-c)}return i},n.prototype.getTitle=function(){var t,e=this.$element,n=this.options;return t=e.attr("data-original-title")||("function"==typeof n.title?n.title.call(e[0]):n.title)},n.prototype.getUID=function(t){do t+=~~(1e6*Math.random());while(document.getElementById(t));return t},n.prototype.tip=function(){if(!this.$tip&&(this.$tip=t(this.options.template),1!=this.$tip.length))throw new Error(this.type+" `template` option must consist of exactly 1 top-level element!");return this.$tip},n.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")},n.prototype.enable=function(){this.enabled=!0},n.prototype.disable=function(){this.enabled=!1},n.prototype.toggleEnabled=function(){this.enabled=!this.enabled},n.prototype.toggle=function(e){var n=this;e&&(n=t(e.currentTarget).data("bs."+this.type),n||(n=new this.constructor(e.currentTarget,this.getDelegateOptions()),t(e.currentTarget).data("bs."+this.type,n))),e?(n.inState.click=!n.inState.click,n.isInStateTrue()?n.enter(n):n.leave(n)):n.tip().hasClass("in")?n.leave(n):n.enter(n)},n.prototype.destroy=function(){var t=this;clearTimeout(this.timeout),this.hide(function(){t.$element.off("."+t.type).removeData("bs."+t.type),t.$tip&&t.$tip.detach(),t.$tip=null,t.$arrow=null,t.$viewport=null})};var r=t.fn.tooltip;t.fn.tooltip=e,t.fn.tooltip.Constructor=n,t.fn.tooltip.noConflict=function(){return t.fn.tooltip=r,this}}(jQuery)},{}],275:[function(t,e,n){+function(t){"use strict";function e(){var t=document.createElement("bootstrap"),e={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var n in e)if(void 0!==t.style[n])return{end:e[n]};return!1}t.fn.emulateTransitionEnd=function(e){var n=!1,r=this;t(this).one("bsTransitionEnd",function(){n=!0});var i=function(){n||t(r).trigger(t.support.transition.end)};return setTimeout(i,e),this},t(function(){t.support.transition=e(),t.support.transition&&(t.event.special.bsTransitionEnd={bindType:t.support.transition.end,delegateType:t.support.transition.end,handle:function(e){return t(e.target).is(this)?e.handleObj.handler.apply(this,arguments):void 0}})})}(jQuery)},{}],276:[function(t,e,n){e.exports=function(){function t(t,e){return e>t?-1:t>e?1:t>=e?0:0/0}function e(t){return null!=t&&!isNaN(t)}function n(t){return{left:function(e,n,r,i){for(arguments.length<3&&(r=0),arguments.length<4&&(i=e.length);i>r;){var o=r+i>>>1;t(e[o],n)<0?r=o+1:i=o}return r},right:function(e,n,r,i){for(arguments.length<3&&(r=0),arguments.length<4&&(i=e.length);i>r;){var o=r+i>>>1;t(e[o],n)>0?i=o:r=o+1}return r}}}function r(t){return t.length}function i(t){for(var e=1;t*e%1;)e*=10;return e}function o(t,e){try{for(var n in e)Object.defineProperty(t.prototype,n,{value:e[n],enumerable:!1})}catch(r){t.prototype=e}}function s(){}function a(t){return ss+t in this}function u(t){return t=ss+t,t in this&&delete this[t]}function l(){var t=[];return this.forEach(function(e){t.push(e)}),t}function c(){var t=0;for(var e in this)e.charCodeAt(0)===as&&++t;return t}function h(){for(var t in this)if(t.charCodeAt(0)===as)return!1;return!0}function p(){}function f(t,e,n){return function(){var r=n.apply(e,arguments);return r===e?t:r}}function d(t,e){if(e in t)return e;e=e.charAt(0).toUpperCase()+e.substring(1);for(var n=0,r=us.length;r>n;++n){var i=us[n]+e;if(i in t)return i}}function m(){}function g(){}function y(t){function e(){for(var e,r=n,i=-1,o=r.length;++i<o;)(e=r[i].on)&&e.apply(this,arguments);return t}var n=[],r=new s;return e.on=function(e,i){var o,s=r.get(e);return arguments.length<2?s&&s.on:(s&&(s.on=null,n=n.slice(0,o=n.indexOf(s)).concat(n.slice(o+1)),r.remove(e)),i&&n.push(r.set(e,{on:i})),t)},e}function v(){Vo.event.preventDefault()}function b(){for(var t,e=Vo.event;t=e.sourceEvent;)e=t;return e}function _(t){for(var e=new g,n=0,r=arguments.length;++n<r;)e[arguments[n]]=y(e);return e.of=function(n,r){return function(i){try{var o=i.sourceEvent=Vo.event;i.target=t,Vo.event=i,e[i.type].apply(n,r)}finally{Vo.event=o}}},e}function w(t){return cs(t,ms),t}function x(t){return"function"==typeof t?t:function(){return hs(t,this)}}function C(t){return"function"==typeof t?t:function(){return ps(t,this)}}function T(t,e){function n(){this.removeAttribute(t)}function r(){this.removeAttributeNS(t.space,t.local)}function i(){this.setAttribute(t,e)}function o(){this.setAttributeNS(t.space,t.local,e)}function s(){var n=e.apply(this,arguments);null==n?this.removeAttribute(t):this.setAttribute(t,n)}function a(){var n=e.apply(this,arguments);null==n?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}return t=Vo.ns.qualify(t),null==e?t.local?r:n:"function"==typeof e?t.local?a:s:t.local?o:i}function S(t){return t.trim().replace(/\s+/g," ")}function E(t){return new RegExp("(?:^|\\s+)"+Vo.requote(t)+"(?:\\s+|$)","g")}function N(t){return(t+"").trim().split(/^|\s+/)}function k(t,e){function n(){for(var n=-1;++n<i;)t[n](this,e)}function r(){for(var n=-1,r=e.apply(this,arguments);++n<i;)t[n](this,r)}t=N(t).map(M);var i=t.length;return"function"==typeof e?r:n}function M(t){var e=E(t);return function(n,r){if(i=n.classList)return r?i.add(t):i.remove(t);var i=n.getAttribute("class")||"";r?(e.lastIndex=0,e.test(i)||n.setAttribute("class",S(i+" "+t))):n.setAttribute("class",S(i.replace(e," ")))}}function P(t,e,n){function r(){this.style.removeProperty(t)}function i(){this.style.setProperty(t,e,n)}function o(){var r=e.apply(this,arguments);null==r?this.style.removeProperty(t):this.style.setProperty(t,r,n)}return null==e?r:"function"==typeof e?o:i}function O(t,e){function n(){delete this[t]}function r(){this[t]=e}function i(){var n=e.apply(this,arguments);null==n?delete this[t]:this[t]=n}return null==e?n:"function"==typeof e?i:r}function A(t){return"function"==typeof t?t:(t=Vo.ns.qualify(t)).local?function(){return this.ownerDocument.createElementNS(t.space,t.local)}:function(){return this.ownerDocument.createElementNS(this.namespaceURI,t)}}function R(t){return{__data__:t}}function I(t){return function(){return ds(this,t)}}function D(e){return arguments.length||(e=t),function(t,n){return t&&n?e(t.__data__,n.__data__):!t-!n}}function L(t,e){for(var n=0,r=t.length;r>n;n++)for(var i,o=t[n],s=0,a=o.length;a>s;s++)(i=o[s])&&e(i,s,n);return t}function q(t){return cs(t,ys),t}function j(t){var e,n;return function(r,i,o){var s,a=t[o].update,u=a.length;for(o!=n&&(n=o,e=0),i>=e&&(e=i+1);!(s=a[e])&&++e<u;);return s}}function $(){var t=this.__transition__;t&&++t.active}function F(t,e,n){function r(){var e=this[s];e&&(this.removeEventListener(t,e,e.$),delete this[s])}function i(){var i=u(e,Jo(arguments));r.call(this),this.addEventListener(t,this[s]=i,i.$=n),i._=e}function o(){var e,n=new RegExp("^__on([^.]+)"+Vo.requote(t)+"$");for(var r in this)if(e=r.match(n)){var i=this[r];this.removeEventListener(e[1],i,i.$),delete this[r]}}var s="__on"+t,a=t.indexOf("."),u=z;a>0&&(t=t.substring(0,a));var l=bs.get(t);return l&&(t=l,u=U),a?e?i:r:e?m:o}function z(t,e){return function(n){var r=Vo.event;Vo.event=n,e[0]=this.__data__;try{t.apply(this,e)}finally{Vo.event=r}}}function U(t,e){var n=z(t,e);return function(t){var e=this,r=t.relatedTarget;r&&(r===e||8&r.compareDocumentPosition(e))||n.call(e,t)}}function H(){var t=".dragsuppress-"+ ++ws,e="click"+t,n=Vo.select(Qo).on("touchmove"+t,v).on("dragstart"+t,v).on("selectstart"+t,v);if(_s){var r=Xo.style,i=r[_s];r[_s]="none"}return function(o){function s(){n.on(e,null)}n.on(t,null),_s&&(r[_s]=i),o&&(n.on(e,function(){v(),s()},!0),setTimeout(s,0))}}function B(t,e){e.changedTouches&&(e=e.changedTouches[0]);var n=t.ownerSVGElement||t;if(n.createSVGPoint){var r=n.createSVGPoint();if(0>xs&&(Qo.scrollX||Qo.scrollY)){n=Vo.select("body").append("svg").style({position:"absolute",top:0,left:0,margin:0,padding:0,border:"none"},"important");var i=n[0][0].getScreenCTM();xs=!(i.f||i.e),n.remove()}return xs?(r.x=e.pageX,r.y=e.pageY):(r.x=e.clientX,r.y=e.clientY),r=r.matrixTransform(t.getScreenCTM().inverse()),[r.x,r.y]}var o=t.getBoundingClientRect();return[e.clientX-o.left-t.clientLeft,e.clientY-o.top-t.clientTop]}function V(){return Vo.event.changedTouches[0].identifier}function W(){return Vo.event.target}function J(){return Qo}function G(t){return t>0?1:0>t?-1:0}function X(t,e,n){return(e[0]-t[0])*(n[1]-t[1])-(e[1]-t[1])*(n[0]-t[0])}function Q(t){return t>1?0:-1>t?Cs:Math.acos(t)}function Y(t){return t>1?Ss:-1>t?-Ss:Math.asin(t);

}function K(t){return((t=Math.exp(t))-1/t)/2}function Z(t){return((t=Math.exp(t))+1/t)/2}function tt(t){return((t=Math.exp(2*t))-1)/(t+1)}function et(t){return(t=Math.sin(t/2))*t}function nt(){}function rt(t,e,n){return this instanceof rt?(this.h=+t,this.s=+e,void(this.l=+n)):arguments.length<2?t instanceof rt?new rt(t.h,t.s,t.l):yt(""+t,vt,rt):new rt(t,e,n)}function it(t,e,n){function r(t){return t>360?t-=360:0>t&&(t+=360),60>t?o+(s-o)*t/60:180>t?s:240>t?o+(s-o)*(240-t)/60:o}function i(t){return Math.round(255*r(t))}var o,s;return t=isNaN(t)?0:(t%=360)<0?t+360:t,e=isNaN(e)?0:0>e?0:e>1?1:e,n=0>n?0:n>1?1:n,s=.5>=n?n*(1+e):n+e-n*e,o=2*n-s,new ft(i(t+120),i(t),i(t-120))}function ot(t,e,n){return this instanceof ot?(this.h=+t,this.c=+e,void(this.l=+n)):arguments.length<2?t instanceof ot?new ot(t.h,t.c,t.l):t instanceof at?lt(t.l,t.a,t.b):lt((t=bt((t=Vo.rgb(t)).r,t.g,t.b)).l,t.a,t.b):new ot(t,e,n)}function st(t,e,n){return isNaN(t)&&(t=0),isNaN(e)&&(e=0),new at(n,Math.cos(t*=ks)*e,Math.sin(t)*e)}function at(t,e,n){return this instanceof at?(this.l=+t,this.a=+e,void(this.b=+n)):arguments.length<2?t instanceof at?new at(t.l,t.a,t.b):t instanceof ot?st(t.l,t.c,t.h):bt((t=ft(t)).r,t.g,t.b):new at(t,e,n)}function ut(t,e,n){var r=(t+16)/116,i=r+e/500,o=r-n/200;return i=ct(i)*$s,r=ct(r)*Fs,o=ct(o)*zs,new ft(pt(3.2404542*i-1.5371385*r-.4985314*o),pt(-.969266*i+1.8760108*r+.041556*o),pt(.0556434*i-.2040259*r+1.0572252*o))}function lt(t,e,n){return t>0?new ot(Math.atan2(n,e)*Ms,Math.sqrt(e*e+n*n),t):new ot(0/0,0/0,t)}function ct(t){return t>.206893034?t*t*t:(t-4/29)/7.787037}function ht(t){return t>.008856?Math.pow(t,1/3):7.787037*t+4/29}function pt(t){return Math.round(255*(.00304>=t?12.92*t:1.055*Math.pow(t,1/2.4)-.055))}function ft(t,e,n){return this instanceof ft?(this.r=~~t,this.g=~~e,void(this.b=~~n)):arguments.length<2?t instanceof ft?new ft(t.r,t.g,t.b):yt(""+t,ft,it):new ft(t,e,n)}function dt(t){return new ft(t>>16,t>>8&255,255&t)}function mt(t){return dt(t)+""}function gt(t){return 16>t?"0"+Math.max(0,t).toString(16):Math.min(255,t).toString(16)}function yt(t,e,n){var r,i,o,s=0,a=0,u=0;if(r=/([a-z]+)\((.*)\)/i.exec(t))switch(i=r[2].split(","),r[1]){case"hsl":return n(parseFloat(i[0]),parseFloat(i[1])/100,parseFloat(i[2])/100);case"rgb":return e(wt(i[0]),wt(i[1]),wt(i[2]))}return(o=Bs.get(t))?e(o.r,o.g,o.b):(null==t||"#"!==t.charAt(0)||isNaN(o=parseInt(t.substring(1),16))||(4===t.length?(s=(3840&o)>>4,s=s>>4|s,a=240&o,a=a>>4|a,u=15&o,u=u<<4|u):7===t.length&&(s=(16711680&o)>>16,a=(65280&o)>>8,u=255&o)),e(s,a,u))}function vt(t,e,n){var r,i,o=Math.min(t/=255,e/=255,n/=255),s=Math.max(t,e,n),a=s-o,u=(s+o)/2;return a?(i=.5>u?a/(s+o):a/(2-s-o),r=t==s?(e-n)/a+(n>e?6:0):e==s?(n-t)/a+2:(t-e)/a+4,r*=60):(r=0/0,i=u>0&&1>u?0:r),new rt(r,i,u)}function bt(t,e,n){t=_t(t),e=_t(e),n=_t(n);var r=ht((.4124564*t+.3575761*e+.1804375*n)/$s),i=ht((.2126729*t+.7151522*e+.072175*n)/Fs),o=ht((.0193339*t+.119192*e+.9503041*n)/zs);return at(116*i-16,500*(r-i),200*(i-o))}function _t(t){return(t/=255)<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4)}function wt(t){var e=parseFloat(t);return"%"===t.charAt(t.length-1)?Math.round(2.55*e):e}function xt(t){return"function"==typeof t?t:function(){return t}}function Ct(t){return t}function Tt(t){return function(e,n,r){return 2===arguments.length&&"function"==typeof n&&(r=n,n=null),St(e,n,t,r)}}function St(t,e,n,r){function i(){var t,e=u.status;if(!e&&u.responseText||e>=200&&300>e||304===e){try{t=n.call(o,u)}catch(r){return void s.error.call(o,r)}s.load.call(o,t)}else s.error.call(o,u)}var o={},s=Vo.dispatch("beforesend","progress","load","error"),a={},u=new XMLHttpRequest,l=null;return!Qo.XDomainRequest||"withCredentials"in u||!/^(http(s)?:)?\/\//.test(t)||(u=new XDomainRequest),"onload"in u?u.onload=u.onerror=i:u.onreadystatechange=function(){u.readyState>3&&i()},u.onprogress=function(t){var e=Vo.event;Vo.event=t;try{s.progress.call(o,u)}finally{Vo.event=e}},o.header=function(t,e){return t=(t+"").toLowerCase(),arguments.length<2?a[t]:(null==e?delete a[t]:a[t]=e+"",o)},o.mimeType=function(t){return arguments.length?(e=null==t?null:t+"",o):e},o.responseType=function(t){return arguments.length?(l=t,o):l},o.response=function(t){return n=t,o},["get","post"].forEach(function(t){o[t]=function(){return o.send.apply(o,[t].concat(Jo(arguments)))}}),o.send=function(n,r,i){if(2===arguments.length&&"function"==typeof r&&(i=r,r=null),u.open(n,t,!0),null==e||"accept"in a||(a.accept=e+",*/*"),u.setRequestHeader)for(var c in a)u.setRequestHeader(c,a[c]);return null!=e&&u.overrideMimeType&&u.overrideMimeType(e),null!=l&&(u.responseType=l),null!=i&&o.on("error",i).on("load",function(t){i(null,t)}),s.beforesend.call(o,u),u.send(null==r?null:r),o},o.abort=function(){return u.abort(),o},Vo.rebind(o,s,"on"),null==r?o:o.get(Et(r))}function Et(t){return 1===t.length?function(e,n){t(null==e?n:null)}:t}function Nt(){var t=kt(),e=Mt()-t;e>24?(isFinite(e)&&(clearTimeout(Gs),Gs=setTimeout(Nt,e)),Js=0):(Js=1,Qs(Nt))}function kt(){var t=Date.now();for(Xs=Vs;Xs;)t>=Xs.t&&(Xs.f=Xs.c(t-Xs.t)),Xs=Xs.n;return t}function Mt(){for(var t,e=Vs,n=1/0;e;)e.f?e=t?t.n=e.n:Vs=e.n:(e.t<n&&(n=e.t),e=(t=e).n);return Ws=t,n}function Pt(t,e){return e-(t?Math.ceil(Math.log(t)/Math.LN10):1)}function Ot(t,e){var n=Math.pow(10,3*os(8-e));return{scale:e>8?function(t){return t/n}:function(t){return t*n},symbol:t}}function At(t){var e=t.decimal,n=t.thousands,r=t.grouping,i=t.currency,o=r?function(t){for(var e=t.length,i=[],o=0,s=r[0];e>0&&s>0;)i.push(t.substring(e-=s,e+s)),s=r[o=(o+1)%r.length];return i.reverse().join(n)}:Ct;return function(t){var n=Ks.exec(t),r=n[1]||" ",s=n[2]||">",a=n[3]||"",u=n[4]||"",l=n[5],c=+n[6],h=n[7],p=n[8],f=n[9],d=1,m="",g="",y=!1;switch(p&&(p=+p.substring(1)),(l||"0"===r&&"="===s)&&(l=r="0",s="=",h&&(c-=Math.floor((c-1)/4))),f){case"n":h=!0,f="g";break;case"%":d=100,g="%",f="f";break;case"p":d=100,g="%",f="r";break;case"b":case"o":case"x":case"X":"#"===u&&(m="0"+f.toLowerCase());case"c":case"d":y=!0,p=0;break;case"s":d=-1,f="r"}"$"===u&&(m=i[0],g=i[1]),"r"!=f||p||(f="g"),null!=p&&("g"==f?p=Math.max(1,Math.min(21,p)):("e"==f||"f"==f)&&(p=Math.max(0,Math.min(20,p)))),f=Zs.get(f)||Rt;var v=l&&h;return function(t){var n=g;if(y&&t%1)return"";var i=0>t||0===t&&0>1/t?(t=-t,"-"):a;if(0>d){var u=Vo.formatPrefix(t,p);t=u.scale(t),n=u.symbol+g}else t*=d;t=f(t,p);var b=t.lastIndexOf("."),_=0>b?t:t.substring(0,b),w=0>b?"":e+t.substring(b+1);!l&&h&&(_=o(_));var x=m.length+_.length+w.length+(v?0:i.length),C=c>x?new Array(x=c-x+1).join(r):"";return v&&(_=o(C+_)),i+=m,t=_+w,("<"===s?i+t+C:">"===s?C+i+t:"^"===s?C.substring(0,x>>=1)+i+t+C.substring(x):i+(v?t:C+t))+n}}}function Rt(t){return t+""}function It(){this._=new Date(arguments.length>1?Date.UTC.apply(this,arguments):arguments[0])}function Dt(t,e,n){function r(e){var n=t(e),r=o(n,1);return r-e>e-n?n:r}function i(n){return e(n=t(new ea(n-1)),1),n}function o(t,n){return e(t=new ea(+t),n),t}function s(t,r,o){var s=i(t),a=[];if(o>1)for(;r>s;)n(s)%o||a.push(new Date(+s)),e(s,1);else for(;r>s;)a.push(new Date(+s)),e(s,1);return a}function a(t,e,n){try{ea=It;var r=new It;return r._=t,s(r,e,n)}finally{ea=Date}}t.floor=t,t.round=r,t.ceil=i,t.offset=o,t.range=s;var u=t.utc=Lt(t);return u.floor=u,u.round=Lt(r),u.ceil=Lt(i),u.offset=Lt(o),u.range=a,t}function Lt(t){return function(e,n){try{ea=It;var r=new It;return r._=e,t(r,n)._}finally{ea=Date}}}function qt(t){function e(t){function e(e){for(var n,i,o,s=[],a=-1,u=0;++a<r;)37===t.charCodeAt(a)&&(s.push(t.substring(u,a)),null!=(i=ra[n=t.charAt(++a)])&&(n=t.charAt(++a)),(o=k[n])&&(n=o(e,null==i?"e"===n?" ":"0":i)),s.push(n),u=a+1);return s.push(t.substring(u,a)),s.join("")}var r=t.length;return e.parse=function(e){var r={y:1900,m:0,d:1,H:0,M:0,S:0,L:0,Z:null},i=n(r,t,e,0);if(i!=e.length)return null;"p"in r&&(r.H=r.H%12+12*r.p);var o=null!=r.Z&&ea!==It,s=new(o?It:ea);return"j"in r?s.setFullYear(r.y,0,r.j):"w"in r&&("W"in r||"U"in r)?(s.setFullYear(r.y,0,1),s.setFullYear(r.y,0,"W"in r?(r.w+6)%7+7*r.W-(s.getDay()+5)%7:r.w+7*r.U-(s.getDay()+6)%7)):s.setFullYear(r.y,r.m,r.d),s.setHours(r.H+Math.floor(r.Z/100),r.M+r.Z%100,r.S,r.L),o?s._:s},e.toString=function(){return t},e}function n(t,e,n,r){for(var i,o,s,a=0,u=e.length,l=n.length;u>a;){if(r>=l)return-1;if(i=e.charCodeAt(a++),37===i){if(s=e.charAt(a++),o=M[s in ra?e.charAt(a++):s],!o||(r=o(t,n,r))<0)return-1}else if(i!=n.charCodeAt(r++))return-1}return r}function r(t,e,n){x.lastIndex=0;var r=x.exec(e.substring(n));return r?(t.w=C.get(r[0].toLowerCase()),n+r[0].length):-1}function i(t,e,n){_.lastIndex=0;var r=_.exec(e.substring(n));return r?(t.w=w.get(r[0].toLowerCase()),n+r[0].length):-1}function o(t,e,n){E.lastIndex=0;var r=E.exec(e.substring(n));return r?(t.m=N.get(r[0].toLowerCase()),n+r[0].length):-1}function s(t,e,n){T.lastIndex=0;var r=T.exec(e.substring(n));return r?(t.m=S.get(r[0].toLowerCase()),n+r[0].length):-1}function a(t,e,r){return n(t,k.c.toString(),e,r)}function u(t,e,r){return n(t,k.x.toString(),e,r)}function l(t,e,r){return n(t,k.X.toString(),e,r)}function c(t,e,n){var r=b.get(e.substring(n,n+=2).toLowerCase());return null==r?-1:(t.p=r,n)}var h=t.dateTime,p=t.date,f=t.time,d=t.periods,m=t.days,g=t.shortDays,y=t.months,v=t.shortMonths;e.utc=function(t){function n(t){try{ea=It;var e=new ea;return e._=t,r(e)}finally{ea=Date}}var r=e(t);return n.parse=function(t){try{ea=It;var e=r.parse(t);return e&&e._}finally{ea=Date}},n.toString=r.toString,n},e.multi=e.utc.multi=re;var b=Vo.map(),_=$t(m),w=Ft(m),x=$t(g),C=Ft(g),T=$t(y),S=Ft(y),E=$t(v),N=Ft(v);d.forEach(function(t,e){b.set(t.toLowerCase(),e)});var k={a:function(t){return g[t.getDay()]},A:function(t){return m[t.getDay()]},b:function(t){return v[t.getMonth()]},B:function(t){return y[t.getMonth()]},c:e(h),d:function(t,e){return jt(t.getDate(),e,2)},e:function(t,e){return jt(t.getDate(),e,2)},H:function(t,e){return jt(t.getHours(),e,2)},I:function(t,e){return jt(t.getHours()%12||12,e,2)},j:function(t,e){return jt(1+ta.dayOfYear(t),e,3)},L:function(t,e){return jt(t.getMilliseconds(),e,3)},m:function(t,e){return jt(t.getMonth()+1,e,2)},M:function(t,e){return jt(t.getMinutes(),e,2)},p:function(t){return d[+(t.getHours()>=12)]},S:function(t,e){return jt(t.getSeconds(),e,2)},U:function(t,e){return jt(ta.sundayOfYear(t),e,2)},w:function(t){return t.getDay()},W:function(t,e){return jt(ta.mondayOfYear(t),e,2)},x:e(p),X:e(f),y:function(t,e){return jt(t.getFullYear()%100,e,2)},Y:function(t,e){return jt(t.getFullYear()%1e4,e,4)},Z:ee,"%":function(){return"%"}},M={a:r,A:i,b:o,B:s,c:a,d:Xt,e:Xt,H:Yt,I:Yt,j:Qt,L:te,m:Gt,M:Kt,p:c,S:Zt,U:Ut,w:zt,W:Ht,x:u,X:l,y:Vt,Y:Bt,Z:Wt,"%":ne};return e}function jt(t,e,n){var r=0>t?"-":"",i=(r?-t:t)+"",o=i.length;return r+(n>o?new Array(n-o+1).join(e)+i:i)}function $t(t){return new RegExp("^(?:"+t.map(Vo.requote).join("|")+")","i")}function Ft(t){for(var e=new s,n=-1,r=t.length;++n<r;)e.set(t[n].toLowerCase(),n);return e}function zt(t,e,n){ia.lastIndex=0;var r=ia.exec(e.substring(n,n+1));return r?(t.w=+r[0],n+r[0].length):-1}function Ut(t,e,n){ia.lastIndex=0;var r=ia.exec(e.substring(n));return r?(t.U=+r[0],n+r[0].length):-1}function Ht(t,e,n){ia.lastIndex=0;var r=ia.exec(e.substring(n));return r?(t.W=+r[0],n+r[0].length):-1}function Bt(t,e,n){ia.lastIndex=0;var r=ia.exec(e.substring(n,n+4));return r?(t.y=+r[0],n+r[0].length):-1}function Vt(t,e,n){ia.lastIndex=0;var r=ia.exec(e.substring(n,n+2));return r?(t.y=Jt(+r[0]),n+r[0].length):-1}function Wt(t,e,n){return/^[+-]\d{4}$/.test(e=e.substring(n,n+5))?(t.Z=-e,n+5):-1}function Jt(t){return t+(t>68?1900:2e3)}function Gt(t,e,n){ia.lastIndex=0;var r=ia.exec(e.substring(n,n+2));return r?(t.m=r[0]-1,n+r[0].length):-1}function Xt(t,e,n){ia.lastIndex=0;var r=ia.exec(e.substring(n,n+2));return r?(t.d=+r[0],n+r[0].length):-1}function Qt(t,e,n){ia.lastIndex=0;var r=ia.exec(e.substring(n,n+3));return r?(t.j=+r[0],n+r[0].length):-1}function Yt(t,e,n){ia.lastIndex=0;var r=ia.exec(e.substring(n,n+2));return r?(t.H=+r[0],n+r[0].length):-1}function Kt(t,e,n){ia.lastIndex=0;var r=ia.exec(e.substring(n,n+2));return r?(t.M=+r[0],n+r[0].length):-1}function Zt(t,e,n){ia.lastIndex=0;var r=ia.exec(e.substring(n,n+2));return r?(t.S=+r[0],n+r[0].length):-1}function te(t,e,n){ia.lastIndex=0;var r=ia.exec(e.substring(n,n+3));return r?(t.L=+r[0],n+r[0].length):-1}function ee(t){var e=t.getTimezoneOffset(),n=e>0?"-":"+",r=~~(os(e)/60),i=os(e)%60;return n+jt(r,"0",2)+jt(i,"0",2)}function ne(t,e,n){oa.lastIndex=0;var r=oa.exec(e.substring(n,n+1));return r?n+r[0].length:-1}function re(t){for(var e=t.length,n=-1;++n<e;)t[n][0]=this(t[n][0]);return function(e){for(var n=0,r=t[n];!r[1](e);)r=t[++n];return r[0](e)}}function ie(){}function oe(t,e,n){var r=n.s=t+e,i=r-t,o=r-i;n.t=t-o+(e-i)}function se(t,e){t&&la.hasOwnProperty(t.type)&&la[t.type](t,e)}function ae(t,e,n){var r,i=-1,o=t.length-n;for(e.lineStart();++i<o;)r=t[i],e.point(r[0],r[1],r[2]);e.lineEnd()}function ue(t,e){var n=-1,r=t.length;for(e.polygonStart();++n<r;)ae(t[n],e,1);e.polygonEnd()}function le(){function t(t,e){t*=ks,e=e*ks/2+Cs/4;var n=t-r,s=n>=0?1:-1,a=s*n,u=Math.cos(e),l=Math.sin(e),c=o*l,h=i*u+c*Math.cos(a),p=c*s*Math.sin(a);ha.add(Math.atan2(p,h)),r=t,i=u,o=l}var e,n,r,i,o;pa.point=function(s,a){pa.point=t,r=(e=s)*ks,i=Math.cos(a=(n=a)*ks/2+Cs/4),o=Math.sin(a)},pa.lineEnd=function(){t(e,n)}}function ce(t){var e=t[0],n=t[1],r=Math.cos(n);return[r*Math.cos(e),r*Math.sin(e),Math.sin(n)]}function he(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function pe(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function fe(t,e){t[0]+=e[0],t[1]+=e[1],t[2]+=e[2]}function de(t,e){return[t[0]*e,t[1]*e,t[2]*e]}function me(t){var e=Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=e,t[1]/=e,t[2]/=e}function ge(t){return[Math.atan2(t[1],t[0]),Y(t[2])]}function ye(t,e){return os(t[0]-e[0])<Es&&os(t[1]-e[1])<Es}function ve(t,e){t*=ks;var n=Math.cos(e*=ks);be(n*Math.cos(t),n*Math.sin(t),Math.sin(e))}function be(t,e,n){++fa,ma+=(t-ma)/fa,ga+=(e-ga)/fa,ya+=(n-ya)/fa}function _e(){function t(t,i){t*=ks;var o=Math.cos(i*=ks),s=o*Math.cos(t),a=o*Math.sin(t),u=Math.sin(i),l=Math.atan2(Math.sqrt((l=n*u-r*a)*l+(l=r*s-e*u)*l+(l=e*a-n*s)*l),e*s+n*a+r*u);da+=l,va+=l*(e+(e=s)),ba+=l*(n+(n=a)),_a+=l*(r+(r=u)),be(e,n,r)}var e,n,r;Ta.point=function(i,o){i*=ks;var s=Math.cos(o*=ks);e=s*Math.cos(i),n=s*Math.sin(i),r=Math.sin(o),Ta.point=t,be(e,n,r)}}function we(){Ta.point=ve}function xe(){function t(t,e){t*=ks;var n=Math.cos(e*=ks),s=n*Math.cos(t),a=n*Math.sin(t),u=Math.sin(e),l=i*u-o*a,c=o*s-r*u,h=r*a-i*s,p=Math.sqrt(l*l+c*c+h*h),f=r*s+i*a+o*u,d=p&&-Q(f)/p,m=Math.atan2(p,f);wa+=d*l,xa+=d*c,Ca+=d*h,da+=m,va+=m*(r+(r=s)),ba+=m*(i+(i=a)),_a+=m*(o+(o=u)),be(r,i,o)}var e,n,r,i,o;Ta.point=function(s,a){e=s,n=a,Ta.point=t,s*=ks;var u=Math.cos(a*=ks);r=u*Math.cos(s),i=u*Math.sin(s),o=Math.sin(a),be(r,i,o)},Ta.lineEnd=function(){t(e,n),Ta.lineEnd=we,Ta.point=ve}}function Ce(){return!0}function Te(t,e,n,r,i){var o=[],s=[];if(t.forEach(function(t){if(!((e=t.length-1)<=0)){var e,n=t[0],r=t[e];if(ye(n,r)){i.lineStart();for(var a=0;e>a;++a)i.point((n=t[a])[0],n[1]);return void i.lineEnd()}var u=new Ee(n,t,null,!0),l=new Ee(n,null,u,!1);u.o=l,o.push(u),s.push(l),u=new Ee(r,t,null,!1),l=new Ee(r,null,u,!0),u.o=l,o.push(u),s.push(l)}}),s.sort(e),Se(o),Se(s),o.length){for(var a=0,u=n,l=s.length;l>a;++a)s[a].e=u=!u;for(var c,h,p=o[0];;){for(var f=p,d=!0;f.v;)if((f=f.n)===p)return;c=f.z,i.lineStart();do{if(f.v=f.o.v=!0,f.e){if(d)for(var a=0,l=c.length;l>a;++a)i.point((h=c[a])[0],h[1]);else r(f.x,f.n.x,1,i);f=f.n}else{if(d){c=f.p.z;for(var a=c.length-1;a>=0;--a)i.point((h=c[a])[0],h[1])}else r(f.x,f.p.x,-1,i);f=f.p}f=f.o,c=f.z,d=!d}while(!f.v);i.lineEnd()}}}function Se(t){if(e=t.length){for(var e,n,r=0,i=t[0];++r<e;)i.n=n=t[r],n.p=i,i=n;i.n=n=t[0],n.p=i}}function Ee(t,e,n,r){this.x=t,this.z=e,this.o=n,this.e=r,this.v=!1,this.n=this.p=null}function Ne(t,e,n,r){return function(i,o){function s(e,n){var r=i(e,n);t(e=r[0],n=r[1])&&o.point(e,n)}function a(t,e){var n=i(t,e);g.point(n[0],n[1])}function u(){v.point=a,g.lineStart()}function l(){v.point=s,g.lineEnd()}function c(t,e){m.push([t,e]);var n=i(t,e);_.point(n[0],n[1])}function h(){_.lineStart(),m=[]}function p(){c(m[0][0],m[0][1]),_.lineEnd();var t,e=_.clean(),n=b.buffer(),r=n.length;if(m.pop(),d.push(m),m=null,r)if(1&e){t=n[0];var i,r=t.length-1,s=-1;if(r>0){for(w||(o.polygonStart(),w=!0),o.lineStart();++s<r;)o.point((i=t[s])[0],i[1]);o.lineEnd()}}else r>1&&2&e&&n.push(n.pop().concat(n.shift())),f.push(n.filter(ke))}var f,d,m,g=e(o),y=i.invert(r[0],r[1]),v={point:s,lineStart:u,lineEnd:l,polygonStart:function(){v.point=c,v.lineStart=h,v.lineEnd=p,f=[],d=[]},polygonEnd:function(){v.point=s,v.lineStart=u,v.lineEnd=l,f=Vo.merge(f);var t=Oe(y,d);f.length?(w||(o.polygonStart(),w=!0),Te(f,Pe,t,n,o)):t&&(w||(o.polygonStart(),w=!0),o.lineStart(),n(null,null,1,o),o.lineEnd()),w&&(o.polygonEnd(),w=!1),f=d=null},sphere:function(){o.polygonStart(),o.lineStart(),n(null,null,1,o),o.lineEnd(),o.polygonEnd()}},b=Me(),_=e(b),w=!1;return v}}function ke(t){return t.length>1}function Me(){var t,e=[];return{lineStart:function(){e.push(t=[])},point:function(e,n){t.push([e,n])},lineEnd:m,buffer:function(){var n=e;return e=[],t=null,n},rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))}}}function Pe(t,e){return((t=t.x)[0]<0?t[1]-Ss-Es:Ss-t[1])-((e=e.x)[0]<0?e[1]-Ss-Es:Ss-e[1])}function Oe(t,e){var n=t[0],r=t[1],i=[Math.sin(n),-Math.cos(n),0],o=0,s=0;ha.reset();for(var a=0,u=e.length;u>a;++a){var l=e[a],c=l.length;if(c)for(var h=l[0],p=h[0],f=h[1]/2+Cs/4,d=Math.sin(f),m=Math.cos(f),g=1;;){g===c&&(g=0),t=l[g];var y=t[0],v=t[1]/2+Cs/4,b=Math.sin(v),_=Math.cos(v),w=y-p,x=w>=0?1:-1,C=x*w,T=C>Cs,S=d*b;if(ha.add(Math.atan2(S*x*Math.sin(C),m*_+S*Math.cos(C))),o+=T?w+x*Ts:w,T^p>=n^y>=n){var E=pe(ce(h),ce(t));me(E);var N=pe(i,E);me(N);var k=(T^w>=0?-1:1)*Y(N[2]);(r>k||r===k&&(E[0]||E[1]))&&(s+=T^w>=0?1:-1)}if(!g++)break;p=y,d=b,m=_,h=t}}return(-Es>o||Es>o&&0>ha)^1&s}function Ae(t){var e,n=0/0,r=0/0,i=0/0;return{lineStart:function(){t.lineStart(),e=1},point:function(o,s){var a=o>0?Cs:-Cs,u=os(o-n);os(u-Cs)<Es?(t.point(n,r=(r+s)/2>0?Ss:-Ss),t.point(i,r),t.lineEnd(),t.lineStart(),t.point(a,r),t.point(o,r),e=0):i!==a&&u>=Cs&&(os(n-i)<Es&&(n-=i*Es),os(o-a)<Es&&(o-=a*Es),r=Re(n,r,o,s),t.point(i,r),t.lineEnd(),t.lineStart(),t.point(a,r),e=0),t.point(n=o,r=s),i=a},lineEnd:function(){t.lineEnd(),n=r=0/0},clean:function(){return 2-e}}}function Re(t,e,n,r){var i,o,s=Math.sin(t-n);return os(s)>Es?Math.atan((Math.sin(e)*(o=Math.cos(r))*Math.sin(n)-Math.sin(r)*(i=Math.cos(e))*Math.sin(t))/(i*o*s)):(e+r)/2}function Ie(t,e,n,r){var i;if(null==t)i=n*Ss,r.point(-Cs,i),r.point(0,i),r.point(Cs,i),r.point(Cs,0),r.point(Cs,-i),r.point(0,-i),r.point(-Cs,-i),r.point(-Cs,0),r.point(-Cs,i);else if(os(t[0]-e[0])>Es){var o=t[0]<e[0]?Cs:-Cs;i=n*o/2,r.point(-o,i),r.point(0,i),r.point(o,i)}else r.point(e[0],e[1])}function De(t){function e(t,e){return Math.cos(t)*Math.cos(e)>o}function n(t){var n,o,u,l,c;return{lineStart:function(){l=u=!1,c=1},point:function(h,p){var f,d=[h,p],m=e(h,p),g=s?m?0:i(h,p):m?i(h+(0>h?Cs:-Cs),p):0;if(!n&&(l=u=m)&&t.lineStart(),m!==u&&(f=r(n,d),(ye(n,f)||ye(d,f))&&(d[0]+=Es,d[1]+=Es,m=e(d[0],d[1]))),m!==u)c=0,m?(t.lineStart(),f=r(d,n),t.point(f[0],f[1])):(f=r(n,d),t.point(f[0],f[1]),t.lineEnd()),n=f;else if(a&&n&&s^m){var y;g&o||!(y=r(d,n,!0))||(c=0,s?(t.lineStart(),t.point(y[0][0],y[0][1]),t.point(y[1][0],y[1][1]),t.lineEnd()):(t.point(y[1][0],y[1][1]),t.lineEnd(),t.lineStart(),t.point(y[0][0],y[0][1])))}!m||n&&ye(n,d)||t.point(d[0],d[1]),n=d,u=m,o=g},lineEnd:function(){u&&t.lineEnd(),n=null},clean:function(){return c|(l&&u)<<1}}}function r(t,e,n){var r=ce(t),i=ce(e),s=[1,0,0],a=pe(r,i),u=he(a,a),l=a[0],c=u-l*l;if(!c)return!n&&t;var h=o*u/c,p=-o*l/c,f=pe(s,a),d=de(s,h),m=de(a,p);fe(d,m);var g=f,y=he(d,g),v=he(g,g),b=y*y-v*(he(d,d)-1);if(!(0>b)){var _=Math.sqrt(b),w=de(g,(-y-_)/v);if(fe(w,d),w=ge(w),!n)return w;var x,C=t[0],T=e[0],S=t[1],E=e[1];C>T&&(x=C,C=T,T=x);var N=T-C,k=os(N-Cs)<Es,M=k||Es>N;if(!k&&S>E&&(x=S,S=E,E=x),M?k?S+E>0^w[1]<(os(w[0]-C)<Es?S:E):S<=w[1]&&w[1]<=E:N>Cs^(C<=w[0]&&w[0]<=T)){var P=de(g,(-y+_)/v);return fe(P,d),[w,ge(P)]}}}function i(e,n){var r=s?t:Cs-t,i=0;return-r>e?i|=1:e>r&&(i|=2),-r>n?i|=4:n>r&&(i|=8),i}var o=Math.cos(t),s=o>0,a=os(o)>Es,u=cn(t,6*ks);return Ne(e,n,u,s?[0,-t]:[-Cs,t-Cs])}function Le(t,e,n,r){return function(i){var o,s=i.a,a=i.b,u=s.x,l=s.y,c=a.x,h=a.y,p=0,f=1,d=c-u,m=h-l;if(o=t-u,d||!(o>0)){if(o/=d,0>d){if(p>o)return;f>o&&(f=o)}else if(d>0){if(o>f)return;o>p&&(p=o)}if(o=n-u,d||!(0>o)){if(o/=d,0>d){if(o>f)return;o>p&&(p=o)}else if(d>0){if(p>o)return;f>o&&(f=o)}if(o=e-l,m||!(o>0)){if(o/=m,0>m){if(p>o)return;f>o&&(f=o)}else if(m>0){if(o>f)return;o>p&&(p=o)}if(o=r-l,m||!(0>o)){if(o/=m,0>m){if(o>f)return;o>p&&(p=o)}else if(m>0){if(p>o)return;f>o&&(f=o)}return p>0&&(i.a={x:u+p*d,y:l+p*m}),1>f&&(i.b={x:u+f*d,y:l+f*m}),i}}}}}}function qe(t,e,n,r){function i(r,i){return os(r[0]-t)<Es?i>0?0:3:os(r[0]-n)<Es?i>0?2:1:os(r[1]-e)<Es?i>0?1:0:i>0?3:2}function o(t,e){return s(t.x,e.x)}function s(t,e){var n=i(t,1),r=i(e,1);return n!==r?n-r:0===n?e[1]-t[1]:1===n?t[0]-e[0]:2===n?t[1]-e[1]:e[0]-t[0]}return function(a){function u(t){for(var e=0,n=g.length,r=t[1],i=0;n>i;++i)for(var o,s=1,a=g[i],u=a.length,l=a[0];u>s;++s)o=a[s],l[1]<=r?o[1]>r&&X(l,o,t)>0&&++e:o[1]<=r&&X(l,o,t)<0&&--e,l=o;return 0!==e}function l(o,a,u,l){var c=0,h=0;if(null==o||(c=i(o,u))!==(h=i(a,u))||s(o,a)<0^u>0){do l.point(0===c||3===c?t:n,c>1?r:e);while((c=(c+u+4)%4)!==h)}else l.point(a[0],a[1])}function c(i,o){return i>=t&&n>=i&&o>=e&&r>=o}function h(t,e){c(t,e)&&a.point(t,e)}function p(){M.point=d,g&&g.push(y=[]),T=!0,C=!1,w=x=0/0}function f(){m&&(d(v,b),_&&C&&N.rejoin(),m.push(N.buffer())),M.point=h,C&&a.lineEnd()}function d(t,e){t=Math.max(-Ea,Math.min(Ea,t)),e=Math.max(-Ea,Math.min(Ea,e));var n=c(t,e);if(g&&y.push([t,e]),T)v=t,b=e,_=n,T=!1,n&&(a.lineStart(),a.point(t,e));else if(n&&C)a.point(t,e);else{var r={a:{x:w,y:x},b:{x:t,y:e}};k(r)?(C||(a.lineStart(),a.point(r.a.x,r.a.y)),a.point(r.b.x,r.b.y),n||a.lineEnd(),S=!1):n&&(a.lineStart(),a.point(t,e),S=!1)}w=t,x=e,C=n}var m,g,y,v,b,_,w,x,C,T,S,E=a,N=Me(),k=Le(t,e,n,r),M={point:h,lineStart:p,lineEnd:f,polygonStart:function(){a=N,m=[],g=[],S=!0},polygonEnd:function(){a=E,m=Vo.merge(m);var e=u([t,r]),n=S&&e,i=m.length;(n||i)&&(a.polygonStart(),n&&(a.lineStart(),l(null,null,1,a),a.lineEnd()),i&&Te(m,o,e,l,a),a.polygonEnd()),m=g=y=null}};return M}}function je(t,e){function n(n,r){return n=t(n,r),e(n[0],n[1])}return t.invert&&e.invert&&(n.invert=function(n,r){return n=e.invert(n,r),n&&t.invert(n[0],n[1])}),n}function $e(t){var e=0,n=Cs/3,r=en(t),i=r(e,n);return i.parallels=function(t){return arguments.length?r(e=t[0]*Cs/180,n=t[1]*Cs/180):[e/Cs*180,n/Cs*180]},i}function Fe(t,e){function n(t,e){var n=Math.sqrt(o-2*i*Math.sin(e))/i;return[n*Math.sin(t*=i),s-n*Math.cos(t)]}var r=Math.sin(t),i=(r+Math.sin(e))/2,o=1+r*(2*i-r),s=Math.sqrt(o)/i;return n.invert=function(t,e){var n=s-e;return[Math.atan2(t,n)/i,Y((o-(t*t+n*n)*i*i)/(2*i))]},n}function ze(){function t(t,e){ka+=i*t-r*e,r=t,i=e}var e,n,r,i;Ra.point=function(o,s){Ra.point=t,e=r=o,n=i=s},Ra.lineEnd=function(){t(e,n)}}function Ue(t,e){Ma>t&&(Ma=t),t>Oa&&(Oa=t),Pa>e&&(Pa=e),e>Aa&&(Aa=e)}function He(){function t(t,e){s.push("M",t,",",e,o)}function e(t,e){s.push("M",t,",",e),a.point=n}function n(t,e){s.push("L",t,",",e)}function r(){a.point=t}function i(){s.push("Z")}var o=Be(4.5),s=[],a={point:t,lineStart:function(){a.point=e},lineEnd:r,polygonStart:function(){a.lineEnd=i},polygonEnd:function(){a.lineEnd=r,a.point=t},pointRadius:function(t){return o=Be(t),a},result:function(){if(s.length){var t=s.join("");return s=[],t}}};return a}function Be(t){return"m0,"+t+"a"+t+","+t+" 0 1,1 0,"+-2*t+"a"+t+","+t+" 0 1,1 0,"+2*t+"z"}function Ve(t,e){ma+=t,ga+=e,++ya}function We(){function t(t,r){var i=t-e,o=r-n,s=Math.sqrt(i*i+o*o);va+=s*(e+t)/2,ba+=s*(n+r)/2,_a+=s,Ve(e=t,n=r)}var e,n;Da.point=function(r,i){Da.point=t,Ve(e=r,n=i)}}function Je(){Da.point=Ve}function Ge(){function t(t,e){var n=t-r,o=e-i,s=Math.sqrt(n*n+o*o);va+=s*(r+t)/2,ba+=s*(i+e)/2,_a+=s,s=i*t-r*e,wa+=s*(r+t),xa+=s*(i+e),Ca+=3*s,Ve(r=t,i=e)}var e,n,r,i;Da.point=function(o,s){Da.point=t,Ve(e=r=o,n=i=s)},Da.lineEnd=function(){t(e,n)}}function Xe(t){function e(e,n){t.moveTo(e,n),t.arc(e,n,s,0,Ts)}function n(e,n){t.moveTo(e,n),a.point=r}function r(e,n){t.lineTo(e,n)}function i(){a.point=e}function o(){t.closePath()}var s=4.5,a={point:e,lineStart:function(){a.point=n},lineEnd:i,polygonStart:function(){a.lineEnd=o},polygonEnd:function(){a.lineEnd=i,a.point=e},pointRadius:function(t){return s=t,a},result:m};return a}function Qe(t){function e(t){return(a?r:n)(t)}function n(e){return Ze(e,function(n,r){n=t(n,r),e.point(n[0],n[1])})}function r(e){function n(n,r){n=t(n,r),e.point(n[0],n[1])}function r(){b=0/0,T.point=o,e.lineStart()}function o(n,r){var o=ce([n,r]),s=t(n,r);i(b,_,v,w,x,C,b=s[0],_=s[1],v=n,w=o[0],x=o[1],C=o[2],a,e),e.point(b,_)}function s(){T.point=n,e.lineEnd()}function u(){r(),T.point=l,T.lineEnd=c}function l(t,e){o(h=t,p=e),f=b,d=_,m=w,g=x,y=C,T.point=o}function c(){i(b,_,v,w,x,C,f,d,h,m,g,y,a,e),T.lineEnd=s,s()}var h,p,f,d,m,g,y,v,b,_,w,x,C,T={point:n,lineStart:r,lineEnd:s,polygonStart:function(){e.polygonStart(),T.lineStart=u},polygonEnd:function(){e.polygonEnd(),T.lineStart=r}};return T}function i(e,n,r,a,u,l,c,h,p,f,d,m,g,y){var v=c-e,b=h-n,_=v*v+b*b;if(_>4*o&&g--){var w=a+f,x=u+d,C=l+m,T=Math.sqrt(w*w+x*x+C*C),S=Math.asin(C/=T),E=os(os(C)-1)<Es||os(r-p)<Es?(r+p)/2:Math.atan2(x,w),N=t(E,S),k=N[0],M=N[1],P=k-e,O=M-n,A=b*P-v*O;(A*A/_>o||os((v*P+b*O)/_-.5)>.3||s>a*f+u*d+l*m)&&(i(e,n,r,a,u,l,k,M,E,w/=T,x/=T,C,g,y),y.point(k,M),i(k,M,E,w,x,C,c,h,p,f,d,m,g,y))}}var o=.5,s=Math.cos(30*ks),a=16;return e.precision=function(t){return arguments.length?(a=(o=t*t)>0&&16,e):Math.sqrt(o)},e}function Ye(t){var e=Qe(function(e,n){return t([e*Ms,n*Ms])});return function(t){return nn(e(t))}}function Ke(t){this.stream=t}function Ze(t,e){return{point:e,sphere:function(){t.sphere()},lineStart:function(){t.lineStart()},lineEnd:function(){t.lineEnd()},polygonStart:function(){t.polygonStart()},polygonEnd:function(){t.polygonEnd()}}}function tn(t){return en(function(){return t})()}function en(t){function e(t){return t=a(t[0]*ks,t[1]*ks),[t[0]*p+u,l-t[1]*p]}function n(t){return t=a.invert((t[0]-u)/p,(l-t[1])/p),t&&[t[0]*Ms,t[1]*Ms]}function r(){a=je(s=sn(y,v,b),o);var t=o(m,g);return u=f-t[0]*p,l=d+t[1]*p,i()}function i(){return c&&(c.valid=!1,c=null),e}var o,s,a,u,l,c,h=Qe(function(t,e){return t=o(t,e),[t[0]*p+u,l-t[1]*p]}),p=150,f=480,d=250,m=0,g=0,y=0,v=0,b=0,_=Sa,w=Ct,x=null,C=null;return e.stream=function(t){return c&&(c.valid=!1),c=nn(_(s,h(w(t)))),c.valid=!0,c},e.clipAngle=function(t){return arguments.length?(_=null==t?(x=t,Sa):De((x=+t)*ks),i()):x},e.clipExtent=function(t){return arguments.length?(C=t,w=t?qe(t[0][0],t[0][1],t[1][0],t[1][1]):Ct,i()):C},e.scale=function(t){return arguments.length?(p=+t,r()):p},e.translate=function(t){return arguments.length?(f=+t[0],d=+t[1],r()):[f,d]},e.center=function(t){return arguments.length?(m=t[0]%360*ks,g=t[1]%360*ks,r()):[m*Ms,g*Ms]},e.rotate=function(t){return arguments.length?(y=t[0]%360*ks,v=t[1]%360*ks,b=t.length>2?t[2]%360*ks:0,r()):[y*Ms,v*Ms,b*Ms]},Vo.rebind(e,h,"precision"),function(){return o=t.apply(this,arguments),e.invert=o.invert&&n,r()}}function nn(t){return Ze(t,function(e,n){t.point(e*ks,n*ks)})}function rn(t,e){return[t,e]}function on(t,e){return[t>Cs?t-Ts:-Cs>t?t+Ts:t,e]}function sn(t,e,n){return t?e||n?je(un(t),ln(e,n)):un(t):e||n?ln(e,n):on}function an(t){return function(e,n){return e+=t,[e>Cs?e-Ts:-Cs>e?e+Ts:e,n]}}function un(t){var e=an(t);return e.invert=an(-t),e}function ln(t,e){function n(t,e){var n=Math.cos(e),a=Math.cos(t)*n,u=Math.sin(t)*n,l=Math.sin(e),c=l*r+a*i;return[Math.atan2(u*o-c*s,a*r-l*i),Y(c*o+u*s)]}var r=Math.cos(t),i=Math.sin(t),o=Math.cos(e),s=Math.sin(e);return n.invert=function(t,e){var n=Math.cos(e),a=Math.cos(t)*n,u=Math.sin(t)*n,l=Math.sin(e),c=l*o-u*s;return[Math.atan2(u*o+l*s,a*r+c*i),Y(c*r-a*i)]},n}function cn(t,e){var n=Math.cos(t),r=Math.sin(t);return function(i,o,s,a){var u=s*e;null!=i?(i=hn(n,i),o=hn(n,o),(s>0?o>i:i>o)&&(i+=s*Ts)):(i=t+s*Ts,o=t-.5*u);for(var l,c=i;s>0?c>o:o>c;c-=u)a.point((l=ge([n,-r*Math.cos(c),-r*Math.sin(c)]))[0],l[1])}}function hn(t,e){var n=ce(e);n[0]-=t,me(n);var r=Q(-n[1]);return((-n[2]<0?-r:r)+2*Math.PI-Es)%(2*Math.PI)}function pn(t,e,n){var r=Vo.range(t,e-Es,n).concat(e);return function(t){return r.map(function(e){return[t,e]})}}function fn(t,e,n){var r=Vo.range(t,e-Es,n).concat(e);return function(t){return r.map(function(e){return[e,t]})}}function dn(t){return t.source}function mn(t){return t.target}function gn(t,e,n,r){var i=Math.cos(e),o=Math.sin(e),s=Math.cos(r),a=Math.sin(r),u=i*Math.cos(t),l=i*Math.sin(t),c=s*Math.cos(n),h=s*Math.sin(n),p=2*Math.asin(Math.sqrt(et(r-e)+i*s*et(n-t))),f=1/Math.sin(p),d=p?function(t){var e=Math.sin(t*=p)*f,n=Math.sin(p-t)*f,r=n*u+e*c,i=n*l+e*h,s=n*o+e*a;return[Math.atan2(i,r)*Ms,Math.atan2(s,Math.sqrt(r*r+i*i))*Ms]}:function(){return[t*Ms,e*Ms]};return d.distance=p,d}function yn(){function t(t,i){var o=Math.sin(i*=ks),s=Math.cos(i),a=os((t*=ks)-e),u=Math.cos(a);La+=Math.atan2(Math.sqrt((a=s*Math.sin(a))*a+(a=r*o-n*s*u)*a),n*o+r*s*u),e=t,n=o,r=s}var e,n,r;qa.point=function(i,o){e=i*ks,n=Math.sin(o*=ks),r=Math.cos(o),qa.point=t},qa.lineEnd=function(){qa.point=qa.lineEnd=m}}function vn(t,e){function n(e,n){var r=Math.cos(e),i=Math.cos(n),o=t(r*i);return[o*i*Math.sin(e),o*Math.sin(n)]}return n.invert=function(t,n){var r=Math.sqrt(t*t+n*n),i=e(r),o=Math.sin(i),s=Math.cos(i);return[Math.atan2(t*o,r*s),Math.asin(r&&n*o/r)]},n}function bn(t,e){function n(t,e){s>0?-Ss+Es>e&&(e=-Ss+Es):e>Ss-Es&&(e=Ss-Es);var n=s/Math.pow(i(e),o);return[n*Math.sin(o*t),s-n*Math.cos(o*t)]}var r=Math.cos(t),i=function(t){return Math.tan(Cs/4+t/2)},o=t===e?Math.sin(t):Math.log(r/Math.cos(e))/Math.log(i(e)/i(t)),s=r*Math.pow(i(t),o)/o;return o?(n.invert=function(t,e){var n=s-e,r=G(o)*Math.sqrt(t*t+n*n);return[Math.atan2(t,n)/o,2*Math.atan(Math.pow(s/r,1/o))-Ss]},n):wn}function _n(t,e){function n(t,e){var n=o-e;return[n*Math.sin(i*t),o-n*Math.cos(i*t)]}var r=Math.cos(t),i=t===e?Math.sin(t):(r-Math.cos(e))/(e-t),o=r/i+t;return os(i)<Es?rn:(n.invert=function(t,e){var n=o-e;return[Math.atan2(t,n)/i,o-G(i)*Math.sqrt(t*t+n*n)]},n)}function wn(t,e){return[t,Math.log(Math.tan(Cs/4+e/2))]}function xn(t){var e,n=tn(t),r=n.scale,i=n.translate,o=n.clipExtent;return n.scale=function(){var t=r.apply(n,arguments);return t===n?e?n.clipExtent(null):n:t},n.translate=function(){var t=i.apply(n,arguments);return t===n?e?n.clipExtent(null):n:t},n.clipExtent=function(t){var s=o.apply(n,arguments);if(s===n){if(e=null==t){var a=Cs*r(),u=i();o([[u[0]-a,u[1]-a],[u[0]+a,u[1]+a]])}}else e&&(s=null);return s},n.clipExtent(null)}function Cn(t,e){return[Math.log(Math.tan(Cs/4+e/2)),-t]}function Tn(t){return t[0]}function Sn(t){return t[1]}function En(t){for(var e=t.length,n=[0,1],r=2,i=2;e>i;i++){for(;r>1&&X(t[n[r-2]],t[n[r-1]],t[i])<=0;)--r;n[r++]=i}return n.slice(0,r)}function Nn(t,e){return t[0]-e[0]||t[1]-e[1]}function kn(t,e,n){return(n[0]-e[0])*(t[1]-e[1])<(n[1]-e[1])*(t[0]-e[0])}function Mn(t,e,n,r){var i=t[0],o=n[0],s=e[0]-i,a=r[0]-o,u=t[1],l=n[1],c=e[1]-u,h=r[1]-l,p=(a*(u-l)-h*(i-o))/(h*s-a*c);return[i+p*s,u+p*c]}function Pn(t){var e=t[0],n=t[t.length-1];return!(e[0]-n[0]||e[1]-n[1])}function On(){Kn(this),this.edge=this.site=this.circle=null}function An(t){var e=Xa.pop()||new On;return e.site=t,e}function Rn(t){Hn(t),Wa.remove(t),Xa.push(t),Kn(t)}function In(t){var e=t.circle,n=e.x,r=e.cy,i={x:n,y:r},o=t.P,s=t.N,a=[t];Rn(t);for(var u=o;u.circle&&os(n-u.circle.x)<Es&&os(r-u.circle.cy)<Es;)o=u.P,a.unshift(u),Rn(u),u=o;a.unshift(u),Hn(u);for(var l=s;l.circle&&os(n-l.circle.x)<Es&&os(r-l.circle.cy)<Es;)s=l.N,a.push(l),Rn(l),l=s;a.push(l),Hn(l);var c,h=a.length;for(c=1;h>c;++c)l=a[c],u=a[c-1],Xn(l.edge,u.site,l.site,i);

u=a[0],l=a[h-1],l.edge=Jn(u.site,l.site,null,i),Un(u),Un(l)}function Dn(t){for(var e,n,r,i,o=t.x,s=t.y,a=Wa._;a;)if(r=Ln(a,s)-o,r>Es)a=a.L;else{if(i=o-qn(a,s),!(i>Es)){r>-Es?(e=a.P,n=a):i>-Es?(e=a,n=a.N):e=n=a;break}if(!a.R){e=a;break}a=a.R}var u=An(t);if(Wa.insert(e,u),e||n){if(e===n)return Hn(e),n=An(e.site),Wa.insert(u,n),u.edge=n.edge=Jn(e.site,u.site),Un(e),void Un(n);if(!n)return void(u.edge=Jn(e.site,u.site));Hn(e),Hn(n);var l=e.site,c=l.x,h=l.y,p=t.x-c,f=t.y-h,d=n.site,m=d.x-c,g=d.y-h,y=2*(p*g-f*m),v=p*p+f*f,b=m*m+g*g,_={x:(g*v-f*b)/y+c,y:(p*b-m*v)/y+h};Xn(n.edge,l,d,_),u.edge=Jn(l,t,null,_),n.edge=Jn(t,d,null,_),Un(e),Un(n)}}function Ln(t,e){var n=t.site,r=n.x,i=n.y,o=i-e;if(!o)return r;var s=t.P;if(!s)return-(1/0);n=s.site;var a=n.x,u=n.y,l=u-e;if(!l)return a;var c=a-r,h=1/o-1/l,p=c/l;return h?(-p+Math.sqrt(p*p-2*h*(c*c/(-2*l)-u+l/2+i-o/2)))/h+r:(r+a)/2}function qn(t,e){var n=t.N;if(n)return Ln(n,e);var r=t.site;return r.y===e?r.x:1/0}function jn(t){this.site=t,this.edges=[]}function $n(t){for(var e,n,r,i,o,s,a,u,l,c,h=t[0][0],p=t[1][0],f=t[0][1],d=t[1][1],m=Va,g=m.length;g--;)if(o=m[g],o&&o.prepare())for(a=o.edges,u=a.length,s=0;u>s;)c=a[s].end(),r=c.x,i=c.y,l=a[++s%u].start(),e=l.x,n=l.y,(os(r-e)>Es||os(i-n)>Es)&&(a.splice(s,0,new Qn(Gn(o.site,c,os(r-h)<Es&&d-i>Es?{x:h,y:os(e-h)<Es?n:d}:os(i-d)<Es&&p-r>Es?{x:os(n-d)<Es?e:p,y:d}:os(r-p)<Es&&i-f>Es?{x:p,y:os(e-p)<Es?n:f}:os(i-f)<Es&&r-h>Es?{x:os(n-f)<Es?e:h,y:f}:null),o.site,null)),++u)}function Fn(t,e){return e.angle-t.angle}function zn(){Kn(this),this.x=this.y=this.arc=this.site=this.cy=null}function Un(t){var e=t.P,n=t.N;if(e&&n){var r=e.site,i=t.site,o=n.site;if(r!==o){var s=i.x,a=i.y,u=r.x-s,l=r.y-a,c=o.x-s,h=o.y-a,p=2*(u*h-l*c);if(!(p>=-Ns)){var f=u*u+l*l,d=c*c+h*h,m=(h*f-l*d)/p,g=(u*d-c*f)/p,h=g+a,y=Qa.pop()||new zn;y.arc=t,y.site=i,y.x=m+s,y.y=h+Math.sqrt(m*m+g*g),y.cy=h,t.circle=y;for(var v=null,b=Ga._;b;)if(y.y<b.y||y.y===b.y&&y.x<=b.x){if(!b.L){v=b.P;break}b=b.L}else{if(!b.R){v=b;break}b=b.R}Ga.insert(v,y),v||(Ja=y)}}}}function Hn(t){var e=t.circle;e&&(e.P||(Ja=e.N),Ga.remove(e),Qa.push(e),Kn(e),t.circle=null)}function Bn(t){for(var e,n=Ba,r=Le(t[0][0],t[0][1],t[1][0],t[1][1]),i=n.length;i--;)e=n[i],(!Vn(e,t)||!r(e)||os(e.a.x-e.b.x)<Es&&os(e.a.y-e.b.y)<Es)&&(e.a=e.b=null,n.splice(i,1))}function Vn(t,e){var n=t.b;if(n)return!0;var r,i,o=t.a,s=e[0][0],a=e[1][0],u=e[0][1],l=e[1][1],c=t.l,h=t.r,p=c.x,f=c.y,d=h.x,m=h.y,g=(p+d)/2,y=(f+m)/2;if(m===f){if(s>g||g>=a)return;if(p>d){if(o){if(o.y>=l)return}else o={x:g,y:u};n={x:g,y:l}}else{if(o){if(o.y<u)return}else o={x:g,y:l};n={x:g,y:u}}}else if(r=(p-d)/(m-f),i=y-r*g,-1>r||r>1)if(p>d){if(o){if(o.y>=l)return}else o={x:(u-i)/r,y:u};n={x:(l-i)/r,y:l}}else{if(o){if(o.y<u)return}else o={x:(l-i)/r,y:l};n={x:(u-i)/r,y:u}}else if(m>f){if(o){if(o.x>=a)return}else o={x:s,y:r*s+i};n={x:a,y:r*a+i}}else{if(o){if(o.x<s)return}else o={x:a,y:r*a+i};n={x:s,y:r*s+i}}return t.a=o,t.b=n,!0}function Wn(t,e){this.l=t,this.r=e,this.a=this.b=null}function Jn(t,e,n,r){var i=new Wn(t,e);return Ba.push(i),n&&Xn(i,t,e,n),r&&Xn(i,e,t,r),Va[t.i].edges.push(new Qn(i,t,e)),Va[e.i].edges.push(new Qn(i,e,t)),i}function Gn(t,e,n){var r=new Wn(t,null);return r.a=e,r.b=n,Ba.push(r),r}function Xn(t,e,n,r){t.a||t.b?t.l===n?t.b=r:t.a=r:(t.a=r,t.l=e,t.r=n)}function Qn(t,e,n){var r=t.a,i=t.b;this.edge=t,this.site=e,this.angle=n?Math.atan2(n.y-e.y,n.x-e.x):t.l===e?Math.atan2(i.x-r.x,r.y-i.y):Math.atan2(r.x-i.x,i.y-r.y)}function Yn(){this._=null}function Kn(t){t.U=t.C=t.L=t.R=t.P=t.N=null}function Zn(t,e){var n=e,r=e.R,i=n.U;i?i.L===n?i.L=r:i.R=r:t._=r,r.U=i,n.U=r,n.R=r.L,n.R&&(n.R.U=n),r.L=n}function tr(t,e){var n=e,r=e.L,i=n.U;i?i.L===n?i.L=r:i.R=r:t._=r,r.U=i,n.U=r,n.L=r.R,n.L&&(n.L.U=n),r.R=n}function er(t){for(;t.L;)t=t.L;return t}function nr(t,e){var n,r,i,o=t.sort(rr).pop();for(Ba=[],Va=new Array(t.length),Wa=new Yn,Ga=new Yn;;)if(i=Ja,o&&(!i||o.y<i.y||o.y===i.y&&o.x<i.x))(o.x!==n||o.y!==r)&&(Va[o.i]=new jn(o),Dn(o),n=o.x,r=o.y),o=t.pop();else{if(!i)break;In(i.arc)}e&&(Bn(e),$n(e));var s={cells:Va,edges:Ba};return Wa=Ga=Ba=Va=null,s}function rr(t,e){return e.y-t.y||e.x-t.x}function ir(t,e,n){return(t.x-n.x)*(e.y-t.y)-(t.x-e.x)*(n.y-t.y)}function or(t){return t.x}function sr(t){return t.y}function ar(){return{leaf:!0,nodes:[],point:null,x:null,y:null}}function ur(t,e,n,r,i,o){if(!t(e,n,r,i,o)){var s=.5*(n+i),a=.5*(r+o),u=e.nodes;u[0]&&ur(t,u[0],n,r,s,a),u[1]&&ur(t,u[1],s,r,i,a),u[2]&&ur(t,u[2],n,a,s,o),u[3]&&ur(t,u[3],s,a,i,o)}}function lr(t,e){t=Vo.rgb(t),e=Vo.rgb(e);var n=t.r,r=t.g,i=t.b,o=e.r-n,s=e.g-r,a=e.b-i;return function(t){return"#"+gt(Math.round(n+o*t))+gt(Math.round(r+s*t))+gt(Math.round(i+a*t))}}function cr(t,e){var n,r={},i={};for(n in t)n in e?r[n]=fr(t[n],e[n]):i[n]=t[n];for(n in e)n in t||(i[n]=e[n]);return function(t){for(n in r)i[n]=r[n](t);return i}}function hr(t,e){return e-=t=+t,function(n){return t+e*n}}function pr(t,e){var n,r,i,o=Ka.lastIndex=Za.lastIndex=0,s=-1,a=[],u=[];for(t+="",e+="";(n=Ka.exec(t))&&(r=Za.exec(e));)(i=r.index)>o&&(i=e.substring(o,i),a[s]?a[s]+=i:a[++s]=i),(n=n[0])===(r=r[0])?a[s]?a[s]+=r:a[++s]=r:(a[++s]=null,u.push({i:s,x:hr(n,r)})),o=Za.lastIndex;return o<e.length&&(i=e.substring(o),a[s]?a[s]+=i:a[++s]=i),a.length<2?u[0]?(e=u[0].x,function(t){return e(t)+""}):function(){return e}:(e=u.length,function(t){for(var n,r=0;e>r;++r)a[(n=u[r]).i]=n.x(t);return a.join("")})}function fr(t,e){for(var n,r=Vo.interpolators.length;--r>=0&&!(n=Vo.interpolators[r](t,e)););return n}function dr(t,e){var n,r=[],i=[],o=t.length,s=e.length,a=Math.min(t.length,e.length);for(n=0;a>n;++n)r.push(fr(t[n],e[n]));for(;o>n;++n)i[n]=t[n];for(;s>n;++n)i[n]=e[n];return function(t){for(n=0;a>n;++n)i[n]=r[n](t);return i}}function mr(t){return function(e){return 0>=e?0:e>=1?1:t(e)}}function gr(t){return function(e){return 1-t(1-e)}}function yr(t){return function(e){return.5*(.5>e?t(2*e):2-t(2-2*e))}}function vr(t){return t*t}function br(t){return t*t*t}function _r(t){if(0>=t)return 0;if(t>=1)return 1;var e=t*t,n=e*t;return 4*(.5>t?n:3*(t-e)+n-.75)}function wr(t){return function(e){return Math.pow(e,t)}}function xr(t){return 1-Math.cos(t*Ss)}function Cr(t){return Math.pow(2,10*(t-1))}function Tr(t){return 1-Math.sqrt(1-t*t)}function Sr(t,e){var n;return arguments.length<2&&(e=.45),arguments.length?n=e/Ts*Math.asin(1/t):(t=1,n=e/4),function(r){return 1+t*Math.pow(2,-10*r)*Math.sin((r-n)*Ts/e)}}function Er(t){return t||(t=1.70158),function(e){return e*e*((t+1)*e-t)}}function Nr(t){return 1/2.75>t?7.5625*t*t:2/2.75>t?7.5625*(t-=1.5/2.75)*t+.75:2.5/2.75>t?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375}function kr(t,e){t=Vo.hcl(t),e=Vo.hcl(e);var n=t.h,r=t.c,i=t.l,o=e.h-n,s=e.c-r,a=e.l-i;return isNaN(s)&&(s=0,r=isNaN(r)?e.c:r),isNaN(o)?(o=0,n=isNaN(n)?e.h:n):o>180?o-=360:-180>o&&(o+=360),function(t){return st(n+o*t,r+s*t,i+a*t)+""}}function Mr(t,e){t=Vo.hsl(t),e=Vo.hsl(e);var n=t.h,r=t.s,i=t.l,o=e.h-n,s=e.s-r,a=e.l-i;return isNaN(s)&&(s=0,r=isNaN(r)?e.s:r),isNaN(o)?(o=0,n=isNaN(n)?e.h:n):o>180?o-=360:-180>o&&(o+=360),function(t){return it(n+o*t,r+s*t,i+a*t)+""}}function Pr(t,e){t=Vo.lab(t),e=Vo.lab(e);var n=t.l,r=t.a,i=t.b,o=e.l-n,s=e.a-r,a=e.b-i;return function(t){return ut(n+o*t,r+s*t,i+a*t)+""}}function Or(t,e){return e-=t,function(n){return Math.round(t+e*n)}}function Ar(t){var e=[t.a,t.b],n=[t.c,t.d],r=Ir(e),i=Rr(e,n),o=Ir(Dr(n,e,-i))||0;e[0]*n[1]<n[0]*e[1]&&(e[0]*=-1,e[1]*=-1,r*=-1,i*=-1),this.rotate=(r?Math.atan2(e[1],e[0]):Math.atan2(-n[0],n[1]))*Ms,this.translate=[t.e,t.f],this.scale=[r,o],this.skew=o?Math.atan2(i,o)*Ms:0}function Rr(t,e){return t[0]*e[0]+t[1]*e[1]}function Ir(t){var e=Math.sqrt(Rr(t,t));return e&&(t[0]/=e,t[1]/=e),e}function Dr(t,e,n){return t[0]+=n*e[0],t[1]+=n*e[1],t}function Lr(t,e){var n,r=[],i=[],o=Vo.transform(t),s=Vo.transform(e),a=o.translate,u=s.translate,l=o.rotate,c=s.rotate,h=o.skew,p=s.skew,f=o.scale,d=s.scale;return a[0]!=u[0]||a[1]!=u[1]?(r.push("translate(",null,",",null,")"),i.push({i:1,x:hr(a[0],u[0])},{i:3,x:hr(a[1],u[1])})):r.push(u[0]||u[1]?"translate("+u+")":""),l!=c?(l-c>180?c+=360:c-l>180&&(l+=360),i.push({i:r.push(r.pop()+"rotate(",null,")")-2,x:hr(l,c)})):c&&r.push(r.pop()+"rotate("+c+")"),h!=p?i.push({i:r.push(r.pop()+"skewX(",null,")")-2,x:hr(h,p)}):p&&r.push(r.pop()+"skewX("+p+")"),f[0]!=d[0]||f[1]!=d[1]?(n=r.push(r.pop()+"scale(",null,",",null,")"),i.push({i:n-4,x:hr(f[0],d[0])},{i:n-2,x:hr(f[1],d[1])})):(1!=d[0]||1!=d[1])&&r.push(r.pop()+"scale("+d+")"),n=i.length,function(t){for(var e,o=-1;++o<n;)r[(e=i[o]).i]=e.x(t);return r.join("")}}function qr(t,e){return e=e-(t=+t)?1/(e-t):0,function(n){return(n-t)*e}}function jr(t,e){return e=e-(t=+t)?1/(e-t):0,function(n){return Math.max(0,Math.min(1,(n-t)*e))}}function $r(t){for(var e=t.source,n=t.target,r=zr(e,n),i=[e];e!==r;)e=e.parent,i.push(e);for(var o=i.length;n!==r;)i.splice(o,0,n),n=n.parent;return i}function Fr(t){for(var e=[],n=t.parent;null!=n;)e.push(t),t=n,n=n.parent;return e.push(t),e}function zr(t,e){if(t===e)return t;for(var n=Fr(t),r=Fr(e),i=n.pop(),o=r.pop(),s=null;i===o;)s=i,i=n.pop(),o=r.pop();return s}function Ur(t){t.fixed|=2}function Hr(t){t.fixed&=-7}function Br(t){t.fixed|=4,t.px=t.x,t.py=t.y}function Vr(t){t.fixed&=-5}function Wr(t,e,n){var r=0,i=0;if(t.charge=0,!t.leaf)for(var o,s=t.nodes,a=s.length,u=-1;++u<a;)o=s[u],null!=o&&(Wr(o,e,n),t.charge+=o.charge,r+=o.charge*o.cx,i+=o.charge*o.cy);if(t.point){t.leaf||(t.point.x+=Math.random()-.5,t.point.y+=Math.random()-.5);var l=e*n[t.point.index];t.charge+=t.pointCharge=l,r+=l*t.point.x,i+=l*t.point.y}t.cx=r/t.charge,t.cy=i/t.charge}function Jr(t,e){return Vo.rebind(t,e,"sort","children","value"),t.nodes=t,t.links=Zr,t}function Gr(t,e){for(var n=[t];null!=(t=n.pop());)if(e(t),(i=t.children)&&(r=i.length))for(var r,i;--r>=0;)n.push(i[r])}function Xr(t,e){for(var n=[t],r=[];null!=(t=n.pop());)if(r.push(t),(o=t.children)&&(i=o.length))for(var i,o,s=-1;++s<i;)n.push(o[s]);for(;null!=(t=r.pop());)e(t)}function Qr(t){return t.children}function Yr(t){return t.value}function Kr(t,e){return e.value-t.value}function Zr(t){return Vo.merge(t.map(function(t){return(t.children||[]).map(function(e){return{source:t,target:e}})}))}function ti(t){return t.x}function ei(t){return t.y}function ni(t,e,n){t.y0=e,t.y=n}function ri(t){return Vo.range(t.length)}function ii(t){for(var e=-1,n=t[0].length,r=[];++e<n;)r[e]=0;return r}function oi(t){for(var e,n=1,r=0,i=t[0][1],o=t.length;o>n;++n)(e=t[n][1])>i&&(r=n,i=e);return r}function si(t){return t.reduce(ai,0)}function ai(t,e){return t+e[1]}function ui(t,e){return li(t,Math.ceil(Math.log(e.length)/Math.LN2+1))}function li(t,e){for(var n=-1,r=+t[0],i=(t[1]-r)/e,o=[];++n<=e;)o[n]=i*n+r;return o}function ci(t){return[Vo.min(t),Vo.max(t)]}function hi(t,e){return t.value-e.value}function pi(t,e){var n=t._pack_next;t._pack_next=e,e._pack_prev=t,e._pack_next=n,n._pack_prev=e}function fi(t,e){t._pack_next=e,e._pack_prev=t}function di(t,e){var n=e.x-t.x,r=e.y-t.y,i=t.r+e.r;return.999*i*i>n*n+r*r}function mi(t){function e(t){c=Math.min(t.x-t.r,c),h=Math.max(t.x+t.r,h),p=Math.min(t.y-t.r,p),f=Math.max(t.y+t.r,f)}if((n=t.children)&&(l=n.length)){var n,r,i,o,s,a,u,l,c=1/0,h=-(1/0),p=1/0,f=-(1/0);if(n.forEach(gi),r=n[0],r.x=-r.r,r.y=0,e(r),l>1&&(i=n[1],i.x=i.r,i.y=0,e(i),l>2))for(o=n[2],bi(r,i,o),e(o),pi(r,o),r._pack_prev=o,pi(o,i),i=r._pack_next,s=3;l>s;s++){bi(r,i,o=n[s]);var d=0,m=1,g=1;for(a=i._pack_next;a!==i;a=a._pack_next,m++)if(di(a,o)){d=1;break}if(1==d)for(u=r._pack_prev;u!==a._pack_prev&&!di(u,o);u=u._pack_prev,g++);d?(g>m||m==g&&i.r<r.r?fi(r,i=a):fi(r=u,i),s--):(pi(r,o),i=o,e(o))}var y=(c+h)/2,v=(p+f)/2,b=0;for(s=0;l>s;s++)o=n[s],o.x-=y,o.y-=v,b=Math.max(b,o.r+Math.sqrt(o.x*o.x+o.y*o.y));t.r=b,n.forEach(yi)}}function gi(t){t._pack_next=t._pack_prev=t}function yi(t){delete t._pack_next,delete t._pack_prev}function vi(t,e,n,r){var i=t.children;if(t.x=e+=r*t.x,t.y=n+=r*t.y,t.r*=r,i)for(var o=-1,s=i.length;++o<s;)vi(i[o],e,n,r)}function bi(t,e,n){var r=t.r+n.r,i=e.x-t.x,o=e.y-t.y;if(r&&(i||o)){var s=e.r+n.r,a=i*i+o*o;s*=s,r*=r;var u=.5+(r-s)/(2*a),l=Math.sqrt(Math.max(0,2*s*(r+a)-(r-=a)*r-s*s))/(2*a);n.x=t.x+u*i+l*o,n.y=t.y+u*o-l*i}else n.x=t.x+r,n.y=t.y}function _i(t,e){return t.parent==e.parent?1:2}function wi(t){var e=t.children;return e.length?e[0]:t.t}function xi(t){var e,n=t.children;return(e=n.length)?n[e-1]:t.t}function Ci(t,e,n){var r=n/(e.i-t.i);e.c-=r,e.s+=n,t.c+=r,e.z+=n,e.m+=n}function Ti(t){for(var e,n=0,r=0,i=t.children,o=i.length;--o>=0;)e=i[o],e.z+=n,e.m+=n,n+=e.s+(r+=e.c)}function Si(t,e,n){return t.a.parent===e.parent?t.a:n}function Ei(t){return 1+Vo.max(t,function(t){return t.y})}function Ni(t){return t.reduce(function(t,e){return t+e.x},0)/t.length}function ki(t){var e=t.children;return e&&e.length?ki(e[0]):t}function Mi(t){var e,n=t.children;return n&&(e=n.length)?Mi(n[e-1]):t}function Pi(t){return{x:t.x,y:t.y,dx:t.dx,dy:t.dy}}function Oi(t,e){var n=t.x+e[3],r=t.y+e[0],i=t.dx-e[1]-e[3],o=t.dy-e[0]-e[2];return 0>i&&(n+=i/2,i=0),0>o&&(r+=o/2,o=0),{x:n,y:r,dx:i,dy:o}}function Ai(t){var e=t[0],n=t[t.length-1];return n>e?[e,n]:[n,e]}function Ri(t){return t.rangeExtent?t.rangeExtent():Ai(t.range())}function Ii(t,e,n,r){var i=n(t[0],t[1]),o=r(e[0],e[1]);return function(t){return o(i(t))}}function Di(t,e){var n,r=0,i=t.length-1,o=t[r],s=t[i];return o>s&&(n=r,r=i,i=n,n=o,o=s,s=n),t[r]=e.floor(o),t[i]=e.ceil(s),t}function Li(t){return t?{floor:function(e){return Math.floor(e/t)*t},ceil:function(e){return Math.ceil(e/t)*t}}:cu}function qi(t,e,n,r){var i=[],o=[],s=0,a=Math.min(t.length,e.length)-1;for(t[a]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());++s<=a;)i.push(n(t[s-1],t[s])),o.push(r(e[s-1],e[s]));return function(e){var n=Vo.bisect(t,e,1,a)-1;return o[n](i[n](e))}}function ji(t,e,n,r){function i(){var i=Math.min(t.length,e.length)>2?qi:Ii,u=r?jr:qr;return s=i(t,e,u,n),a=i(e,t,u,fr),o}function o(t){return s(t)}var s,a;return o.invert=function(t){return a(t)},o.domain=function(e){return arguments.length?(t=e.map(Number),i()):t},o.range=function(t){return arguments.length?(e=t,i()):e},o.rangeRound=function(t){return o.range(t).interpolate(Or)},o.clamp=function(t){return arguments.length?(r=t,i()):r},o.interpolate=function(t){return arguments.length?(n=t,i()):n},o.ticks=function(e){return Ui(t,e)},o.tickFormat=function(e,n){return Hi(t,e,n)},o.nice=function(e){return Fi(t,e),i()},o.copy=function(){return ji(t,e,n,r)},i()}function $i(t,e){return Vo.rebind(t,e,"range","rangeRound","interpolate","clamp")}function Fi(t,e){return Di(t,Li(zi(t,e)[2]))}function zi(t,e){null==e&&(e=10);var n=Ai(t),r=n[1]-n[0],i=Math.pow(10,Math.floor(Math.log(r/e)/Math.LN10)),o=e/r*i;return.15>=o?i*=10:.35>=o?i*=5:.75>=o&&(i*=2),n[0]=Math.ceil(n[0]/i)*i,n[1]=Math.floor(n[1]/i)*i+.5*i,n[2]=i,n}function Ui(t,e){return Vo.range.apply(Vo,zi(t,e))}function Hi(t,e,n){var r=zi(t,e);if(n){var i=Ks.exec(n);if(i.shift(),"s"===i[8]){var o=Vo.formatPrefix(Math.max(os(r[0]),os(r[1])));return i[7]||(i[7]="."+Bi(o.scale(r[2]))),i[8]="f",n=Vo.format(i.join("")),function(t){return n(o.scale(t))+o.symbol}}i[7]||(i[7]="."+Vi(i[8],r)),n=i.join("")}else n=",."+Bi(r[2])+"f";return Vo.format(n)}function Bi(t){return-Math.floor(Math.log(t)/Math.LN10+.01)}function Vi(t,e){var n=Bi(e[2]);return t in hu?Math.abs(n-Bi(Math.max(os(e[0]),os(e[1]))))+ +("e"!==t):n-2*("%"===t)}function Wi(t,e,n,r){function i(t){return(n?Math.log(0>t?0:t):-Math.log(t>0?0:-t))/Math.log(e)}function o(t){return n?Math.pow(e,t):-Math.pow(e,-t)}function s(e){return t(i(e))}return s.invert=function(e){return o(t.invert(e))},s.domain=function(e){return arguments.length?(n=e[0]>=0,t.domain((r=e.map(Number)).map(i)),s):r},s.base=function(n){return arguments.length?(e=+n,t.domain(r.map(i)),s):e},s.nice=function(){var e=Di(r.map(i),n?Math:fu);return t.domain(e),r=e.map(o),s},s.ticks=function(){var t=Ai(r),s=[],a=t[0],u=t[1],l=Math.floor(i(a)),c=Math.ceil(i(u)),h=e%1?2:e;if(isFinite(c-l)){if(n){for(;c>l;l++)for(var p=1;h>p;p++)s.push(o(l)*p);s.push(o(l))}else for(s.push(o(l));l++<c;)for(var p=h-1;p>0;p--)s.push(o(l)*p);for(l=0;s[l]<a;l++);for(c=s.length;s[c-1]>u;c--);s=s.slice(l,c)}return s},s.tickFormat=function(t,e){if(!arguments.length)return pu;arguments.length<2?e=pu:"function"!=typeof e&&(e=Vo.format(e));var r,a=Math.max(.1,t/s.ticks().length),u=n?(r=1e-12,Math.ceil):(r=-1e-12,Math.floor);return function(t){return t/o(u(i(t)+r))<=a?e(t):""}},s.copy=function(){return Wi(t.copy(),e,n,r)},$i(s,t)}function Ji(t,e,n){function r(e){return t(i(e))}var i=Gi(e),o=Gi(1/e);return r.invert=function(e){return o(t.invert(e))},r.domain=function(e){return arguments.length?(t.domain((n=e.map(Number)).map(i)),r):n},r.ticks=function(t){return Ui(n,t)},r.tickFormat=function(t,e){return Hi(n,t,e)},r.nice=function(t){return r.domain(Fi(n,t))},r.exponent=function(s){return arguments.length?(i=Gi(e=s),o=Gi(1/e),t.domain(n.map(i)),r):e},r.copy=function(){return Ji(t.copy(),e,n)},$i(r,t)}function Gi(t){return function(e){return 0>e?-Math.pow(-e,t):Math.pow(e,t)}}function Xi(t,e){function n(n){return o[((i.get(n)||("range"===e.t?i.set(n,t.push(n)):0/0))-1)%o.length]}function r(e,n){return Vo.range(t.length).map(function(t){return e+n*t})}var i,o,a;return n.domain=function(r){if(!arguments.length)return t;t=[],i=new s;for(var o,a=-1,u=r.length;++a<u;)i.has(o=r[a])||i.set(o,t.push(o));return n[e.t].apply(n,e.a)},n.range=function(t){return arguments.length?(o=t,a=0,e={t:"range",a:arguments},n):o},n.rangePoints=function(i,s){arguments.length<2&&(s=0);var u=i[0],l=i[1],c=(l-u)/(Math.max(1,t.length-1)+s);return o=r(t.length<2?(u+l)/2:u+c*s/2,c),a=0,e={t:"rangePoints",a:arguments},n},n.rangeBands=function(i,s,u){arguments.length<2&&(s=0),arguments.length<3&&(u=s);var l=i[1]<i[0],c=i[l-0],h=i[1-l],p=(h-c)/(t.length-s+2*u);return o=r(c+p*u,p),l&&o.reverse(),a=p*(1-s),e={t:"rangeBands",a:arguments},n},n.rangeRoundBands=function(i,s,u){arguments.length<2&&(s=0),arguments.length<3&&(u=s);var l=i[1]<i[0],c=i[l-0],h=i[1-l],p=Math.floor((h-c)/(t.length-s+2*u)),f=h-c-(t.length-s)*p;return o=r(c+Math.round(f/2),p),l&&o.reverse(),a=Math.round(p*(1-s)),e={t:"rangeRoundBands",a:arguments},n},n.rangeBand=function(){return a},n.rangeExtent=function(){return Ai(e.a[0])},n.copy=function(){return Xi(t,e)},n.domain(t)}function Qi(n,r){function i(){var t=0,e=r.length;for(s=[];++t<e;)s[t-1]=Vo.quantile(n,t/e);return o}function o(t){return isNaN(t=+t)?void 0:r[Vo.bisect(s,t)]}var s;return o.domain=function(r){return arguments.length?(n=r.filter(e).sort(t),i()):n},o.range=function(t){return arguments.length?(r=t,i()):r},o.quantiles=function(){return s},o.invertExtent=function(t){return t=r.indexOf(t),0>t?[0/0,0/0]:[t>0?s[t-1]:n[0],t<s.length?s[t]:n[n.length-1]]},o.copy=function(){return Qi(n,r)},i()}function Yi(t,e,n){function r(e){return n[Math.max(0,Math.min(s,Math.floor(o*(e-t))))]}function i(){return o=n.length/(e-t),s=n.length-1,r}var o,s;return r.domain=function(n){return arguments.length?(t=+n[0],e=+n[n.length-1],i()):[t,e]},r.range=function(t){return arguments.length?(n=t,i()):n},r.invertExtent=function(e){return e=n.indexOf(e),e=0>e?0/0:e/o+t,[e,e+1/o]},r.copy=function(){return Yi(t,e,n)},i()}function Ki(t,e){function n(n){return n>=n?e[Vo.bisect(t,n)]:void 0}return n.domain=function(e){return arguments.length?(t=e,n):t},n.range=function(t){return arguments.length?(e=t,n):e},n.invertExtent=function(n){return n=e.indexOf(n),[t[n-1],t[n]]},n.copy=function(){return Ki(t,e)},n}function Zi(t){function e(t){return+t}return e.invert=e,e.domain=e.range=function(n){return arguments.length?(t=n.map(e),e):t},e.ticks=function(e){return Ui(t,e)},e.tickFormat=function(e,n){return Hi(t,e,n)},e.copy=function(){return Zi(t)},e}function to(t){return t.innerRadius}function eo(t){return t.outerRadius}function no(t){return t.startAngle}function ro(t){return t.endAngle}function io(t){function e(e){function s(){l.push("M",o(t(c),a))}for(var u,l=[],c=[],h=-1,p=e.length,f=xt(n),d=xt(r);++h<p;)i.call(this,u=e[h],h)?c.push([+f.call(this,u,h),+d.call(this,u,h)]):c.length&&(s(),c=[]);return c.length&&s(),l.length?l.join(""):null}var n=Tn,r=Sn,i=Ce,o=oo,s=o.key,a=.7;return e.x=function(t){return arguments.length?(n=t,e):n},e.y=function(t){return arguments.length?(r=t,e):r},e.defined=function(t){return arguments.length?(i=t,e):i},e.interpolate=function(t){return arguments.length?(s="function"==typeof t?o=t:(o=_u.get(t)||oo).key,e):s},e.tension=function(t){return arguments.length?(a=t,e):a},e}function oo(t){return t.join("L")}function so(t){return oo(t)+"Z"}function ao(t){for(var e=0,n=t.length,r=t[0],i=[r[0],",",r[1]];++e<n;)i.push("H",(r[0]+(r=t[e])[0])/2,"V",r[1]);return n>1&&i.push("H",r[0]),i.join("")}function uo(t){for(var e=0,n=t.length,r=t[0],i=[r[0],",",r[1]];++e<n;)i.push("V",(r=t[e])[1],"H",r[0]);return i.join("")}function lo(t){for(var e=0,n=t.length,r=t[0],i=[r[0],",",r[1]];++e<n;)i.push("H",(r=t[e])[0],"V",r[1]);return i.join("")}function co(t,e){return t.length<4?oo(t):t[1]+fo(t.slice(1,t.length-1),mo(t,e))}function ho(t,e){return t.length<3?oo(t):t[0]+fo((t.push(t[0]),t),mo([t[t.length-2]].concat(t,[t[1]]),e))}function po(t,e){return t.length<3?oo(t):t[0]+fo(t,mo(t,e))}function fo(t,e){if(e.length<1||t.length!=e.length&&t.length!=e.length+2)return oo(t);var n=t.length!=e.length,r="",i=t[0],o=t[1],s=e[0],a=s,u=1;if(n&&(r+="Q"+(o[0]-2*s[0]/3)+","+(o[1]-2*s[1]/3)+","+o[0]+","+o[1],i=t[1],u=2),e.length>1){a=e[1],o=t[u],u++,r+="C"+(i[0]+s[0])+","+(i[1]+s[1])+","+(o[0]-a[0])+","+(o[1]-a[1])+","+o[0]+","+o[1];for(var l=2;l<e.length;l++,u++)o=t[u],a=e[l],r+="S"+(o[0]-a[0])+","+(o[1]-a[1])+","+o[0]+","+o[1]}if(n){var c=t[u];r+="Q"+(o[0]+2*a[0]/3)+","+(o[1]+2*a[1]/3)+","+c[0]+","+c[1]}return r}function mo(t,e){for(var n,r=[],i=(1-e)/2,o=t[0],s=t[1],a=1,u=t.length;++a<u;)n=o,o=s,s=t[a],r.push([i*(s[0]-n[0]),i*(s[1]-n[1])]);return r}function go(t){if(t.length<3)return oo(t);var e=1,n=t.length,r=t[0],i=r[0],o=r[1],s=[i,i,i,(r=t[1])[0]],a=[o,o,o,r[1]],u=[i,",",o,"L",_o(Cu,s),",",_o(Cu,a)];for(t.push(t[n-1]);++e<=n;)r=t[e],s.shift(),s.push(r[0]),a.shift(),a.push(r[1]),wo(u,s,a);return t.pop(),u.push("L",r),u.join("")}function yo(t){if(t.length<4)return oo(t);for(var e,n=[],r=-1,i=t.length,o=[0],s=[0];++r<3;)e=t[r],o.push(e[0]),s.push(e[1]);for(n.push(_o(Cu,o)+","+_o(Cu,s)),--r;++r<i;)e=t[r],o.shift(),o.push(e[0]),s.shift(),s.push(e[1]),wo(n,o,s);return n.join("")}function vo(t){for(var e,n,r=-1,i=t.length,o=i+4,s=[],a=[];++r<4;)n=t[r%i],s.push(n[0]),a.push(n[1]);for(e=[_o(Cu,s),",",_o(Cu,a)],--r;++r<o;)n=t[r%i],s.shift(),s.push(n[0]),a.shift(),a.push(n[1]),wo(e,s,a);return e.join("")}function bo(t,e){var n=t.length-1;if(n)for(var r,i,o=t[0][0],s=t[0][1],a=t[n][0]-o,u=t[n][1]-s,l=-1;++l<=n;)r=t[l],i=l/n,r[0]=e*r[0]+(1-e)*(o+i*a),r[1]=e*r[1]+(1-e)*(s+i*u);return go(t)}function _o(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}function wo(t,e,n){t.push("C",_o(wu,e),",",_o(wu,n),",",_o(xu,e),",",_o(xu,n),",",_o(Cu,e),",",_o(Cu,n))}function xo(t,e){return(e[1]-t[1])/(e[0]-t[0])}function Co(t){for(var e=0,n=t.length-1,r=[],i=t[0],o=t[1],s=r[0]=xo(i,o);++e<n;)r[e]=(s+(s=xo(i=o,o=t[e+1])))/2;return r[e]=s,r}function To(t){for(var e,n,r,i,o=[],s=Co(t),a=-1,u=t.length-1;++a<u;)e=xo(t[a],t[a+1]),os(e)<Es?s[a]=s[a+1]=0:(n=s[a]/e,r=s[a+1]/e,i=n*n+r*r,i>9&&(i=3*e/Math.sqrt(i),s[a]=i*n,s[a+1]=i*r));for(a=-1;++a<=u;)i=(t[Math.min(u,a+1)][0]-t[Math.max(0,a-1)][0])/(6*(1+s[a]*s[a])),o.push([i||0,s[a]*i||0]);return o}function So(t){return t.length<3?oo(t):t[0]+fo(t,To(t))}function Eo(t){for(var e,n,r,i=-1,o=t.length;++i<o;)e=t[i],n=e[0],r=e[1]+vu,e[0]=n*Math.cos(r),e[1]=n*Math.sin(r);return t}function No(t){function e(e){function u(){m.push("M",a(t(y),h),c,l(t(g.reverse()),h),"Z")}for(var p,f,d,m=[],g=[],y=[],v=-1,b=e.length,_=xt(n),w=xt(i),x=n===r?function(){return f}:xt(r),C=i===o?function(){return d}:xt(o);++v<b;)s.call(this,p=e[v],v)?(g.push([f=+_.call(this,p,v),d=+w.call(this,p,v)]),y.push([+x.call(this,p,v),+C.call(this,p,v)])):g.length&&(u(),g=[],y=[]);return g.length&&u(),m.length?m.join(""):null}var n=Tn,r=Tn,i=0,o=Sn,s=Ce,a=oo,u=a.key,l=a,c="L",h=.7;return e.x=function(t){return arguments.length?(n=r=t,e):r},e.x0=function(t){return arguments.length?(n=t,e):n},e.x1=function(t){return arguments.length?(r=t,e):r},e.y=function(t){return arguments.length?(i=o=t,e):o},e.y0=function(t){return arguments.length?(i=t,e):i},e.y1=function(t){return arguments.length?(o=t,e):o},e.defined=function(t){return arguments.length?(s=t,e):s},e.interpolate=function(t){return arguments.length?(u="function"==typeof t?a=t:(a=_u.get(t)||oo).key,l=a.reverse||a,c=a.closed?"M":"L",e):u},e.tension=function(t){return arguments.length?(h=t,e):h},e}function ko(t){return t.radius}function Mo(t){return[t.x,t.y]}function Po(t){return function(){var e=t.apply(this,arguments),n=e[0],r=e[1]+vu;return[n*Math.cos(r),n*Math.sin(r)]}}function Oo(){return 64}function Ao(){return"circle"}function Ro(t){var e=Math.sqrt(t/Cs);return"M0,"+e+"A"+e+","+e+" 0 1,1 0,"+-e+"A"+e+","+e+" 0 1,1 0,"+e+"Z"}function Io(t,e){return cs(t,Mu),t.id=e,t}function Do(t,e,n,r){var i=t.id;return L(t,"function"==typeof n?function(t,o,s){t.__transition__[i].tween.set(e,r(n.call(t,t.__data__,o,s)))}:(n=r(n),function(t){t.__transition__[i].tween.set(e,n)}))}function Lo(t){return null==t&&(t=""),function(){this.textContent=t}}function qo(t,e,n,r){var i=t.__transition__||(t.__transition__={active:0,count:0}),o=i[n];if(!o){var a=r.time;o=i[n]={tween:new s,time:a,ease:r.ease,delay:r.delay,duration:r.duration},++i.count,Vo.timer(function(r){function s(r){return i.active>n?l():(i.active=n,o.event&&o.event.start.call(t,c,e),o.tween.forEach(function(n,r){(r=r.call(t,c,e))&&m.push(r)}),void Vo.timer(function(){return d.c=u(r||1)?Ce:u,1},0,a))}function u(r){if(i.active!==n)return l();for(var s=r/f,a=h(s),u=m.length;u>0;)m[--u].call(t,a);return s>=1?(o.event&&o.event.end.call(t,c,e),l()):void 0}function l(){return--i.count?delete i[n]:delete t.__transition__,1}var c=t.__data__,h=o.ease,p=o.delay,f=o.duration,d=Xs,m=[];return d.t=p+a,r>=p?s(r-p):void(d.c=s)},0,a)}}function jo(t,e){t.attr("transform",function(t){return"translate("+e(t)+",0)"})}function $o(t,e){t.attr("transform",function(t){return"translate(0,"+e(t)+")"})}function Fo(t){return t.toISOString()}function zo(t,e,n){function r(e){return t(e)}function i(t,n){var r=t[1]-t[0],i=r/n,o=Vo.bisect(ju,i);return o==ju.length?[e.year,zi(t.map(function(t){return t/31536e6}),n)[2]]:o?e[i/ju[o-1]<ju[o]/i?o-1:o]:[zu,zi(t,n)[2]]}return r.invert=function(e){return Uo(t.invert(e))},r.domain=function(e){return arguments.length?(t.domain(e),r):t.domain().map(Uo)},r.nice=function(t,e){function n(n){return!isNaN(n)&&!t.range(n,Uo(+n+1),e).length}var o=r.domain(),s=Ai(o),a=null==t?i(s,10):"number"==typeof t&&i(s,t);return a&&(t=a[0],e=a[1]),r.domain(Di(o,e>1?{floor:function(e){for(;n(e=t.floor(e));)e=Uo(e-1);return e},ceil:function(e){for(;n(e=t.ceil(e));)e=Uo(+e+1);return e}}:t))},r.ticks=function(t,e){var n=Ai(r.domain()),o=null==t?i(n,10):"number"==typeof t?i(n,t):!t.range&&[{range:t},e];return o&&(t=o[0],e=o[1]),t.range(n[0],Uo(+n[1]+1),1>e?1:e)},r.tickFormat=function(){return n},r.copy=function(){return zo(t.copy(),e,n)},$i(r,t)}function Uo(t){return new Date(t)}function Ho(t){return JSON.parse(t.responseText)}function Bo(t){var e=Go.createRange();return e.selectNode(Go.body),e.createContextualFragment(t.responseText)}var Vo={version:"3.4.11"};Date.now||(Date.now=function(){return+new Date});var Wo=[].slice,Jo=function(t){return Wo.call(t)},Go=document,Xo=Go.documentElement,Qo=window;try{Jo(Xo.childNodes)[0].nodeType}catch(Yo){Jo=function(t){for(var e=t.length,n=new Array(e);e--;)n[e]=t[e];return n}}try{Go.createElement("div").style.setProperty("opacity",0,"")}catch(Ko){var Zo=Qo.Element.prototype,ts=Zo.setAttribute,es=Zo.setAttributeNS,ns=Qo.CSSStyleDeclaration.prototype,rs=ns.setProperty;Zo.setAttribute=function(t,e){ts.call(this,t,e+"")},Zo.setAttributeNS=function(t,e,n){es.call(this,t,e,n+"")},ns.setProperty=function(t,e,n){rs.call(this,t,e+"",n)}}Vo.ascending=t,Vo.descending=function(t,e){return t>e?-1:e>t?1:e>=t?0:0/0},Vo.min=function(t,e){var n,r,i=-1,o=t.length;if(1===arguments.length){for(;++i<o&&!(null!=(n=t[i])&&n>=n);)n=void 0;for(;++i<o;)null!=(r=t[i])&&n>r&&(n=r)}else{for(;++i<o&&!(null!=(n=e.call(t,t[i],i))&&n>=n);)n=void 0;for(;++i<o;)null!=(r=e.call(t,t[i],i))&&n>r&&(n=r)}return n},Vo.max=function(t,e){var n,r,i=-1,o=t.length;if(1===arguments.length){for(;++i<o&&!(null!=(n=t[i])&&n>=n);)n=void 0;for(;++i<o;)null!=(r=t[i])&&r>n&&(n=r)}else{for(;++i<o&&!(null!=(n=e.call(t,t[i],i))&&n>=n);)n=void 0;for(;++i<o;)null!=(r=e.call(t,t[i],i))&&r>n&&(n=r)}return n},Vo.extent=function(t,e){var n,r,i,o=-1,s=t.length;if(1===arguments.length){for(;++o<s&&!(null!=(n=i=t[o])&&n>=n);)n=i=void 0;for(;++o<s;)null!=(r=t[o])&&(n>r&&(n=r),r>i&&(i=r))}else{for(;++o<s&&!(null!=(n=i=e.call(t,t[o],o))&&n>=n);)n=void 0;for(;++o<s;)null!=(r=e.call(t,t[o],o))&&(n>r&&(n=r),r>i&&(i=r))}return[n,i]},Vo.sum=function(t,e){var n,r=0,i=t.length,o=-1;if(1===arguments.length)for(;++o<i;)isNaN(n=+t[o])||(r+=n);else for(;++o<i;)isNaN(n=+e.call(t,t[o],o))||(r+=n);return r},Vo.mean=function(t,n){var r,i=0,o=t.length,s=-1,a=o;if(1===arguments.length)for(;++s<o;)e(r=t[s])?i+=r:--a;else for(;++s<o;)e(r=n.call(t,t[s],s))?i+=r:--a;return a?i/a:void 0},Vo.quantile=function(t,e){var n=(t.length-1)*e+1,r=Math.floor(n),i=+t[r-1],o=n-r;return o?i+o*(t[r]-i):i},Vo.median=function(n,r){return arguments.length>1&&(n=n.map(r)),n=n.filter(e),n.length?Vo.quantile(n.sort(t),.5):void 0};var is=n(t);Vo.bisectLeft=is.left,Vo.bisect=Vo.bisectRight=is.right,Vo.bisector=function(e){return n(1===e.length?function(n,r){return t(e(n),r)}:e)},Vo.shuffle=function(t){for(var e,n,r=t.length;r;)n=Math.random()*r--|0,e=t[r],t[r]=t[n],t[n]=e;return t},Vo.permute=function(t,e){for(var n=e.length,r=new Array(n);n--;)r[n]=t[e[n]];return r},Vo.pairs=function(t){for(var e,n=0,r=t.length-1,i=t[0],o=new Array(0>r?0:r);r>n;)o[n]=[e=i,i=t[++n]];return o},Vo.zip=function(){if(!(i=arguments.length))return[];for(var t=-1,e=Vo.min(arguments,r),n=new Array(e);++t<e;)for(var i,o=-1,s=n[t]=new Array(i);++o<i;)s[o]=arguments[o][t];return n},Vo.transpose=function(t){return Vo.zip.apply(Vo,t)},Vo.keys=function(t){var e=[];for(var n in t)e.push(n);return e},Vo.values=function(t){var e=[];for(var n in t)e.push(t[n]);return e},Vo.entries=function(t){var e=[];for(var n in t)e.push({key:n,value:t[n]});return e},Vo.merge=function(t){for(var e,n,r,i=t.length,o=-1,s=0;++o<i;)s+=t[o].length;for(n=new Array(s);--i>=0;)for(r=t[i],e=r.length;--e>=0;)n[--s]=r[e];return n};var os=Math.abs;Vo.range=function(t,e,n){if(arguments.length<3&&(n=1,arguments.length<2&&(e=t,t=0)),(e-t)/n===1/0)throw new Error("infinite range");var r,o=[],s=i(os(n)),a=-1;if(t*=s,e*=s,n*=s,0>n)for(;(r=t+n*++a)>e;)o.push(r/s);else for(;(r=t+n*++a)<e;)o.push(r/s);return o},Vo.map=function(t){var e=new s;if(t instanceof s)t.forEach(function(t,n){e.set(t,n)});else for(var n in t)e.set(n,t[n]);return e},o(s,{has:a,get:function(t){return this[ss+t]},set:function(t,e){return this[ss+t]=e},remove:u,keys:l,values:function(){var t=[];return this.forEach(function(e,n){t.push(n)}),t},entries:function(){var t=[];return this.forEach(function(e,n){t.push({key:e,value:n})}),t},size:c,empty:h,forEach:function(t){for(var e in this)e.charCodeAt(0)===as&&t.call(this,e.substring(1),this[e])}});var ss="\x00",as=ss.charCodeAt(0);Vo.nest=function(){function t(e,a,u){if(u>=o.length)return r?r.call(i,a):n?a.sort(n):a;for(var l,c,h,p,f=-1,d=a.length,m=o[u++],g=new s;++f<d;)(p=g.get(l=m(c=a[f])))?p.push(c):g.set(l,[c]);return e?(c=e(),h=function(n,r){c.set(n,t(e,r,u))}):(c={},h=function(n,r){c[n]=t(e,r,u)}),g.forEach(h),c}function e(t,n){if(n>=o.length)return t;var r=[],i=a[n++];return t.forEach(function(t,i){r.push({key:t,values:e(i,n)})}),i?r.sort(function(t,e){return i(t.key,e.key)}):r}var n,r,i={},o=[],a=[];return i.map=function(e,n){return t(n,e,0)},i.entries=function(n){return e(t(Vo.map,n,0),0)},i.key=function(t){
return o.push(t),i},i.sortKeys=function(t){return a[o.length-1]=t,i},i.sortValues=function(t){return n=t,i},i.rollup=function(t){return r=t,i},i},Vo.set=function(t){var e=new p;if(t)for(var n=0,r=t.length;r>n;++n)e.add(t[n]);return e},o(p,{has:a,add:function(t){return this[ss+t]=!0,t},remove:function(t){return t=ss+t,t in this&&delete this[t]},values:l,size:c,empty:h,forEach:function(t){for(var e in this)e.charCodeAt(0)===as&&t.call(this,e.substring(1))}}),Vo.behavior={},Vo.rebind=function(t,e){for(var n,r=1,i=arguments.length;++r<i;)t[n=arguments[r]]=f(t,e,e[n]);return t};var us=["webkit","ms","moz","Moz","o","O"];Vo.dispatch=function(){for(var t=new g,e=-1,n=arguments.length;++e<n;)t[arguments[e]]=y(t);return t},g.prototype.on=function(t,e){var n=t.indexOf("."),r="";if(n>=0&&(r=t.substring(n+1),t=t.substring(0,n)),t)return arguments.length<2?this[t].on(r):this[t].on(r,e);if(2===arguments.length){if(null==e)for(t in this)this.hasOwnProperty(t)&&this[t].on(r,null);return this}},Vo.event=null,Vo.requote=function(t){return t.replace(ls,"\\$&")};var ls=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g,cs={}.__proto__?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)t[n]=e[n]},hs=function(t,e){return e.querySelector(t)},ps=function(t,e){return e.querySelectorAll(t)},fs=Xo.matches||Xo[d(Xo,"matchesSelector")],ds=function(t,e){return fs.call(t,e)};"function"==typeof Sizzle&&(hs=function(t,e){return Sizzle(t,e)[0]||null},ps=Sizzle,ds=Sizzle.matchesSelector),Vo.selection=function(){return vs};var ms=Vo.selection.prototype=[];ms.select=function(t){var e,n,r,i,o=[];t=x(t);for(var s=-1,a=this.length;++s<a;){o.push(e=[]),e.parentNode=(r=this[s]).parentNode;for(var u=-1,l=r.length;++u<l;)(i=r[u])?(e.push(n=t.call(i,i.__data__,u,s)),n&&"__data__"in i&&(n.__data__=i.__data__)):e.push(null)}return w(o)},ms.selectAll=function(t){var e,n,r=[];t=C(t);for(var i=-1,o=this.length;++i<o;)for(var s=this[i],a=-1,u=s.length;++a<u;)(n=s[a])&&(r.push(e=Jo(t.call(n,n.__data__,a,i))),e.parentNode=n);return w(r)};var gs={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};Vo.ns={prefix:gs,qualify:function(t){var e=t.indexOf(":"),n=t;return e>=0&&(n=t.substring(0,e),t=t.substring(e+1)),gs.hasOwnProperty(n)?{space:gs[n],local:t}:t}},ms.attr=function(t,e){if(arguments.length<2){if("string"==typeof t){var n=this.node();return t=Vo.ns.qualify(t),t.local?n.getAttributeNS(t.space,t.local):n.getAttribute(t)}for(e in t)this.each(T(e,t[e]));return this}return this.each(T(t,e))},ms.classed=function(t,e){if(arguments.length<2){if("string"==typeof t){var n=this.node(),r=(t=N(t)).length,i=-1;if(e=n.classList){for(;++i<r;)if(!e.contains(t[i]))return!1}else for(e=n.getAttribute("class");++i<r;)if(!E(t[i]).test(e))return!1;return!0}for(e in t)this.each(k(e,t[e]));return this}return this.each(k(t,e))},ms.style=function(t,e,n){var r=arguments.length;if(3>r){if("string"!=typeof t){2>r&&(e="");for(n in t)this.each(P(n,t[n],e));return this}if(2>r)return Qo.getComputedStyle(this.node(),null).getPropertyValue(t);n=""}return this.each(P(t,e,n))},ms.property=function(t,e){if(arguments.length<2){if("string"==typeof t)return this.node()[t];for(e in t)this.each(O(e,t[e]));return this}return this.each(O(t,e))},ms.text=function(t){return arguments.length?this.each("function"==typeof t?function(){var e=t.apply(this,arguments);this.textContent=null==e?"":e}:null==t?function(){this.textContent=""}:function(){this.textContent=t}):this.node().textContent},ms.html=function(t){return arguments.length?this.each("function"==typeof t?function(){var e=t.apply(this,arguments);this.innerHTML=null==e?"":e}:null==t?function(){this.innerHTML=""}:function(){this.innerHTML=t}):this.node().innerHTML},ms.append=function(t){return t=A(t),this.select(function(){return this.appendChild(t.apply(this,arguments))})},ms.insert=function(t,e){return t=A(t),e=x(e),this.select(function(){return this.insertBefore(t.apply(this,arguments),e.apply(this,arguments)||null)})},ms.remove=function(){return this.each(function(){var t=this.parentNode;t&&t.removeChild(this)})},ms.data=function(t,e){function n(t,n){var r,i,o,a=t.length,h=n.length,p=Math.min(a,h),f=new Array(h),d=new Array(h),m=new Array(a);if(e){var g,y=new s,v=new s,b=[];for(r=-1;++r<a;)g=e.call(i=t[r],i.__data__,r),y.has(g)?m[r]=i:y.set(g,i),b.push(g);for(r=-1;++r<h;)g=e.call(n,o=n[r],r),(i=y.get(g))?(f[r]=i,i.__data__=o):v.has(g)||(d[r]=R(o)),v.set(g,o),y.remove(g);for(r=-1;++r<a;)y.has(b[r])&&(m[r]=t[r])}else{for(r=-1;++r<p;)i=t[r],o=n[r],i?(i.__data__=o,f[r]=i):d[r]=R(o);for(;h>r;++r)d[r]=R(n[r]);for(;a>r;++r)m[r]=t[r]}d.update=f,d.parentNode=f.parentNode=m.parentNode=t.parentNode,u.push(d),l.push(f),c.push(m)}var r,i,o=-1,a=this.length;if(!arguments.length){for(t=new Array(a=(r=this[0]).length);++o<a;)(i=r[o])&&(t[o]=i.__data__);return t}var u=q([]),l=w([]),c=w([]);if("function"==typeof t)for(;++o<a;)n(r=this[o],t.call(r,r.parentNode.__data__,o));else for(;++o<a;)n(r=this[o],t);return l.enter=function(){return u},l.exit=function(){return c},l},ms.datum=function(t){return arguments.length?this.property("__data__",t):this.property("__data__")},ms.filter=function(t){var e,n,r,i=[];"function"!=typeof t&&(t=I(t));for(var o=0,s=this.length;s>o;o++){i.push(e=[]),e.parentNode=(n=this[o]).parentNode;for(var a=0,u=n.length;u>a;a++)(r=n[a])&&t.call(r,r.__data__,a,o)&&e.push(r)}return w(i)},ms.order=function(){for(var t=-1,e=this.length;++t<e;)for(var n,r=this[t],i=r.length-1,o=r[i];--i>=0;)(n=r[i])&&(o&&o!==n.nextSibling&&o.parentNode.insertBefore(n,o),o=n);return this},ms.sort=function(t){t=D.apply(this,arguments);for(var e=-1,n=this.length;++e<n;)this[e].sort(t);return this.order()},ms.each=function(t){return L(this,function(e,n,r){t.call(e,e.__data__,n,r)})},ms.call=function(t){var e=Jo(arguments);return t.apply(e[0]=this,e),this},ms.empty=function(){return!this.node()},ms.node=function(){for(var t=0,e=this.length;e>t;t++)for(var n=this[t],r=0,i=n.length;i>r;r++){var o=n[r];if(o)return o}return null},ms.size=function(){var t=0;return this.each(function(){++t}),t};var ys=[];Vo.selection.enter=q,Vo.selection.enter.prototype=ys,ys.append=ms.append,ys.empty=ms.empty,ys.node=ms.node,ys.call=ms.call,ys.size=ms.size,ys.select=function(t){for(var e,n,r,i,o,s=[],a=-1,u=this.length;++a<u;){r=(i=this[a]).update,s.push(e=[]),e.parentNode=i.parentNode;for(var l=-1,c=i.length;++l<c;)(o=i[l])?(e.push(r[l]=n=t.call(i.parentNode,o.__data__,l,a)),n.__data__=o.__data__):e.push(null)}return w(s)},ys.insert=function(t,e){return arguments.length<2&&(e=j(this)),ms.insert.call(this,t,e)},ms.transition=function(){for(var t,e,n=Su||++Pu,r=[],i=Eu||{time:Date.now(),ease:_r,delay:0,duration:250},o=-1,s=this.length;++o<s;){r.push(t=[]);for(var a=this[o],u=-1,l=a.length;++u<l;)(e=a[u])&&qo(e,u,n,i),t.push(e)}return Io(r,n)},ms.interrupt=function(){return this.each($)},Vo.select=function(t){var e=["string"==typeof t?hs(t,Go):t];return e.parentNode=Xo,w([e])},Vo.selectAll=function(t){var e=Jo("string"==typeof t?ps(t,Go):t);return e.parentNode=Xo,w([e])};var vs=Vo.select(Xo);ms.on=function(t,e,n){var r=arguments.length;if(3>r){if("string"!=typeof t){2>r&&(e=!1);for(n in t)this.each(F(n,t[n],e));return this}if(2>r)return(r=this.node()["__on"+t])&&r._;n=!1}return this.each(F(t,e,n))};var bs=Vo.map({mouseenter:"mouseover",mouseleave:"mouseout"});bs.forEach(function(t){"on"+t in Go&&bs.remove(t)});var _s="onselectstart"in Go?null:d(Xo.style,"userSelect"),ws=0;Vo.mouse=function(t){return B(t,b())};var xs=/WebKit/.test(Qo.navigator.userAgent)?-1:0;Vo.touches=function(t,e){return arguments.length<2&&(e=b().touches),e?Jo(e).map(function(e){var n=B(t,e);return n.identifier=e.identifier,n}):[]},Vo.behavior.drag=function(){function t(){this.on("mousedown.drag",i).on("touchstart.drag",o)}function e(t,e,i,o,s){return function(){function a(){var t,n,r=e(p,m);r&&(t=r[0]-b[0],n=r[1]-b[1],d|=t|n,b=r,f({type:"drag",x:r[0]+l[0],y:r[1]+l[1],dx:t,dy:n}))}function u(){e(p,m)&&(y.on(o+g,null).on(s+g,null),v(d&&Vo.event.target===h),f({type:"dragend"}))}var l,c=this,h=Vo.event.target,p=c.parentNode,f=n.of(c,arguments),d=0,m=t(),g=".drag"+(null==m?"":"-"+m),y=Vo.select(i()).on(o+g,a).on(s+g,u),v=H(),b=e(p,m);r?(l=r.apply(c,arguments),l=[l.x-b[0],l.y-b[1]]):l=[0,0],f({type:"dragstart"})}}var n=_(t,"drag","dragstart","dragend"),r=null,i=e(m,Vo.mouse,J,"mousemove","mouseup"),o=e(V,Vo.touch,W,"touchmove","touchend");return t.origin=function(e){return arguments.length?(r=e,t):r},Vo.rebind(t,n,"on")};var Cs=Math.PI,Ts=2*Cs,Ss=Cs/2,Es=1e-6,Ns=Es*Es,ks=Cs/180,Ms=180/Cs,Ps=Math.SQRT2,Os=2,As=4;Vo.interpolateZoom=function(t,e){function n(t){var e=t*v;if(y){var n=Z(m),s=o/(Os*p)*(n*tt(Ps*e+m)-K(m));return[r+s*l,i+s*c,o*n/Z(Ps*e+m)]}return[r+t*l,i+t*c,o*Math.exp(Ps*e)]}var r=t[0],i=t[1],o=t[2],s=e[0],a=e[1],u=e[2],l=s-r,c=a-i,h=l*l+c*c,p=Math.sqrt(h),f=(u*u-o*o+As*h)/(2*o*Os*p),d=(u*u-o*o-As*h)/(2*u*Os*p),m=Math.log(Math.sqrt(f*f+1)-f),g=Math.log(Math.sqrt(d*d+1)-d),y=g-m,v=(y||Math.log(u/o))/Ps;return n.duration=1e3*v,n},Vo.behavior.zoom=function(){function t(t){t.on(N,l).on(Ds+".zoom",h).on("dblclick.zoom",p).on(P,c)}function e(t){return[(t[0]-T.x)/T.k,(t[1]-T.y)/T.k]}function n(t){return[t[0]*T.k+T.x,t[1]*T.k+T.y]}function r(t){T.k=Math.max(E[0],Math.min(E[1],t))}function i(t,e){e=n(e),T.x+=t[0]-e[0],T.y+=t[1]-e[1]}function o(){w&&w.domain(b.range().map(function(t){return(t-T.x)/T.k}).map(b.invert)),C&&C.domain(x.range().map(function(t){return(t-T.y)/T.k}).map(x.invert))}function s(t){t({type:"zoomstart"})}function a(t){o(),t({type:"zoom",scale:T.k,translate:[T.x,T.y]})}function u(t){t({type:"zoomend"})}function l(){function t(){c=1,i(Vo.mouse(r),p),a(l)}function n(){h.on(k,null).on(M,null),f(c&&Vo.event.target===o),u(l)}var r=this,o=Vo.event.target,l=O.of(r,arguments),c=0,h=Vo.select(Qo).on(k,t).on(M,n),p=e(Vo.mouse(r)),f=H();$.call(r),s(l)}function c(){function t(){var t=Vo.touches(f);return p=T.k,t.forEach(function(t){t.identifier in m&&(m[t.identifier]=e(t))}),t}function n(){var e=Vo.event.target;Vo.select(e).on(_,o).on(w,h),x.push(e);for(var n=Vo.event.changedTouches,s=0,u=n.length;u>s;++s)m[n[s].identifier]=null;var l=t(),c=Date.now();if(1===l.length){if(500>c-y){var p=l[0],f=m[p.identifier];r(2*T.k),i(p,f),v(),a(d)}y=c}else if(l.length>1){var p=l[0],b=l[1],C=p[0]-b[0],S=p[1]-b[1];g=C*C+S*S}}function o(){for(var t,e,n,o,s=Vo.touches(f),u=0,l=s.length;l>u;++u,o=null)if(n=s[u],o=m[n.identifier]){if(e)break;t=n,e=o}if(o){var c=(c=n[0]-t[0])*c+(c=n[1]-t[1])*c,h=g&&Math.sqrt(c/g);t=[(t[0]+n[0])/2,(t[1]+n[1])/2],e=[(e[0]+o[0])/2,(e[1]+o[1])/2],r(h*p)}y=null,i(t,e),a(d)}function h(){if(Vo.event.touches.length){for(var e=Vo.event.changedTouches,n=0,r=e.length;r>n;++n)delete m[e[n].identifier];for(var i in m)return void t()}Vo.selectAll(x).on(b,null),C.on(N,l).on(P,c),S(),u(d)}var p,f=this,d=O.of(f,arguments),m={},g=0,b=".zoom-"+Vo.event.changedTouches[0].identifier,_="touchmove"+b,w="touchend"+b,x=[],C=Vo.select(f).on(N,null).on(P,n),S=H();$.call(f),n(),s(d)}function h(){var t=O.of(this,arguments);g?clearTimeout(g):(f=e(d=m||Vo.mouse(this)),$.call(this),s(t)),g=setTimeout(function(){g=null,u(t)},50),v(),r(Math.pow(2,.002*Rs())*T.k),i(d,f),a(t)}function p(){var t=O.of(this,arguments),n=Vo.mouse(this),o=e(n),l=Math.log(T.k)/Math.LN2;s(t),r(Math.pow(2,Vo.event.shiftKey?Math.ceil(l)-1:Math.floor(l)+1)),i(n,o),a(t),u(t)}var f,d,m,g,y,b,w,x,C,T={x:0,y:0,k:1},S=[960,500],E=Is,N="mousedown.zoom",k="mousemove.zoom",M="mouseup.zoom",P="touchstart.zoom",O=_(t,"zoomstart","zoom","zoomend");return t.event=function(t){t.each(function(){var t=O.of(this,arguments),e=T;Su?Vo.select(this).transition().each("start.zoom",function(){T=this.__chart__||{x:0,y:0,k:1},s(t)}).tween("zoom:zoom",function(){var n=S[0],r=S[1],i=n/2,o=r/2,s=Vo.interpolateZoom([(i-T.x)/T.k,(o-T.y)/T.k,n/T.k],[(i-e.x)/e.k,(o-e.y)/e.k,n/e.k]);return function(e){var r=s(e),u=n/r[2];this.__chart__=T={x:i-r[0]*u,y:o-r[1]*u,k:u},a(t)}}).each("end.zoom",function(){u(t)}):(this.__chart__=T,s(t),a(t),u(t))})},t.translate=function(e){return arguments.length?(T={x:+e[0],y:+e[1],k:T.k},o(),t):[T.x,T.y]},t.scale=function(e){return arguments.length?(T={x:T.x,y:T.y,k:+e},o(),t):T.k},t.scaleExtent=function(e){return arguments.length?(E=null==e?Is:[+e[0],+e[1]],t):E},t.center=function(e){return arguments.length?(m=e&&[+e[0],+e[1]],t):m},t.size=function(e){return arguments.length?(S=e&&[+e[0],+e[1]],t):S},t.x=function(e){return arguments.length?(w=e,b=e.copy(),T={x:0,y:0,k:1},t):w},t.y=function(e){return arguments.length?(C=e,x=e.copy(),T={x:0,y:0,k:1},t):C},Vo.rebind(t,O,"on")};var Rs,Is=[0,1/0],Ds="onwheel"in Go?(Rs=function(){return-Vo.event.deltaY*(Vo.event.deltaMode?120:1)},"wheel"):"onmousewheel"in Go?(Rs=function(){return Vo.event.wheelDelta},"mousewheel"):(Rs=function(){return-Vo.event.detail},"MozMousePixelScroll");Vo.color=nt,nt.prototype.toString=function(){return this.rgb()+""},Vo.hsl=rt;var Ls=rt.prototype=new nt;Ls.brighter=function(t){return t=Math.pow(.7,arguments.length?t:1),new rt(this.h,this.s,this.l/t)},Ls.darker=function(t){return t=Math.pow(.7,arguments.length?t:1),new rt(this.h,this.s,t*this.l)},Ls.rgb=function(){return it(this.h,this.s,this.l)},Vo.hcl=ot;var qs=ot.prototype=new nt;qs.brighter=function(t){return new ot(this.h,this.c,Math.min(100,this.l+js*(arguments.length?t:1)))},qs.darker=function(t){return new ot(this.h,this.c,Math.max(0,this.l-js*(arguments.length?t:1)))},qs.rgb=function(){return st(this.h,this.c,this.l).rgb()},Vo.lab=at;var js=18,$s=.95047,Fs=1,zs=1.08883,Us=at.prototype=new nt;Us.brighter=function(t){return new at(Math.min(100,this.l+js*(arguments.length?t:1)),this.a,this.b)},Us.darker=function(t){return new at(Math.max(0,this.l-js*(arguments.length?t:1)),this.a,this.b)},Us.rgb=function(){return ut(this.l,this.a,this.b)},Vo.rgb=ft;var Hs=ft.prototype=new nt;Hs.brighter=function(t){t=Math.pow(.7,arguments.length?t:1);var e=this.r,n=this.g,r=this.b,i=30;return e||n||r?(e&&i>e&&(e=i),n&&i>n&&(n=i),r&&i>r&&(r=i),new ft(Math.min(255,e/t),Math.min(255,n/t),Math.min(255,r/t))):new ft(i,i,i)},Hs.darker=function(t){return t=Math.pow(.7,arguments.length?t:1),new ft(t*this.r,t*this.g,t*this.b)},Hs.hsl=function(){return vt(this.r,this.g,this.b)},Hs.toString=function(){return"#"+gt(this.r)+gt(this.g)+gt(this.b)};var Bs=Vo.map({aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074});Bs.forEach(function(t,e){Bs.set(t,dt(e))}),Vo.functor=xt,Vo.xhr=Tt(Ct),Vo.dsv=function(t,e){function n(t,n,o){arguments.length<3&&(o=n,n=null);var s=St(t,e,null==n?r:i(n),o);return s.row=function(t){return arguments.length?s.response(null==(n=t)?r:i(t)):n},s}function r(t){return n.parse(t.responseText)}function i(t){return function(e){return n.parse(e.responseText,t)}}function o(e){return e.map(s).join(t)}function s(t){return a.test(t)?'"'+t.replace(/\"/g,'""')+'"':t}var a=new RegExp('["'+t+"\n]"),u=t.charCodeAt(0);return n.parse=function(t,e){var r;return n.parseRows(t,function(t,n){if(r)return r(t,n-1);var i=new Function("d","return {"+t.map(function(t,e){return JSON.stringify(t)+": d["+e+"]"}).join(",")+"}");r=e?function(t,n){return e(i(t),n)}:i})},n.parseRows=function(t,e){function n(){if(c>=l)return s;if(i)return i=!1,o;var e=c;if(34===t.charCodeAt(e)){for(var n=e;n++<l;)if(34===t.charCodeAt(n)){if(34!==t.charCodeAt(n+1))break;++n}c=n+2;var r=t.charCodeAt(n+1);return 13===r?(i=!0,10===t.charCodeAt(n+2)&&++c):10===r&&(i=!0),t.substring(e+1,n).replace(/""/g,'"')}for(;l>c;){var r=t.charCodeAt(c++),a=1;if(10===r)i=!0;else if(13===r)i=!0,10===t.charCodeAt(c)&&(++c,++a);else if(r!==u)continue;return t.substring(e,c-a)}return t.substring(e)}for(var r,i,o={},s={},a=[],l=t.length,c=0,h=0;(r=n())!==s;){for(var p=[];r!==o&&r!==s;)p.push(r),r=n();(!e||(p=e(p,h++)))&&a.push(p)}return a},n.format=function(e){if(Array.isArray(e[0]))return n.formatRows(e);var r=new p,i=[];return e.forEach(function(t){for(var e in t)r.has(e)||i.push(r.add(e))}),[i.map(s).join(t)].concat(e.map(function(e){return i.map(function(t){return s(e[t])}).join(t)})).join("\n")},n.formatRows=function(t){return t.map(o).join("\n")},n},Vo.csv=Vo.dsv(",","text/csv"),Vo.tsv=Vo.dsv("	","text/tab-separated-values"),Vo.touch=function(t,e,n){if(arguments.length<3&&(n=e,e=b().changedTouches),e)for(var r,i=0,o=e.length;o>i;++i)if((r=e[i]).identifier===n)return B(t,r)};var Vs,Ws,Js,Gs,Xs,Qs=Qo[d(Qo,"requestAnimationFrame")]||function(t){setTimeout(t,17)};Vo.timer=function(t,e,n){var r=arguments.length;2>r&&(e=0),3>r&&(n=Date.now());var i=n+e,o={c:t,t:i,f:!1,n:null};Ws?Ws.n=o:Vs=o,Ws=o,Js||(Gs=clearTimeout(Gs),Js=1,Qs(Nt))},Vo.timer.flush=function(){kt(),Mt()},Vo.round=function(t,e){return e?Math.round(t*(e=Math.pow(10,e)))/e:Math.round(t)};var Ys=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"].map(Ot);Vo.formatPrefix=function(t,e){var n=0;return t&&(0>t&&(t*=-1),e&&(t=Vo.round(t,Pt(t,e))),n=1+Math.floor(1e-12+Math.log(t)/Math.LN10),n=Math.max(-24,Math.min(24,3*Math.floor((n-1)/3)))),Ys[8+n/3]};var Ks=/(?:([^{])?([<>=^]))?([+\- ])?([$#])?(0)?(\d+)?(,)?(\.-?\d+)?([a-z%])?/i,Zs=Vo.map({b:function(t){return t.toString(2)},c:function(t){return String.fromCharCode(t)},o:function(t){return t.toString(8)},x:function(t){return t.toString(16)},X:function(t){return t.toString(16).toUpperCase()},g:function(t,e){return t.toPrecision(e)},e:function(t,e){return t.toExponential(e)},f:function(t,e){return t.toFixed(e)},r:function(t,e){return(t=Vo.round(t,Pt(t,e))).toFixed(Math.max(0,Math.min(20,Pt(t*(1+1e-15),e))))}}),ta=Vo.time={},ea=Date;It.prototype={getDate:function(){return this._.getUTCDate()},getDay:function(){return this._.getUTCDay()},getFullYear:function(){return this._.getUTCFullYear()},getHours:function(){return this._.getUTCHours()},getMilliseconds:function(){return this._.getUTCMilliseconds()},getMinutes:function(){return this._.getUTCMinutes()},getMonth:function(){return this._.getUTCMonth()},getSeconds:function(){return this._.getUTCSeconds()},getTime:function(){return this._.getTime()},getTimezoneOffset:function(){return 0},valueOf:function(){return this._.valueOf()},setDate:function(){na.setUTCDate.apply(this._,arguments)},setDay:function(){na.setUTCDay.apply(this._,arguments)},setFullYear:function(){na.setUTCFullYear.apply(this._,arguments)},setHours:function(){na.setUTCHours.apply(this._,arguments)},setMilliseconds:function(){na.setUTCMilliseconds.apply(this._,arguments)},setMinutes:function(){na.setUTCMinutes.apply(this._,arguments)},setMonth:function(){na.setUTCMonth.apply(this._,arguments)},setSeconds:function(){na.setUTCSeconds.apply(this._,arguments)},setTime:function(){na.setTime.apply(this._,arguments)}};var na=Date.prototype;ta.year=Dt(function(t){return t=ta.day(t),t.setMonth(0,1),t},function(t,e){t.setFullYear(t.getFullYear()+e)},function(t){return t.getFullYear()}),ta.years=ta.year.range,ta.years.utc=ta.year.utc.range,ta.day=Dt(function(t){var e=new ea(2e3,0);return e.setFullYear(t.getFullYear(),t.getMonth(),t.getDate()),e},function(t,e){t.setDate(t.getDate()+e)},function(t){return t.getDate()-1}),ta.days=ta.day.range,ta.days.utc=ta.day.utc.range,ta.dayOfYear=function(t){var e=ta.year(t);return Math.floor((t-e-6e4*(t.getTimezoneOffset()-e.getTimezoneOffset()))/864e5)},["sunday","monday","tuesday","wednesday","thursday","friday","saturday"].forEach(function(t,e){e=7-e;var n=ta[t]=Dt(function(t){return(t=ta.day(t)).setDate(t.getDate()-(t.getDay()+e)%7),t},function(t,e){t.setDate(t.getDate()+7*Math.floor(e))},function(t){var n=ta.year(t).getDay();return Math.floor((ta.dayOfYear(t)+(n+e)%7)/7)-(n!==e)});ta[t+"s"]=n.range,ta[t+"s"].utc=n.utc.range,ta[t+"OfYear"]=function(t){var n=ta.year(t).getDay();return Math.floor((ta.dayOfYear(t)+(n+e)%7)/7)}}),ta.week=ta.sunday,ta.weeks=ta.sunday.range,ta.weeks.utc=ta.sunday.utc.range,ta.weekOfYear=ta.sundayOfYear;var ra={"-":"",_:" ",0:"0"},ia=/^\s*\d+/,oa=/^%/;Vo.locale=function(t){return{numberFormat:At(t),timeFormat:qt(t)}};var sa=Vo.locale({decimal:".",thousands:",",grouping:[3],currency:["$",""],dateTime:"%a %b %e %X %Y",date:"%m/%d/%Y",time:"%H:%M:%S",periods:["AM","PM"],days:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],shortDays:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],shortMonths:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"]});Vo.format=sa.numberFormat,Vo.geo={},ie.prototype={s:0,t:0,add:function(t){oe(t,this.t,aa),oe(aa.s,this.s,this),this.s?this.t+=aa.t:this.s=aa.t},reset:function(){this.s=this.t=0},valueOf:function(){return this.s}};var aa=new ie;Vo.geo.stream=function(t,e){t&&ua.hasOwnProperty(t.type)?ua[t.type](t,e):se(t,e)};var ua={Feature:function(t,e){se(t.geometry,e)},FeatureCollection:function(t,e){for(var n=t.features,r=-1,i=n.length;++r<i;)se(n[r].geometry,e)}},la={Sphere:function(t,e){e.sphere()},Point:function(t,e){t=t.coordinates,e.point(t[0],t[1],t[2])},MultiPoint:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)t=n[r],e.point(t[0],t[1],t[2])},LineString:function(t,e){ae(t.coordinates,e,0)},MultiLineString:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)ae(n[r],e,0)},Polygon:function(t,e){ue(t.coordinates,e)},MultiPolygon:function(t,e){for(var n=t.coordinates,r=-1,i=n.length;++r<i;)ue(n[r],e)},GeometryCollection:function(t,e){for(var n=t.geometries,r=-1,i=n.length;++r<i;)se(n[r],e)}};Vo.geo.area=function(t){return ca=0,Vo.geo.stream(t,pa),ca};var ca,ha=new ie,pa={sphere:function(){ca+=4*Cs},point:m,lineStart:m,lineEnd:m,polygonStart:function(){ha.reset(),pa.lineStart=le},polygonEnd:function(){var t=2*ha;ca+=0>t?4*Cs+t:t,pa.lineStart=pa.lineEnd=pa.point=m}};Vo.geo.bounds=function(){function t(t,e){b.push(_=[c=t,p=t]),h>e&&(h=e),e>f&&(f=e)}function e(e,n){var r=ce([e*ks,n*ks]);if(y){var i=pe(y,r),o=[i[1],-i[0],0],s=pe(o,i);me(s),s=ge(s);var u=e-d,l=u>0?1:-1,m=s[0]*Ms*l,g=os(u)>180;if(g^(m>l*d&&l*e>m)){var v=s[1]*Ms;v>f&&(f=v)}else if(m=(m+360)%360-180,g^(m>l*d&&l*e>m)){var v=-s[1]*Ms;h>v&&(h=v)}else h>n&&(h=n),n>f&&(f=n);g?d>e?a(c,e)>a(c,p)&&(p=e):a(e,p)>a(c,p)&&(c=e):p>=c?(c>e&&(c=e),e>p&&(p=e)):e>d?a(c,e)>a(c,p)&&(p=e):a(e,p)>a(c,p)&&(c=e)}else t(e,n);y=r,d=e}function n(){w.point=e}function r(){_[0]=c,_[1]=p,w.point=t,y=null}function i(t,n){if(y){var r=t-d;v+=os(r)>180?r+(r>0?360:-360):r}else m=t,g=n;pa.point(t,n),e(t,n)}function o(){pa.lineStart()}function s(){i(m,g),pa.lineEnd(),os(v)>Es&&(c=-(p=180)),_[0]=c,_[1]=p,y=null}function a(t,e){return(e-=t)<0?e+360:e}function u(t,e){return t[0]-e[0]}function l(t,e){return e[0]<=e[1]?e[0]<=t&&t<=e[1]:t<e[0]||e[1]<t}var c,h,p,f,d,m,g,y,v,b,_,w={point:t,lineStart:n,lineEnd:r,polygonStart:function(){w.point=i,w.lineStart=o,w.lineEnd=s,v=0,pa.polygonStart()},polygonEnd:function(){pa.polygonEnd(),w.point=t,w.lineStart=n,w.lineEnd=r,0>ha?(c=-(p=180),h=-(f=90)):v>Es?f=90:-Es>v&&(h=-90),_[0]=c,_[1]=p}};return function(t){f=p=-(c=h=1/0),b=[],Vo.geo.stream(t,w);var e=b.length;if(e){b.sort(u);for(var n,r=1,i=b[0],o=[i];e>r;++r)n=b[r],l(n[0],i)||l(n[1],i)?(a(i[0],n[1])>a(i[0],i[1])&&(i[1]=n[1]),a(n[0],i[1])>a(i[0],i[1])&&(i[0]=n[0])):o.push(i=n);for(var s,n,d=-(1/0),e=o.length-1,r=0,i=o[e];e>=r;i=n,++r)n=o[r],(s=a(i[1],n[0]))>d&&(d=s,c=n[0],p=i[1])}return b=_=null,c===1/0||h===1/0?[[0/0,0/0],[0/0,0/0]]:[[c,h],[p,f]]}}(),Vo.geo.centroid=function(t){fa=da=ma=ga=ya=va=ba=_a=wa=xa=Ca=0,Vo.geo.stream(t,Ta);var e=wa,n=xa,r=Ca,i=e*e+n*n+r*r;return Ns>i&&(e=va,n=ba,r=_a,Es>da&&(e=ma,n=ga,r=ya),i=e*e+n*n+r*r,Ns>i)?[0/0,0/0]:[Math.atan2(n,e)*Ms,Y(r/Math.sqrt(i))*Ms]};var fa,da,ma,ga,ya,va,ba,_a,wa,xa,Ca,Ta={sphere:m,point:ve,lineStart:_e,lineEnd:we,polygonStart:function(){Ta.lineStart=xe},polygonEnd:function(){Ta.lineStart=_e}},Sa=Ne(Ce,Ae,Ie,[-Cs,-Cs/2]),Ea=1e9;Vo.geo.clipExtent=function(){var t,e,n,r,i,o,s={stream:function(t){return i&&(i.valid=!1),i=o(t),i.valid=!0,i},extent:function(a){return arguments.length?(o=qe(t=+a[0][0],e=+a[0][1],n=+a[1][0],r=+a[1][1]),i&&(i.valid=!1,i=null),s):[[t,e],[n,r]]}};return s.extent([[0,0],[960,500]])},(Vo.geo.conicEqualArea=function(){return $e(Fe)}).raw=Fe,Vo.geo.albers=function(){return Vo.geo.conicEqualArea().rotate([96,0]).center([-.6,38.7]).parallels([29.5,45.5]).scale(1070)},Vo.geo.albersUsa=function(){function t(t){var o=t[0],s=t[1];return e=null,n(o,s),e||(r(o,s),e)||i(o,s),e}var e,n,r,i,o=Vo.geo.albers(),s=Vo.geo.conicEqualArea().rotate([154,0]).center([-2,58.5]).parallels([55,65]),a=Vo.geo.conicEqualArea().rotate([157,0]).center([-3,19.9]).parallels([8,18]),u={point:function(t,n){e=[t,n]}};return t.invert=function(t){var e=o.scale(),n=o.translate(),r=(t[0]-n[0])/e,i=(t[1]-n[1])/e;return(i>=.12&&.234>i&&r>=-.425&&-.214>r?s:i>=.166&&.234>i&&r>=-.214&&-.115>r?a:o).invert(t)},t.stream=function(t){var e=o.stream(t),n=s.stream(t),r=a.stream(t);return{point:function(t,i){e.point(t,i),n.point(t,i),r.point(t,i)},sphere:function(){e.sphere(),n.sphere(),r.sphere()},lineStart:function(){e.lineStart(),n.lineStart(),r.lineStart()},lineEnd:function(){e.lineEnd(),n.lineEnd(),r.lineEnd()},polygonStart:function(){e.polygonStart(),n.polygonStart(),r.polygonStart()},polygonEnd:function(){e.polygonEnd(),n.polygonEnd(),r.polygonEnd()}}},t.precision=function(e){return arguments.length?(o.precision(e),s.precision(e),a.precision(e),t):o.precision()},t.scale=function(e){return arguments.length?(o.scale(e),s.scale(.35*e),a.scale(e),t.translate(o.translate())):o.scale()},t.translate=function(e){if(!arguments.length)return o.translate();var l=o.scale(),c=+e[0],h=+e[1];return n=o.translate(e).clipExtent([[c-.455*l,h-.238*l],[c+.455*l,h+.238*l]]).stream(u).point,r=s.translate([c-.307*l,h+.201*l]).clipExtent([[c-.425*l+Es,h+.12*l+Es],[c-.214*l-Es,h+.234*l-Es]]).stream(u).point,i=a.translate([c-.205*l,h+.212*l]).clipExtent([[c-.214*l+Es,h+.166*l+Es],[c-.115*l-Es,h+.234*l-Es]]).stream(u).point,t},t.scale(1070)};var Na,ka,Ma,Pa,Oa,Aa,Ra={point:m,lineStart:m,lineEnd:m,polygonStart:function(){ka=0,Ra.lineStart=ze},polygonEnd:function(){Ra.lineStart=Ra.lineEnd=Ra.point=m,Na+=os(ka/2)}},Ia={point:Ue,lineStart:m,lineEnd:m,polygonStart:m,polygonEnd:m},Da={point:Ve,lineStart:We,lineEnd:Je,polygonStart:function(){Da.lineStart=Ge},polygonEnd:function(){Da.point=Ve,Da.lineStart=We,Da.lineEnd=Je}};Vo.geo.path=function(){function t(t){return t&&("function"==typeof a&&o.pointRadius(+a.apply(this,arguments)),s&&s.valid||(s=i(o)),Vo.geo.stream(t,s)),o.result()}function e(){return s=null,t}var n,r,i,o,s,a=4.5;return t.area=function(t){return Na=0,Vo.geo.stream(t,i(Ra)),Na},t.centroid=function(t){return ma=ga=ya=va=ba=_a=wa=xa=Ca=0,Vo.geo.stream(t,i(Da)),Ca?[wa/Ca,xa/Ca]:_a?[va/_a,ba/_a]:ya?[ma/ya,ga/ya]:[0/0,0/0]},t.bounds=function(t){return Oa=Aa=-(Ma=Pa=1/0),Vo.geo.stream(t,i(Ia)),[[Ma,Pa],[Oa,Aa]]},t.projection=function(t){return arguments.length?(i=(n=t)?t.stream||Ye(t):Ct,e()):n},t.context=function(t){return arguments.length?(o=null==(r=t)?new He:new Xe(t),"function"!=typeof a&&o.pointRadius(a),e()):r},t.pointRadius=function(e){return arguments.length?(a="function"==typeof e?e:(o.pointRadius(+e),+e),t):a},t.projection(Vo.geo.albersUsa()).context(null)},Vo.geo.transform=function(t){return{stream:function(e){var n=new Ke(e);for(var r in t)n[r]=t[r];return n}}},Ke.prototype={point:function(t,e){this.stream.point(t,e)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}},Vo.geo.projection=tn,Vo.geo.projectionMutator=en,(Vo.geo.equirectangular=function(){return tn(rn)}).raw=rn.invert=rn,Vo.geo.rotation=function(t){function e(e){return e=t(e[0]*ks,e[1]*ks),e[0]*=Ms,e[1]*=Ms,e}return t=sn(t[0]%360*ks,t[1]*ks,t.length>2?t[2]*ks:0),e.invert=function(e){return e=t.invert(e[0]*ks,e[1]*ks),e[0]*=Ms,e[1]*=Ms,e},e},on.invert=rn,Vo.geo.circle=function(){function t(){var t="function"==typeof r?r.apply(this,arguments):r,e=sn(-t[0]*ks,-t[1]*ks,0).invert,i=[];return n(null,null,1,{point:function(t,n){i.push(t=e(t,n)),t[0]*=Ms,t[1]*=Ms}}),{type:"Polygon",coordinates:[i]}}var e,n,r=[0,0],i=6;return t.origin=function(e){return arguments.length?(r=e,t):r},t.angle=function(r){return arguments.length?(n=cn((e=+r)*ks,i*ks),t):e},t.precision=function(r){return arguments.length?(n=cn(e*ks,(i=+r)*ks),t):i},t.angle(90)},Vo.geo.distance=function(t,e){var n,r=(e[0]-t[0])*ks,i=t[1]*ks,o=e[1]*ks,s=Math.sin(r),a=Math.cos(r),u=Math.sin(i),l=Math.cos(i),c=Math.sin(o),h=Math.cos(o);return Math.atan2(Math.sqrt((n=h*s)*n+(n=l*c-u*h*a)*n),u*c+l*h*a)},Vo.geo.graticule=function(){function t(){return{type:"MultiLineString",coordinates:e()}}function e(){return Vo.range(Math.ceil(o/g)*g,i,g).map(p).concat(Vo.range(Math.ceil(l/y)*y,u,y).map(f)).concat(Vo.range(Math.ceil(r/d)*d,n,d).filter(function(t){return os(t%g)>Es}).map(c)).concat(Vo.range(Math.ceil(a/m)*m,s,m).filter(function(t){return os(t%y)>Es}).map(h))}var n,r,i,o,s,a,u,l,c,h,p,f,d=10,m=d,g=90,y=360,v=2.5;return t.lines=function(){return e().map(function(t){return{type:"LineString",coordinates:t}})},t.outline=function(){return{type:"Polygon",coordinates:[p(o).concat(f(u).slice(1),p(i).reverse().slice(1),f(l).reverse().slice(1))]}},t.extent=function(e){return arguments.length?t.majorExtent(e).minorExtent(e):t.minorExtent();

},t.majorExtent=function(e){return arguments.length?(o=+e[0][0],i=+e[1][0],l=+e[0][1],u=+e[1][1],o>i&&(e=o,o=i,i=e),l>u&&(e=l,l=u,u=e),t.precision(v)):[[o,l],[i,u]]},t.minorExtent=function(e){return arguments.length?(r=+e[0][0],n=+e[1][0],a=+e[0][1],s=+e[1][1],r>n&&(e=r,r=n,n=e),a>s&&(e=a,a=s,s=e),t.precision(v)):[[r,a],[n,s]]},t.step=function(e){return arguments.length?t.majorStep(e).minorStep(e):t.minorStep()},t.majorStep=function(e){return arguments.length?(g=+e[0],y=+e[1],t):[g,y]},t.minorStep=function(e){return arguments.length?(d=+e[0],m=+e[1],t):[d,m]},t.precision=function(e){return arguments.length?(v=+e,c=pn(a,s,90),h=fn(r,n,v),p=pn(l,u,90),f=fn(o,i,v),t):v},t.majorExtent([[-180,-90+Es],[180,90-Es]]).minorExtent([[-180,-80-Es],[180,80+Es]])},Vo.geo.greatArc=function(){function t(){return{type:"LineString",coordinates:[e||r.apply(this,arguments),n||i.apply(this,arguments)]}}var e,n,r=dn,i=mn;return t.distance=function(){return Vo.geo.distance(e||r.apply(this,arguments),n||i.apply(this,arguments))},t.source=function(n){return arguments.length?(r=n,e="function"==typeof n?null:n,t):r},t.target=function(e){return arguments.length?(i=e,n="function"==typeof e?null:e,t):i},t.precision=function(){return arguments.length?t:0},t},Vo.geo.interpolate=function(t,e){return gn(t[0]*ks,t[1]*ks,e[0]*ks,e[1]*ks)},Vo.geo.length=function(t){return La=0,Vo.geo.stream(t,qa),La};var La,qa={sphere:m,point:m,lineStart:yn,lineEnd:m,polygonStart:m,polygonEnd:m},ja=vn(function(t){return Math.sqrt(2/(1+t))},function(t){return 2*Math.asin(t/2)});(Vo.geo.azimuthalEqualArea=function(){return tn(ja)}).raw=ja;var $a=vn(function(t){var e=Math.acos(t);return e&&e/Math.sin(e)},Ct);(Vo.geo.azimuthalEquidistant=function(){return tn($a)}).raw=$a,(Vo.geo.conicConformal=function(){return $e(bn)}).raw=bn,(Vo.geo.conicEquidistant=function(){return $e(_n)}).raw=_n;var Fa=vn(function(t){return 1/t},Math.atan);(Vo.geo.gnomonic=function(){return tn(Fa)}).raw=Fa,wn.invert=function(t,e){return[t,2*Math.atan(Math.exp(e))-Ss]},(Vo.geo.mercator=function(){return xn(wn)}).raw=wn;var za=vn(function(){return 1},Math.asin);(Vo.geo.orthographic=function(){return tn(za)}).raw=za;var Ua=vn(function(t){return 1/(1+t)},function(t){return 2*Math.atan(t)});(Vo.geo.stereographic=function(){return tn(Ua)}).raw=Ua,Cn.invert=function(t,e){return[-e,2*Math.atan(Math.exp(t))-Ss]},(Vo.geo.transverseMercator=function(){var t=xn(Cn),e=t.center,n=t.rotate;return t.center=function(t){return t?e([-t[1],t[0]]):(t=e(),[t[1],-t[0]])},t.rotate=function(t){return t?n([t[0],t[1],t.length>2?t[2]+90:90]):(t=n(),[t[0],t[1],t[2]-90])},n([0,0,90])}).raw=Cn,Vo.geom={},Vo.geom.hull=function(t){function e(t){if(t.length<3)return[];var e,i=xt(n),o=xt(r),s=t.length,a=[],u=[];for(e=0;s>e;e++)a.push([+i.call(this,t[e],e),+o.call(this,t[e],e),e]);for(a.sort(Nn),e=0;s>e;e++)u.push([a[e][0],-a[e][1]]);var l=En(a),c=En(u),h=c[0]===l[0],p=c[c.length-1]===l[l.length-1],f=[];for(e=l.length-1;e>=0;--e)f.push(t[a[l[e]][2]]);for(e=+h;e<c.length-p;++e)f.push(t[a[c[e]][2]]);return f}var n=Tn,r=Sn;return arguments.length?e(t):(e.x=function(t){return arguments.length?(n=t,e):n},e.y=function(t){return arguments.length?(r=t,e):r},e)},Vo.geom.polygon=function(t){return cs(t,Ha),t};var Ha=Vo.geom.polygon.prototype=[];Ha.area=function(){for(var t,e=-1,n=this.length,r=this[n-1],i=0;++e<n;)t=r,r=this[e],i+=t[1]*r[0]-t[0]*r[1];return.5*i},Ha.centroid=function(t){var e,n,r=-1,i=this.length,o=0,s=0,a=this[i-1];for(arguments.length||(t=-1/(6*this.area()));++r<i;)e=a,a=this[r],n=e[0]*a[1]-a[0]*e[1],o+=(e[0]+a[0])*n,s+=(e[1]+a[1])*n;return[o*t,s*t]},Ha.clip=function(t){for(var e,n,r,i,o,s,a=Pn(t),u=-1,l=this.length-Pn(this),c=this[l-1];++u<l;){for(e=t.slice(),t.length=0,i=this[u],o=e[(r=e.length-a)-1],n=-1;++n<r;)s=e[n],kn(s,c,i)?(kn(o,c,i)||t.push(Mn(o,s,c,i)),t.push(s)):kn(o,c,i)&&t.push(Mn(o,s,c,i)),o=s;a&&t.push(t[0]),c=i}return t};var Ba,Va,Wa,Ja,Ga,Xa=[],Qa=[];jn.prototype.prepare=function(){for(var t,e=this.edges,n=e.length;n--;)t=e[n].edge,t.b&&t.a||e.splice(n,1);return e.sort(Fn),e.length},Qn.prototype={start:function(){return this.edge.l===this.site?this.edge.a:this.edge.b},end:function(){return this.edge.l===this.site?this.edge.b:this.edge.a}},Yn.prototype={insert:function(t,e){var n,r,i;if(t){if(e.P=t,e.N=t.N,t.N&&(t.N.P=e),t.N=e,t.R){for(t=t.R;t.L;)t=t.L;t.L=e}else t.R=e;n=t}else this._?(t=er(this._),e.P=null,e.N=t,t.P=t.L=e,n=t):(e.P=e.N=null,this._=e,n=null);for(e.L=e.R=null,e.U=n,e.C=!0,t=e;n&&n.C;)r=n.U,n===r.L?(i=r.R,i&&i.C?(n.C=i.C=!1,r.C=!0,t=r):(t===n.R&&(Zn(this,n),t=n,n=t.U),n.C=!1,r.C=!0,tr(this,r))):(i=r.L,i&&i.C?(n.C=i.C=!1,r.C=!0,t=r):(t===n.L&&(tr(this,n),t=n,n=t.U),n.C=!1,r.C=!0,Zn(this,r))),n=t.U;this._.C=!1},remove:function(t){t.N&&(t.N.P=t.P),t.P&&(t.P.N=t.N),t.N=t.P=null;var e,n,r,i=t.U,o=t.L,s=t.R;if(n=o?s?er(s):o:s,i?i.L===t?i.L=n:i.R=n:this._=n,o&&s?(r=n.C,n.C=t.C,n.L=o,o.U=n,n!==s?(i=n.U,n.U=t.U,t=n.R,i.L=t,n.R=s,s.U=n):(n.U=i,i=n,t=n.R)):(r=t.C,t=n),t&&(t.U=i),!r){if(t&&t.C)return void(t.C=!1);do{if(t===this._)break;if(t===i.L){if(e=i.R,e.C&&(e.C=!1,i.C=!0,Zn(this,i),e=i.R),e.L&&e.L.C||e.R&&e.R.C){e.R&&e.R.C||(e.L.C=!1,e.C=!0,tr(this,e),e=i.R),e.C=i.C,i.C=e.R.C=!1,Zn(this,i),t=this._;break}}else if(e=i.L,e.C&&(e.C=!1,i.C=!0,tr(this,i),e=i.L),e.L&&e.L.C||e.R&&e.R.C){e.L&&e.L.C||(e.R.C=!1,e.C=!0,Zn(this,e),e=i.L),e.C=i.C,i.C=e.L.C=!1,tr(this,i),t=this._;break}e.C=!0,t=i,i=i.U}while(!t.C);t&&(t.C=!1)}}},Vo.geom.voronoi=function(t){function e(t){var e=new Array(t.length),r=a[0][0],i=a[0][1],o=a[1][0],s=a[1][1];return nr(n(t),a).cells.forEach(function(n,a){var u=n.edges,l=n.site,c=e[a]=u.length?u.map(function(t){var e=t.start();return[e.x,e.y]}):l.x>=r&&l.x<=o&&l.y>=i&&l.y<=s?[[r,s],[o,s],[o,i],[r,i]]:[];c.point=t[a]}),e}function n(t){return t.map(function(t,e){return{x:Math.round(o(t,e)/Es)*Es,y:Math.round(s(t,e)/Es)*Es,i:e}})}var r=Tn,i=Sn,o=r,s=i,a=Ya;return t?e(t):(e.links=function(t){return nr(n(t)).edges.filter(function(t){return t.l&&t.r}).map(function(e){return{source:t[e.l.i],target:t[e.r.i]}})},e.triangles=function(t){var e=[];return nr(n(t)).cells.forEach(function(n,r){for(var i,o,s=n.site,a=n.edges.sort(Fn),u=-1,l=a.length,c=a[l-1].edge,h=c.l===s?c.r:c.l;++u<l;)i=c,o=h,c=a[u].edge,h=c.l===s?c.r:c.l,r<o.i&&r<h.i&&ir(s,o,h)<0&&e.push([t[r],t[o.i],t[h.i]])}),e},e.x=function(t){return arguments.length?(o=xt(r=t),e):r},e.y=function(t){return arguments.length?(s=xt(i=t),e):i},e.clipExtent=function(t){return arguments.length?(a=null==t?Ya:t,e):a===Ya?null:a},e.size=function(t){return arguments.length?e.clipExtent(t&&[[0,0],t]):a===Ya?null:a&&a[1]},e)};var Ya=[[-1e6,-1e6],[1e6,1e6]];Vo.geom.delaunay=function(t){return Vo.geom.voronoi().triangles(t)},Vo.geom.quadtree=function(t,e,n,r,i){function o(t){function o(t,e,n,r,i,o,s,a){if(!isNaN(n)&&!isNaN(r))if(t.leaf){var u=t.x,c=t.y;if(null!=u)if(os(u-n)+os(c-r)<.01)l(t,e,n,r,i,o,s,a);else{var h=t.point;t.x=t.y=t.point=null,l(t,h,u,c,i,o,s,a),l(t,e,n,r,i,o,s,a)}else t.x=n,t.y=r,t.point=e}else l(t,e,n,r,i,o,s,a)}function l(t,e,n,r,i,s,a,u){var l=.5*(i+a),c=.5*(s+u),h=n>=l,p=r>=c,f=(p<<1)+h;t.leaf=!1,t=t.nodes[f]||(t.nodes[f]=ar()),h?i=l:a=l,p?s=c:u=c,o(t,e,n,r,i,s,a,u)}var c,h,p,f,d,m,g,y,v,b=xt(a),_=xt(u);if(null!=e)m=e,g=n,y=r,v=i;else if(y=v=-(m=g=1/0),h=[],p=[],d=t.length,s)for(f=0;d>f;++f)c=t[f],c.x<m&&(m=c.x),c.y<g&&(g=c.y),c.x>y&&(y=c.x),c.y>v&&(v=c.y),h.push(c.x),p.push(c.y);else for(f=0;d>f;++f){var w=+b(c=t[f],f),x=+_(c,f);m>w&&(m=w),g>x&&(g=x),w>y&&(y=w),x>v&&(v=x),h.push(w),p.push(x)}var C=y-m,T=v-g;C>T?v=g+C:y=m+T;var S=ar();if(S.add=function(t){o(S,t,+b(t,++f),+_(t,f),m,g,y,v)},S.visit=function(t){ur(t,S,m,g,y,v)},f=-1,null==e){for(;++f<d;)o(S,t[f],h[f],p[f],m,g,y,v);--f}else t.forEach(S.add);return h=p=t=c=null,S}var s,a=Tn,u=Sn;return(s=arguments.length)?(a=or,u=sr,3===s&&(i=n,r=e,n=e=0),o(t)):(o.x=function(t){return arguments.length?(a=t,o):a},o.y=function(t){return arguments.length?(u=t,o):u},o.extent=function(t){return arguments.length?(null==t?e=n=r=i=null:(e=+t[0][0],n=+t[0][1],r=+t[1][0],i=+t[1][1]),o):null==e?null:[[e,n],[r,i]]},o.size=function(t){return arguments.length?(null==t?e=n=r=i=null:(e=n=0,r=+t[0],i=+t[1]),o):null==e?null:[r-e,i-n]},o)},Vo.interpolateRgb=lr,Vo.interpolateObject=cr,Vo.interpolateNumber=hr,Vo.interpolateString=pr;var Ka=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g,Za=new RegExp(Ka.source,"g");Vo.interpolate=fr,Vo.interpolators=[function(t,e){var n=typeof e;return("string"===n?Bs.has(e)||/^(#|rgb\(|hsl\()/.test(e)?lr:pr:e instanceof nt?lr:Array.isArray(e)?dr:"object"===n&&isNaN(e)?cr:hr)(t,e)}],Vo.interpolateArray=dr;var tu=function(){return Ct},eu=Vo.map({linear:tu,poly:wr,quad:function(){return vr},cubic:function(){return br},sin:function(){return xr},exp:function(){return Cr},circle:function(){return Tr},elastic:Sr,back:Er,bounce:function(){return Nr}}),nu=Vo.map({"in":Ct,out:gr,"in-out":yr,"out-in":function(t){return yr(gr(t))}});Vo.ease=function(t){var e=t.indexOf("-"),n=e>=0?t.substring(0,e):t,r=e>=0?t.substring(e+1):"in";return n=eu.get(n)||tu,r=nu.get(r)||Ct,mr(r(n.apply(null,Wo.call(arguments,1))))},Vo.interpolateHcl=kr,Vo.interpolateHsl=Mr,Vo.interpolateLab=Pr,Vo.interpolateRound=Or,Vo.transform=function(t){var e=Go.createElementNS(Vo.ns.prefix.svg,"g");return(Vo.transform=function(t){if(null!=t){e.setAttribute("transform",t);var n=e.transform.baseVal.consolidate()}return new Ar(n?n.matrix:ru)})(t)},Ar.prototype.toString=function(){return"translate("+this.translate+")rotate("+this.rotate+")skewX("+this.skew+")scale("+this.scale+")"};var ru={a:1,b:0,c:0,d:1,e:0,f:0};Vo.interpolateTransform=Lr,Vo.layout={},Vo.layout.bundle=function(){return function(t){for(var e=[],n=-1,r=t.length;++n<r;)e.push($r(t[n]));return e}},Vo.layout.chord=function(){function t(){var t,l,h,p,f,d={},m=[],g=Vo.range(o),y=[];for(n=[],r=[],t=0,p=-1;++p<o;){for(l=0,f=-1;++f<o;)l+=i[p][f];m.push(l),y.push(Vo.range(o)),t+=l}for(s&&g.sort(function(t,e){return s(m[t],m[e])}),a&&y.forEach(function(t,e){t.sort(function(t,n){return a(i[e][t],i[e][n])})}),t=(Ts-c*o)/t,l=0,p=-1;++p<o;){for(h=l,f=-1;++f<o;){var v=g[p],b=y[v][f],_=i[v][b],w=l,x=l+=_*t;d[v+"-"+b]={index:v,subindex:b,startAngle:w,endAngle:x,value:_}}r[v]={index:v,startAngle:h,endAngle:l,value:(l-h)/t},l+=c}for(p=-1;++p<o;)for(f=p-1;++f<o;){var C=d[p+"-"+f],T=d[f+"-"+p];(C.value||T.value)&&n.push(C.value<T.value?{source:T,target:C}:{source:C,target:T})}u&&e()}function e(){n.sort(function(t,e){return u((t.source.value+t.target.value)/2,(e.source.value+e.target.value)/2)})}var n,r,i,o,s,a,u,l={},c=0;return l.matrix=function(t){return arguments.length?(o=(i=t)&&i.length,n=r=null,l):i},l.padding=function(t){return arguments.length?(c=t,n=r=null,l):c},l.sortGroups=function(t){return arguments.length?(s=t,n=r=null,l):s},l.sortSubgroups=function(t){return arguments.length?(a=t,n=null,l):a},l.sortChords=function(t){return arguments.length?(u=t,n&&e(),l):u},l.chords=function(){return n||t(),n},l.groups=function(){return r||t(),r},l},Vo.layout.force=function(){function t(t){return function(e,n,r,i){if(e.point!==t){var o=e.cx-t.x,s=e.cy-t.y,a=i-n,u=o*o+s*s;if(u>a*a/g){if(d>u){var l=e.charge/u;t.px-=o*l,t.py-=s*l}return!0}if(e.point&&u&&d>u){var l=e.pointCharge/u;t.px-=o*l,t.py-=s*l}}return!e.charge}}function e(t){t.px=Vo.event.x,t.py=Vo.event.y,a.resume()}var n,r,i,o,s,a={},u=Vo.dispatch("start","tick","end"),l=[1,1],c=.9,h=iu,p=ou,f=-30,d=su,m=.1,g=.64,y=[],v=[];return a.tick=function(){if((r*=.99)<.005)return u.end({type:"end",alpha:r=0}),!0;var e,n,a,h,p,d,g,b,_,w=y.length,x=v.length;for(n=0;x>n;++n)a=v[n],h=a.source,p=a.target,b=p.x-h.x,_=p.y-h.y,(d=b*b+_*_)&&(d=r*o[n]*((d=Math.sqrt(d))-i[n])/d,b*=d,_*=d,p.x-=b*(g=h.weight/(p.weight+h.weight)),p.y-=_*g,h.x+=b*(g=1-g),h.y+=_*g);if((g=r*m)&&(b=l[0]/2,_=l[1]/2,n=-1,g))for(;++n<w;)a=y[n],a.x+=(b-a.x)*g,a.y+=(_-a.y)*g;if(f)for(Wr(e=Vo.geom.quadtree(y),r,s),n=-1;++n<w;)(a=y[n]).fixed||e.visit(t(a));for(n=-1;++n<w;)a=y[n],a.fixed?(a.x=a.px,a.y=a.py):(a.x-=(a.px-(a.px=a.x))*c,a.y-=(a.py-(a.py=a.y))*c);u.tick({type:"tick",alpha:r})},a.nodes=function(t){return arguments.length?(y=t,a):y},a.links=function(t){return arguments.length?(v=t,a):v},a.size=function(t){return arguments.length?(l=t,a):l},a.linkDistance=function(t){return arguments.length?(h="function"==typeof t?t:+t,a):h},a.distance=a.linkDistance,a.linkStrength=function(t){return arguments.length?(p="function"==typeof t?t:+t,a):p},a.friction=function(t){return arguments.length?(c=+t,a):c},a.charge=function(t){return arguments.length?(f="function"==typeof t?t:+t,a):f},a.chargeDistance=function(t){return arguments.length?(d=t*t,a):Math.sqrt(d)},a.gravity=function(t){return arguments.length?(m=+t,a):m},a.theta=function(t){return arguments.length?(g=t*t,a):Math.sqrt(g)},a.alpha=function(t){return arguments.length?(t=+t,r?r=t>0?t:0:t>0&&(u.start({type:"start",alpha:r=t}),Vo.timer(a.tick)),a):r},a.start=function(){function t(t,r){if(!n){for(n=new Array(u),a=0;u>a;++a)n[a]=[];for(a=0;l>a;++a){var i=v[a];n[i.source.index].push(i.target),n[i.target.index].push(i.source)}}for(var o,s=n[e],a=-1,l=s.length;++a<l;)if(!isNaN(o=s[a][t]))return o;return Math.random()*r}var e,n,r,u=y.length,c=v.length,d=l[0],m=l[1];for(e=0;u>e;++e)(r=y[e]).index=e,r.weight=0;for(e=0;c>e;++e)r=v[e],"number"==typeof r.source&&(r.source=y[r.source]),"number"==typeof r.target&&(r.target=y[r.target]),++r.source.weight,++r.target.weight;for(e=0;u>e;++e)r=y[e],isNaN(r.x)&&(r.x=t("x",d)),isNaN(r.y)&&(r.y=t("y",m)),isNaN(r.px)&&(r.px=r.x),isNaN(r.py)&&(r.py=r.y);if(i=[],"function"==typeof h)for(e=0;c>e;++e)i[e]=+h.call(this,v[e],e);else for(e=0;c>e;++e)i[e]=h;if(o=[],"function"==typeof p)for(e=0;c>e;++e)o[e]=+p.call(this,v[e],e);else for(e=0;c>e;++e)o[e]=p;if(s=[],"function"==typeof f)for(e=0;u>e;++e)s[e]=+f.call(this,y[e],e);else for(e=0;u>e;++e)s[e]=f;return a.resume()},a.resume=function(){return a.alpha(.1)},a.stop=function(){return a.alpha(0)},a.drag=function(){return n||(n=Vo.behavior.drag().origin(Ct).on("dragstart.force",Ur).on("drag.force",e).on("dragend.force",Hr)),arguments.length?void this.on("mouseover.force",Br).on("mouseout.force",Vr).call(n):n},Vo.rebind(a,u,"on")};var iu=20,ou=1,su=1/0;Vo.layout.hierarchy=function(){function t(i){var o,s=[i],a=[];for(i.depth=0;null!=(o=s.pop());)if(a.push(o),(l=n.call(t,o,o.depth))&&(u=l.length)){for(var u,l,c;--u>=0;)s.push(c=l[u]),c.parent=o,c.depth=o.depth+1;r&&(o.value=0),o.children=l}else r&&(o.value=+r.call(t,o,o.depth)||0),delete o.children;return Xr(i,function(t){var n,i;e&&(n=t.children)&&n.sort(e),r&&(i=t.parent)&&(i.value+=t.value)}),a}var e=Kr,n=Qr,r=Yr;return t.sort=function(n){return arguments.length?(e=n,t):e},t.children=function(e){return arguments.length?(n=e,t):n},t.value=function(e){return arguments.length?(r=e,t):r},t.revalue=function(e){return r&&(Gr(e,function(t){t.children&&(t.value=0)}),Xr(e,function(e){var n;e.children||(e.value=+r.call(t,e,e.depth)||0),(n=e.parent)&&(n.value+=e.value)})),e},t},Vo.layout.partition=function(){function t(e,n,r,i){var o=e.children;if(e.x=n,e.y=e.depth*i,e.dx=r,e.dy=i,o&&(s=o.length)){var s,a,u,l=-1;for(r=e.value?r/e.value:0;++l<s;)t(a=o[l],n,u=a.value*r,i),n+=u}}function e(t){var n=t.children,r=0;if(n&&(i=n.length))for(var i,o=-1;++o<i;)r=Math.max(r,e(n[o]));return 1+r}function n(n,o){var s=r.call(this,n,o);return t(s[0],0,i[0],i[1]/e(s[0])),s}var r=Vo.layout.hierarchy(),i=[1,1];return n.size=function(t){return arguments.length?(i=t,n):i},Jr(n,r)},Vo.layout.pie=function(){function t(o){var s=o.map(function(n,r){return+e.call(t,n,r)}),a=+("function"==typeof r?r.apply(this,arguments):r),u=(("function"==typeof i?i.apply(this,arguments):i)-a)/Vo.sum(s),l=Vo.range(o.length);null!=n&&l.sort(n===au?function(t,e){return s[e]-s[t]}:function(t,e){return n(o[t],o[e])});var c=[];return l.forEach(function(t){var e;c[t]={data:o[t],value:e=s[t],startAngle:a,endAngle:a+=e*u}}),c}var e=Number,n=au,r=0,i=Ts;return t.value=function(n){return arguments.length?(e=n,t):e},t.sort=function(e){return arguments.length?(n=e,t):n},t.startAngle=function(e){return arguments.length?(r=e,t):r},t.endAngle=function(e){return arguments.length?(i=e,t):i},t};var au={};Vo.layout.stack=function(){function t(a,u){var l=a.map(function(n,r){return e.call(t,n,r)}),c=l.map(function(e){return e.map(function(e,n){return[o.call(t,e,n),s.call(t,e,n)]})}),h=n.call(t,c,u);l=Vo.permute(l,h),c=Vo.permute(c,h);var p,f,d,m=r.call(t,c,u),g=l.length,y=l[0].length;for(f=0;y>f;++f)for(i.call(t,l[0][f],d=m[f],c[0][f][1]),p=1;g>p;++p)i.call(t,l[p][f],d+=c[p-1][f][1],c[p][f][1]);return a}var e=Ct,n=ri,r=ii,i=ni,o=ti,s=ei;return t.values=function(n){return arguments.length?(e=n,t):e},t.order=function(e){return arguments.length?(n="function"==typeof e?e:uu.get(e)||ri,t):n},t.offset=function(e){return arguments.length?(r="function"==typeof e?e:lu.get(e)||ii,t):r},t.x=function(e){return arguments.length?(o=e,t):o},t.y=function(e){return arguments.length?(s=e,t):s},t.out=function(e){return arguments.length?(i=e,t):i},t};var uu=Vo.map({"inside-out":function(t){var e,n,r=t.length,i=t.map(oi),o=t.map(si),s=Vo.range(r).sort(function(t,e){return i[t]-i[e]}),a=0,u=0,l=[],c=[];for(e=0;r>e;++e)n=s[e],u>a?(a+=o[n],l.push(n)):(u+=o[n],c.push(n));return c.reverse().concat(l)},reverse:function(t){return Vo.range(t.length).reverse()},"default":ri}),lu=Vo.map({silhouette:function(t){var e,n,r,i=t.length,o=t[0].length,s=[],a=0,u=[];for(n=0;o>n;++n){for(e=0,r=0;i>e;e++)r+=t[e][n][1];r>a&&(a=r),s.push(r)}for(n=0;o>n;++n)u[n]=(a-s[n])/2;return u},wiggle:function(t){var e,n,r,i,o,s,a,u,l,c=t.length,h=t[0],p=h.length,f=[];for(f[0]=u=l=0,n=1;p>n;++n){for(e=0,i=0;c>e;++e)i+=t[e][n][1];for(e=0,o=0,a=h[n][0]-h[n-1][0];c>e;++e){for(r=0,s=(t[e][n][1]-t[e][n-1][1])/(2*a);e>r;++r)s+=(t[r][n][1]-t[r][n-1][1])/a;o+=s*t[e][n][1]}f[n]=u-=i?o/i*a:0,l>u&&(l=u)}for(n=0;p>n;++n)f[n]-=l;return f},expand:function(t){var e,n,r,i=t.length,o=t[0].length,s=1/i,a=[];for(n=0;o>n;++n){for(e=0,r=0;i>e;e++)r+=t[e][n][1];if(r)for(e=0;i>e;e++)t[e][n][1]/=r;else for(e=0;i>e;e++)t[e][n][1]=s}for(n=0;o>n;++n)a[n]=0;return a},zero:ii});Vo.layout.histogram=function(){function t(t,o){for(var s,a,u=[],l=t.map(n,this),c=r.call(this,l,o),h=i.call(this,c,l,o),o=-1,p=l.length,f=h.length-1,d=e?1:1/p;++o<f;)s=u[o]=[],s.dx=h[o+1]-(s.x=h[o]),s.y=0;if(f>0)for(o=-1;++o<p;)a=l[o],a>=c[0]&&a<=c[1]&&(s=u[Vo.bisect(h,a,1,f)-1],s.y+=d,s.push(t[o]));return u}var e=!0,n=Number,r=ci,i=ui;return t.value=function(e){return arguments.length?(n=e,t):n},t.range=function(e){return arguments.length?(r=xt(e),t):r},t.bins=function(e){return arguments.length?(i="number"==typeof e?function(t){return li(t,e)}:xt(e),t):i},t.frequency=function(n){return arguments.length?(e=!!n,t):e},t},Vo.layout.pack=function(){function t(t,o){var s=n.call(this,t,o),a=s[0],u=i[0],l=i[1],c=null==e?Math.sqrt:"function"==typeof e?e:function(){return e};if(a.x=a.y=0,Xr(a,function(t){t.r=+c(t.value)}),Xr(a,mi),r){var h=r*(e?1:Math.max(2*a.r/u,2*a.r/l))/2;Xr(a,function(t){t.r+=h}),Xr(a,mi),Xr(a,function(t){t.r-=h})}return vi(a,u/2,l/2,e?1:1/Math.max(2*a.r/u,2*a.r/l)),s}var e,n=Vo.layout.hierarchy().sort(hi),r=0,i=[1,1];return t.size=function(e){return arguments.length?(i=e,t):i},t.radius=function(n){return arguments.length?(e=null==n||"function"==typeof n?n:+n,t):e},t.padding=function(e){return arguments.length?(r=+e,t):r},Jr(t,n)},Vo.layout.tree=function(){function t(t,i){var c=s.call(this,t,i),h=c[0],p=e(h);if(Xr(p,n),p.parent.m=-p.z,Gr(p,r),l)Gr(h,o);else{var f=h,d=h,m=h;Gr(h,function(t){t.x<f.x&&(f=t),t.x>d.x&&(d=t),t.depth>m.depth&&(m=t)});var g=a(f,d)/2-f.x,y=u[0]/(d.x+a(d,f)/2+g),v=u[1]/(m.depth||1);Gr(h,function(t){t.x=(t.x+g)*y,t.y=t.depth*v})}return c}function e(t){for(var e,n={A:null,children:[t]},r=[n];null!=(e=r.pop());)for(var i,o=e.children,s=0,a=o.length;a>s;++s)r.push((o[s]=i={_:o[s],parent:e,children:(i=o[s].children)&&i.slice()||[],A:null,a:null,z:0,m:0,c:0,s:0,t:null,i:s}).a=i);return n.children[0]}function n(t){var e=t.children,n=t.parent.children,r=t.i?n[t.i-1]:null;if(e.length){Ti(t);var o=(e[0].z+e[e.length-1].z)/2;r?(t.z=r.z+a(t._,r._),t.m=t.z-o):t.z=o}else r&&(t.z=r.z+a(t._,r._));t.parent.A=i(t,r,t.parent.A||n[0])}function r(t){t._.x=t.z+t.parent.m,t.m+=t.parent.m}function i(t,e,n){if(e){for(var r,i=t,o=t,s=e,u=i.parent.children[0],l=i.m,c=o.m,h=s.m,p=u.m;s=xi(s),i=wi(i),s&&i;)u=wi(u),o=xi(o),o.a=t,r=s.z+h-i.z-l+a(s._,i._),r>0&&(Ci(Si(s,t,n),t,r),l+=r,c+=r),h+=s.m,l+=i.m,p+=u.m,c+=o.m;s&&!xi(o)&&(o.t=s,o.m+=h-c),i&&!wi(u)&&(u.t=i,u.m+=l-p,n=t)}return n}function o(t){t.x*=u[0],t.y=t.depth*u[1]}var s=Vo.layout.hierarchy().sort(null).value(null),a=_i,u=[1,1],l=null;return t.separation=function(e){return arguments.length?(a=e,t):a},t.size=function(e){return arguments.length?(l=null==(u=e)?o:null,t):l?null:u},t.nodeSize=function(e){return arguments.length?(l=null==(u=e)?null:o,t):l?u:null},Jr(t,s)},Vo.layout.cluster=function(){function t(t,o){var s,a=e.call(this,t,o),u=a[0],l=0;Xr(u,function(t){var e=t.children;e&&e.length?(t.x=Ni(e),t.y=Ei(e)):(t.x=s?l+=n(t,s):0,t.y=0,s=t)});var c=ki(u),h=Mi(u),p=c.x-n(c,h)/2,f=h.x+n(h,c)/2;return Xr(u,i?function(t){t.x=(t.x-u.x)*r[0],t.y=(u.y-t.y)*r[1]}:function(t){t.x=(t.x-p)/(f-p)*r[0],t.y=(1-(u.y?t.y/u.y:1))*r[1]}),a}var e=Vo.layout.hierarchy().sort(null).value(null),n=_i,r=[1,1],i=!1;return t.separation=function(e){return arguments.length?(n=e,t):n},t.size=function(e){return arguments.length?(i=null==(r=e),t):i?null:r},t.nodeSize=function(e){return arguments.length?(i=null!=(r=e),t):i?r:null},Jr(t,e)},Vo.layout.treemap=function(){function t(t,e){for(var n,r,i=-1,o=t.length;++i<o;)r=(n=t[i]).value*(0>e?0:e),n.area=isNaN(r)||0>=r?0:r}function e(n){var o=n.children;if(o&&o.length){var s,a,u,l=h(n),c=[],p=o.slice(),d=1/0,m="slice"===f?l.dx:"dice"===f?l.dy:"slice-dice"===f?1&n.depth?l.dy:l.dx:Math.min(l.dx,l.dy);for(t(p,l.dx*l.dy/n.value),c.area=0;(u=p.length)>0;)c.push(s=p[u-1]),c.area+=s.area,"squarify"!==f||(a=r(c,m))<=d?(p.pop(),d=a):(c.area-=c.pop().area,i(c,m,l,!1),m=Math.min(l.dx,l.dy),c.length=c.area=0,d=1/0);c.length&&(i(c,m,l,!0),c.length=c.area=0),o.forEach(e)}}function n(e){var r=e.children;if(r&&r.length){var o,s=h(e),a=r.slice(),u=[];for(t(a,s.dx*s.dy/e.value),u.area=0;o=a.pop();)u.push(o),u.area+=o.area,null!=o.z&&(i(u,o.z?s.dx:s.dy,s,!a.length),u.length=u.area=0);r.forEach(n)}}function r(t,e){for(var n,r=t.area,i=0,o=1/0,s=-1,a=t.length;++s<a;)(n=t[s].area)&&(o>n&&(o=n),n>i&&(i=n));return r*=r,e*=e,r?Math.max(e*i*d/r,r/(e*o*d)):1/0}function i(t,e,n,r){var i,o=-1,s=t.length,a=n.x,l=n.y,c=e?u(t.area/e):0;if(e==n.dx){for((r||c>n.dy)&&(c=n.dy);++o<s;)i=t[o],i.x=a,i.y=l,i.dy=c,a+=i.dx=Math.min(n.x+n.dx-a,c?u(i.area/c):0);i.z=!0,i.dx+=n.x+n.dx-a,n.y+=c,n.dy-=c}else{for((r||c>n.dx)&&(c=n.dx);++o<s;)i=t[o],i.x=a,i.y=l,i.dx=c,l+=i.dy=Math.min(n.y+n.dy-l,c?u(i.area/c):0);i.z=!1,i.dy+=n.y+n.dy-l,n.x+=c,n.dx-=c}}function o(r){var i=s||a(r),o=i[0];return o.x=0,o.y=0,o.dx=l[0],o.dy=l[1],s&&a.revalue(o),t([o],o.dx*o.dy/o.value),(s?n:e)(o),p&&(s=i),i}var s,a=Vo.layout.hierarchy(),u=Math.round,l=[1,1],c=null,h=Pi,p=!1,f="squarify",d=.5*(1+Math.sqrt(5));return o.size=function(t){return arguments.length?(l=t,o):l},o.padding=function(t){function e(e){var n=t.call(o,e,e.depth);return null==n?Pi(e):Oi(e,"number"==typeof n?[n,n,n,n]:n)}function n(e){return Oi(e,t)}if(!arguments.length)return c;var r;return h=null==(c=t)?Pi:"function"==(r=typeof t)?e:"number"===r?(t=[t,t,t,t],n):n,o},o.round=function(t){return arguments.length?(u=t?Math.round:Number,o):u!=Number},o.sticky=function(t){return arguments.length?(p=t,s=null,o):p},o.ratio=function(t){return arguments.length?(d=t,o):d},o.mode=function(t){return arguments.length?(f=t+"",o):f},Jr(o,a)},Vo.random={normal:function(t,e){var n=arguments.length;return 2>n&&(e=1),1>n&&(t=0),function(){var n,r,i;do n=2*Math.random()-1,r=2*Math.random()-1,i=n*n+r*r;while(!i||i>1);return t+e*n*Math.sqrt(-2*Math.log(i)/i)}},logNormal:function(){var t=Vo.random.normal.apply(Vo,arguments);return function(){return Math.exp(t())}},bates:function(t){var e=Vo.random.irwinHall(t);return function(){return e()/t}},irwinHall:function(t){return function(){for(var e=0,n=0;t>n;n++)e+=Math.random();return e}}},Vo.scale={};var cu={floor:Ct,ceil:Ct};Vo.scale.linear=function(){return ji([0,1],[0,1],fr,!1)};var hu={s:1,g:1,p:1,r:1,e:1};Vo.scale.log=function(){return Wi(Vo.scale.linear().domain([0,1]),10,!0,[1,10])};var pu=Vo.format(".0e"),fu={floor:function(t){return-Math.ceil(-t)},ceil:function(t){return-Math.floor(-t)}};Vo.scale.pow=function(){return Ji(Vo.scale.linear(),1,[0,1])},Vo.scale.sqrt=function(){return Vo.scale.pow().exponent(.5)},Vo.scale.ordinal=function(){return Xi([],{t:"range",a:[[]]})},Vo.scale.category10=function(){return Vo.scale.ordinal().range(du)},Vo.scale.category20=function(){return Vo.scale.ordinal().range(mu)},Vo.scale.category20b=function(){return Vo.scale.ordinal().range(gu)},Vo.scale.category20c=function(){return Vo.scale.ordinal().range(yu)};var du=[2062260,16744206,2924588,14034728,9725885,9197131,14907330,8355711,12369186,1556175].map(mt),mu=[2062260,11454440,16744206,16759672,2924588,10018698,14034728,16750742,9725885,12955861,9197131,12885140,14907330,16234194,8355711,13092807,12369186,14408589,1556175,10410725].map(mt),gu=[3750777,5395619,7040719,10264286,6519097,9216594,11915115,13556636,9202993,12426809,15186514,15190932,8666169,11356490,14049643,15177372,8077683,10834324,13528509,14589654].map(mt),yu=[3244733,7057110,10406625,13032431,15095053,16616764,16625259,16634018,3253076,7652470,10607003,13101504,7695281,10394312,12369372,14342891,6513507,9868950,12434877,14277081].map(mt);Vo.scale.quantile=function(){return Qi([],[])},Vo.scale.quantize=function(){return Yi(0,1,[0,1])},Vo.scale.threshold=function(){return Ki([.5],[0,1])},Vo.scale.identity=function(){return Zi([0,1])},Vo.svg={},Vo.svg.arc=function(){function t(){var t=e.apply(this,arguments),o=n.apply(this,arguments),s=r.apply(this,arguments)+vu,a=i.apply(this,arguments)+vu,u=(s>a&&(u=s,s=a,a=u),a-s),l=Cs>u?"0":"1",c=Math.cos(s),h=Math.sin(s),p=Math.cos(a),f=Math.sin(a);return u>=bu?t?"M0,"+o+"A"+o+","+o+" 0 1,1 0,"+-o+"A"+o+","+o+" 0 1,1 0,"+o+"M0,"+t+"A"+t+","+t+" 0 1,0 0,"+-t+"A"+t+","+t+" 0 1,0 0,"+t+"Z":"M0,"+o+"A"+o+","+o+" 0 1,1 0,"+-o+"A"+o+","+o+" 0 1,1 0,"+o+"Z":t?"M"+o*c+","+o*h+"A"+o+","+o+" 0 "+l+",1 "+o*p+","+o*f+"L"+t*p+","+t*f+"A"+t+","+t+" 0 "+l+",0 "+t*c+","+t*h+"Z":"M"+o*c+","+o*h+"A"+o+","+o+" 0 "+l+",1 "+o*p+","+o*f+"L0,0Z"}var e=to,n=eo,r=no,i=ro;return t.innerRadius=function(n){return arguments.length?(e=xt(n),t):e},t.outerRadius=function(e){return arguments.length?(n=xt(e),t):n},t.startAngle=function(e){return arguments.length?(r=xt(e),t):r},t.endAngle=function(e){return arguments.length?(i=xt(e),t):i},t.centroid=function(){var t=(e.apply(this,arguments)+n.apply(this,arguments))/2,o=(r.apply(this,arguments)+i.apply(this,arguments))/2+vu;return[Math.cos(o)*t,Math.sin(o)*t]},t};var vu=-Ss,bu=Ts-Es;Vo.svg.line=function(){return io(Ct)};var _u=Vo.map({linear:oo,"linear-closed":so,step:ao,"step-before":uo,"step-after":lo,basis:go,"basis-open":yo,"basis-closed":vo,bundle:bo,cardinal:po,"cardinal-open":co,"cardinal-closed":ho,monotone:So});_u.forEach(function(t,e){e.key=t,e.closed=/-closed$/.test(t)});var wu=[0,2/3,1/3,0],xu=[0,1/3,2/3,0],Cu=[0,1/6,2/3,1/6];Vo.svg.line.radial=function(){var t=io(Eo);return t.radius=t.x,delete t.x,t.angle=t.y,delete t.y,t},uo.reverse=lo,lo.reverse=uo,Vo.svg.area=function(){return No(Ct)},Vo.svg.area.radial=function(){var t=No(Eo);return t.radius=t.x,delete t.x,t.innerRadius=t.x0,delete t.x0,t.outerRadius=t.x1,delete t.x1,t.angle=t.y,delete t.y,t.startAngle=t.y0,delete t.y0,t.endAngle=t.y1,delete t.y1,t},Vo.svg.chord=function(){function t(t,a){var u=e(this,o,t,a),l=e(this,s,t,a);return"M"+u.p0+r(u.r,u.p1,u.a1-u.a0)+(n(u,l)?i(u.r,u.p1,u.r,u.p0):i(u.r,u.p1,l.r,l.p0)+r(l.r,l.p1,l.a1-l.a0)+i(l.r,l.p1,u.r,u.p0))+"Z"}function e(t,e,n,r){var i=e.call(t,n,r),o=a.call(t,i,r),s=u.call(t,i,r)+vu,c=l.call(t,i,r)+vu;return{r:o,a0:s,a1:c,p0:[o*Math.cos(s),o*Math.sin(s)],p1:[o*Math.cos(c),o*Math.sin(c)]}}function n(t,e){return t.a0==e.a0&&t.a1==e.a1}function r(t,e,n){return"A"+t+","+t+" 0 "+ +(n>Cs)+",1 "+e}function i(t,e,n,r){return"Q 0,0 "+r}var o=dn,s=mn,a=ko,u=no,l=ro;return t.radius=function(e){return arguments.length?(a=xt(e),t):a},t.source=function(e){return arguments.length?(o=xt(e),t):o},t.target=function(e){return arguments.length?(s=xt(e),t):s},t.startAngle=function(e){return arguments.length?(u=xt(e),t):u},t.endAngle=function(e){return arguments.length?(l=xt(e),t):l},t},Vo.svg.diagonal=function(){function t(t,i){var o=e.call(this,t,i),s=n.call(this,t,i),a=(o.y+s.y)/2,u=[o,{x:o.x,y:a},{x:s.x,y:a},s];return u=u.map(r),"M"+u[0]+"C"+u[1]+" "+u[2]+" "+u[3]}var e=dn,n=mn,r=Mo;return t.source=function(n){return arguments.length?(e=xt(n),t):e},t.target=function(e){return arguments.length?(n=xt(e),t):n},t.projection=function(e){return arguments.length?(r=e,t):r},t},Vo.svg.diagonal.radial=function(){var t=Vo.svg.diagonal(),e=Mo,n=t.projection;return t.projection=function(t){return arguments.length?n(Po(e=t)):e},t},Vo.svg.symbol=function(){function t(t,r){return(Tu.get(e.call(this,t,r))||Ro)(n.call(this,t,r))}var e=Ao,n=Oo;return t.type=function(n){return arguments.length?(e=xt(n),t):e},t.size=function(e){return arguments.length?(n=xt(e),t):n},t};var Tu=Vo.map({circle:Ro,cross:function(t){var e=Math.sqrt(t/5)/2;return"M"+-3*e+","+-e+"H"+-e+"V"+-3*e+"H"+e+"V"+-e+"H"+3*e+"V"+e+"H"+e+"V"+3*e+"H"+-e+"V"+e+"H"+-3*e+"Z"},diamond:function(t){var e=Math.sqrt(t/(2*ku)),n=e*ku;return"M0,"+-e+"L"+n+",0 0,"+e+" "+-n+",0Z"},square:function(t){var e=Math.sqrt(t)/2;return"M"+-e+","+-e+"L"+e+","+-e+" "+e+","+e+" "+-e+","+e+"Z"},"triangle-down":function(t){var e=Math.sqrt(t/Nu),n=e*Nu/2;return"M0,"+n+"L"+e+","+-n+" "+-e+","+-n+"Z"},"triangle-up":function(t){var e=Math.sqrt(t/Nu),n=e*Nu/2;return"M0,"+-n+"L"+e+","+n+" "+-e+","+n+"Z"}});Vo.svg.symbolTypes=Tu.keys();var Su,Eu,Nu=Math.sqrt(3),ku=Math.tan(30*ks),Mu=[],Pu=0;Mu.call=ms.call,Mu.empty=ms.empty,Mu.node=ms.node,Mu.size=ms.size,Vo.transition=function(t){return arguments.length?Su?t.transition():t:vs.transition()},Vo.transition.prototype=Mu,Mu.select=function(t){var e,n,r,i=this.id,o=[];t=x(t);for(var s=-1,a=this.length;++s<a;){o.push(e=[]);for(var u=this[s],l=-1,c=u.length;++l<c;)(r=u[l])&&(n=t.call(r,r.__data__,l,s))?("__data__"in r&&(n.__data__=r.__data__),qo(n,l,i,r.__transition__[i]),e.push(n)):e.push(null)}return Io(o,i)},Mu.selectAll=function(t){var e,n,r,i,o,s=this.id,a=[];t=C(t);for(var u=-1,l=this.length;++u<l;)for(var c=this[u],h=-1,p=c.length;++h<p;)if(r=c[h]){o=r.__transition__[s],n=t.call(r,r.__data__,h,u),a.push(e=[]);for(var f=-1,d=n.length;++f<d;)(i=n[f])&&qo(i,f,s,o),e.push(i)}return Io(a,s)},Mu.filter=function(t){var e,n,r,i=[];"function"!=typeof t&&(t=I(t));for(var o=0,s=this.length;s>o;o++){i.push(e=[]);for(var n=this[o],a=0,u=n.length;u>a;a++)(r=n[a])&&t.call(r,r.__data__,a,o)&&e.push(r)}return Io(i,this.id)},Mu.tween=function(t,e){var n=this.id;return arguments.length<2?this.node().__transition__[n].tween.get(t):L(this,null==e?function(e){e.__transition__[n].tween.remove(t)}:function(r){r.__transition__[n].tween.set(t,e)})},Mu.attr=function(t,e){function n(){this.removeAttribute(a)}function r(){this.removeAttributeNS(a.space,a.local)}function i(t){return null==t?n:(t+="",function(){var e,n=this.getAttribute(a);return n!==t&&(e=s(n,t),function(t){this.setAttribute(a,e(t))})})}function o(t){return null==t?r:(t+="",function(){var e,n=this.getAttributeNS(a.space,a.local);return n!==t&&(e=s(n,t),function(t){this.setAttributeNS(a.space,a.local,e(t))})})}if(arguments.length<2){for(e in t)this.attr(e,t[e]);return this}var s="transform"==t?Lr:fr,a=Vo.ns.qualify(t);return Do(this,"attr."+t,e,a.local?o:i)},Mu.attrTween=function(t,e){function n(t,n){var r=e.call(this,t,n,this.getAttribute(i));return r&&function(t){this.setAttribute(i,r(t))}}function r(t,n){var r=e.call(this,t,n,this.getAttributeNS(i.space,i.local));return r&&function(t){
this.setAttributeNS(i.space,i.local,r(t))}}var i=Vo.ns.qualify(t);return this.tween("attr."+t,i.local?r:n)},Mu.style=function(t,e,n){function r(){this.style.removeProperty(t)}function i(e){return null==e?r:(e+="",function(){var r,i=Qo.getComputedStyle(this,null).getPropertyValue(t);return i!==e&&(r=fr(i,e),function(e){this.style.setProperty(t,r(e),n)})})}var o=arguments.length;if(3>o){if("string"!=typeof t){2>o&&(e="");for(n in t)this.style(n,t[n],e);return this}n=""}return Do(this,"style."+t,e,i)},Mu.styleTween=function(t,e,n){function r(r,i){var o=e.call(this,r,i,Qo.getComputedStyle(this,null).getPropertyValue(t));return o&&function(e){this.style.setProperty(t,o(e),n)}}return arguments.length<3&&(n=""),this.tween("style."+t,r)},Mu.text=function(t){return Do(this,"text",t,Lo)},Mu.remove=function(){return this.each("end.transition",function(){var t;this.__transition__.count<2&&(t=this.parentNode)&&t.removeChild(this)})},Mu.ease=function(t){var e=this.id;return arguments.length<1?this.node().__transition__[e].ease:("function"!=typeof t&&(t=Vo.ease.apply(Vo,arguments)),L(this,function(n){n.__transition__[e].ease=t}))},Mu.delay=function(t){var e=this.id;return arguments.length<1?this.node().__transition__[e].delay:L(this,"function"==typeof t?function(n,r,i){n.__transition__[e].delay=+t.call(n,n.__data__,r,i)}:(t=+t,function(n){n.__transition__[e].delay=t}))},Mu.duration=function(t){var e=this.id;return arguments.length<1?this.node().__transition__[e].duration:L(this,"function"==typeof t?function(n,r,i){n.__transition__[e].duration=Math.max(1,t.call(n,n.__data__,r,i))}:(t=Math.max(1,t),function(n){n.__transition__[e].duration=t}))},Mu.each=function(t,e){var n=this.id;if(arguments.length<2){var r=Eu,i=Su;Su=n,L(this,function(e,r,i){Eu=e.__transition__[n],t.call(e,e.__data__,r,i)}),Eu=r,Su=i}else L(this,function(r){var i=r.__transition__[n];(i.event||(i.event=Vo.dispatch("start","end"))).on(t,e)});return this},Mu.transition=function(){for(var t,e,n,r,i=this.id,o=++Pu,s=[],a=0,u=this.length;u>a;a++){s.push(t=[]);for(var e=this[a],l=0,c=e.length;c>l;l++)(n=e[l])&&(r=Object.create(n.__transition__[i]),r.delay+=r.duration,qo(n,l,o,r)),t.push(n)}return Io(s,o)},Vo.svg.axis=function(){function t(t){t.each(function(){var t,l=Vo.select(this),c=this.__chart__||n,h=this.__chart__=n.copy(),p=null==u?h.ticks?h.ticks.apply(h,a):h.domain():u,f=null==e?h.tickFormat?h.tickFormat.apply(h,a):Ct:e,d=l.selectAll(".tick").data(p,h),m=d.enter().insert("g",".domain").attr("class","tick").style("opacity",Es),g=Vo.transition(d.exit()).style("opacity",Es).remove(),y=Vo.transition(d.order()).style("opacity",1),v=Ri(h),b=l.selectAll(".domain").data([0]),_=(b.enter().append("path").attr("class","domain"),Vo.transition(b));m.append("line"),m.append("text");var w=m.select("line"),x=y.select("line"),C=d.select("text").text(f),T=m.select("text"),S=y.select("text");switch(r){case"bottom":t=jo,w.attr("y2",i),T.attr("y",Math.max(i,0)+s),x.attr("x2",0).attr("y2",i),S.attr("x",0).attr("y",Math.max(i,0)+s),C.attr("dy",".71em").style("text-anchor","middle"),_.attr("d","M"+v[0]+","+o+"V0H"+v[1]+"V"+o);break;case"top":t=jo,w.attr("y2",-i),T.attr("y",-(Math.max(i,0)+s)),x.attr("x2",0).attr("y2",-i),S.attr("x",0).attr("y",-(Math.max(i,0)+s)),C.attr("dy","0em").style("text-anchor","middle"),_.attr("d","M"+v[0]+","+-o+"V0H"+v[1]+"V"+-o);break;case"left":t=$o,w.attr("x2",-i),T.attr("x",-(Math.max(i,0)+s)),x.attr("x2",-i).attr("y2",0),S.attr("x",-(Math.max(i,0)+s)).attr("y",0),C.attr("dy",".32em").style("text-anchor","end"),_.attr("d","M"+-o+","+v[0]+"H0V"+v[1]+"H"+-o);break;case"right":t=$o,w.attr("x2",i),T.attr("x",Math.max(i,0)+s),x.attr("x2",i).attr("y2",0),S.attr("x",Math.max(i,0)+s).attr("y",0),C.attr("dy",".32em").style("text-anchor","start"),_.attr("d","M"+o+","+v[0]+"H0V"+v[1]+"H"+o)}if(h.rangeBand){var E=h,N=E.rangeBand()/2;c=h=function(t){return E(t)+N}}else c.rangeBand?c=h:g.call(t,h);m.call(t,c),y.call(t,h)})}var e,n=Vo.scale.linear(),r=Ou,i=6,o=6,s=3,a=[10],u=null;return t.scale=function(e){return arguments.length?(n=e,t):n},t.orient=function(e){return arguments.length?(r=e in Au?e+"":Ou,t):r},t.ticks=function(){return arguments.length?(a=arguments,t):a},t.tickValues=function(e){return arguments.length?(u=e,t):u},t.tickFormat=function(n){return arguments.length?(e=n,t):e},t.tickSize=function(e){var n=arguments.length;return n?(i=+e,o=+arguments[n-1],t):i},t.innerTickSize=function(e){return arguments.length?(i=+e,t):i},t.outerTickSize=function(e){return arguments.length?(o=+e,t):o},t.tickPadding=function(e){return arguments.length?(s=+e,t):s},t.tickSubdivide=function(){return arguments.length&&t},t};var Ou="bottom",Au={top:1,right:1,bottom:1,left:1};Vo.svg.brush=function(){function t(o){o.each(function(){var o=Vo.select(this).style("pointer-events","all").style("-webkit-tap-highlight-color","rgba(0,0,0,0)").on("mousedown.brush",i).on("touchstart.brush",i),s=o.selectAll(".background").data([0]);s.enter().append("rect").attr("class","background").style("visibility","hidden").style("cursor","crosshair"),o.selectAll(".extent").data([0]).enter().append("rect").attr("class","extent").style("cursor","move");var a=o.selectAll(".resize").data(d,Ct);a.exit().remove(),a.enter().append("g").attr("class",function(t){return"resize "+t}).style("cursor",function(t){return Ru[t]}).append("rect").attr("x",function(t){return/[ew]$/.test(t)?-3:null}).attr("y",function(t){return/^[ns]/.test(t)?-3:null}).attr("width",6).attr("height",6).style("visibility","hidden"),a.style("display",t.empty()?"none":null);var c,h=Vo.transition(o),p=Vo.transition(s);u&&(c=Ri(u),p.attr("x",c[0]).attr("width",c[1]-c[0]),n(h)),l&&(c=Ri(l),p.attr("y",c[0]).attr("height",c[1]-c[0]),r(h)),e(h)})}function e(t){t.selectAll(".resize").attr("transform",function(t){return"translate("+c[+/e$/.test(t)]+","+h[+/^s/.test(t)]+")"})}function n(t){t.select(".extent").attr("x",c[0]),t.selectAll(".extent,.n>rect,.s>rect").attr("width",c[1]-c[0])}function r(t){t.select(".extent").attr("y",h[0]),t.selectAll(".extent,.e>rect,.w>rect").attr("height",h[1]-h[0])}function i(){function i(){32==Vo.event.keyCode&&(k||(b=null,P[0]-=c[1],P[1]-=h[1],k=2),v())}function d(){32==Vo.event.keyCode&&2==k&&(P[0]+=c[1],P[1]+=h[1],k=0,v())}function m(){var t=Vo.mouse(w),i=!1;_&&(t[0]+=_[0],t[1]+=_[1]),k||(Vo.event.altKey?(b||(b=[(c[0]+c[1])/2,(h[0]+h[1])/2]),P[0]=c[+(t[0]<b[0])],P[1]=h[+(t[1]<b[1])]):b=null),E&&g(t,u,0)&&(n(T),i=!0),N&&g(t,l,1)&&(r(T),i=!0),i&&(e(T),C({type:"brush",mode:k?"move":"resize"}))}function g(t,e,n){var r,i,a=Ri(e),u=a[0],l=a[1],d=P[n],m=n?h:c,g=m[1]-m[0];return k&&(u-=d,l-=g+d),r=(n?f:p)?Math.max(u,Math.min(l,t[n])):t[n],k?i=(r+=d)+g:(b&&(d=Math.max(u,Math.min(l,2*b[n]-r))),r>d?(i=r,r=d):i=d),m[0]!=r||m[1]!=i?(n?s=null:o=null,m[0]=r,m[1]=i,!0):void 0}function y(){m(),T.style("pointer-events","all").selectAll(".resize").style("display",t.empty()?"none":null),Vo.select("body").style("cursor",null),O.on("mousemove.brush",null).on("mouseup.brush",null).on("touchmove.brush",null).on("touchend.brush",null).on("keydown.brush",null).on("keyup.brush",null),M(),C({type:"brushend"})}var b,_,w=this,x=Vo.select(Vo.event.target),C=a.of(w,arguments),T=Vo.select(w),S=x.datum(),E=!/^(n|s)$/.test(S)&&u,N=!/^(e|w)$/.test(S)&&l,k=x.classed("extent"),M=H(),P=Vo.mouse(w),O=Vo.select(Qo).on("keydown.brush",i).on("keyup.brush",d);if(Vo.event.changedTouches?O.on("touchmove.brush",m).on("touchend.brush",y):O.on("mousemove.brush",m).on("mouseup.brush",y),T.interrupt().selectAll("*").interrupt(),k)P[0]=c[0]-P[0],P[1]=h[0]-P[1];else if(S){var A=+/w$/.test(S),R=+/^n/.test(S);_=[c[1-A]-P[0],h[1-R]-P[1]],P[0]=c[A],P[1]=h[R]}else Vo.event.altKey&&(b=P.slice());T.style("pointer-events","none").selectAll(".resize").style("display",null),Vo.select("body").style("cursor",x.style("cursor")),C({type:"brushstart"}),m()}var o,s,a=_(t,"brushstart","brush","brushend"),u=null,l=null,c=[0,0],h=[0,0],p=!0,f=!0,d=Iu[0];return t.event=function(t){t.each(function(){var t=a.of(this,arguments),e={x:c,y:h,i:o,j:s},n=this.__chart__||e;this.__chart__=e,Su?Vo.select(this).transition().each("start.brush",function(){o=n.i,s=n.j,c=n.x,h=n.y,t({type:"brushstart"})}).tween("brush:brush",function(){var n=dr(c,e.x),r=dr(h,e.y);return o=s=null,function(i){c=e.x=n(i),h=e.y=r(i),t({type:"brush",mode:"resize"})}}).each("end.brush",function(){o=e.i,s=e.j,t({type:"brush",mode:"resize"}),t({type:"brushend"})}):(t({type:"brushstart"}),t({type:"brush",mode:"resize"}),t({type:"brushend"}))})},t.x=function(e){return arguments.length?(u=e,d=Iu[!u<<1|!l],t):u},t.y=function(e){return arguments.length?(l=e,d=Iu[!u<<1|!l],t):l},t.clamp=function(e){return arguments.length?(u&&l?(p=!!e[0],f=!!e[1]):u?p=!!e:l&&(f=!!e),t):u&&l?[p,f]:u?p:l?f:null},t.extent=function(e){var n,r,i,a,p;return arguments.length?(u&&(n=e[0],r=e[1],l&&(n=n[0],r=r[0]),o=[n,r],u.invert&&(n=u(n),r=u(r)),n>r&&(p=n,n=r,r=p),(n!=c[0]||r!=c[1])&&(c=[n,r])),l&&(i=e[0],a=e[1],u&&(i=i[1],a=a[1]),s=[i,a],l.invert&&(i=l(i),a=l(a)),i>a&&(p=i,i=a,a=p),(i!=h[0]||a!=h[1])&&(h=[i,a])),t):(u&&(o?(n=o[0],r=o[1]):(n=c[0],r=c[1],u.invert&&(n=u.invert(n),r=u.invert(r)),n>r&&(p=n,n=r,r=p))),l&&(s?(i=s[0],a=s[1]):(i=h[0],a=h[1],l.invert&&(i=l.invert(i),a=l.invert(a)),i>a&&(p=i,i=a,a=p))),u&&l?[[n,i],[r,a]]:u?[n,r]:l&&[i,a])},t.clear=function(){return t.empty()||(c=[0,0],h=[0,0],o=s=null),t},t.empty=function(){return!!u&&c[0]==c[1]||!!l&&h[0]==h[1]},Vo.rebind(t,a,"on")};var Ru={n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},Iu=[["n","e","s","w","nw","ne","se","sw"],["e","w"],["n","s"],[]],Du=ta.format=sa.timeFormat,Lu=Du.utc,qu=Lu("%Y-%m-%dT%H:%M:%S.%LZ");Du.iso=Date.prototype.toISOString&&+new Date("2000-01-01T00:00:00.000Z")?Fo:qu,Fo.parse=function(t){var e=new Date(t);return isNaN(e)?null:e},Fo.toString=qu.toString,ta.second=Dt(function(t){return new ea(1e3*Math.floor(t/1e3))},function(t,e){t.setTime(t.getTime()+1e3*Math.floor(e))},function(t){return t.getSeconds()}),ta.seconds=ta.second.range,ta.seconds.utc=ta.second.utc.range,ta.minute=Dt(function(t){return new ea(6e4*Math.floor(t/6e4))},function(t,e){t.setTime(t.getTime()+6e4*Math.floor(e))},function(t){return t.getMinutes()}),ta.minutes=ta.minute.range,ta.minutes.utc=ta.minute.utc.range,ta.hour=Dt(function(t){var e=t.getTimezoneOffset()/60;return new ea(36e5*(Math.floor(t/36e5-e)+e))},function(t,e){t.setTime(t.getTime()+36e5*Math.floor(e))},function(t){return t.getHours()}),ta.hours=ta.hour.range,ta.hours.utc=ta.hour.utc.range,ta.month=Dt(function(t){return t=ta.day(t),t.setDate(1),t},function(t,e){t.setMonth(t.getMonth()+e)},function(t){return t.getMonth()}),ta.months=ta.month.range,ta.months.utc=ta.month.utc.range;var ju=[1e3,5e3,15e3,3e4,6e4,3e5,9e5,18e5,36e5,108e5,216e5,432e5,864e5,1728e5,6048e5,2592e6,7776e6,31536e6],$u=[[ta.second,1],[ta.second,5],[ta.second,15],[ta.second,30],[ta.minute,1],[ta.minute,5],[ta.minute,15],[ta.minute,30],[ta.hour,1],[ta.hour,3],[ta.hour,6],[ta.hour,12],[ta.day,1],[ta.day,2],[ta.week,1],[ta.month,1],[ta.month,3],[ta.year,1]],Fu=Du.multi([[".%L",function(t){return t.getMilliseconds()}],[":%S",function(t){return t.getSeconds()}],["%I:%M",function(t){return t.getMinutes()}],["%I %p",function(t){return t.getHours()}],["%a %d",function(t){return t.getDay()&&1!=t.getDate()}],["%b %d",function(t){return 1!=t.getDate()}],["%B",function(t){return t.getMonth()}],["%Y",Ce]]),zu={range:function(t,e,n){return Vo.range(Math.ceil(t/n)*n,+e,n).map(Uo)},floor:Ct,ceil:Ct};$u.year=ta.year,ta.scale=function(){return zo(Vo.scale.linear(),$u,Fu)};var Uu=$u.map(function(t){return[t[0].utc,t[1]]}),Hu=Lu.multi([[".%L",function(t){return t.getUTCMilliseconds()}],[":%S",function(t){return t.getUTCSeconds()}],["%I:%M",function(t){return t.getUTCMinutes()}],["%I %p",function(t){return t.getUTCHours()}],["%a %d",function(t){return t.getUTCDay()&&1!=t.getUTCDate()}],["%b %d",function(t){return 1!=t.getUTCDate()}],["%B",function(t){return t.getUTCMonth()}],["%Y",Ce]]);return Uu.year=ta.year.utc,ta.scale.utc=function(){return zo(Vo.scale.linear(),Uu,Hu)},Vo.text=Tt(function(t){return t.responseText}),Vo.json=function(t,e){return St(t,"application/json",Ho,e)},Vo.html=function(t,e){return St(t,"text/html",Bo,e)},Vo.xml=Tt(function(t){return t.responseXML}),Vo}()},{}],277:[function(t,e,n){(function(n,r){(function(){"use strict";function i(t){return"function"==typeof t||"object"==typeof t&&null!==t}function o(t){return"function"==typeof t}function s(t){return"object"==typeof t&&null!==t}function a(t){V=t}function u(t){X=t}function l(){var t=n.nextTick,e=n.versions.node.match(/^(?:(\d+)\.)?(?:(\d+)\.)?(\*|\d+)$/);return Array.isArray(e)&&"0"===e[1]&&"10"===e[2]&&(t=setImmediate),function(){t(d)}}function c(){return function(){B(d)}}function h(){var t=0,e=new K(d),n=document.createTextNode("");return e.observe(n,{characterData:!0}),function(){n.data=t=++t%2}}function p(){var t=new MessageChannel;return t.port1.onmessage=d,function(){t.port2.postMessage(0)}}function f(){return function(){setTimeout(d,1)}}function d(){for(var t=0;G>t;t+=2){var e=et[t],n=et[t+1];e(n),et[t]=void 0,et[t+1]=void 0}G=0}function m(){try{var e=t,n=e("vertx");return B=n.runOnLoop||n.runOnContext,c()}catch(r){return f()}}function g(){}function y(){return new TypeError("You cannot resolve a promise with itself")}function v(){return new TypeError("A promises callback cannot return that same promise.")}function b(t){try{return t.then}catch(e){return ot.error=e,ot}}function _(t,e,n,r){try{t.call(e,n,r)}catch(i){return i}}function w(t,e,n){X(function(t){var r=!1,i=_(n,e,function(n){r||(r=!0,e!==n?T(t,n):E(t,n))},function(e){r||(r=!0,N(t,e))},"Settle: "+(t._label||" unknown promise"));!r&&i&&(r=!0,N(t,i))},t)}function x(t,e){e._state===rt?E(t,e._result):e._state===it?N(t,e._result):k(e,void 0,function(e){T(t,e)},function(e){N(t,e)})}function C(t,e){if(e.constructor===t.constructor)x(t,e);else{var n=b(e);n===ot?N(t,ot.error):void 0===n?E(t,e):o(n)?w(t,e,n):E(t,e)}}function T(t,e){t===e?N(t,y()):i(e)?C(t,e):E(t,e)}function S(t){t._onerror&&t._onerror(t._result),M(t)}function E(t,e){t._state===nt&&(t._result=e,t._state=rt,0!==t._subscribers.length&&X(M,t))}function N(t,e){t._state===nt&&(t._state=it,t._result=e,X(S,t))}function k(t,e,n,r){var i=t._subscribers,o=i.length;t._onerror=null,i[o]=e,i[o+rt]=n,i[o+it]=r,0===o&&t._state&&X(M,t)}function M(t){var e=t._subscribers,n=t._state;if(0!==e.length){for(var r,i,o=t._result,s=0;s<e.length;s+=3)r=e[s],i=e[s+n],r?A(n,r,i,o):i(o);t._subscribers.length=0}}function P(){this.error=null}function O(t,e){try{return t(e)}catch(n){return st.error=n,st}}function A(t,e,n,r){var i,s,a,u,l=o(n);if(l){if(i=O(n,r),i===st?(u=!0,s=i.error,i=null):a=!0,e===i)return void N(e,v())}else i=r,a=!0;e._state!==nt||(l&&a?T(e,i):u?N(e,s):t===rt?E(e,i):t===it&&N(e,i))}function R(t,e){try{e(function(e){T(t,e)},function(e){N(t,e)})}catch(n){N(t,n)}}function I(t,e){var n=this;n._instanceConstructor=t,n.promise=new t(g),n._validateInput(e)?(n._input=e,n.length=e.length,n._remaining=e.length,n._init(),0===n.length?E(n.promise,n._result):(n.length=n.length||0,n._enumerate(),0===n._remaining&&E(n.promise,n._result))):N(n.promise,n._validationError())}function D(t){return new at(this,t).promise}function L(t){function e(t){T(i,t)}function n(t){N(i,t)}var r=this,i=new r(g);if(!J(t))return N(i,new TypeError("You must pass an array to race.")),i;for(var o=t.length,s=0;i._state===nt&&o>s;s++)k(r.resolve(t[s]),void 0,e,n);return i}function q(t){var e=this;if(t&&"object"==typeof t&&t.constructor===e)return t;var n=new e(g);return T(n,t),n}function j(t){var e=this,n=new e(g);return N(n,t),n}function $(){throw new TypeError("You must pass a resolver function as the first argument to the promise constructor")}function F(){throw new TypeError("Failed to construct 'Promise': Please use the 'new' operator, this object constructor cannot be called as a function.")}function z(t){this._id=pt++,this._state=void 0,this._result=void 0,this._subscribers=[],g!==t&&(o(t)||$(),this instanceof z||F(),R(this,t))}function U(){var t;if("undefined"!=typeof r)t=r;else if("undefined"!=typeof self)t=self;else try{t=Function("return this")()}catch(e){throw new Error("polyfill failed because global object is unavailable in this environment")}var n=t.Promise;(!n||"[object Promise]"!==Object.prototype.toString.call(n.resolve())||n.cast)&&(t.Promise=ft)}var H;H=Array.isArray?Array.isArray:function(t){return"[object Array]"===Object.prototype.toString.call(t)};var B,V,W,J=H,G=0,X=({}.toString,function(t,e){et[G]=t,et[G+1]=e,G+=2,2===G&&(V?V(d):W())}),Q="undefined"!=typeof window?window:void 0,Y=Q||{},K=Y.MutationObserver||Y.WebKitMutationObserver,Z="undefined"!=typeof n&&"[object process]"==={}.toString.call(n),tt="undefined"!=typeof Uint8ClampedArray&&"undefined"!=typeof importScripts&&"undefined"!=typeof MessageChannel,et=new Array(1e3);W=Z?l():K?h():tt?p():void 0===Q&&"function"==typeof t?m():f();var nt=void 0,rt=1,it=2,ot=new P,st=new P;I.prototype._validateInput=function(t){return J(t)},I.prototype._validationError=function(){return new Error("Array Methods must be provided an Array")},I.prototype._init=function(){this._result=new Array(this.length)};var at=I;I.prototype._enumerate=function(){for(var t=this,e=t.length,n=t.promise,r=t._input,i=0;n._state===nt&&e>i;i++)t._eachEntry(r[i],i)},I.prototype._eachEntry=function(t,e){var n=this,r=n._instanceConstructor;s(t)?t.constructor===r&&t._state!==nt?(t._onerror=null,n._settledAt(t._state,e,t._result)):n._willSettleAt(r.resolve(t),e):(n._remaining--,n._result[e]=t)},I.prototype._settledAt=function(t,e,n){var r=this,i=r.promise;i._state===nt&&(r._remaining--,t===it?N(i,n):r._result[e]=n),0===r._remaining&&E(i,r._result)},I.prototype._willSettleAt=function(t,e){var n=this;k(t,void 0,function(t){n._settledAt(rt,e,t)},function(t){n._settledAt(it,e,t)})};var ut=D,lt=L,ct=q,ht=j,pt=0,ft=z;z.all=ut,z.race=lt,z.resolve=ct,z.reject=ht,z._setScheduler=a,z._setAsap=u,z._asap=X,z.prototype={constructor:z,then:function(t,e){var n=this,r=n._state;if(r===rt&&!t||r===it&&!e)return this;var i=new this.constructor(g),o=n._result;if(r){var s=arguments[r-1];X(function(){A(r,i,s,o)})}else k(n,i,t,e);return i},"catch":function(t){return this.then(null,t)}};var dt=U,mt={Promise:ft,polyfill:dt};"function"==typeof define&&define.amd?define(function(){return mt}):"undefined"!=typeof e&&e.exports?e.exports=mt:"undefined"!=typeof this&&(this.ES6Promise=mt),dt()}).call(this)}).call(this,t("IrXUsu"),"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{IrXUsu:15}],278:[function(t,e,n){(function(){n.ACCEPT_HEADER={xml:"application/xml",json:"application/json",tsv:"text/tab-separated-values",tab:"text/tab-separated-values",csv:"text/comma-separated-values",fasta:"text/x-fasta",gff3:"text/x-gff3",bed:"text/x-bed",objects:"application/json;type=objects",jsonobjects:"application/json;type=objects",jsontable:"application/json;type=table",jsonrows:"application/json;type=rows",jsoncount:"application/json;type=count",jsonp:"application/javascript",jsonpobjects:"application/javascript;type=objects",jsonptable:"application/javascript;type=table",jsonprows:"application/javascript;type=rows",jsonpcount:"application/javascript;type=count"}}).call(this)},{}],279:[function(t,e,n){(function(){var e,r,i,o,s,a,u,l,c,h,p,f,d,m,g,y,v,b,_;o=t("url"),r=t("JSONStream"),f=t("http"),e=t("./constants").ACCEPT_HEADER,u=t("./version").VERSION,_=b=t("./util"),h=_.error,c=_.defer,m=_.merge,d=_.invoke,a="node-http/imjs-"+u,i=/,\s*$/,s="application/x-www-form-urlencoded",n.supports=function(){return!0},v=function(t,e,n){return function(t){var i,o;return null==t.pipe?n(new Error("response is not a stream")):(t.on("error",n),null!=t.statusCode&&200!==t.statusCode?(i=r.parse("error"),i.pause(),t.pipe(i),n([t.statusCode,i])):(o=r.parse("results.*"),o.pause(),t.pipe(o),e(o)))}},p=function(t,e,n,r){var i,o;return i=t.type,o=t.url,"Could not parse response to "+i+" "+o+': "'+e+'" ('+r+": "+n+")"},l=function(t,e,n){return function(r){var i;return i="",r.on("data",function(t){return i+=t}),r.on("error",n),r.on("end",function(){var o,s,a,u,l,c,h;if(o=r.headers["content-type"],"application/json"!==o&&!/json/.test(t.dataType)&&!/json/.test(t.data.format))return(l=i.match(/\[ERROR\] (\d+)([\s\S]*)/))?n(new Error(l[2])):(u=200<=(h=r.statusCode)&&400>h?e:n)(i);if(""===i&&200===r.statusCode)return e();try{return c=JSON.parse(i),(a=c.error)?n(new Error(a)):e(c)}catch(f){return s=f,n(r.statusCode>=400?new Error(r.statusCode):new Error(p(t,i,s,r.statusCode)))}})}},n.iterReq=function(t,e,n){return function(r,i,o,s,a){var u,l,c,p,f;return null==i&&(i={}),null==o&&(o=function(){}),null==s&&(s=function(){}),null==a&&(a=function(){}),b.isFunction(i)&&(f=[{},i,o,s],i=f[0],o=f[1],s=f[2],a=f[3]),p=m({format:n},i,{query:r.toXML()}),u=function(t){return t.on("data",o),t.on("error",s),t.on("end",a),setTimeout(function(){return null!=t.resume?t.resume():void 0},3),t},c=function(t){var e,n;return n=t[0],e=t[1],e.on("data",s),e.on("error",s),e.on("end",a),null!=e.resume&&e.resume(),h(n)},l=this.makeRequest(t,e,p,null,!0),l.then(u,c),l}},y=function(t,e,n){var r;return r=setTimeout(function(){return e("Request timed out.")},t),n.then(function(){return cancelTimeout(r)})},g=function(t){var n,r,i,u,l,c,h,p;if(!t.url)throw new Error("No url provided in "+JSON.stringify(t));if("string"==typeof t.data){if(i=t.data,"GET"===(c=t.type)||"DELETE"===c)throw new Error("Invalid request. "+t.type+" requests must not have bodies")}else i=b.querystring(t.data);if(r=o.parse(t.url,!0),r.withCredentials=!1,r.method=t.type||"GET",null!=t.port&&(r.port=t.port),r.headers={"User-Agent":a,Accept:e[t.dataType]},("GET"===(h=r.method)||"DELETE"===h)&&(null!=i?i.length:void 0)?(u=/\?/.test(r.path)?"&":"?",r.path+=u+i,i=null):(r.headers["Content-Type"]=(t.contentType||s)+"; charset=UTF-8",r.headers["Content-Length"]=i.length),null!=t.headers){p=t.headers;for(n in p)l=p[n],r.headers[n]=l}return null!=t.auth&&(r.auth=t.auth),[r,i]},n.doReq=function(t,e){var n,r,i,o,s,a,u,h,p,d,m;d=c(),o=d.promise,u=d.resolve,s=d.reject,o.then(null,t.error);try{m=g(t),p=m[0],i=m[1],r=(e?v:l)(t,u,s),a=f.request(p,r),a.on("error",function(e){return s(new Error("Error: "+p.method+" "+t.url+": "+e))}),null!=i&&a.write(i),a.end(),h=t.timeout,h>0&&y(h,s,o)}catch(b){n=b,s(n)}return o}}).call(this)},{"./constants":278,"./util":290,"./version":291,JSONStream:293,http:10,url:28}],280:[function(t,e,n){(function(){var e,r,i,o,s,a,u,l,c,h,p,f,d,m,g={}.hasOwnProperty,y=[].indexOf||function(t){for(var e=0,n=this.length;n>e;e++)if(e in this&&this[e]===t)return e;return-1},v=function(t,e){return function(){return t.apply(e,arguments)}};c=t("./util"),f=n,d=c.uniqBy,u=c.difference,a=c.defer,m=c.withCB,p=c.id,h=c.get,l=c.fold,s=c.concatMap,o=6e4,e=function(){function t(t){var e,n;for(e in t)g.call(t,e)&&(n=t[e],this[e]=n)}var e;return t.prototype.getStats=function(t){return null!=t?this.stats[t]:this.stats},e=s(h("matches")),t.prototype.getMatches=function(t){var n;return"MATCH"===t?this.matches[t]:null!=(n=e(this.matches[t]))?n:[]},t.prototype.getMatchIds=function(t){return null!=t?this.getMatches(t).map(h("id")):this.allMatchIds()},t.prototype.goodMatchIds=function(){return this.getMatchIds("MATCH")},t.prototype.allMatchIds=function(){var t;return(t=l(function(t){return function(e,n){return e.concat(t.getMatchIds(n))}}(this)))(this.goodMatchIds(),["DUPLICATE","WILDCARD","TYPE_CONVERTED","OTHER"])},t}(),i=function(){function t(t){var e,n;for(e in t)g.call(t,e)&&(n=t[e],this[e]=n)}var e,n,r,i;return i=d(p),e=s(p),n=function(t){var n,r;return e(function(){var e,i;e=t.identifiers,i=[];for(n in e)r=e[n],i.push(r);return i}())},r=function(t,e){return null==e||y.call(n(t),e)>=0},t.prototype.getStats=function(t){switch(t){case"objects":return this.getObjectStats();case"identifiers":return this.getIdentifierStats();default:return{objects:this.getObjectStats(),identifiers:this.getIdentifierStats()}}},t.prototype.getIdentifierStats=function(){var t,n,r,o,s,a;return a=function(t){var n,r;return i(e(function(){var e,i,o;for(o=[],e=0,i=t.length;i>e;e++)r=t[e],o.push(function(){var t;t=[];for(n in null!=r?r.identifiers:void 0)t.push(n);return t}());return o}()))},o=a(this.getMatches("MATCH")),n=a(this.getMatches()),s=o.length,t=n.length,r=u(n,o).length,{matches:s,all:t,issues:r}},t.prototype.getObjectStats=function(){var t,e,r,i;return i=this.goodMatchIds().length,t=this.allMatchIds().length,e=function(){var t;t=[];for(p in this)g.call(this,p)&&(r=this[p],y.call(n(r),"MATCH")<0&&t.push(p));return t}.call(this).length,{matches:i,all:t,issues:e}},t.prototype.getMatches=function(t){var e,n;n=[];for(p in this)g.call(this,p)&&(e=this[p],r(e,t)&&n.push(e));return n},t.prototype.getMatchIds=function(t){var e,n;n=[];for(p in this)g.call(this,p)&&(e=this[p],r(e,t)&&n.push(p));return n},t.prototype.goodMatchIds=function(){return this.getMatchIds("MATCH")},t.prototype.allMatchIds=function(){return this.getMatchIds()},t}(),r=function(){function t(t,e){this.uid=t,this.service=e,this.del=v(this.del,this),this.fetchResults=v(this.fetchResults,this),this.fetchErrorMessage=v(this.fetchErrorMessage,this),this.fetchStatus=v(this.fetchStatus,this)}return t.prototype.fetchStatus=function(t){return m(t,this.service.get("ids/"+this.uid+"/status").then(h("status")))},t.prototype.fetchErrorMessage=function(t){return m(t,this.service.get("ids/"+this.uid+"/status").then(h("message")))},t.prototype.fetchResults=function(t){var n,r;return n=this.service.get("ids/"+this.uid+"/result").then(h("results")),r=this.service.fetchVersion(),r.then(function(t){return n.then(function(n){return t>=16?new e(n):new i(n)})})},t.prototype.del=function(t){return m(t,this.service.makeRequest("DELETE","ids/"+this.uid))},t.prototype.decay=50,t.prototype.poll=function(t,e,n){var r,i,s,u,l,c,h;return h=a(),s=h.promise,l=h.resolve,u=h.reject,s.then(t,e),i=null!=n?n:function(){},c=this.fetchStatus(),c.then(null,u),r=this.decay,this.decay=Math.min(o,1.25*r),c.then(function(t){return function(e){switch(i(e),e){case"SUCCESS":return t.fetchResults().then(l,u);case"ERROR":return t.fetchErrorMessage().then(u,u);default:return setTimeout(function(){return t.poll(l,u,i)},r)}}}(this)),s},t}(),r.prototype.wait=r.prototype.poll,r.create=function(t){return function(e){return new r(e,t)}},f.IDResolutionJob=r,f.CategoryResults=e,f.IdResults=i}).call(this)},{"./util":290}],281:[function(t,e,n){(function(){var e,r,i,o,s,a,u,l,c,h,p,f,d,m,g,y=function(t,e){return function(){return t.apply(e,arguments)}},v={}.hasOwnProperty,b=[].indexOf||function(t){for(var e=0,n=this.length;n>e;e++)if(e in this&&this[e]===t)return e;return-1};m=t("./util"),c=n,f=m.merge,g=m.withCB,u=m.get,h=m.invoke,i=m.REQUIRES_VERSION,d=m.set,a=m.dejoin,s="list/tags",o="lists/shares",e="lists/invitations",p=function(t){return"__folder__"===t.substr(0,t.indexOf(":"))},l=function(t){return t.substr(t.indexOf(":")+1)},r=function(){function t(t,e){var n,r;this.service=e,this._updateTags=y(this._updateTags,this),this.hasTag=y(this.hasTag,this);for(n in t)v.call(t,n)&&(r=t[n],this[n]=r);this.dateCreated=null!=this.dateCreated?new Date(this.dateCreated):null,this.folders=this.tags.filter(p).map(l)}var n;return t.prototype.hasTag=function(t){return b.call(this.tags,t)>=0},t.prototype.query=function(t){return null==t&&(t=["*"]),this.service.query({select:t,from:this.type,where:[[this.type,"IN",this.name]]})},t.prototype.del=function(t){return this.service.makeRequest("DELETE","lists",{name:this.name},t)},n=function(t){var e;return e=t.tags},t.prototype._updateTags=function(t,e){return null==t?(this.tags=e.slice(),this.folders=this.tags.filter(p).map(l)):void 0},t.prototype.fetchTags=function(t){return g(this._updateTags,t,this.service.makeRequest("GET","list/tags",{name:this.name}).then(n))},t.prototype.addTags=function(t,e){var r;return r={name:this.name,tags:t},g(this._updateTags,e,this.service.makeRequest("POST","list/tags",r).then(n))},t.prototype.removeTags=function(t,e){var r;return r={name:this.name,tags:t},g(this._updateTags,e,this.service.makeRequest("DELETE","list/tags",r).then(n))},t.prototype.contents=function(t){return g(t,this.query().then(a).then(h("records")))},t.prototype.rename=function(t,e){var n;return n=this.service.post("lists/rename",{oldname:this.name,newname:t}).then(u("listName")).then(function(t){return function(e){return t.name=e}}(this)).then(this.service.fetchList),g(e,n)},t.prototype.copy=function(t,e){var n,r,i,o,s,a,l;return null==t&&(t={}),null==e&&(e=function(){}),1===arguments.length&&m.isFunction(t)&&(s=[{},t],t=s[0],e=s[1]),"string"==typeof t&&(t={name:t}),r=n=null!=(a=t.name)?a:""+this.name+"_copy",o=this.tags.concat(null!=(l=t.tags)?l:[]),i=this.query(["id"]),g(e,this.service.fetchLists().then(h("map",u("name"))).then(function(t){return function(e){var s;for(s=1;b.call(e,r)>=0;)r=""+n+"-"+s++;return i.then(h("saveAsList",{name:r,tags:o,description:t.description}))}}(this)))},t.prototype.enrichment=function(t,e){return this.service.enrichment(f({list:this.name},t),e)},t.prototype.shareWithUser=function(t,e){return g(e,this.service.post(o,{list:this.name,"with":t}))},t.prototype.inviteUserToShare=function(t,n,r){return null==n&&(n=!0),null==r&&(r=function(){}),g(r,this.service.post(e,{list:this.name,to:t,notify:!!n}))},t}(),c.List=r}).call(this)},{"./util":290}],282:[function(t,e,n){(function(){var e,r,i,o,s,a,u,l,c,h,p=function(t,e){return function(){return t.apply(e,arguments)}},f=[].indexOf||function(t){for(var e=0,n=this.length;n>e;e++)if(e in this&&this[e]===t)return e;return-1};o=t("./table").Table,i=t("./path").PathInfo,h=t("./util"),u=h.flatten,a=h.find,s=h.error,c=h.omap,l=n,e=new o({name:"Object",tags:[],displayName:"Object",attributes:{},references:{},collections:{}}),r=function(){function t(t){var n,r;this.name=t.name,n=t.classes,this.findCommonType=p(this.findCommonType,this),this.findSharedAncestor=p(this.findSharedAncestor,this),this.getAncestorsOf=p(this.getAncestorsOf,this),this.getSubclassesOf=p(this.getSubclassesOf,this),this.getPathInfo=p(this.getPathInfo,this),r=c(function(t){return function(e,n){return[e,new o(n,t)]}}(this)),this.classes=r(n),this.classes["java.lang.Object"]=e}return t.prototype.getPathInfo=function(t,e){return i.parse(this,t,e)},t.prototype.getSubclassesOf=function(t){var e,n,r,i,o,s;if(n=t&&t.name?t:this.classes[t],null==n)throw new Error(""+t+" is not a table");r=[n.name],o=this.classes;for(i in o)e=o[i],s=n.name,f.call(e.parents(),s)>=0&&(r=r.concat(this.getSubclassesOf(e)));return r},t.prototype.getAncestorsOf=function(t){var e,n;if(e=t&&t.name?t:this.classes[t],null==e)throw new Error(""+t+" is not a table");return n=e.parents(),n.filter(function(t){return function(e){return t.classes[e]}}(this)).reduce(function(t){return function(e,n){return e.concat(t.getAncestorsOf(n))}}(this),n)},t.prototype.findSharedAncestor=function(t,e){var n,r,i;return null===e||null===t?null:t===e?t:(n=this.getAncestorsOf(t),f.call(n,e)>=0?e:(r=this.getAncestorsOf(e),f.call(r,t)>=0?t:i=a(n,function(t){return f.call(r,t)>=0})))},t.prototype.findCommonType=function(t){return null==t&&(t=[]),t.reduce(this.findSharedAncestor)},t}(),r.prototype.makePath=r.prototype.getPathInfo,r.prototype.findCommonTypeOfMultipleClasses=r.prototype.findCommonType,r.load=function(t){var e;try{return new r(t)}catch(n){throw e=n,new Error("Error loading model: "+e)}},r.INTEGRAL_TYPES=["int","Integer","long","Long"],r.FRACTIONAL_TYPES=["double","Double","float","Float"],r.NUMERIC_TYPES=r.INTEGRAL_TYPES.concat(r.FRACTIONAL_TYPES),r.BOOLEAN_TYPES=["boolean","Boolean"],l.Model=r}).call(this)},{"./path":283,"./table":288,"./util":290}],283:[function(t,e,n){(function(){var e,r,i,o,s,a,u,l,c,h,p,f,d,m,g=function(t,e){return function(){return t.apply(e,arguments)}},y=[].slice,v=[].indexOf||function(t){for(var e=0,n=this.length;n>e;e++)if(e in this&&this[e]===t)return e;return-1};c=n,d=t("./util"),m=d.withCB,s=d.concatMap,l=d.get,
o=d.any,p=d.set,a=d.copy,f=d.success,u=d.error,e={},r={},h=function(t,e,n){var r,i,o;return""+(null!=t?t.name:void 0)+"|"+(null!=t&&null!=(o=t.service)?o.root:void 0)+"|"+e+":"+function(){var t;t=[];for(r in n)i=n[r],t.push(""+r+"="+i);return t}()},i=function(){function t(t){var e,n;this.root=t.root,this.model=t.model,this.descriptors=t.descriptors,this.subclasses=t.subclasses,this.displayName=t.displayName,this.ident=t.ident,this.allDescriptors=g(this.allDescriptors,this),this.getChildNodes=g(this.getChildNodes,this),this.getDisplayName=g(this.getDisplayName,this),this.isa=g(this.isa,this),this.append=g(this.append,this),this.getParent=g(this.getParent,this),this.getEndClass=g(this.getEndClass,this),this.containsCollection=g(this.containsCollection,this),this.isCollection=g(this.isCollection,this),this.isReverseReference=g(this.isReverseReference,this),this.isReference=g(this.isReference,this),this.isClass=g(this.isClass,this),this.isAttribute=g(this.isAttribute,this),this.isRoot=g(this.isRoot,this),n=this.descriptors,this.mid=2<=n.length?y.call(n,0,e=n.length-1):(e=0,[]),this.end=n[e++],null==this.ident&&(this.ident=h(this.model,this,this.subclasses))}return t.prototype.isRoot=function(){return 0===this.descriptors.length},t.prototype.isAttribute=function(){return null!=this.end&&!this.isReference()},t.prototype.isClass=function(){return this.isRoot()||this.isReference()},t.prototype.isReference=function(){var t;return null!=(null!=(t=this.end)?t.referencedType:void 0)},t.prototype.isReverseReference=function(){var t,e,n,r,i;return this.isReference()&&this.mid.length>0?(i=this.end,r=i.reverseReference,n=i.referencedType,e=this.getParent(),t=e.getParent(),null!=n&&t.isa(n)&&e.end.name===r):!1},t.prototype.isCollection=function(){var t,e;return null!=(t=null!=(e=this.end)?e.isCollection:void 0)?t:!1},t.prototype.containsCollection=function(){return o(this.descriptors,function(t){return t.isCollection})},t.prototype.getEndClass=function(){var t;return this.model.classes[this.subclasses[this.toString()]||(null!=(t=this.end)?t.referencedType:void 0)]||this.root},t.prototype.getParent=function(){var e;if(this.isRoot())throw new Error("Root paths do not have parents");return e={root:this.root,model:this.model,descriptors:this.mid.slice(),subclasses:this.subclasses},new t(e)},t.prototype.append=function(e){var n,r;if(this.isAttribute())throw new Error(""+this+" is an attribute.");if(r="string"==typeof e?this.getType().fields[e]:e,null==r)throw new Error(""+e+" is not a field of "+this.getType());return n={root:this.root,model:this.model,descriptors:this.descriptors.concat([r]),subclasses:this.subclasses},new t(n)},t.prototype.isa=function(t){var e,n;return null==t?!1:this.isAttribute()?this.getType()===t:(e=t.name?t.name:""+t,n=this.getType(),e===n.name||v.call(this.model.getAncestorsOf(n),e)>=0)},t.prototype.getDisplayName=function(t){var n,r,i,o;return(r=this.displayName)?f(r):(null==this.namePromise&&(this.namePromise=(n=e[this.ident])?f(n):this.isRoot()&&this.root.displayName?f(this.root.displayName):null==this.model.service?u("No service"):(o="model"+s(function(t){return"/"+t.name})(this.allDescriptors()),i=p({format:"json"})(a(this.subclasses)),this.model.service.get(o,i).then(l("display")).then(function(t){return function(n){var r;return null!=e[r=t.ident]?e[r]:e[r]=n}}(this)))),m(t,this.namePromise))},t.prototype.getChildNodes=function(){var t,e,n,r,i;r=(null!=(n=this.getEndClass())?n.fields:void 0)||{},i=[];for(e in r)t=r[e],i.push(this.append(t));return i},t.prototype.allDescriptors=function(){return[this.root].concat(this.descriptors)},t.prototype.toString=function(){return this.allDescriptors().map(l("name")).join(".")},t.prototype.equals=function(t){return this===t||this.ident&&(null!=t?t.ident:void 0)===this.ident},t.prototype.getType=function(){var t,e;return(null!=(t=this.end)&&null!=(e=t.type)?e.replace(/java\.lang\./,""):void 0)||this.getEndClass()},t}(),i.prototype.toPathString=i.prototype.toString,i.parse=function(t,e,n){var o,s,a,u,l,c,p,f,d;return null==n&&(n={}),l=h(t,e,n),(o=r[l])?o:(f=(e+"").split("."),d=s=t.classes[f.shift()],c=d.name,a=function(){var r,i,o,a;for(a=[],r=0,i=f.length;i>r;r++){if(p=f[r],u=(null!=s?s.fields[p]:void 0)||(null!=(o=s=t.classes[n[c]])?o.fields[p]:void 0),!u)throw new Error("Could not find "+p+" in "+s+" when parsing "+e);c+="."+p,s=t.classes[u.type||u.referencedType],a.push(u)}return a}(),r[l]=new i({root:d,model:t,descriptors:a,subclasses:n,ident:l}))},i.flushCache=function(){return r={},e={}},c.PathInfo=i}).call(this)},{"./util":290}],284:[function(t,e,n){(function(){var n;n=t("es6-promise").Promise,e.exports=n}).call(this)},{"es6-promise":277}],285:[function(t,e,n){(function(){var e,r,i,o,s,a,u,l,c,h,p,f,d,m,g,y,v,b,_,w,x,C,T,S,E,N,k,M,P,O,A,R,I,D,L,q,j,$,F,z,U,H,B,V,W,J,G,X,Q,Y,K,Z=[].indexOf||function(t){for(var e=0,n=this.length;n>e;e++)if(e in this&&this[e]===t)return e;return-1},tt=function(t,e){return function(){return t.apply(e,arguments)}},et=[].slice,nt={}.hasOwnProperty;i=t("backbone-events-standalone"),N=n,N.xml=t("./xml"),B=t("./util"),a=B.REQUIRES_VERSION,V=B.withCB,O=B.merge,_=B.filter,L=B.partition,w=B.fold,m=B.concatMap,S=B.id,x=B.get,P=B.invoke,z=B.querystring,C=function(t){var e;if(e=null!=(null!=t?t.toLowerCase:void 0)?s.OP_DICT[t.toLowerCase()]:null,!e)throw new Error("Illegal constraint operator: "+t);return e},e=["path","op","code"],l=e.concat(["value","extraValue"]),u=["rowByRow","eachRow","recordByRecord","eachRecord","records","rows","table","tableRows","values"],o=function(t){return B.compose(t.fetchList,x("listName"))},r=["A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],y=function(t){return null==t&&(t=""),t.substr(t.indexOf("."))},d=function(t){return null!=t?"<value>"+B.escape(t)+"</value>":"<nullValue/>"},h=function(t,e){var n,r;return function(){var i;i=[];for(n in t)r=t[n],Z.call(e,n)>=0&&i.push(""+n+'="'+B.escape(r)+'" ');return i}().join("")},D=function(t){return"<constraint "+h(t,e)+"/>"},U=function(t){return"<constraint "+h(t,["path","type"])+"/>"},j=function(t){return"<constraint "+h(t,l)+"/>"},R=function(t){return"<constraint "+h(t,e)+">"+m(d)(t.values)+"</constraint>"},E=function(t){return"<constraint "+h(t,e)+'ids="'+t.ids.join(",")+'"/>'},p=function(t){var e;return null!=t.values?R(t):null!=t.ids?E(t):null==t.op?U(t):(e=t.op,Z.call(s.NULL_OPS,e)>=0?D(t):j(t))},T=function(t){return t.replace(/^[^\.]+\./,"")},g=function(t){var e,n,r,i,o,s,a,u,l,c,h;return s=t.path,l=t.type,o=t.op,c=t.value,h=t.values,r=t.extraValue,i=t.ids,e=t.code,n=t.editable,u=t.switched,a=t.switchable,i=null!=i?i.slice():void 0,h=null!=h?h.slice():void 0,I({path:s,type:l,op:o,value:c,values:h,extraValue:r,ids:i,code:e,editable:n,switched:u,switchable:a})},f=function(t){var e;return e=g(t),e.path=T(e.path),e},I=function(t){var e,n;for(e in t)n=t[e],null==n&&delete t[e];return t},v=function(t,e){return"Did not remove a single constraint. original = "+t+", reduced = "+e},M=function(t,e){var n,r,i,o,a,u,l;if(n={path:t},null===e)n.op="IS NULL";else if(B.isArray(e))n.op="ONE OF",n.values=e;else if("string"==(u=typeof e)||"number"===u||"boolean"===u)l="function"==typeof e.toUpperCase?e.toUpperCase():void 0,Z.call(s.NULL_OPS,l)>=0?n.op=e:(n.op="=",n.value=e);else if(i=function(){var t;t=[];for(r in e)a=e[r],t.push(r);return t}(),Z.call(i,"isa")>=0)B.isArray(e.isa)?(n.op=r,n.values=e.isa):n.type=e.isa;else{Z.call(i,"extraValue")>=0&&(n.extraValue=e.extraValue);for(r in e)o=e[r],"extraValue"!==r&&(n.op=r,B.isArray(o)?n.values=o:n.value=o)}return n},k=function(t){var e,n,r,i;return t=t.slice(),n={path:t.shift()},1===t.length?(e=t[0],i="function"==typeof e.toUpperCase?e.toUpperCase():void 0,Z.call(s.NULL_OPS,i)>=0?n.op=e:n.type=e):t.length>=2&&(n.op=t[0],r=t[1],B.isArray(r)?n.values=r:n.value=r,3===t.length&&(n.extraValue=t[2])),n},F=function(t){var e;return function(){var n,r,i;for(i=[],n=0,r=t.length;r>n;n++)e=t[n],i.push(""+e.path+" "+e.direction);return i}().join(" ")},$=function(t){var e,n,r,i,o,s,a;if(null==t)return[];for(n=t.split(/\s+/),r=function(){var t,e,r;for(r=[],i=t=0,e=n.length/2;e>=0?e>t:t>e;i=e>=0?++t:--t)r.push(2*i);return r}(),a=[],o=0,s=r.length;s>o;o++)e=r[o],a.push([n[e],n[e+1]]);return a},q=function(){var t,e;return e=this.sortOrder,this.sortOrder=function(){var n,r,i;for(i=[],n=0,r=e.length;r>n;n++)t=e[n],this.isRelevant(t.path)&&i.push(t);return i}.call(this),e.length!==this.sortOrder.length?this.trigger("change:sortorder change:orderby",this.sortOrder.slice()):void 0},s=function(){function t(t,e,n){var r,i,o,s,a,u,l,c,h,p,f,d,m,g,y,v;for(u=null!=n?n:{},r=u.model,o=u.summaryFields,this.addConstraint=tt(this.addConstraint,this),this.expandStar=tt(this.expandStar,this),this.adjustPath=tt(this.adjustPath,this),this.select=tt(this.select,this),null==t&&(t={}),this.constraints=[],this.views=[],this.joins={},this.displayNames=B.copy(null!=(l=null!=(h=t.displayNames)?h:t.aliases)?l:{}),p=["name","title","comment","description","type"],s=0,a=p.length;a>s;s++)i=p[s],null!=t[i]&&(this[i]=t[i]);this.service=null!=e?e:{},this.model=null!=(f=null!=r?r:t.model)?f:{},this.summaryFields=null!=(d=null!=o?o:t.summaryFields)?d:{},this.root=null!=(m=t.root)?m:t.from,this.maxRows=null!=(g=null!=(y=t.size)?y:t.limit)?g:t.maxRows,this.start=null!=(v=null!=(c=t.start)?c:t.offset)?v:0,this.select(t.views||t.view||t.select||[]),this.addConstraints(t.constraints||t.where||[]),this.addJoins(t.joins||t.join||[]),this.orderBy(t.sortOrder||t.orderBy||[]),null!=t.constraintLogic&&(this.constraintLogic=t.constraintLogic),this.on("change:views",q,this)}var e,n,i,s,u,l,c,d,b;return t.JOIN_STYLES=["INNER","OUTER"],t.BIO_FORMATS=["gff3","fasta","bed"],t.NULL_OPS=["IS NULL","IS NOT NULL"],t.ATTRIBUTE_VALUE_OPS=["=","!=",">",">=","<","<=","CONTAINS","LIKE","NOT LIKE"],t.MULTIVALUE_OPS=["ONE OF","NONE OF"],t.RANGE_OPS=["OVERLAPS","DOES NOT OVERLAP","OUTSIDE","WITHIN","CONTAINS","DOES NOT CONTAIN"],t.TERNARY_OPS=["LOOKUP"],t.LOOP_OPS=["=","!="],t.LIST_OPS=["IN","NOT IN"],t.OP_DICT={"=":"=","==":"==",eq:"=",eqq:"==","!=":"!=",ne:"!=",">":">",gt:">",">=":">=",ge:">=","<":"<",lt:"<","<=":"<=",le:"<=",contains:"CONTAINS",CONTAINS:"CONTAINS","does not contain":"DOES NOT CONTAIN","DOES NOT CONTAIN":"DOES NOT CONTAIN",like:"LIKE",LIKE:"LIKE","not like":"NOT LIKE","NOT LIKE":"NOT LIKE",lookup:"LOOKUP","IS NULL":"IS NULL","is null":"IS NULL","IS NOT NULL":"IS NOT NULL","is not null":"IS NOT NULL","ONE OF":"ONE OF","one of":"ONE OF","NONE OF":"NONE OF","none of":"NONE OF","in":"IN","not in":"NOT IN",IN:"IN","NOT IN":"NOT IN",WITHIN:"WITHIN",within:"WITHIN",OVERLAPS:"OVERLAPS",overlaps:"OVERLAPS","DOES NOT OVERLAP":"DOES NOT OVERLAP","does not overlap":"DOES NOT OVERLAP",OUTSIDE:"OUTSIDE",outside:"OUTSIDE",ISA:"ISA",isa:"ISA"},u=["name","view","sortOrder","constraintLogic","title","description","comment"],n=["path","type","op","code","value","ids"],c=function(t,e){var n,r,i,o;for(o=[],r=0,i=e.length;i>r;r++)n=e[r],t.hasAttribute(n)&&o.push([n,t.getAttribute(n)]);return o},i=function(t,e){var n,r,i,o,s;for(o=t.getElementsByTagName(e),s=[],r=0,i=o.length;i>r;r++)n=o[r],s.push(n);return s},b=function(t){return function(e){return e.getAttribute(t)}},t.fromXML=function(t){var e,r,o,s,a,l,h;if(r=N.xml.parse(t),l=i(r,"query")[0]||i(r,"template")[0],!l)throw new Error("no query in xml");return s=b("path"),h=b("style"),a=B.pairsToObj(c(l,u)),a.view=a.view.split(/\s+/),a.sortOrder=$(a.sortOrder),a.joins=function(){var t,e,n,r;for(n=i(l,"join"),r=[],t=0,e=n.length;e>t;t++)o=n[t],"OUTER"===h(o)&&r.push(s(o));return r}(),a.constraints=function(){var t,r,o,s;for(o=i(l,"constraint"),s=[],t=0,r=o.length;r>t;t++)e=o[t],s.push(function(t){var e,r,o,s,a;return e=B.pairsToObj(c(t,n)),null!=e.ids&&(e.ids=function(){var t,n,r,i;for(r=e.ids.split(","),i=[],t=0,n=r.length;n>t;t++)a=r[t],i.push(parseInt(a,10));return i}()),s=i(t,"value"),s.length&&(e.values=function(){var t,e,n;for(n=[],t=0,e=s.length;e>t;t++)o=s[t],n.push(function(){var t,e,n,i;for(n=o.childNodes,i=[],t=0,e=n.length;e>t;t++)r=n[t],i.push(r.data);return i}().join(""));return n}()),e}(e));return s}(),a},t.prototype.constraints=[],t.prototype.views=[],t.prototype.joins={},t.prototype.constraintLogic="",t.prototype.sortOrder="",t.prototype.name=null,t.prototype.title=null,t.prototype.comment=null,t.prototype.description=null,t.prototype.removeFromSelect=function(t){var e,n,r,i;return null==t&&(t=[]),t=B.stringList(t),e=B.compose(this.expandStar,this.adjustPath),t=B.flatten(function(){var n,i,o;for(o=[],n=0,i=t.length;i>n;n++)r=t[n],o.push(e(r));return o}()),this.sortOrder=function(){var e,r,i,o,s;for(i=this.sortOrder,s=[],e=0,r=i.length;r>e;e++)n=i[e],o=n.path,Z.call(t,o)>=0||s.push(n);return s}.call(this),this.views=function(){var e,n,r,o;for(r=this.views,o=[],e=0,n=r.length;n>e;e++)i=r[e],Z.call(t,i)>=0||o.push(i);return o}.call(this),this.trigger("remove:view",t),this.trigger("change:views",this.views),this.trigger("change",this.views)},t.prototype.removeConstraint=function(t,e){var n,r,i,o;if(null==e&&(e=!1),i=this.constraints,r="string"==typeof t?function(e){return e.code===t}:function(e){var n,r;return e.path===t.path&&e.op===t.op&&e.value===t.value&&e.extraValue===t.extraValue&&t.type===e.type&&(null!=(n=e.values)?n.join("%%"):void 0)===(null!=(r=t.values)?r.join("%%"):void 0)},o=function(){var t,e,o;for(o=[],t=0,e=i.length;e>t;t++)n=i[t],r(n)||o.push(n);return o}(),o.length!==i.length-1)throw new Error(v(i,o));return this.constraints=o,e?void 0:(this.trigger("change:constraints"),this.trigger("change"),this.trigger("removed:constraint",B.find(i,r)))},t.prototype.addToSelect=function(t,e){var n,r,i,o,s,a,u,l;if(null==t&&(t=[]),null==e&&(e={}),t=B.stringList(t),r=B.compose(this.expandStar,this.adjustPath),o=B.flatten(function(){var e,n,i;for(i=[],e=0,n=t.length;n>e;e++)s=t[e],i.push(r(s));return i}()),n=function(){var t,e,n;for(n=[],t=0,e=o.length;e>t;t++)i=o[t],Z.call(this.views,i)>=0&&n.push(i);return n}.call(this),n.length)throw new Error(""+n+" already in the select list");if(n=function(){var t,e,n;for(n=[],t=0,e=o.length;e>t;t++)i=o[t],function(){var t,e,n;for(n=[],t=0,e=o.length;e>t;t++)a=o[t],a===i&&n.push(a);return n}().length>1&&n.push(i);return n}(),n.length)throw new Error(""+n+" specified multiple times as arguments to addToSelect");return(u=this.views).push.apply(u,o),e.silent?e.events=(null!=(l=e.events)?l:[]).concat(["change","add:view","change:views"]):(this.trigger("add:view change:views",o),this.trigger("change")),this},t.prototype.select=function(t,e){var n,r;r=this.views.slice();try{this.views=[],this.addToSelect(t,e)}catch(i){n=i,this.views=r,B.error(n)}return this},t.prototype.adjustPath=function(t){return t=t&&t.name?t.name:""+t,null!=this.root?t.match("^"+this.root)||(t=this.root+"."+t):this.root=t.split(".")[0],t},t.prototype.getPossiblePaths=function(t,e,n){var r,i,o,s,a;return null==t&&(t=3),null==e&&(e=!0),null==n&&(n=null),s="string"==typeof n?function(t){return t[n]()}:n,r=function(t){return function(n,i){var o,s,a,u,l,c;return l=t.getPathInfo(n),!e&&l.isReverseReference()?[]:l.isAttribute()?[l]:(o=l.getType(),c=m(function(t){return r(""+n+"."+t.name,i-1)}),u=o&&i>0?c(function(){var t,e;t=o.fields,e=[];for(a in t)s=t[a],e.push(s);return e}()):[],[l].concat(u))}}(this),i=""+t+"-"+e,null==this._possiblePaths&&(this._possiblePaths={}),o=(null!=(a=this._possiblePaths)[i]?a[i]:a[i]=r(this.root,t)).slice(),null!=s?o.filter(s):o},t.prototype.getPathInfo=function(t){var e,n,r;return e=this.adjustPath(t),n=null!=(r=this.model)&&"function"==typeof r.getPathInfo?r.getPathInfo(e,this.getSubclasses()):void 0,n&&e in this.displayNames&&(n.displayName=this.displayNames[e]),n},t.prototype.makePath=t.prototype.getPathInfo,d=function(t){return[t.path,t.type]},l=B.compose(B.pairsToObj,B.map(d),_(x("type"))),t.prototype.getSubclasses=function(){return l(this.constraints)},t.prototype.getType=function(t){return this.getPathInfo(t).getType()},t.prototype.getViewNodes=function(){var t,e;return e=function(t){return function(e){return t.getPathInfo(e).getParent()}}(this),B.uniqBy(String,function(){var n,r,i,o;for(i=this.views,o=[],n=0,r=i.length;r>n;n++)t=i[n],o.push(e(t));return o}.call(this))},t.prototype.isInView=function(t){var e,n,r;if(e=this.getPathInfo(t),!e)throw new Error("Invalid path: "+t);return e.isAttribute()?(r=e.toString(),Z.call(this.views,r)>=0):(n=e.toString(),B.any(this.getViewNodes(),function(t){return t.toString()===n}))},t.prototype.isConstrained=function(t,e){var n,r;if(null==e&&(e=!1),n=this.getPathInfo(t),!n)throw new Error("Invalid path: "+t);return r=function(t){return null!=t.op&&t.path===n.toString()},!n.isAttribute()&&e&&(r=function(t){return function(e){return null!=e.op&&(e.path===n.toString()||n.equals(t.getPathInfo(e.path).getParent()))}}(this)),B.any(this.constraints,r)},t.prototype.canHaveMultipleValues=function(t){return this.getPathInfo(t).containsCollection()},t.prototype.getQueryNodes=function(){var t,e,n,r;return r=this.getViewNodes(),e=function(){var e,r,i,o;for(i=this.constraints,o=[],e=0,r=i.length;r>e;e++)t=i[e],null==t.type&&(n=this.getPathInfo(t.path),o.push(n.isAttribute()?n.getParent():n));return o}.call(this),B.uniqBy(String,r.concat(e))},t.prototype.isInQuery=function(t){var e,n,r,i,o,s;if(n=this.getPathInfo(t)){for(r=n.toPathString(),s=this.views.concat(function(){var t,n,r,i;for(r=this.constraints,i=[],t=0,n=r.length;n>t;t++)e=r[t],null==e.type&&i.push(e.path);return i}.call(this)),i=0,o=s.length;o>i;i++)if(t=s[i],0===t.indexOf(r))return!0;return!1}return!0},t.prototype.isRelevant=function(t){var e,n,r;return n=this.getPathInfo(t),n.isAttribute()&&(n=n.getParent()),r=n.toString(),e=this.getViewNodes(),B.any(e,function(t){return t.toPathString()===r})},t.prototype.expandStar=function(t){var e,n,r,i,o,s,a,u;if(/\*$/.test(t))if(a=t.substr(0,t.lastIndexOf(".")),r=function(t){return a+t},n=this.getType(a),/\.\*$/.test(t)){if(n&&this.summaryFields[n.name])return i=B.compose(r,y),function(){var t,e,r,s;for(r=this.summaryFields[n.name],s=[],t=0,e=r.length;e>t;t++)o=r[t],this.hasView(o)||s.push(i(o));return s}.call(this)}else if(/\.\*\*$/.test(t))return u=this.expandStar(a+".*"),e=function(){var t;t=[];for(s in n.attributes)t.push(r("."+s));return t}(),B.uniqBy(S,u.concat(e));return t},t.prototype.isOuterJoin=function(t){return"OUTER"===this.joins[this.adjustPath(t)]},t.prototype.hasView=function(t){var e;return this.views&&(e=this.adjustPath(t),Z.call(this.views,e)>=0)},t.prototype.count=function(t){if(this.service.count)return this.service.count(this,t);throw new Error("This query has no service with count functionality attached.")},t.prototype.appendToList=function(t,e){var n,r,i,s,a;return(null!=t?t.name:void 0)?(n=t.name,a=function(e,n){return null==e?t.size=n.size:void 0}):(n=String(t),a=null),s=this.makeListQuery(),i={listName:n,query:s.toXML()},r=o(this.service),V(a,e,this.service.post("query/append/tolist",i).then(r))},t.prototype.selectPreservingImpliedConstraints=function(t){var e,n,r,i,o;for(null==t&&(t=[]),n=this.clone(),n.select(t),o=this.getViewNodes(),r=0,i=o.length;i>r;r++)e=o[r],this.isOuterJoined(e)||n.isInView(e||n.isConstrained(e))||null==e.getEndClass().fields.id||n.addConstraint([e.append("id"),"IS NOT NULL"]);return n},t.prototype.makeListQuery=function(){var t,e;return t=this.views.slice(),1===t.length&&(null!=(e=t[0])?e.match(/\.id$/):void 0)||(t=["id"]),this.selectPreservingImpliedConstraints(t)},t.prototype.saveAsList=function(t,e){var n,r;return r=this.makeListQuery(),n=B.copy(t),n.listName=n.listName||n.name,n.query=r.toXML(),t.tags&&(n.tags=t.tags.join(";")),V(e,this.service.post("query/tolist",n).then(o(this.service)))},t.prototype.summarise=function(t,e,n){return this.filterSummary(t,"",e,n)},t.prototype.summarize=function(){var t;return t=1<=arguments.length?et.call(arguments,0):[],this.summarise.apply(this,t)},s=function(t){var e,n,r,i,o,s,a;for(e=null!=(null!=(s=t.results[0])?s.max:void 0),a=t.results,i=0,o=a.length;o>i;i++)n=a[i],n.count=parseInt(n.count,10);return r={uniqueValues:t.uniqueValues,filteredCount:t.filteredCount},e&&(r=O(r,t.results[0])),t.stats=r,t},t.prototype.filterSummary=function(t,e,n,r){var i,o,a;return null==r&&(r=function(){}),B.isFunction(n)&&(a=[n,null],r=a[0],n=a[1]),t=this.adjustPath(t),o=this.clone(),Z.call(o.views,t)<0&&o.views.push(t),i={query:o.toXML(),summaryPath:t,format:"jsonrows"},n&&(i.size=n),e&&(i.filterTerm=e),V(r,this.service.post("query/results",i).then(s))},t.prototype.clone=function(e){var n,r,i,o;if(n=new t(this,this.service),null==n._callbacks&&(n._callbacks={}),e){o=this._callbacks;for(r in o)nt.call(o,r)&&(i=o[r],n._callbacks[r]=i);n.off("change:views",q,this)}return n},t.prototype.next=function(){var t;return t=this.clone(),this.maxRows&&(t.start=this.start+this.maxRows),t},t.prototype.previous=function(){var t;return t=this.clone(),t.start=this.maxRows?this.start-this.maxRows:0,t},t.prototype.getSortDirection=function(t){var e,n;if(e=this.adjustPath(t),!this.isInQuery(e)&&!this.isRelevant(e))throw new Error(""+t+" is not in the query");return n=B.find(this.sortOrder,function(t){var n;return n=t.path,e===n}),null!=n?n.direction:void 0},t.prototype.isOuterJoined=function(t){var e,n,r;t=this.adjustPath(t),r=this.joins;for(n in r)if(e=r[n],"OUTER"===e&&0===t.indexOf(n))return!0;return!1},t.prototype.getOuterJoin=function(t){var e,n;return t=this.adjustPath(t),e=function(){var t;t=[];for(n in this.joins)t.push(n);return t}.call(this).sort(function(t,e){return e.length-t.length}),B.find(e,function(e){return function(n){return"OUTER"===e.joins[n]&&0===t.indexOf(n)}}(this))},t.prototype._parse_sort_order=function(t){var e,n,r,i,o,s;if(null==t)throw new Error("No input");if("string"==typeof t)i={path:t,direction:"ASC"};else if(B.isArray(t))r=t[0],e=t[1],i={path:r,direction:e};else if(null==t.path){for(n in t)o=t[n],s=[n,o],r=s[0],e=s[1];i={path:r,direction:e}}else r=t.path,e=t.direction,i={path:r,direction:e};return i.path=this.adjustPath(i.path),null==i.direction&&(i.direction="ASC"),i.direction=i.direction.toUpperCase(),i},t.prototype.addOrSetSortOrder=function(t){var e,n;return t=this._parse_sort_order(t),e=this.getSortDirection(t.path),null==e?this.addSortOrder(t):e!==t.direction&&(n=B.find(this.sortOrder,function(e){var n;return n=e.path,n===t.path}),n.direction=t.direction,this.trigger("change:sortorder",this.sortOrder),this.trigger("change")),this},t.prototype.addSortOrder=function(t,e){var n;return n=(null!=e?e:{}).silent,this.sortOrder.push(this._parse_sort_order(t)),n?void 0:(this.trigger("add:sortorder",t),this.trigger("change:sortorder",this.sortOrder),this.trigger("change"))},t.prototype.orderBy=function(t,e){var n,r,i,o,s,a,u,l;for(null==e&&(e={}),o=this.sortOrder.slice(),this.sortOrder=[],a=0,u=t.length;u>a;a++)i=t[a],this.addSortOrder(this._parse_sort_order(i),{silent:!0});return n=function(){var t,e,n,i,o;for(n=this.sortOrder,o=[],t=0,e=n.length;e>t;t++)i=n[t],s=i.path,r=i.direction,o.push({path:s,direction:r});return o}.call(this),this.trigger("set:sortorder",n),F(o)!==this.getSorting()&&(e.silent?e.events=(null!=(l=e.events)?l:[]).concat(["change","change:sortorder"]):(this.trigger("change:sortorder",n),this.trigger("change"))),this},t.prototype.addJoins=function(t){var e,n,r,i,o,s,a;if(B.isArray(t)){for(s=[],i=0,o=t.length;o>i;i++)e=t[i],s.push(this.addJoin(e));return s}a=[];for(n in t)r=t[n],a.push(this.addJoin({path:n,style:r}));return a},t.prototype.addJoin=function(t){return"string"==typeof t&&(t={path:t,style:"OUTER"}),this.setJoinStyle(t.path,t.style)},t.prototype.setJoinStyle=function(e,n){if(null==n&&(n="OUTER"),e=this.adjustPath(e),n=n.toUpperCase(),Z.call(t.JOIN_STYLES,n)<0)throw new Error("Invalid join style: "+n);return this.joins[e]!==n&&(this.joins[e]=n,this.trigger("change:joins",{path:e,style:n}),this.trigger("change")),this},t.prototype.addConstraints=function(t,e){var n,r,i,o,s,a,u;if(null==e&&(e="and"),this.__silent__=!0,i=this.constraintLogic,B.isArray(t))for(a=0,u=t.length;u>a;a++)n=t[a],this.addConstraint(n,e);else{s=function(t){return function(n,r){return t.addConstraint(M(n,r),e)}}(this);for(o in t)r=t[o],s(o,r)}return this.__silent__=!1,this.trigger("add:constraint"),this.trigger("change:constraints"),i!==this.constraintLogic&&this.trigger("change:logic",this.constraintLogic),this.trigger("change")},t.prototype.addConstraint=function(t,e){var n,i,o,s,a,u,l;if(null==e&&(e="and"),"and"!==e&&"or"!==e)throw new Error("Unknown logical conjunction: "+e);return t=B.isArray(t)?k(t):g(t),"OFF"===t.switched?this:(t.path=this.adjustPath(t.path),null==t.type&&(t.op=C(t.op)),this.constraints.push(t),o="or"===e||(null!=(l=this.constraintLogic)?l.length:void 0)>0,s=this.constraints.length,u=this.constraintLogic,o&&(a=2===s?""+r[0]+" "+e+" "+r[1]:(i=this.constraintLogic,i||(i=function(){var t,e,i;for(i=[],n=t=0,e=s-2;e>=0?e>=t:t>=e;n=e>=0?++t:--t)i.push(r[n]);return i}().join(" and ")),"("+i+") "+e+" "+r[s-1]),this.constraintLogic=a),this.__silent__||(this.trigger("add:constraint",t),this.trigger("change:constraints"),u!==this.constraintLogic&&this.trigger("change:logic",this.constraintLogic),this.trigger("change")),this)},t.prototype.getSorting=function(){return F(this.sortOrder)},t.prototype.getConstraintXML=function(){var t,e;return e=function(){var e,n,r,i;for(r=this.constraints,i=[],e=0,n=r.length;n>e;e++)t=r[e],(null==t.type||this.isInQuery(t.path))&&i.push(t);return i}.call(this),e.length?m(p)(m(S)(L(function(t){return null!=t.type})(e))):""},t.prototype.getJoinXML=function(){var t,e,n;return n=function(){var n,r;n=this.joins,r=[];for(t in n)e=n[t],this.isInQuery(t)&&"OUTER"===e&&r.push('<join path="'+t+'" style="OUTER"/>');return r}.call(this),n.join("")},t.prototype.toXML=function(){var t,e,n,r;return t={model:this.model.name,view:this.views.join(" "),sortOrder:this.getSorting(),constraintLogic:this.constraintLogic},null!=this.name&&(t.name=this.name),e=function(){var e;e=[];for(n in t)r=t[n],r&&e.push(n+'="'+r+'"');return e}().join(" "),"<query "+e+" >"+this.getJoinXML()+this.getConstraintXML()+"</query>"},t.prototype.toJSON=function(){var t,e,n,r,i;return I({name:this.name,title:this.title,comment:this.comment,description:this.description,constraintLogic:this.constraintLogic,from:this.root,select:function(){var t,e,n,r;for(n=this.views,r=[],t=0,e=n.length;e>t;t++)i=n[t],r.push(T(i));return r}.call(this),orderBy:function(){var t,r,i,o,s;for(i=this.sortOrder,s=[],t=0,r=i.length;r>t;t++)o=i[t],n=o.path,e=o.direction,s.push({path:T(n),direction:e});return s}.call(this),joins:function(){var t,e;t=this.joins,e=[];for(n in t)r=t[n],"OUTER"===r&&e.push(T(n));return e}.call(this),where:function(){var e,n,r,i;for(r=this.constraints,i=[],e=0,n=r.length;n>e;e++)t=r[e],i.push(f(t));return i}.call(this)})},t.prototype.fetchCode=function(t,e){var n;return n={query:this.toXML(),lang:t},V(e,this.service.post("query/code",n).then(this.service.VERIFIER).then(x("code")))},t.prototype.setName=function(t){this.name=t},t.prototype.save=function(t,e){return a(this.service,16,function(n){return function(){var r,i;return B.isFunction(t)&&(i=[null,t],t=i[0],e=i[1]),null!=t&&n.setName(t),r={type:"PUT",path:"user/queries",data:n.toXML(),contentType:"application/xml",dataType:"json"},V(e,n.service.authorise(r)).then(function(t){return n.service.doReq(t)}).then(function(t){return t.queries})}}(this))},t.prototype.store=function(t,e){return a(this.service,16,function(n){return function(){var r,i,o,s;return B.isFunction(t)&&(s=[null,t],t=s[0],e=s[1]),null!=t&&n.setName(t),o=function(t,e){return null==t?n.setName(e):void 0},r=B.compose(x(n.name),x("queries")),i={type:"POST",path:"user/queries",data:n.toXML(),contentType:"application/xml",dataType:"json"},V(e,o,n.service.authorise(i)).then(function(t){return n.service.doReq(t)}).then(r)}}(this))},t.prototype.saveAsTemplate=function(t,e){return a(this.service,16,function(n){return function(){var r,i;if(B.isFunction(t)&&(i=[null,t],t=i[0],e=i[1]),null!=t&&n.setName(t),!n.name)throw new Error("Templates must have a name");return r={type:"POST",path:"templates",data:"<template "+h(n,["name","title","comment"])+">"+n.toXML()+"</template>",contentType:"application/xml",dataType:"json"},V(e,n.service.authorise(r).then(function(t){return n.service.doReq(t)}))}}(this))},t.prototype.getCodeURI=function(t){var e,n;return e={query:this.toXML(),lang:t,format:"text"},null!=(null!=(n=this.service)?n.token:void 0)&&(e.token=this.service.token),""+this.service.root+"query/code?"+z(e)},t.prototype.getExportURI=function(e,n){var r,i;return null==e&&(e="tab"),null==n&&(n={}),Z.call(t.BIO_FORMATS,e)>=0?this["get"+e.toUpperCase()+"URI"](n):(r=O(n,{query:this.toXML(),format:e}),null!=(null!=(i=this.service)?i.token:void 0)&&(r.token=this.service.token),""+this.service.root+"query/results?"+z(r))},t.prototype.needsAuthentication=function(){return B.any(this.constraints,function(t){var e;return"NOT IN"===(e=t.op)||"IN"===e})},t.prototype.fetchQID=function(t){return V(t,this.service.post("queries",{query:this.toXML()}).then(x("id")))},e=function(t){return t.append("primaryIdentifier").toString()},t.prototype.__bio_req=function(t,n){var r,i;return i=this.makeListQuery(),r=function(e){return B.any(t,function(t){return e.isa(t)})},i.views=B.take(n)(function(){var t,i,o,s;for(o=this.getViewNodes(),s=[],t=0,i=o.length;i>t;t++)n=o[t],r(n)&&s.push(e(n));return s}.call(this)),{query:i.toXML(),format:"text"}},t.prototype._fasta_req=function(){return this.__bio_req(["SequenceFeature","Protein"],1)},t.prototype._gff3_req=function(){return this.__bio_req(["SequenceFeature"])},t.prototype._bed_req=t.prototype._gff3_req,t}(),H=w(function(t,e){return t.concat(e)}),s.prototype.toString=s.prototype.toXML,s.ATTRIBUTE_OPS=H([s.ATTRIBUTE_VALUE_OPS,s.MULTIVALUE_OPS,s.NULL_OPS]),s.REFERENCE_OPS=H([s.TERNARY_OPS,s.LOOP_OPS,s.LIST_OPS]),c=function(t,e){return function(n,r){var i,o,s,a,u;return null==n&&(n={}),null==r&&(r=function(){}),B.isFunction(n)&&(u=[{},n],n=u[0],r=u[1]),i=function(t){return function(e){var n;return n=t.getPathInfo(e),n.isAttribute()?n:n.append("id")}}(this),null!=(null!=n?n.view:void 0)&&(n.view=function(){var t,e,r,i;for(r=n.view,i=[],t=0,e=r.length;e>t;t++)a=r[t],i.push(this.getPathInfo(a).toString());return i}.call(this)),o=null!=n["export"]?this.selectPreservingImpliedConstraints(n["export"].map(i)):this,s=O(o[t](),n),e.call(o,s,r)}},K=s.BIO_FORMATS,W=function(t){var e,n,r;return n="_"+t+"_req",e="get"+t.toUpperCase(),r=e+"URI",s.prototype[e]=c(n,function(e,n){return V(n,this.service.post("query/results/"+t,e))}),s.prototype[r]=c(n,function(e,n){return null!=this.service.token&&(e.token=this.service.token),""+this.service.root+"query/results/"+t+"?"+z(e)})};for(G=0,Q=K.length;Q>G;G++)b=K[G],W(b);for(J=function(t){return function(){var e,n,r,i;if(n=arguments[0],e=2<=arguments.length?et.call(arguments,1):[],this.service[t])return null==n?n={}:B.isFunction(n)&&(n={},e=function(){var t,e,n;for(n=[],t=0,e=arguments.length;e>t;t++)r=arguments[t],n.push(r);return n}.apply(this,arguments)),n=I(O({start:this.start,size:this.maxRows},n)),(i=this.service)[t].apply(i,[this,n].concat(et.call(e)));throw new Error("Service does not provide '"+t+"'.")}},X=0,Y=u.length;Y>X;X++)A=u[X],s.prototype[A]=J(A);i.mixin(s.prototype),s.prototype.emit=s.prototype.trigger,s.prototype.bind=s.prototype.on,N.Query=s}).call(this)},{"./util":290,"./xml":292,"backbone-events-standalone":297}],286:[function(t,e,n){(function(){var e,r,i,o,s,a,u,l,c,h,p,f,d,m,g,y,v,b,_,w,x,C,T,S,E,N,k,M,P,O,A,R,I,D,L,q,j,$,F,z,U,H,B,V,W,J,G,X,Q,Y,K,Z,tt,et,nt,rt,it,ot,st,at,ut,lt,ct,ht,pt,ft,dt=function(t,e){return function(){return t.apply(e,arguments)}},mt={}.hasOwnProperty,gt=[].slice;for(C=t("./promise"),v=t("./model").Model,E=t("./query").Query,m=t("./lists").List,$=t("./user").User,c=t("./id-resolution-job").IDResolutionJob,ot=t("./version"),it=t("./util"),Q=t("./http"),rt=it.querystring,st=it.withCB,K=it.map,Z=it.merge,G=it.get,et=it.set,Y=it.invoke,
nt=it.success,J=it.error,M=it.REQUIRES_VERSION,W=it.dejoin,F={},r={},N={},g={},R={},H={},s="http://",z="version",L="templates",k="version/release",i="classkeys",p="lists",y="model",A="summaryfields",T="query/results",S="search",B="widgets",a="list/enrichment",V="listswithobject",f={union:"lists/union",intersection:"lists/intersect",difference:"lists/diff"},P="lists/subtract",U="user/whoami",D=T+"/tablerows",x="user/preferences",w="path/values",j="user/tokens",h="ids",_={},pt=[z,k,i,B,y,A,S,w],ut=0,ct=pt.length;ct>ut;ut++)tt=pt[ut],_[tt]=!0;for(e={},ft=[U,x,f,P,V,a,L,j],lt=0,ht=ft.length;ht>lt;lt++)tt=ft[lt],e[tt]=!0;b=function(t,n){return _[t]?!1:e[t]?!0:(null!=n?n.needsAuthentication:void 0)?n.needsAuthentication():!0},u=/^https?:\/\//i,l=/service\/?$/i,O="/service/",o=function(t){var e,n;return(e=null!=(n=console.error)?n:console.log)(t)},at=function(t,e,n,r,i){var o,s,a,u,l;return a=this.root,u=this.useCache,s=null!=this[t]?this[t]:this[t]=u&&(l=e[a])?nt(l):(o={type:"GET",dataType:"json",data:{format:"json"}},this.doReq(Z(o,{url:this.root+n})).then(function(t){return e[a]=t[r]})),st(i,s)},X=function(t){return function(e){return new C(function(n,r){var i;return(i=it.find(e,function(e){return e.name===t}))?n(i):r('List "'+t+'" not found among: '+e.map(G("name")))})}},d=function(t,e){return null==e&&(e="listName"),it.compose(t.fetchList,G(e))},q=function(t){var e,n,r,i,o,s;for(null==t&&(t=[]),i=it.isArray(t)?t:[t],s=[],n=0,r=i.length;r>n;n++)e=i[n],s.push(null!=(o=e.name)?o:e);return s},I=function(){function t(t){var e;if(this.root=t.root,this.token=t.token,this.errorHandler=t.errorHandler,this.DEBUG=t.DEBUG,this.help=t.help,e=t.noCache,this.connectAs=dt(this.connectAs,this),this.createList=dt(this.createList,this),this.resolveIds=dt(this.resolveIds,this),this.templateQuery=dt(this.templateQuery,this),this.savedQuery=dt(this.savedQuery,this),this.query=dt(this.query,this),this.fetchRelease=dt(this.fetchRelease,this),this.fetchClassKeys=dt(this.fetchClassKeys,this),this.fetchVersion=dt(this.fetchVersion,this),this.fetchSummaryFields=dt(this.fetchSummaryFields,this),this.fetchModel=dt(this.fetchModel,this),this.fetchWidgetMap=dt(this.fetchWidgetMap,this),this.fetchWidgets=dt(this.fetchWidgets,this),this.complement=dt(this.complement,this),this.fetchListsContaining=dt(this.fetchListsContaining,this),this.fetchList=dt(this.fetchList,this),this.findLists=dt(this.findLists,this),this.fetchLists=dt(this.fetchLists,this),this.fetchTemplates=dt(this.fetchTemplates,this),this.tableRows=dt(this.tableRows,this),this.values=dt(this.values,this),this.rows=dt(this.rows,this),this.records=dt(this.records,this),this.table=dt(this.table,this),this.pathValues=dt(this.pathValues,this),this.fetchUser=dt(this.fetchUser,this),this.whoami=dt(this.whoami,this),this.findById=dt(this.findById,this),this.count=dt(this.count,this),this.enrichment=dt(this.enrichment,this),null==this.root)throw new Error("No service root provided. This is required");u.test(this.root)||(this.root=s+this.root),l.test(this.root)||(this.root=this.root+O),this.root=this.root.replace(/ice$/,"ice/"),null==this.errorHandler&&(this.errorHandler=o),null==this.help&&(this.help="no.help.available@dev.null"),this.useCache=!e,this.getFormat=function(t){return function(t){return null==t&&(t="json"),t}}(this)}var e,n,_,C,I,j;return t.prototype.doReq=Q.doReq,t.prototype.post=function(t,e){return this.makeRequest("POST",t,e)},t.prototype.get=function(t,e){return this.makeRequest("GET",t,e)},t.prototype.makeRequest=function(t,e,n,r,i){var o,s,a,u,l,c,h;return null==t&&(t="GET"),null==e&&(e=""),null==n&&(n={}),null==r&&(r=function(){}),null==i&&(i=!1),it.isArray(r)&&(l=r,r=l[0],s=l[1]),it.isArray(n)&&(n=it.pairsToObj(n)),null==s&&(s=this.errorHandler),n=it.copy(n),o=this.getFormat(n.format),Q.supports(t)||(c=[t,Q.getMethod(t)],n.method=c[0],t=c[1]),a={data:n,dataType:o,success:r,error:s,path:e,type:t},null!=n.auth&&(a.auth=n.auth,delete a.data.auth),null!=n.headers&&(a.headers=it.copy(n.headers),delete a.data.headers),(u=null!=(h=n.timeout)?h:this.timeout)&&(a.timeout=u,delete n.timeout),this.authorise(a).then(function(t){return function(e){return t.doReq(e,i)}}(this))},t.prototype.authorise=function(t){return this.fetchVersion().then(function(e){return function(n){var r,i,o;return r=it.copy(t),null==r.headers&&(r.headers={}),r.url=e.root+r.path,i=[],14>n&&("string"==typeof r.data?i.push(["format",r.dataType]):r.data.format=r.dataType),null!=e.token&&b(t.path,null!=(o=r.data)?o.query:void 0)&&(n>=14?r.headers.Authorization="Token "+e.token:"string"==typeof r.data?i.push(["token",e.token]):r.data.token=e.token),i.length&&(r.url+="?"+rt(i)),r}}(this))},t.prototype.enrichment=function(t,e){return M(this,8,function(n){return function(){var r;return r=Z({maxp:.05,correction:"Holm-Bonferroni"},t),st(e,n.get(a,r).then(G("results")))}}(this))},t.prototype.search=function(t,e){return null==t&&(t={}),null==e&&(e=function(){}),M(this,9,function(n){return function(){var r,i,o,s;if(it.isFunction(t)&&(s=[t,{}],e=s[0],t=s[1]),"string"==typeof t)i={q:t};else{i={q:t.q};for(r in t)mt.call(t,r)&&(o=t[r],"q"!==r&&(i["facet_"+r]=o))}return st(e,n.post(S,i))}}(this))},t.prototype.makePath=function(t,e,n){return null==e&&(e={}),null==n&&(n=function(){}),st(n,this.fetchModel().then(function(n){return n.makePath(t,e)}))},t.prototype.count=function(t,e){var n,r;return null==e&&(e=function(){}),n=t?null!=t.toPathString?(tt=t.isClass()?t.append("id"):t,this.pathValues(tt,"count")):null!=t.toXML?(r={query:t,format:"jsoncount"},this.post(T,r).then(G("count"))):"string"==typeof t?this.fetchModel().then(function(e){return function(n){var r;try{return e.count(n.makePath(t))}catch(i){return r=i,e.query({select:[t]}).then(e.count)}}}(this)):this.query(t).then(this.count):J("Not enough arguments"),st(e,n)},t.prototype.findById=function(t,e,n,r){var i,o;return null==n&&(n=["**"]),null==r&&(r=function(){}),it.isFunction(n)&&(o=[["**"],n],n=o[0],r=o[1]),i=this.query({from:t,select:n,where:{id:e}}).then(W).then(Y("records")).then(G(0)),st(r,i)},t.prototype.lookup=function(t,e,n,r){var i,o;return it.isFunction(n)&&(o=[null,n],n=o[0],r=o[1]),i=this.query({from:t,select:["**"],where:[[t,"LOOKUP",e,n]]}).then(W).then(Y("records")),st(r,i)},t.prototype.find=function(t,e,n,r){var i;return it.isFunction(n)&&(i=[null,n],n=i[0],r=i[1]),st(r,this.lookup(t,e,n).then(function(t){return null==t||0===t.length?J("Nothing found"):t.length>1?J("Multiple items found: "+t.slice(0,3)+"..."):nt(t[0])}))},t.prototype.whoami=function(t){return M(this,9,function(e){return function(){return st(t,e.get(U).then(G("user")).then(function(t){return new $(e,t)}))}}(this))},t.prototype.fetchUser=function(){var t;return t=1<=arguments.length?gt.call(arguments,0):[],this.whoami.apply(this,t)},I=function(t,e){return{format:t,path:String(e),typeConstraints:JSON.stringify(e.subclasses)}},t.prototype.pathValues=function(t,e,n){return null==e&&(e={}),M(this,6,function(r){return function(){var i,o,s,a,u;return"string"==typeof e&&(a=e,e={}),it.isFunction(e)&&(u=[n,e],e=u[0],n=u[1]),"count"!==a&&(a="results"),o="count"===a?"jsoncount":"json",s=function(){var n;try{return this.fetchModel().then(Y("makePath",t,null!=(n=t.subclasses)?n:e)).then(function(t){return I(o,t)}).then(function(t){return function(e){return t.post(w,e)}}(this)).then(G(a))}catch(r){return i=r,J(i)}}.call(r),st(n,s)}}(this))},t.prototype.doPagedRequest=function(t,e,n,r,i){var o,s;return null==n&&(n={}),null==i&&(i=function(){}),null!=t.toXML?(it.isFunction(n)&&(s=[n,{}],i=s[0],n=s[1]),o=Z(n,{query:t,format:r}),st(i,this.post(e,o).then(G("results")))):this.query(t).then(function(t){return function(o){return t.doPagedRequest(o,e,n,r,i)}}(this))},t.prototype.table=function(t,e,n){return this.doPagedRequest(t,T,e,"jsontable",n)},t.prototype.records=function(t,e,n){return this.doPagedRequest(t,T,e,"jsonobjects",n)},t.prototype.rows=function(t,e,n){return this.doPagedRequest(t,T,e,"json",n)},t.prototype.values=function(t,e,n){var r,i;return it.isFunction(e)&&(i=[e,n],n=i[0],e=i[1]),r=null==t?J("No query term supplied"):null!=t.descriptors||"string"==typeof t?this.pathValues(t,e).then(K(G("value"))):null!=t.toXML?1!==t.views.length?J("Expected one column, got "+t.views.length):this.rows(t,e).then(K(G(0))):this.query(t).then(function(t){return function(n){return t.values(n,e)}}(this)),st(n,r)},t.prototype.tableRows=function(t,e,n){return this.doPagedRequest(t,D,e,"json",n)},t.prototype.fetchTemplates=function(t){return st(t,this.get(L).then(G("templates")))},t.prototype.fetchLists=function(t){return this.findLists("",t)},t.prototype.findLists=function(t,e){return null==t&&(t=""),null==e&&(e=function(){}),this.fetchVersion().then(function(n){return function(r){var i;return st(e,t&&13>r?J("Finding lists by name on the server requires version 13. This is only "+r):(i=function(t){var e,r,i,o;for(o=[],r=0,i=t.length;i>r;r++)e=t[r],o.push(new m(e,n));return o},n.get(p,{name:t}).then(G("lists")).then(i)))}}(this))},t.prototype.fetchList=function(t,e){return this.fetchVersion().then(function(n){return function(r){return st(e,13>r?n.findLists().then(X(t)):n.findLists(t).then(G(0)))}}(this))},t.prototype.fetchListsContaining=function(t,e){var n;return n=function(t){return function(e){var n,r,i,o;for(o=[],r=0,i=e.length;i>r;r++)n=e[r],o.push(new m(n,t));return o}}(this),st(e,this.get(V,t).then(G("lists")).then(n))},t.prototype.combineLists=function(t,e,n){var r,i,o,s,a,u;return u=Z({lists:[],tags:[]},e),o=u.name,i=u.lists,a=u.tags,r=u.description,s={name:o,description:r},null==s.description&&(s.description=""+t+" of "+i.join(", ")),s.tags=a.join(";"),s.lists=i.join(";"),st(n,this.get(f[t],s).then(d(this)))},t.prototype.merge=function(){return this.combineLists.apply(this,["union"].concat(gt.call(arguments)))},t.prototype.intersect=function(){return this.combineLists.apply(this,["intersection"].concat(gt.call(arguments)))},t.prototype.diff=function(){return this.combineLists.apply(this,["difference"].concat(gt.call(arguments)))},t.prototype.complement=function(t,e){var n,r,i,o,s,a,u,l,c;return null==t&&(t={}),null==e&&(e=function(){}),o=t.from,i=t.exclude,a=t.name,r=t.description,c=t.tags,n=function(){return"Relative complement of "+s.join(" and ")+" in "+u.join(" and ")},u=q(o),s=q(i),null==a&&(a=n()),null==r&&(r=n()),null==c&&(c=[]),l={name:a,description:r,tags:c,lists:s,references:u},st(e,this.post(P,l).then(d(this)))},t.prototype.fetchWidgets=function(t){return M(this,8,function(e){return function(){return at.call(e,"widgets",H,B,"widgets",t)}}(this))},j=it.omap(function(t){return[t.name,t]}),t.prototype.fetchWidgetMap=function(t){return M(this,8,function(e){return function(){return st(t,null!=e.__wmap__?e.__wmap__:e.__wmap__=e.fetchWidgets().then(j))}}(this))},t.prototype.fetchModel=function(t){var e;return e=at.call(this,"model",g,y,"model").then(v.load).then(et({service:this})),st(t,e)},t.prototype.fetchSummaryFields=function(t){return at.call(this,"summaryFields",R,A,"classes",t)},t.prototype.fetchVersion=function(t){return at.call(this,"version",F,z,"version",t)},t.prototype.fetchClassKeys=function(t){return at.call(this,"classkeys",r,i,"classes",t)},t.prototype.fetchRelease=function(t){return at.call(this,"release",N,k,"version",t)},t.prototype.query=function(t,e){var n;return n=function(e){return function(n){var r,i;return r=n[0],i=n[1],new E(t,e,{model:r,summaryFields:i})}}(this),st(e,it.parallel(this.fetchModel(),this.fetchSummaryFields()).then(n))},C=function(t,e){return function(n){return n?t.query(n):J("No query found called "+e)}},n=function(t){return t?"string"==typeof t?nt():J("Name must be a string"):J("Name not provided")},t.prototype.savedQuery=function(t,e){return M(this,16,function(r){return function(){return n(t).then(function(){return st(e,r.get("user/queries",{filter:t}).then(function(e){return e.queries[t]}).then(C(r,t)))})}}(this))},t.prototype.templateQuery=function(t,e){return n(t).then(function(n){return function(){return st(e,n.fetchTemplates().then(G(t)).then(et("type","TEMPLATE")).then(C(n,t)))}}(this))},t.prototype.manageUserPreferences=function(t,e,n){return M(this,11,function(r){return function(){return st(n,r.makeRequest(t,x,e).then(G("preferences")))}}(this))},t.prototype.resolveIds=function(t,e){return M(this,10,function(n){return function(){var r;return r={type:"POST",url:n.root+h,contentType:"application/json",data:JSON.stringify(t),dataType:"json"},st(e,n.doReq(r).then(G("uid")).then(c.create(n)))}}(this))},t.prototype.resolutionJob=function(t){return c.create(this)(t)},t.prototype.createList=function(t,e,n){var r,i;return null==t&&(t={}),null==e&&(e=""),null==n&&(n=function(){}),r=function(e){return function(n){return Z(n,{token:e.token,tags:t.tags||[]})}}(this),i={data:it.isArray(e)?e.map(function(t){return'"'+t+'"'}).join("\n"):e,dataType:"json",url:""+this.root+"lists?"+rt(r(t)),type:"POST",contentType:"text/plain"},st(n,this.doReq(i).then(d(this)))},_=function(t){return t.user.temporaryToken},t.prototype.connectAs=function(e){return t.connect(Z(this,{token:e,noCache:!this.useCache}))},t.prototype.register=function(t,e,n){return M(this,9,function(r){return function(){return st(n,r.post("users",{name:t,password:e}).then(_).then(r.connectAs))}}(this))},e=300,t.prototype.getDeregistrationToken=function(t,n){return null==t&&(t=e),M(this,16,function(e){return function(){var r;return r=null!=e.token?e.post("user/deregistration",{validity:t}).then(G("token")):J("Not registered"),st(n,r)}}(this))},t.prototype.deregister=function(t,e){return M(this,16,function(n){return function(){return st(e,n.makeRequest("DELETE","user",{deregistrationToken:t,format:"xml"}))}}(this))},t.prototype.login=function(t,e,n){return M(this,9,function(r){return function(){var i;return i=""+t+":"+e,st(n,r.logout().then(function(t){return t.get("user/token",{auth:i})})).then(G("token")).then(r.connectAs)}}(this))},t.prototype.logout=function(t){return st(t,nt(this.connectAs()))},t}(),I.prototype.rowByRow=function(){var t,e,n;return n=arguments[0],t=2<=arguments.length?gt.call(arguments,1):[],e=Q.iterReq("POST",T,"json"),null!=n.toXML?e.apply(this,arguments):this.query(n).then(function(e){return function(n){return e.rowByRow.apply(e,[n].concat(gt.call(t)))}}(this))},I.prototype.eachRow=I.prototype.rowByRow,I.prototype.recordByRecord=function(){var t,e,n;return n=arguments[0],t=2<=arguments.length?gt.call(arguments,1):[],e=Q.iterReq("POST",T,"jsonobjects"),null!=n.toXML?e.apply(this,arguments):this.query(n).then(function(e){return function(n){return e.recordByRecord.apply(e,[n].concat(gt.call(t)))}}(this))},I.prototype.eachRecord=I.prototype.recordByRecord,I.prototype.union=I.prototype.merge,I.prototype.difference=I.prototype.diff,I.prototype.symmetricDifference=I.prototype.diff,I.prototype.relativeComplement=I.prototype.complement,I.prototype.subtract=I.prototype.complement,I.flushCaches=function(){return g={},F={},N={},r={},R={},H={}},I.connect=function(t){if(null==(null!=t?t.root:void 0))throw new Error("Invalid options provided: "+JSON.stringify(t));return new I(t)},n.Service=I,n.Model=v,n.Query=E,n.utils=it,n.VERSION=ot.VERSION,n.imjs=ot}).call(this)},{"./http":279,"./id-resolution-job":280,"./lists":281,"./model":282,"./promise":284,"./query":285,"./user":289,"./util":290,"./version":291}],287:[function(t,e,n){(function(t){(function(){var e;n.DOMParser=null!=t.DOMParser?t.DOMParser:e=function(){function t(){throw new Error("DOMParser is not available")}return t}()}).call(this)}).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],288:[function(t,e,n){(function(){var e,r,i,o=function(t,e){return function(){return t.apply(e,arguments)}};r=function(t,e){var n,r,i;i=[];for(n in t)r=t[n],i.push(e[n]=r);return i},e=t("./promise"),i=["attributes","references","collections"],n.Table=function(){function t(t,e){var n,s,a,u,l,c,h;for(this.model=e,this.getDisplayName=o(this.getDisplayName,this),this.name=t.name,this.tags=t.tags,this.displayName=t.displayName,this.attributes=t.attributes,this.references=t.references,this.collections=t.collections,this.fields={},this.__parents__=null!=(c=t["extends"])?c:[],u=0,l=i.length;l>u;u++){if(s=i[u],null==this[s])throw new Error("Bad model data: missing "+s);r(this[s],this.fields)}h=this.collections;for(a in h)n=h[a],n.isCollection=!0}return t.prototype.toString=function(){var t,e;return"[Table name="+this.name+", fields=["+function(){var n,r;n=this.fields,r=[];for(t in n)e=n[t],r.push(t);return r}.call(this)+"]]"},t.prototype.parents=function(){var t;return(null!=(t=this.__parents__)?t:[]).slice()},t.prototype.getDisplayName=function(){return new e(function(t){return function(e,n){return null!=t.model?e(t.model.makePath(t.name).getDisplayName()):n(new Error("model not set - cannot make path"))}}(this))},t}()}).call(this)},{"./promise":284}],289:[function(t,e,n){(function(){var e,r,i,o,s,a,u,l=function(t,e){return function(){return t.apply(e,arguments)}};u=t("./util"),a=u.withCB,o=u.get,s=u.isFunction,e=u.any,i=u.error,r=function(t,e,n,r){return t.service.manageUserPreferences(n,e,r).then(function(e){return t.preferences=e})},n.User=function(){function t(t,e){this.service=t,this.username=e.username,this.preferences=e.preferences,this.refresh=l(this.refresh,this),this.clearPreferences=l(this.clearPreferences,this),this.clearPreference=l(this.clearPreference,this),this.setPreferences=l(this.setPreferences,this),this.setPreference=l(this.setPreference,this),this.hasPreferences=null!=this.preferences,null==this.preferences&&(this.preferences={})}return t.prototype.setPreference=function(t,e,n){var r,o;if(s(e)&&(o=[null,e],e=o[0],n=o[1]),"string"==typeof t)r={},r[t]=e;else{if(null!=e)return a(n,i("Incorrect arguments to setPreference"));r=t}return this.setPreferences(r,n)},t.prototype.setPreferences=function(t,e){return r(this,t,"POST",e)},t.prototype.clearPreference=function(t,e){return r(this,{key:t},"DELETE",e)},t.prototype.clearPreferences=function(t){return r(this,{},"DELETE",t)},t.prototype.refresh=function(t){return r(this,{},"GET",t)},t.prototype.createToken=function(t,n,r){var i,u;return null==t&&(t="day"),null==r&&e([t,n],s)&&(s(t)?(i=[null,null,t],t=i[0],n=i[1],r=i[2]):s(n)&&(u=[null,n],n=u[0],r=u[1])),a(r,this.service.post("user/tokens",{type:t,message:n}).then(o("token")))},t.prototype.fetchCurrentTokens=function(t){return a(t,this.service.get("user/tokens").then(o("tokens")))},t.prototype.revokeAllTokens=function(t){return a(t,this.service.makeRequest("DELETE","user/tokens"))},t.prototype.revokeToken=function(t,e){return a(e,this.service.makeRequest("DELETE","user/tokens/"+t))},t}()}).call(this)},{"./util":290}],290:[function(t,e,n){(function(){var e,r,i,o,s,a,u,l,c,h,p,f,d,m,g,y,v,b,_,w,x=[].slice,C=[].indexOf||function(t){for(var e=0,n=this.length;n>e;e++)if(e in this&&this[e]===t)return e;return-1},T={}.hasOwnProperty;e=t("./promise"),v=n,v.defer=function(){var t;return t={},t.promise=new e(function(e,n){return t.resolve=e,t.reject=n}),t},s=function(t){return encodeURIComponent(String(t))},y=function(t){var e;return function(){var n,r,i;for(i=[],n=0,r=t.length;r>n;n++)e=t[n],i.push(e.map(s).join("="));return i}().join("&")},v.querystring=function(t){var e,n,r,i,o,s;if(!t)return"";if(d(t))r=t.slice();else{r=[];for(e in t)s=t[e],d(s)?(i=function(){var t,n,r;for(r=[],t=0,n=s.length;n>t;t++)o=s[t],r.push([e,o]);return r}(),r=r.concat(i)):r.push([e,s])}return y(function(){var t,e,i;for(i=[],t=0,e=r.length;e>t;t++)n=r[t],null!=n[1]&&i.push(n);return i}())},v.curry=o=function(){var t,e;return e=arguments[0],t=2<=arguments.length?x.call(arguments,1):[],function(){var n;return n=1<=arguments.length?x.call(arguments,0):[],e.apply(null,t.concat(n))}},v.error=u=function(t){return new e(function(e,n){return n(new Error(t))})},v.success=b=function(t){return new e(function(e,n){return e(t)})},v.parallel=function(){var t;return t=1<=arguments.length?x.call(arguments,0):[],e.all(1===t.length&&!t[0].then&&t[0].length?t[0]:t)},v.withCB=function(){var t,e,n,r,i,s,a,u;for(e=2<=arguments.length?x.call(arguments,0,s=arguments.length-1):(s=0,[]),i=arguments[s++],a=0,u=e.length;u>a;a++)t=e[a],null!=t&&(r=o(t,null),n=t,i.then(r,n));return i},v.fold=c=function(t){return function(e,n){var r,i,o;if(1===arguments.length&&(n=(null!=e?e.slice():void 0)||e,e=(null!=n?n.shift():void 0)||{}),null==n)throw new Error("xs is null");if(null!=n.reduce)return n.reduce(t,e);i=e;for(r in n)o=n[r],i=null!=i?t(i,r,o):{k:o};return i}},v.take=function(t){return function(e){return null!=t?e.slice(0,+(t-1)+1||9e9):e.slice()}},v.filter=function(t){return function(e){var n,r,i,o;for(o=[],r=0,i=e.length;i>r;r++)n=e[r],t(n)&&o.push(n);return o}},v.uniqBy=function(t,e){var n,r,i,s,a,u;if(1===arguments.length)return o(v.uniqBy,t);if(r=[],i=[],null==e)return i;for(a=0,u=e.length;u>a;a++)s=e[a],n=t(s),C.call(r,n)<0&&(r.push(n),i.push(s));return i},v.find=function(t,e){var n,r,i;if(1===arguments.length)return e=t,function(t){return v.find(t,e)};for(r=0,i=t.length;i>r;r++)if(n=t[r],e(n))return n;return null},d=null!=(w=Array.isArray)?w:function(t){return null!=(null!=t?t.splice:void 0)&&null!=(null!=t?t.push:void 0)&&null!=(null!=t?t.pop:void 0)&&null!=(null!=t?t.slice:void 0)},v.isArray=d,v.isFunction="function"!=typeof/./?function(t){return"function"==typeof t}:function(t){return null!=t&&null!=t.call&&null!=t.apply&&"[object Function]"===t.toString()},a={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&apos;"},v.escape=function(t){var e,n,r,i,o,s;if(null==t)return"";for(i=String(t).replace(/[&<>"']/g,function(t){return a[t]}),r=[],n=o=0,s=i.length;s>=0?s>=o:o>=s;n=s>=0?++o:--o)e=i.charCodeAt(n),r.push(e>256?"&#"+e+";":i.charAt(n));return r.join("")},v.omap=function(t){var e;return e=c(function(e,n,r){var i,o,s;return s=t(n,r),i=s[0],o=s[1],d(o)&&(o=o.slice()),e[i]=o,e}),function(t){return e({},t)}},v.copy=v.omap(function(t,e){return[t,e]}),v.partition=function(t){return function(e){var n;return(n=c(function(e,n){var r,i;return i=e[0],r=e[1],t(n)?[i.concat([n]),r]:[i,r.concat([n])]}))([[],[]],e)}},v.id=h=function(t){return t},v.concatMap=function(t){return function(e){var n,r,i,o,s;for(r=void 0,o=0,s=e.length;s>o;o++)i=e[o],n=t(i),r=void 0===r?n:"number"==typeof r?r+n:null!=r.concat?r.concat(n):m(r,n);return r}},v.map=function(t){return p("map",t)},i=c(function(t,e){return function(){var n;return n=1<=arguments.length?x.call(arguments,0):[],t(e.apply(null,n))}}),v.compose=function(){var t;return t=1<=arguments.length?x.call(arguments,0):[],i(t)},v.flatMap=v.concatMap,v.difference=function(t,e){var n,r,i,o;for(o=[],r=0,i=t.length;i>r;r++)n=t[r],C.call(e,n)<0&&o.push(n);return o},v.stringList=function(t){return"string"==typeof t?[t]:t},v.flatten=l=function(){var t,e,n,r,i,o,s,a,u;for(n=1<=arguments.length?x.call(arguments,0):[],t=[],i=0,s=n.length;s>i;i++)if(e=n[i],d(e))for(u=l.apply(null,e),o=0,a=u.length;a>o;o++)r=u[o],t.push(r);else t.push(e);return t},v.sum=v.concatMap(h),v.merge=m=function(){var t,e,n,r,i,o,s;for(r=1<=arguments.length?x.call(arguments,0):[],e={},o=0,s=r.length;s>o;o++){n=r[o];for(t in n)T.call(n,t)&&(i=n[t],e[t]=i)}return e},v.any=function(t,e){var n,r,i;for(null==e&&(e=h),r=0,i=t.length;i>r;r++)if(n=t[r],e(n))return!0;return!1},v.invoke=p=function(){var t,e;return e=arguments[0],t=2<=arguments.length?x.call(arguments,1):[],f(e,t)},v.invokeWith=f=function(t,e,n){return null==e&&(e=[]),null==n&&(n=null),function(r){if(null==r)throw new Error('Cannot call method "'+t+'" of null');if(r[t])return r[t].apply(n||r,e);throw new Error('Cannot call undefined method "'+t+" of "+r)}},v.get=function(t){return function(e){return e[t]}},v.set=function(t,e){return function(n){var r,i;if(2===arguments.length)n[t]=e;else for(r in t)T.call(t,r)&&(i=t[r],n[r]=i);return n}},r=function(t,e){return"This service requires a service at version "+t+" or above. This one is at "+e},v.REQUIRES_VERSION=function(t,e,n){return t.fetchVersion().then(function(t){return t>=e?n():u(r(e,t))})},v.dejoin=function(t){var e,n,r,i,o;for(o=t.views,r=0,i=o.length;i>r;r++)n=o[r],e=n.split("."),e.length>2&&t.addJoin(e.slice(1,-1).join("."));return t},_=c(function(t,e){return t.then(e)}),v.sequence=function(){var t;return t=1<=arguments.length?x.call(arguments,0):[],_(b(),t)},g=c(function(t,e){var n,r;if(n=e[0],r=e[1],null!=t[n])throw new Error("Duplicate key: "+n);return t[n]=r,t}),v.pairsToObj=function(t){return g({},t)}}).call(this)},{"./promise":284}],291:[function(t,e,n){(function(){n.VERSION="3.14.0"}).call(this)},{}],292:[function(t,e,n){(function(){var e,r;e=t("xmldom").DOMParser,r=function(t){return t=t.replace(/^\s*/g,""),t=t.replace(/\s$/g,""),0===t.length?t:">"!==t[t.length-1]?t+">":t},n.parse=function(t){var n,i;if("string"!=typeof t)throw new Error("Expected a string - got "+t);if(t=r(t),!t)throw new Error("Expected content - got empty string");if(n=function(){try{return i=new e,i.parseFromString(t,"text/xml")}catch(n){}}(),!n||!n.documentElement||n.getElementsByTagName("parsererror").length)throw new Error("Invalid XML: "+t);return n}}).call(this)},{xmldom:287}],293:[function(t,e,n){(function(r,i){function o(t,e){return"string"==typeof t?e==t:t&&"function"==typeof t.exec?t.exec(e):"boolean"==typeof t?t:"function"==typeof t?t(e):!1}var s=t("jsonparse"),a=t("through");n.parse=function(t,e){var n=new s,r=a(function(t){"string"==typeof t&&(t=new i(t)),n.write(t)},function(t){t&&r.write(t),r.queue(null)});"string"==typeof t&&(t=t.split(".").map(function(t){return"*"===t?!0:""===t?{recurse:!0}:t}));var u=0;return t&&t.length||(t=null),n.onValue=function(n){if(this.root||(r.root=n),t){for(var i=0,s=0;i<t.length;){var a,l=t[i];if(s++,l&&!l.recurse){if(a=s===this.stack.length?this:this.stack[s],!a)return;if(!o(l,a.key))return;i++}else{i++;var c=t[i];if(!c)return;for(;;){if(a=s===this.stack.length?this:this.stack[s],!a)return;if(o(c,a.key)){i++;break}s++}}}if(s===this.stack.length){u++;var h=this.stack.slice(1).map(function(t){return t.key}).concat([this.key]),p=this.value[this.key];null!=p&&null!=(p=e?e(p,h):p)&&r.queue(p),delete this.value[this.key]}}},n._onToken=n.onToken,n.onToken=function(e,i){n._onToken(e,i),0===this.stack.length&&r.root&&(t||r.queue(r.root),r.emit("root",r.root,u),u=0,r.root=null)},n.onError=function(t){r.emit("error",t)},r},n.stringify=function(t,e,n,r){r=r||0,t===!1?(t="",e="\n",n=""):null==t&&(t="[\n",e="\n,\n",n="\n]\n");var i,o=!0,s=!1;return i=a(function(n){s=!0;var a=JSON.stringify(n,null,r);o?(o=!1,i.queue(t+a)):i.queue(e+a)},function(e){s||i.queue(t),i.queue(n),i.queue(null)})},n.stringifyObject=function(t,e,n,r){r=r||0,t===!1?(t="",e="\n",n=""):null==t&&(t="{\n",e="\n,\n",n="\n}\n");var i=!0,o=!1;return stream=a(function(n){o=!0;var s=JSON.stringify(n[0])+":"+JSON.stringify(n[1],null,r);i?(i=!1,this.queue(t+s)):this.queue(e+s)},function(e){o||this.queue(t),this.queue(n),this.queue(null)}),stream},e.parent||"browser"===r.title||r.stdin.pipe(n.parse(r.argv[2])).pipe(n.stringify("[",",\n","]\n",2)).pipe(r.stdout)}).call(this,t("IrXUsu"),t("buffer").Buffer)},{IrXUsu:15,buffer:6,jsonparse:294,through:295}],294:[function(t,e,n){(function(t){function n(t){for(var e=Object.keys(i),n=0,r=e.length;r>n;n++){var o=e[n];if(i[o]===t)return o}return t&&"0x"+t.toString(16)}function r(){this.tState=g,this.value=void 0,this.string=void 0,this.unicode=void 0,this.negative=void 0,this.magnatude=void 0,this.position=void 0,this.exponent=void 0,this.negativeExponent=void 0,this.key=void 0,this.mode=void 0,this.stack=[],this.state=z,this.bytes_remaining=0,this.bytes_in_sequence=0,this.temp_buffs={2:new t(2),3:new t(3),4:new t(4)}}var i={},o=i.LEFT_BRACE=1,s=i.RIGHT_BRACE=2,a=i.LEFT_BRACKET=3,u=i.RIGHT_BRACKET=4,l=i.COLON=5,c=i.COMMA=6,h=i.TRUE=7,p=i.FALSE=8,f=i.NULL=9,d=i.STRING=10,m=i.NUMBER=11,g=i.START=17,y=i.TRUE1=33,v=i.TRUE2=34,b=i.TRUE3=35,_=i.FALSE1=49,w=i.FALSE2=50,x=i.FALSE3=51,C=i.FALSE4=52,T=i.NULL1=65,S=i.NULL3=66,E=i.NULL2=67,N=i.NUMBER1=81,k=i.NUMBER2=82,M=i.NUMBER3=83,P=i.NUMBER4=84,O=i.NUMBER5=85,A=i.NUMBER6=86,R=i.NUMBER7=87,I=i.NUMBER8=88,D=i.STRING1=97,L=i.STRING2=98,q=i.STRING3=99,j=i.STRING4=100,$=i.STRING5=101,F=i.STRING6=102,z=i.VALUE=113,U=i.KEY=114,H=i.OBJECT=129,B=i.ARRAY=130,V=r.prototype;V.charError=function(t,e){this.onError(new Error("Unexpected "+JSON.stringify(String.fromCharCode(t[e]))+" at position "+e+" in state "+n(this.tState)))},V.onError=function(t){throw t},V.write=function(e){"string"==typeof e&&(e=new t(e));for(var n,r=0,i=e.length;i>r;r++)if(this.tState===g)n=e[r],123===n?this.onToken(o,"{"):125===n?this.onToken(s,"}"):91===n?this.onToken(a,"["):93===n?this.onToken(u,"]"):58===n?this.onToken(l,":"):44===n?this.onToken(c,","):116===n?this.tState=y:102===n?this.tState=_:110===n?this.tState=T:34===n?(this.string="",this.tState=D):45===n?(this.negative=!0,this.tState=N):48===n?(this.magnatude=0,this.tState=k):n>48&&64>n?(this.magnatude=n-48,this.tState=M):32===n||9===n||10===n||13===n||this.charError(e,r);else if(this.tState===D)if(n=e[r],this.bytes_remaining>0){for(var z=0;z<this.bytes_remaining;z++)this.temp_buffs[this.bytes_in_sequence][this.bytes_in_sequence-this.bytes_remaining+z]=e[z];this.string+=this.temp_buffs[this.bytes_in_sequence].toString(),this.bytes_in_sequence=this.bytes_remaining=0,r=r+z-1}else if(0===this.bytes_remaining&&n>=128)if(n>=194&&223>=n&&(this.bytes_in_sequence=2),n>=224&&239>=n&&(this.bytes_in_sequence=3),n>=240&&244>=n&&(this.bytes_in_sequence=4),this.bytes_in_sequence+r>e.length){for(var U=0;U<=e.length-1-r;U++)this.temp_buffs[this.bytes_in_sequence][U]=e[r+U];this.bytes_remaining=r+this.bytes_in_sequence-e.length,r=e.length-1}else this.string+=e.slice(r,r+this.bytes_in_sequence).toString(),r=r+this.bytes_in_sequence-1;else 34===n?(this.tState=g,this.onToken(d,this.string),this.string=void 0):92===n?this.tState=L:n>=32?this.string+=String.fromCharCode(n):this.charError(e,r);else this.tState===L?(n=e[r],34===n?(this.string+='"',this.tState=D):92===n?(this.string+="\\",this.tState=D):47===n?(this.string+="/",this.tState=D):98===n?(this.string+="\b",this.tState=D):102===n?(this.string+="\f",this.tState=D):110===n?(this.string+="\n",this.tState=D):114===n?(this.string+="\r",this.tState=D):116===n?(this.string+="	",this.tState=D):117===n?(this.unicode="",this.tState=q):this.charError(e,r)):this.tState===q||this.tState===j||this.tState===$||this.tState===F?(n=e[r],n>=48&&64>n||n>64&&70>=n||n>96&&102>=n?(this.unicode+=String.fromCharCode(n),this.tState++===F&&(this.string+=String.fromCharCode(parseInt(this.unicode,16)),this.unicode=void 0,this.tState=D)):this.charError(e,r)):this.tState===N?(n=e[r],48===n?(this.magnatude=0,this.tState=k):n>48&&64>n?(this.magnatude=n-48,this.tState=M):this.charError(e,r)):this.tState===k?(n=e[r],46===n?(this.position=.1,this.tState=P):101===n||69===n?(this.exponent=0,this.tState=A):(this.tState=g,this.onToken(m,0),this.magnatude=void 0,this.negative=void 0,r--)):this.tState===M?(n=e[r],46===n?(this.position=.1,this.tState=P):101===n||69===n?(this.exponent=0,this.tState=A):n>=48&&64>n?this.magnatude=10*this.magnatude+n-48:(this.tState=g,this.negative&&(this.magnatude=-this.magnatude,this.negative=void 0),this.onToken(m,this.magnatude),this.magnatude=void 0,r--)):this.tState===P?(n=e[r],n>=48&&64>n?(this.magnatude+=this.position*(n-48),this.position/=10,this.tState=O):this.charError(e,r)):this.tState===O?(n=e[r],n>=48&&64>n?(this.magnatude+=this.position*(n-48),this.position/=10):101===n||69===n?(this.exponent=0,this.tState=A):(this.tState=g,this.negative&&(this.magnatude=-this.magnatude,this.negative=void 0),this.onToken(m,this.negative?-this.magnatude:this.magnatude),this.magnatude=void 0,this.position=void 0,r--)):this.tState===A?(n=e[r],43===n||45===n?(45===n&&(this.negativeExponent=!0),this.tState=R):n>=48&&64>n?(this.exponent=10*this.exponent+(n-48),this.tState=I):this.charError(e,r)):this.tState===R?(n=e[r],n>=48&&64>n?(this.exponent=10*this.exponent+(n-48),this.tState=I):this.charError(e,r)):this.tState===I?(n=e[r],n>=48&&64>n?this.exponent=10*this.exponent+(n-48):(this.negativeExponent&&(this.exponent=-this.exponent,
this.negativeExponent=void 0),this.magnatude*=Math.pow(10,this.exponent),this.exponent=void 0,this.negative&&(this.magnatude=-this.magnatude,this.negative=void 0),this.tState=g,this.onToken(m,this.magnatude),this.magnatude=void 0,r--)):this.tState===y?114===e[r]?this.tState=v:this.charError(e,r):this.tState===v?117===e[r]?this.tState=b:this.charError(e,r):this.tState===b?101===e[r]?(this.tState=g,this.onToken(h,!0)):this.charError(e,r):this.tState===_?97===e[r]?this.tState=w:this.charError(e,r):this.tState===w?108===e[r]?this.tState=x:this.charError(e,r):this.tState===x?115===e[r]?this.tState=C:this.charError(e,r):this.tState===C?101===e[r]?(this.tState=g,this.onToken(p,!1)):this.charError(e,r):this.tState===T?117===e[r]?this.tState=S:this.charError(e,r):this.tState===S?108===e[r]?this.tState=E:this.charError(e,r):this.tState===E&&(108===e[r]?(this.tState=g,this.onToken(f,null)):this.charError(e,r))},V.onToken=function(t,e){},V.parseError=function(t,e){this.onError(new Error("Unexpected "+n(t)+(e?"("+JSON.stringify(e)+")":"")+" in state "+n(this.state)))},V.onError=function(t){throw t},V.push=function(){this.stack.push({value:this.value,key:this.key,mode:this.mode})},V.pop=function(){var t=this.value,e=this.stack.pop();this.value=e.value,this.key=e.key,this.mode=e.mode,this.emit(t),this.mode||(this.state=z)},V.emit=function(t){this.mode&&(this.state=c),this.onValue(t)},V.onValue=function(t){},V.onToken=function(t,e){this.state===z?t===d||t===m||t===h||t===p||t===f?(this.value&&(this.value[this.key]=e),this.emit(e)):t===o?(this.push(),this.value=this.value?this.value[this.key]={}:{},this.key=void 0,this.state=U,this.mode=H):t===a?(this.push(),this.value=this.value?this.value[this.key]=[]:[],this.key=0,this.mode=B,this.state=z):t===s?this.mode===H?this.pop():this.parseError(t,e):t===u&&this.mode===B?this.pop():this.parseError(t,e):this.state===U?t===d?(this.key=e,this.state=l):t===s?this.pop():this.parseError(t,e):this.state===l?t===l?this.state=z:this.parseError(t,e):this.state===c?t===c?this.mode===B?(this.key++,this.state=z):this.mode===H&&(this.state=U):t===u&&this.mode===B||t===s&&this.mode===H?this.pop():this.parseError(t,e):this.parseError(t,e)},e.exports=r}).call(this,t("buffer").Buffer)},{buffer:6}],295:[function(t,e,n){(function(r){function i(t,e,n){function i(){for(;l.length&&!h.paused;){var t=l.shift();if(null===t)return h.emit("end");h.emit("data",t)}}function s(){h.writable=!1,e.call(h),!h.readable&&h.autoDestroy&&h.destroy()}t=t||function(t){this.queue(t)},e=e||function(){this.queue(null)};var a=!1,u=!1,l=[],c=!1,h=new o;return h.readable=h.writable=!0,h.paused=!1,h.autoDestroy=!(n&&n.autoDestroy===!1),h.write=function(e){return t.call(this,e),!h.paused},h.queue=h.push=function(t){return c?h:(null===t&&(c=!0),l.push(t),i(),h)},h.on("end",function(){h.readable=!1,!h.writable&&h.autoDestroy&&r.nextTick(function(){h.destroy()})}),h.end=function(t){return a?void 0:(a=!0,arguments.length&&h.write(t),s(),h)},h.destroy=function(){return u?void 0:(u=!0,a=!0,l.length=0,h.writable=h.readable=!1,h.emit("close"),h)},h.pause=function(){return h.paused?void 0:(h.paused=!0,h)},h.resume=function(){return h.paused&&(h.paused=!1,h.emit("resume")),i(),h.paused||h.emit("drain"),h},h}var o=t("stream");n=e.exports=i,i.through=i}).call(this,t("IrXUsu"))},{IrXUsu:15,stream:21}],296:[function(t,e,n){!function(){function t(){return{keys:Object.keys||function(t){if("object"!=typeof t&&"function"!=typeof t||null===t)throw new TypeError("keys() called on a non-object");var e,n=[];for(e in t)t.hasOwnProperty(e)&&(n[n.length]=e);return n},uniqueId:function(t){var e=++u+"";return t?t+e:e},has:function(t,e){return s.call(t,e)},each:function(t,e,n){if(null!=t)if(o&&t.forEach===o)t.forEach(e,n);else if(t.length===+t.length)for(var r=0,i=t.length;i>r;r++)e.call(n,t[r],r,t);else for(var s in t)this.has(t,s)&&e.call(n,t[s],s,t)},once:function(t){var e,n=!1;return function(){return n?e:(n=!0,e=t.apply(this,arguments),t=null,e)}}}}var r,i=this,o=Array.prototype.forEach,s=Object.prototype.hasOwnProperty,a=Array.prototype.slice,u=0,l=t();r={on:function(t,e,n){if(!h(this,"on",t,[e,n])||!e)return this;this._events||(this._events={});var r=this._events[t]||(this._events[t]=[]);return r.push({callback:e,context:n,ctx:n||this}),this},once:function(t,e,n){if(!h(this,"once",t,[e,n])||!e)return this;var r=this,i=l.once(function(){r.off(t,i),e.apply(this,arguments)});return i._callback=e,this.on(t,i,n)},off:function(t,e,n){var r,i,o,s,a,u,c,p;if(!this._events||!h(this,"off",t,[e,n]))return this;if(!t&&!e&&!n)return this._events={},this;for(s=t?[t]:l.keys(this._events),a=0,u=s.length;u>a;a++)if(t=s[a],o=this._events[t]){if(this._events[t]=r=[],e||n)for(c=0,p=o.length;p>c;c++)i=o[c],(e&&e!==i.callback&&e!==i.callback._callback||n&&n!==i.context)&&r.push(i);r.length||delete this._events[t]}return this},trigger:function(t){if(!this._events)return this;var e=a.call(arguments,1);if(!h(this,"trigger",t,e))return this;var n=this._events[t],r=this._events.all;return n&&p(n,e),r&&p(r,arguments),this},stopListening:function(t,e,n){var r=this._listeners;if(!r)return this;var i=!e&&!n;"object"==typeof e&&(n=this),t&&((r={})[t._listenerId]=t);for(var o in r)r[o].off(e,n,this),i&&delete this._listeners[o];return this}};var c=/\s+/,h=function(t,e,n,r){if(!n)return!0;if("object"==typeof n){for(var i in n)t[e].apply(t,[i,n[i]].concat(r));return!1}if(c.test(n)){for(var o=n.split(c),s=0,a=o.length;a>s;s++)t[e].apply(t,[o[s]].concat(r));return!1}return!0},p=function(t,e){var n,r=-1,i=t.length,o=e[0],s=e[1],a=e[2];switch(e.length){case 0:for(;++r<i;)(n=t[r]).callback.call(n.ctx);return;case 1:for(;++r<i;)(n=t[r]).callback.call(n.ctx,o);return;case 2:for(;++r<i;)(n=t[r]).callback.call(n.ctx,o,s);return;case 3:for(;++r<i;)(n=t[r]).callback.call(n.ctx,o,s,a);return;default:for(;++r<i;)(n=t[r]).callback.apply(n.ctx,e)}},f={listenTo:"on",listenToOnce:"once"};l.each(f,function(t,e){r[e]=function(e,n,r){var i=this._listeners||(this._listeners={}),o=e._listenerId||(e._listenerId=l.uniqueId("l"));return i[o]=e,"object"==typeof n&&(r=this),e[t](n,r,this),this}}),r.bind=r.on,r.unbind=r.off,r.mixin=function(t){var e=["on","once","off","trigger","stopListening","listenTo","listenToOnce","bind","unbind"];return l.each(e,function(e){t[e]=this[e]},this),t},"undefined"!=typeof n?("undefined"!=typeof e&&e.exports&&(n=e.exports=r),n.BackboneEvents=r):"function"==typeof define&&"object"==typeof define.amd?define(function(){return r}):i.BackboneEvents=r}(this)},{}],297:[function(t,e,n){e.exports=t("./backbone-events-standalone")},{"./backbone-events-standalone":296}],298:[function(t,e,n){var r=t("jquery");!function(t,e){function n(e,n){var i,o,s,a=e.nodeName.toLowerCase();return"area"===a?(i=e.parentNode,o=i.name,e.href&&o&&"map"===i.nodeName.toLowerCase()?(s=t("img[usemap=#"+o+"]")[0],!!s&&r(s)):!1):(/input|select|textarea|button|object/.test(a)?!e.disabled:"a"===a?e.href||n:n)&&r(e)}function r(e){return t.expr.filters.visible(e)&&!t(e).parents().addBack().filter(function(){return"hidden"===t.css(this,"visibility")}).length}var i=0,o=/^ui-id-\d+$/;t.ui=t.ui||{},t.extend(t.ui,{version:"1.10.4",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),t.fn.extend({focus:function(e){return function(n,r){return"number"==typeof n?this.each(function(){var e=this;setTimeout(function(){t(e).focus(),r&&r.call(e)},n)}):e.apply(this,arguments)}}(t.fn.focus),scrollParent:function(){var e;return e=t.ui.ie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?this.parents().filter(function(){return/(relative|absolute|fixed)/.test(t.css(this,"position"))&&/(auto|scroll)/.test(t.css(this,"overflow")+t.css(this,"overflow-y")+t.css(this,"overflow-x"))}).eq(0):this.parents().filter(function(){return/(auto|scroll)/.test(t.css(this,"overflow")+t.css(this,"overflow-y")+t.css(this,"overflow-x"))}).eq(0),/fixed/.test(this.css("position"))||!e.length?t(document):e},zIndex:function(n){if(n!==e)return this.css("zIndex",n);if(this.length)for(var r,i,o=t(this[0]);o.length&&o[0]!==document;){if(r=o.css("position"),("absolute"===r||"relative"===r||"fixed"===r)&&(i=parseInt(o.css("zIndex"),10),!isNaN(i)&&0!==i))return i;o=o.parent()}return 0},uniqueId:function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++i)})},removeUniqueId:function(){return this.each(function(){o.test(this.id)&&t(this).removeAttr("id")})}}),t.extend(t.expr[":"],{data:t.expr.createPseudo?t.expr.createPseudo(function(e){return function(n){return!!t.data(n,e)}}):function(e,n,r){return!!t.data(e,r[3])},focusable:function(e){return n(e,!isNaN(t.attr(e,"tabindex")))},tabbable:function(e){var r=t.attr(e,"tabindex"),i=isNaN(r);return(i||r>=0)&&n(e,!i)}}),t("<a>").outerWidth(1).jquery||t.each(["Width","Height"],function(n,r){function i(e,n,r,i){return t.each(o,function(){n-=parseFloat(t.css(e,"padding"+this))||0,r&&(n-=parseFloat(t.css(e,"border"+this+"Width"))||0),i&&(n-=parseFloat(t.css(e,"margin"+this))||0)}),n}var o="Width"===r?["Left","Right"]:["Top","Bottom"],s=r.toLowerCase(),a={innerWidth:t.fn.innerWidth,innerHeight:t.fn.innerHeight,outerWidth:t.fn.outerWidth,outerHeight:t.fn.outerHeight};t.fn["inner"+r]=function(n){return n===e?a["inner"+r].call(this):this.each(function(){t(this).css(s,i(this,n)+"px")})},t.fn["outer"+r]=function(e,n){return"number"!=typeof e?a["outer"+r].call(this,e):this.each(function(){t(this).css(s,i(this,e,!0,n)+"px")})}}),t.fn.addBack||(t.fn.addBack=function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}),t("<a>").data("a-b","a").removeData("a-b").data("a-b")&&(t.fn.removeData=function(e){return function(n){return arguments.length?e.call(this,t.camelCase(n)):e.call(this)}}(t.fn.removeData)),t.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()),t.support.selectstart="onselectstart"in document.createElement("div"),t.fn.extend({disableSelection:function(){return this.bind((t.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(t){t.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}}),t.extend(t.ui,{plugin:{add:function(e,n,r){var i,o=t.ui[e].prototype;for(i in r)o.plugins[i]=o.plugins[i]||[],o.plugins[i].push([n,r[i]])},call:function(t,e,n){var r,i=t.plugins[e];if(i&&t.element[0].parentNode&&11!==t.element[0].parentNode.nodeType)for(r=0;r<i.length;r++)t.options[i[r][0]]&&i[r][1].apply(t.element,n)}},hasScroll:function(e,n){if("hidden"===t(e).css("overflow"))return!1;var r=n&&"left"===n?"scrollLeft":"scrollTop",i=!1;return e[r]>0?!0:(e[r]=1,i=e[r]>0,e[r]=0,i)}})}(r)},{jquery:305}],299:[function(t,e,n){var r=t("jquery");t("./core"),t("./mouse"),t("./widget"),function(t,e){t.widget("ui.draggable",t.ui.mouse,{version:"1.10.4",widgetEventPrefix:"drag",options:{addClasses:!0,appendTo:"parent",axis:!1,connectToSortable:!1,containment:!1,cursor:"auto",cursorAt:!1,grid:!1,handle:!1,helper:"original",iframeFix:!1,opacity:!1,refreshPositions:!1,revert:!1,revertDuration:500,scope:"default",scroll:!0,scrollSensitivity:20,scrollSpeed:20,snap:!1,snapMode:"both",snapTolerance:20,stack:!1,zIndex:!1,drag:null,start:null,stop:null},_create:function(){"original"!==this.options.helper||/^(?:r|a|f)/.test(this.element.css("position"))||(this.element[0].style.position="relative"),this.options.addClasses&&this.element.addClass("ui-draggable"),this.options.disabled&&this.element.addClass("ui-draggable-disabled"),this._mouseInit()},_destroy:function(){this.element.removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"),this._mouseDestroy()},_mouseCapture:function(e){var n=this.options;return this.helper||n.disabled||t(e.target).closest(".ui-resizable-handle").length>0?!1:(this.handle=this._getHandle(e),this.handle?(t(n.iframeFix===!0?"iframe":n.iframeFix).each(function(){t("<div class='ui-draggable-iframeFix' style='background: #fff;'></div>").css({width:this.offsetWidth+"px",height:this.offsetHeight+"px",position:"absolute",opacity:"0.001",zIndex:1e3}).css(t(this).offset()).appendTo("body")}),!0):!1)},_mouseStart:function(e){var n=this.options;return this.helper=this._createHelper(e),this.helper.addClass("ui-draggable-dragging"),this._cacheHelperProportions(),t.ui.ddmanager&&(t.ui.ddmanager.current=this),this._cacheMargins(),this.cssPosition=this.helper.css("position"),this.scrollParent=this.helper.scrollParent(),this.offsetParent=this.helper.offsetParent(),this.offsetParentCssPosition=this.offsetParent.css("position"),this.offset=this.positionAbs=this.element.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},this.offset.scroll=!1,t.extend(this.offset,{click:{left:e.pageX-this.offset.left,top:e.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.originalPosition=this.position=this._generatePosition(e),this.originalPageX=e.pageX,this.originalPageY=e.pageY,n.cursorAt&&this._adjustOffsetFromHelper(n.cursorAt),this._setContainment(),this._trigger("start",e)===!1?(this._clear(),!1):(this._cacheHelperProportions(),t.ui.ddmanager&&!n.dropBehaviour&&t.ui.ddmanager.prepareOffsets(this,e),this._mouseDrag(e,!0),t.ui.ddmanager&&t.ui.ddmanager.dragStart(this,e),!0)},_mouseDrag:function(e,n){if("fixed"===this.offsetParentCssPosition&&(this.offset.parent=this._getParentOffset()),this.position=this._generatePosition(e),this.positionAbs=this._convertPositionTo("absolute"),!n){var r=this._uiHash();if(this._trigger("drag",e,r)===!1)return this._mouseUp({}),!1;this.position=r.position}return this.options.axis&&"y"===this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"===this.options.axis||(this.helper[0].style.top=this.position.top+"px"),t.ui.ddmanager&&t.ui.ddmanager.drag(this,e),!1},_mouseStop:function(e){var n=this,r=!1;return t.ui.ddmanager&&!this.options.dropBehaviour&&(r=t.ui.ddmanager.drop(this,e)),this.dropped&&(r=this.dropped,this.dropped=!1),"original"!==this.options.helper||t.contains(this.element[0].ownerDocument,this.element[0])?("invalid"===this.options.revert&&!r||"valid"===this.options.revert&&r||this.options.revert===!0||t.isFunction(this.options.revert)&&this.options.revert.call(this.element,r)?t(this.helper).animate(this.originalPosition,parseInt(this.options.revertDuration,10),function(){n._trigger("stop",e)!==!1&&n._clear()}):this._trigger("stop",e)!==!1&&this._clear(),!1):!1},_mouseUp:function(e){return t("div.ui-draggable-iframeFix").each(function(){this.parentNode.removeChild(this)}),t.ui.ddmanager&&t.ui.ddmanager.dragStop(this,e),t.ui.mouse.prototype._mouseUp.call(this,e)},cancel:function(){return this.helper.is(".ui-draggable-dragging")?this._mouseUp({}):this._clear(),this},_getHandle:function(e){return this.options.handle?!!t(e.target).closest(this.element.find(this.options.handle)).length:!0},_createHelper:function(e){var n=this.options,r=t.isFunction(n.helper)?t(n.helper.apply(this.element[0],[e])):"clone"===n.helper?this.element.clone().removeAttr("id"):this.element;return r.parents("body").length||r.appendTo("parent"===n.appendTo?this.element[0].parentNode:n.appendTo),r[0]===this.element[0]||/(fixed|absolute)/.test(r.css("position"))||r.css("position","absolute"),r},_adjustOffsetFromHelper:function(e){"string"==typeof e&&(e=e.split(" ")),t.isArray(e)&&(e={left:+e[0],top:+e[1]||0}),"left"in e&&(this.offset.click.left=e.left+this.margins.left),"right"in e&&(this.offset.click.left=this.helperProportions.width-e.right+this.margins.left),"top"in e&&(this.offset.click.top=e.top+this.margins.top),"bottom"in e&&(this.offset.click.top=this.helperProportions.height-e.bottom+this.margins.top)},_getParentOffset:function(){var e=this.offsetParent.offset();return"absolute"===this.cssPosition&&this.scrollParent[0]!==document&&t.contains(this.scrollParent[0],this.offsetParent[0])&&(e.left+=this.scrollParent.scrollLeft(),e.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]===document.body||this.offsetParent[0].tagName&&"html"===this.offsetParent[0].tagName.toLowerCase()&&t.ui.ie)&&(e={top:0,left:0}),{top:e.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:e.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"===this.cssPosition){var t=this.element.position();return{top:t.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:t.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.element.css("marginLeft"),10)||0,top:parseInt(this.element.css("marginTop"),10)||0,right:parseInt(this.element.css("marginRight"),10)||0,bottom:parseInt(this.element.css("marginBottom"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var e,n,r,i=this.options;return i.containment?"window"===i.containment?void(this.containment=[t(window).scrollLeft()-this.offset.relative.left-this.offset.parent.left,t(window).scrollTop()-this.offset.relative.top-this.offset.parent.top,t(window).scrollLeft()+t(window).width()-this.helperProportions.width-this.margins.left,t(window).scrollTop()+(t(window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]):"document"===i.containment?void(this.containment=[0,0,t(document).width()-this.helperProportions.width-this.margins.left,(t(document).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]):i.containment.constructor===Array?void(this.containment=i.containment):("parent"===i.containment&&(i.containment=this.helper[0].parentNode),n=t(i.containment),r=n[0],void(r&&(e="hidden"!==n.css("overflow"),this.containment=[(parseInt(n.css("borderLeftWidth"),10)||0)+(parseInt(n.css("paddingLeft"),10)||0),(parseInt(n.css("borderTopWidth"),10)||0)+(parseInt(n.css("paddingTop"),10)||0),(e?Math.max(r.scrollWidth,r.offsetWidth):r.offsetWidth)-(parseInt(n.css("borderRightWidth"),10)||0)-(parseInt(n.css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left-this.margins.right,(e?Math.max(r.scrollHeight,r.offsetHeight):r.offsetHeight)-(parseInt(n.css("borderBottomWidth"),10)||0)-(parseInt(n.css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top-this.margins.bottom],this.relative_container=n))):void(this.containment=null)},_convertPositionTo:function(e,n){n||(n=this.position);var r="absolute"===e?1:-1,i="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&t.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent;return this.offset.scroll||(this.offset.scroll={top:i.scrollTop(),left:i.scrollLeft()}),{top:n.top+this.offset.relative.top*r+this.offset.parent.top*r-("fixed"===this.cssPosition?-this.scrollParent.scrollTop():this.offset.scroll.top)*r,left:n.left+this.offset.relative.left*r+this.offset.parent.left*r-("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():this.offset.scroll.left)*r}},_generatePosition:function(e){var n,r,i,o,s=this.options,a="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&t.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,u=e.pageX,l=e.pageY;return this.offset.scroll||(this.offset.scroll={top:a.scrollTop(),left:a.scrollLeft()}),this.originalPosition&&(this.containment&&(this.relative_container?(r=this.relative_container.offset(),n=[this.containment[0]+r.left,this.containment[1]+r.top,this.containment[2]+r.left,this.containment[3]+r.top]):n=this.containment,e.pageX-this.offset.click.left<n[0]&&(u=n[0]+this.offset.click.left),e.pageY-this.offset.click.top<n[1]&&(l=n[1]+this.offset.click.top),e.pageX-this.offset.click.left>n[2]&&(u=n[2]+this.offset.click.left),e.pageY-this.offset.click.top>n[3]&&(l=n[3]+this.offset.click.top)),s.grid&&(i=s.grid[1]?this.originalPageY+Math.round((l-this.originalPageY)/s.grid[1])*s.grid[1]:this.originalPageY,l=n?i-this.offset.click.top>=n[1]||i-this.offset.click.top>n[3]?i:i-this.offset.click.top>=n[1]?i-s.grid[1]:i+s.grid[1]:i,o=s.grid[0]?this.originalPageX+Math.round((u-this.originalPageX)/s.grid[0])*s.grid[0]:this.originalPageX,u=n?o-this.offset.click.left>=n[0]||o-this.offset.click.left>n[2]?o:o-this.offset.click.left>=n[0]?o-s.grid[0]:o+s.grid[0]:o)),{top:l-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.scrollParent.scrollTop():this.offset.scroll.top),left:u-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():this.offset.scroll.left)}},_clear:function(){this.helper.removeClass("ui-draggable-dragging"),this.helper[0]===this.element[0]||this.cancelHelperRemoval||this.helper.remove(),this.helper=null,this.cancelHelperRemoval=!1},_trigger:function(e,n,r){return r=r||this._uiHash(),t.ui.plugin.call(this,e,[n,r]),"drag"===e&&(this.positionAbs=this._convertPositionTo("absolute")),t.Widget.prototype._trigger.call(this,e,n,r)},plugins:{},_uiHash:function(){return{helper:this.helper,position:this.position,originalPosition:this.originalPosition,offset:this.positionAbs}}}),t.ui.plugin.add("draggable","connectToSortable",{start:function(e,n){var r=t(this).data("ui-draggable"),i=r.options,o=t.extend({},n,{item:r.element});r.sortables=[],t(i.connectToSortable).each(function(){var n=t.data(this,"ui-sortable");n&&!n.options.disabled&&(r.sortables.push({instance:n,shouldRevert:n.options.revert}),n.refreshPositions(),n._trigger("activate",e,o))})},stop:function(e,n){var r=t(this).data("ui-draggable"),i=t.extend({},n,{item:r.element});t.each(r.sortables,function(){this.instance.isOver?(this.instance.isOver=0,r.cancelHelperRemoval=!0,this.instance.cancelHelperRemoval=!1,this.shouldRevert&&(this.instance.options.revert=this.shouldRevert),this.instance._mouseStop(e),this.instance.options.helper=this.instance.options._helper,"original"===r.options.helper&&this.instance.currentItem.css({top:"auto",left:"auto"})):(this.instance.cancelHelperRemoval=!1,this.instance._trigger("deactivate",e,i))})},drag:function(e,n){var r=t(this).data("ui-draggable"),i=this;t.each(r.sortables,function(){var o=!1,s=this;this.instance.positionAbs=r.positionAbs,this.instance.helperProportions=r.helperProportions,this.instance.offset.click=r.offset.click,this.instance._intersectsWith(this.instance.containerCache)&&(o=!0,t.each(r.sortables,function(){return this.instance.positionAbs=r.positionAbs,this.instance.helperProportions=r.helperProportions,this.instance.offset.click=r.offset.click,this!==s&&this.instance._intersectsWith(this.instance.containerCache)&&t.contains(s.instance.element[0],this.instance.element[0])&&(o=!1),o})),o?(this.instance.isOver||(this.instance.isOver=1,this.instance.currentItem=t(i).clone().removeAttr("id").appendTo(this.instance.element).data("ui-sortable-item",!0),this.instance.options._helper=this.instance.options.helper,this.instance.options.helper=function(){return n.helper[0]},e.target=this.instance.currentItem[0],this.instance._mouseCapture(e,!0),this.instance._mouseStart(e,!0,!0),this.instance.offset.click.top=r.offset.click.top,this.instance.offset.click.left=r.offset.click.left,this.instance.offset.parent.left-=r.offset.parent.left-this.instance.offset.parent.left,this.instance.offset.parent.top-=r.offset.parent.top-this.instance.offset.parent.top,r._trigger("toSortable",e),r.dropped=this.instance.element,r.currentItem=r.element,this.instance.fromOutside=r),this.instance.currentItem&&this.instance._mouseDrag(e)):this.instance.isOver&&(this.instance.isOver=0,this.instance.cancelHelperRemoval=!0,this.instance.options.revert=!1,this.instance._trigger("out",e,this.instance._uiHash(this.instance)),this.instance._mouseStop(e,!0),this.instance.options.helper=this.instance.options._helper,this.instance.currentItem.remove(),this.instance.placeholder&&this.instance.placeholder.remove(),r._trigger("fromSortable",e),r.dropped=!1)})}}),t.ui.plugin.add("draggable","cursor",{start:function(){var e=t("body"),n=t(this).data("ui-draggable").options;e.css("cursor")&&(n._cursor=e.css("cursor")),e.css("cursor",n.cursor)},stop:function(){var e=t(this).data("ui-draggable").options;e._cursor&&t("body").css("cursor",e._cursor)}}),t.ui.plugin.add("draggable","opacity",{start:function(e,n){var r=t(n.helper),i=t(this).data("ui-draggable").options;r.css("opacity")&&(i._opacity=r.css("opacity")),r.css("opacity",i.opacity)},stop:function(e,n){var r=t(this).data("ui-draggable").options;r._opacity&&t(n.helper).css("opacity",r._opacity)}}),t.ui.plugin.add("draggable","scroll",{start:function(){var e=t(this).data("ui-draggable");e.scrollParent[0]!==document&&"HTML"!==e.scrollParent[0].tagName&&(e.overflowOffset=e.scrollParent.offset())},drag:function(e){var n=t(this).data("ui-draggable"),r=n.options,i=!1;n.scrollParent[0]!==document&&"HTML"!==n.scrollParent[0].tagName?(r.axis&&"x"===r.axis||(n.overflowOffset.top+n.scrollParent[0].offsetHeight-e.pageY<r.scrollSensitivity?n.scrollParent[0].scrollTop=i=n.scrollParent[0].scrollTop+r.scrollSpeed:e.pageY-n.overflowOffset.top<r.scrollSensitivity&&(n.scrollParent[0].scrollTop=i=n.scrollParent[0].scrollTop-r.scrollSpeed)),r.axis&&"y"===r.axis||(n.overflowOffset.left+n.scrollParent[0].offsetWidth-e.pageX<r.scrollSensitivity?n.scrollParent[0].scrollLeft=i=n.scrollParent[0].scrollLeft+r.scrollSpeed:e.pageX-n.overflowOffset.left<r.scrollSensitivity&&(n.scrollParent[0].scrollLeft=i=n.scrollParent[0].scrollLeft-r.scrollSpeed))):(r.axis&&"x"===r.axis||(e.pageY-t(document).scrollTop()<r.scrollSensitivity?i=t(document).scrollTop(t(document).scrollTop()-r.scrollSpeed):t(window).height()-(e.pageY-t(document).scrollTop())<r.scrollSensitivity&&(i=t(document).scrollTop(t(document).scrollTop()+r.scrollSpeed))),r.axis&&"y"===r.axis||(e.pageX-t(document).scrollLeft()<r.scrollSensitivity?i=t(document).scrollLeft(t(document).scrollLeft()-r.scrollSpeed):t(window).width()-(e.pageX-t(document).scrollLeft())<r.scrollSensitivity&&(i=t(document).scrollLeft(t(document).scrollLeft()+r.scrollSpeed)))),i!==!1&&t.ui.ddmanager&&!r.dropBehaviour&&t.ui.ddmanager.prepareOffsets(n,e)}}),t.ui.plugin.add("draggable","snap",{start:function(){var e=t(this).data("ui-draggable"),n=e.options;e.snapElements=[],t(n.snap.constructor!==String?n.snap.items||":data(ui-draggable)":n.snap).each(function(){var n=t(this),r=n.offset();this!==e.element[0]&&e.snapElements.push({item:this,width:n.outerWidth(),height:n.outerHeight(),top:r.top,left:r.left})})},drag:function(e,n){var r,i,o,s,a,u,l,c,h,p,f=t(this).data("ui-draggable"),d=f.options,m=d.snapTolerance,g=n.offset.left,y=g+f.helperProportions.width,v=n.offset.top,b=v+f.helperProportions.height;for(h=f.snapElements.length-1;h>=0;h--)a=f.snapElements[h].left,u=a+f.snapElements[h].width,l=f.snapElements[h].top,c=l+f.snapElements[h].height,a-m>y||g>u+m||l-m>b||v>c+m||!t.contains(f.snapElements[h].item.ownerDocument,f.snapElements[h].item)?(f.snapElements[h].snapping&&f.options.snap.release&&f.options.snap.release.call(f.element,e,t.extend(f._uiHash(),{snapItem:f.snapElements[h].item})),f.snapElements[h].snapping=!1):("inner"!==d.snapMode&&(r=Math.abs(l-b)<=m,i=Math.abs(c-v)<=m,o=Math.abs(a-y)<=m,s=Math.abs(u-g)<=m,r&&(n.position.top=f._convertPositionTo("relative",{top:l-f.helperProportions.height,left:0}).top-f.margins.top),i&&(n.position.top=f._convertPositionTo("relative",{top:c,left:0}).top-f.margins.top),o&&(n.position.left=f._convertPositionTo("relative",{top:0,left:a-f.helperProportions.width}).left-f.margins.left),s&&(n.position.left=f._convertPositionTo("relative",{top:0,left:u}).left-f.margins.left)),p=r||i||o||s,"outer"!==d.snapMode&&(r=Math.abs(l-v)<=m,i=Math.abs(c-b)<=m,o=Math.abs(a-g)<=m,s=Math.abs(u-y)<=m,r&&(n.position.top=f._convertPositionTo("relative",{top:l,left:0}).top-f.margins.top),i&&(n.position.top=f._convertPositionTo("relative",{top:c-f.helperProportions.height,left:0}).top-f.margins.top),o&&(n.position.left=f._convertPositionTo("relative",{top:0,left:a}).left-f.margins.left),s&&(n.position.left=f._convertPositionTo("relative",{top:0,left:u-f.helperProportions.width}).left-f.margins.left)),!f.snapElements[h].snapping&&(r||i||o||s||p)&&f.options.snap.snap&&f.options.snap.snap.call(f.element,e,t.extend(f._uiHash(),{snapItem:f.snapElements[h].item})),f.snapElements[h].snapping=r||i||o||s||p)}}),t.ui.plugin.add("draggable","stack",{start:function(){var e,n=this.data("ui-draggable").options,r=t.makeArray(t(n.stack)).sort(function(e,n){return(parseInt(t(e).css("zIndex"),10)||0)-(parseInt(t(n).css("zIndex"),10)||0)});r.length&&(e=parseInt(t(r[0]).css("zIndex"),10)||0,t(r).each(function(n){t(this).css("zIndex",e+n)}),this.css("zIndex",e+r.length))}}),t.ui.plugin.add("draggable","zIndex",{start:function(e,n){var r=t(n.helper),i=t(this).data("ui-draggable").options;r.css("zIndex")&&(i._zIndex=r.css("zIndex")),r.css("zIndex",i.zIndex)},stop:function(e,n){var r=t(this).data("ui-draggable").options;r._zIndex&&t(n.helper).css("zIndex",r._zIndex)}})}(r)},{"./core":298,"./mouse":301,"./widget":304,jquery:305}],300:[function(t,e,n){var r=t("jquery");t("./core"),t("./widget"),t("./mouse"),t("./draggable"),function(t,e){function n(t,e,n){return t>e&&e+n>t}t.widget("ui.droppable",{version:"1.10.4",widgetEventPrefix:"drop",options:{accept:"*",activeClass:!1,addClasses:!0,greedy:!1,hoverClass:!1,scope:"default",tolerance:"intersect",activate:null,deactivate:null,drop:null,out:null,over:null},_create:function(){var e,n=this.options,r=n.accept;this.isover=!1,this.isout=!0,this.accept=t.isFunction(r)?r:function(t){return t.is(r)},this.proportions=function(){return arguments.length?void(e=arguments[0]):e?e:e={width:this.element[0].offsetWidth,height:this.element[0].offsetHeight}},t.ui.ddmanager.droppables[n.scope]=t.ui.ddmanager.droppables[n.scope]||[],t.ui.ddmanager.droppables[n.scope].push(this),n.addClasses&&this.element.addClass("ui-droppable")},_destroy:function(){for(var e=0,n=t.ui.ddmanager.droppables[this.options.scope];e<n.length;e++)n[e]===this&&n.splice(e,1);this.element.removeClass("ui-droppable ui-droppable-disabled")},_setOption:function(e,n){"accept"===e&&(this.accept=t.isFunction(n)?n:function(t){return t.is(n)}),t.Widget.prototype._setOption.apply(this,arguments)},_activate:function(e){var n=t.ui.ddmanager.current;this.options.activeClass&&this.element.addClass(this.options.activeClass),n&&this._trigger("activate",e,this.ui(n))},_deactivate:function(e){var n=t.ui.ddmanager.current;this.options.activeClass&&this.element.removeClass(this.options.activeClass),n&&this._trigger("deactivate",e,this.ui(n))},_over:function(e){var n=t.ui.ddmanager.current;n&&(n.currentItem||n.element)[0]!==this.element[0]&&this.accept.call(this.element[0],n.currentItem||n.element)&&(this.options.hoverClass&&this.element.addClass(this.options.hoverClass),this._trigger("over",e,this.ui(n)))},_out:function(e){var n=t.ui.ddmanager.current;n&&(n.currentItem||n.element)[0]!==this.element[0]&&this.accept.call(this.element[0],n.currentItem||n.element)&&(this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("out",e,this.ui(n)))},_drop:function(e,n){var r=n||t.ui.ddmanager.current,i=!1;return r&&(r.currentItem||r.element)[0]!==this.element[0]?(this.element.find(":data(ui-droppable)").not(".ui-draggable-dragging").each(function(){var e=t.data(this,"ui-droppable");return e.options.greedy&&!e.options.disabled&&e.options.scope===r.options.scope&&e.accept.call(e.element[0],r.currentItem||r.element)&&t.ui.intersect(r,t.extend(e,{offset:e.element.offset()}),e.options.tolerance)?(i=!0,!1):void 0}),i?!1:this.accept.call(this.element[0],r.currentItem||r.element)?(this.options.activeClass&&this.element.removeClass(this.options.activeClass),
this.options.hoverClass&&this.element.removeClass(this.options.hoverClass),this._trigger("drop",e,this.ui(r)),this.element):!1):!1},ui:function(t){return{draggable:t.currentItem||t.element,helper:t.helper,position:t.position,offset:t.positionAbs}}}),t.ui.intersect=function(t,e,r){if(!e.offset)return!1;var i,o,s=(t.positionAbs||t.position.absolute).left,a=(t.positionAbs||t.position.absolute).top,u=s+t.helperProportions.width,l=a+t.helperProportions.height,c=e.offset.left,h=e.offset.top,p=c+e.proportions().width,f=h+e.proportions().height;switch(r){case"fit":return s>=c&&p>=u&&a>=h&&f>=l;case"intersect":return c<s+t.helperProportions.width/2&&u-t.helperProportions.width/2<p&&h<a+t.helperProportions.height/2&&l-t.helperProportions.height/2<f;case"pointer":return i=(t.positionAbs||t.position.absolute).left+(t.clickOffset||t.offset.click).left,o=(t.positionAbs||t.position.absolute).top+(t.clickOffset||t.offset.click).top,n(o,h,e.proportions().height)&&n(i,c,e.proportions().width);case"touch":return(a>=h&&f>=a||l>=h&&f>=l||h>a&&l>f)&&(s>=c&&p>=s||u>=c&&p>=u||c>s&&u>p);default:return!1}},t.ui.ddmanager={current:null,droppables:{"default":[]},prepareOffsets:function(e,n){var r,i,o=t.ui.ddmanager.droppables[e.options.scope]||[],s=n?n.type:null,a=(e.currentItem||e.element).find(":data(ui-droppable)").addBack();t:for(r=0;r<o.length;r++)if(!(o[r].options.disabled||e&&!o[r].accept.call(o[r].element[0],e.currentItem||e.element))){for(i=0;i<a.length;i++)if(a[i]===o[r].element[0]){o[r].proportions().height=0;continue t}o[r].visible="none"!==o[r].element.css("display"),o[r].visible&&("mousedown"===s&&o[r]._activate.call(o[r],n),o[r].offset=o[r].element.offset(),o[r].proportions({width:o[r].element[0].offsetWidth,height:o[r].element[0].offsetHeight}))}},drop:function(e,n){var r=!1;return t.each((t.ui.ddmanager.droppables[e.options.scope]||[]).slice(),function(){this.options&&(!this.options.disabled&&this.visible&&t.ui.intersect(e,this,this.options.tolerance)&&(r=this._drop.call(this,n)||r),!this.options.disabled&&this.visible&&this.accept.call(this.element[0],e.currentItem||e.element)&&(this.isout=!0,this.isover=!1,this._deactivate.call(this,n)))}),r},dragStart:function(e,n){e.element.parentsUntil("body").bind("scroll.droppable",function(){e.options.refreshPositions||t.ui.ddmanager.prepareOffsets(e,n)})},drag:function(e,n){e.options.refreshPositions&&t.ui.ddmanager.prepareOffsets(e,n),t.each(t.ui.ddmanager.droppables[e.options.scope]||[],function(){if(!this.options.disabled&&!this.greedyChild&&this.visible){var r,i,o,s=t.ui.intersect(e,this,this.options.tolerance),a=!s&&this.isover?"isout":s&&!this.isover?"isover":null;a&&(this.options.greedy&&(i=this.options.scope,o=this.element.parents(":data(ui-droppable)").filter(function(){return t.data(this,"ui-droppable").options.scope===i}),o.length&&(r=t.data(o[0],"ui-droppable"),r.greedyChild="isover"===a)),r&&"isover"===a&&(r.isover=!1,r.isout=!0,r._out.call(r,n)),this[a]=!0,this["isout"===a?"isover":"isout"]=!1,this["isover"===a?"_over":"_out"].call(this,n),r&&"isout"===a&&(r.isout=!1,r.isover=!0,r._over.call(r,n)))}})},dragStop:function(e,n){e.element.parentsUntil("body").unbind("scroll.droppable"),e.options.refreshPositions||t.ui.ddmanager.prepareOffsets(e,n)}}}(r)},{"./core":298,"./draggable":299,"./mouse":301,"./widget":304,jquery:305}],301:[function(t,e,n){var r=t("jquery");t("./widget"),function(t,e){var n=!1;t(document).mouseup(function(){n=!1}),t.widget("ui.mouse",{version:"1.10.4",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var e=this;this.element.bind("mousedown."+this.widgetName,function(t){return e._mouseDown(t)}).bind("click."+this.widgetName,function(n){return!0===t.data(n.target,e.widgetName+".preventClickEvent")?(t.removeData(n.target,e.widgetName+".preventClickEvent"),n.stopImmediatePropagation(),!1):void 0}),this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName),this._mouseMoveDelegate&&t(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(e){if(!n){this._mouseStarted&&this._mouseUp(e),this._mouseDownEvent=e;var r=this,i=1===e.which,o="string"==typeof this.options.cancel&&e.target.nodeName?t(e.target).closest(this.options.cancel).length:!1;return i&&!o&&this._mouseCapture(e)?(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){r.mouseDelayMet=!0},this.options.delay)),this._mouseDistanceMet(e)&&this._mouseDelayMet(e)&&(this._mouseStarted=this._mouseStart(e)!==!1,!this._mouseStarted)?(e.preventDefault(),!0):(!0===t.data(e.target,this.widgetName+".preventClickEvent")&&t.removeData(e.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(t){return r._mouseMove(t)},this._mouseUpDelegate=function(t){return r._mouseUp(t)},t(document).bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),e.preventDefault(),n=!0,!0)):!0}},_mouseMove:function(e){return t.ui.ie&&(!document.documentMode||document.documentMode<9)&&!e.button?this._mouseUp(e):this._mouseStarted?(this._mouseDrag(e),e.preventDefault()):(this._mouseDistanceMet(e)&&this._mouseDelayMet(e)&&(this._mouseStarted=this._mouseStart(this._mouseDownEvent,e)!==!1,this._mouseStarted?this._mouseDrag(e):this._mouseUp(e)),!this._mouseStarted)},_mouseUp:function(e){return t(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,e.target===this._mouseDownEvent.target&&t.data(e.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(e)),!1},_mouseDistanceMet:function(t){return Math.max(Math.abs(this._mouseDownEvent.pageX-t.pageX),Math.abs(this._mouseDownEvent.pageY-t.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}})}(r)},{"./widget":304,jquery:305}],302:[function(t,e,n){var r=t("jquery");t("./core"),t("./mouse"),t("./widget"),function(t,e){var n=5;t.widget("ui.slider",t.ui.mouse,{version:"1.10.4",widgetEventPrefix:"slide",options:{animate:!1,distance:0,max:100,min:0,orientation:"horizontal",range:!1,step:1,value:0,values:null,change:null,slide:null,start:null,stop:null},_create:function(){this._keySliding=!1,this._mouseSliding=!1,this._animateOff=!0,this._handleIndex=null,this._detectOrientation(),this._mouseInit(),this.element.addClass("ui-slider ui-slider-"+this.orientation+" ui-widget ui-widget-content ui-corner-all"),this._refresh(),this._setOption("disabled",this.options.disabled),this._animateOff=!1},_refresh:function(){this._createRange(),this._createHandles(),this._setupEvents(),this._refreshValue()},_createHandles:function(){var e,n,r=this.options,i=this.element.find(".ui-slider-handle").addClass("ui-state-default ui-corner-all"),o="<a class='ui-slider-handle ui-state-default ui-corner-all' href='#'></a>",s=[];for(n=r.values&&r.values.length||1,i.length>n&&(i.slice(n).remove(),i=i.slice(0,n)),e=i.length;n>e;e++)s.push(o);this.handles=i.add(t(s.join("")).appendTo(this.element)),this.handle=this.handles.eq(0),this.handles.each(function(e){t(this).data("ui-slider-handle-index",e)})},_createRange:function(){var e=this.options,n="";e.range?(e.range===!0&&(e.values?e.values.length&&2!==e.values.length?e.values=[e.values[0],e.values[0]]:t.isArray(e.values)&&(e.values=e.values.slice(0)):e.values=[this._valueMin(),this._valueMin()]),this.range&&this.range.length?this.range.removeClass("ui-slider-range-min ui-slider-range-max").css({left:"",bottom:""}):(this.range=t("<div></div>").appendTo(this.element),n="ui-slider-range ui-widget-header ui-corner-all"),this.range.addClass(n+("min"===e.range||"max"===e.range?" ui-slider-range-"+e.range:""))):(this.range&&this.range.remove(),this.range=null)},_setupEvents:function(){var t=this.handles.add(this.range).filter("a");this._off(t),this._on(t,this._handleEvents),this._hoverable(t),this._focusable(t)},_destroy:function(){this.handles.remove(),this.range&&this.range.remove(),this.element.removeClass("ui-slider ui-slider-horizontal ui-slider-vertical ui-widget ui-widget-content ui-corner-all"),this._mouseDestroy()},_mouseCapture:function(e){var n,r,i,o,s,a,u,l,c=this,h=this.options;return h.disabled?!1:(this.elementSize={width:this.element.outerWidth(),height:this.element.outerHeight()},this.elementOffset=this.element.offset(),n={x:e.pageX,y:e.pageY},r=this._normValueFromMouse(n),i=this._valueMax()-this._valueMin()+1,this.handles.each(function(e){var n=Math.abs(r-c.values(e));(i>n||i===n&&(e===c._lastChangedValue||c.values(e)===h.min))&&(i=n,o=t(this),s=e)}),a=this._start(e,s),a===!1?!1:(this._mouseSliding=!0,this._handleIndex=s,o.addClass("ui-state-active").focus(),u=o.offset(),l=!t(e.target).parents().addBack().is(".ui-slider-handle"),this._clickOffset=l?{left:0,top:0}:{left:e.pageX-u.left-o.width()/2,top:e.pageY-u.top-o.height()/2-(parseInt(o.css("borderTopWidth"),10)||0)-(parseInt(o.css("borderBottomWidth"),10)||0)+(parseInt(o.css("marginTop"),10)||0)},this.handles.hasClass("ui-state-hover")||this._slide(e,s,r),this._animateOff=!0,!0))},_mouseStart:function(){return!0},_mouseDrag:function(t){var e={x:t.pageX,y:t.pageY},n=this._normValueFromMouse(e);return this._slide(t,this._handleIndex,n),!1},_mouseStop:function(t){return this.handles.removeClass("ui-state-active"),this._mouseSliding=!1,this._stop(t,this._handleIndex),this._change(t,this._handleIndex),this._handleIndex=null,this._clickOffset=null,this._animateOff=!1,!1},_detectOrientation:function(){this.orientation="vertical"===this.options.orientation?"vertical":"horizontal"},_normValueFromMouse:function(t){var e,n,r,i,o;return"horizontal"===this.orientation?(e=this.elementSize.width,n=t.x-this.elementOffset.left-(this._clickOffset?this._clickOffset.left:0)):(e=this.elementSize.height,n=t.y-this.elementOffset.top-(this._clickOffset?this._clickOffset.top:0)),r=n/e,r>1&&(r=1),0>r&&(r=0),"vertical"===this.orientation&&(r=1-r),i=this._valueMax()-this._valueMin(),o=this._valueMin()+r*i,this._trimAlignValue(o)},_start:function(t,e){var n={handle:this.handles[e],value:this.value()};return this.options.values&&this.options.values.length&&(n.value=this.values(e),n.values=this.values()),this._trigger("start",t,n)},_slide:function(t,e,n){var r,i,o;this.options.values&&this.options.values.length?(r=this.values(e?0:1),2===this.options.values.length&&this.options.range===!0&&(0===e&&n>r||1===e&&r>n)&&(n=r),n!==this.values(e)&&(i=this.values(),i[e]=n,o=this._trigger("slide",t,{handle:this.handles[e],value:n,values:i}),r=this.values(e?0:1),o!==!1&&this.values(e,n))):n!==this.value()&&(o=this._trigger("slide",t,{handle:this.handles[e],value:n}),o!==!1&&this.value(n))},_stop:function(t,e){var n={handle:this.handles[e],value:this.value()};this.options.values&&this.options.values.length&&(n.value=this.values(e),n.values=this.values()),this._trigger("stop",t,n)},_change:function(t,e){if(!this._keySliding&&!this._mouseSliding){var n={handle:this.handles[e],value:this.value()};this.options.values&&this.options.values.length&&(n.value=this.values(e),n.values=this.values()),this._lastChangedValue=e,this._trigger("change",t,n)}},value:function(t){return arguments.length?(this.options.value=this._trimAlignValue(t),this._refreshValue(),void this._change(null,0)):this._value()},values:function(e,n){var r,i,o;if(arguments.length>1)return this.options.values[e]=this._trimAlignValue(n),this._refreshValue(),void this._change(null,e);if(!arguments.length)return this._values();if(!t.isArray(arguments[0]))return this.options.values&&this.options.values.length?this._values(e):this.value();for(r=this.options.values,i=arguments[0],o=0;o<r.length;o+=1)r[o]=this._trimAlignValue(i[o]),this._change(null,o);this._refreshValue()},_setOption:function(e,n){var r,i=0;switch("range"===e&&this.options.range===!0&&("min"===n?(this.options.value=this._values(0),this.options.values=null):"max"===n&&(this.options.value=this._values(this.options.values.length-1),this.options.values=null)),t.isArray(this.options.values)&&(i=this.options.values.length),t.Widget.prototype._setOption.apply(this,arguments),e){case"orientation":this._detectOrientation(),this.element.removeClass("ui-slider-horizontal ui-slider-vertical").addClass("ui-slider-"+this.orientation),this._refreshValue();break;case"value":this._animateOff=!0,this._refreshValue(),this._change(null,0),this._animateOff=!1;break;case"values":for(this._animateOff=!0,this._refreshValue(),r=0;i>r;r+=1)this._change(null,r);this._animateOff=!1;break;case"min":case"max":this._animateOff=!0,this._refreshValue(),this._animateOff=!1;break;case"range":this._animateOff=!0,this._refresh(),this._animateOff=!1}},_value:function(){var t=this.options.value;return t=this._trimAlignValue(t)},_values:function(t){var e,n,r;if(arguments.length)return e=this.options.values[t],e=this._trimAlignValue(e);if(this.options.values&&this.options.values.length){for(n=this.options.values.slice(),r=0;r<n.length;r+=1)n[r]=this._trimAlignValue(n[r]);return n}return[]},_trimAlignValue:function(t){if(t<=this._valueMin())return this._valueMin();if(t>=this._valueMax())return this._valueMax();var e=this.options.step>0?this.options.step:1,n=(t-this._valueMin())%e,r=t-n;return 2*Math.abs(n)>=e&&(r+=n>0?e:-e),parseFloat(r.toFixed(5))},_valueMin:function(){return this.options.min},_valueMax:function(){return this.options.max},_refreshValue:function(){var e,n,r,i,o,s=this.options.range,a=this.options,u=this,l=this._animateOff?!1:a.animate,c={};this.options.values&&this.options.values.length?this.handles.each(function(r){n=(u.values(r)-u._valueMin())/(u._valueMax()-u._valueMin())*100,c["horizontal"===u.orientation?"left":"bottom"]=n+"%",t(this).stop(1,1)[l?"animate":"css"](c,a.animate),u.options.range===!0&&("horizontal"===u.orientation?(0===r&&u.range.stop(1,1)[l?"animate":"css"]({left:n+"%"},a.animate),1===r&&u.range[l?"animate":"css"]({width:n-e+"%"},{queue:!1,duration:a.animate})):(0===r&&u.range.stop(1,1)[l?"animate":"css"]({bottom:n+"%"},a.animate),1===r&&u.range[l?"animate":"css"]({height:n-e+"%"},{queue:!1,duration:a.animate}))),e=n}):(r=this.value(),i=this._valueMin(),o=this._valueMax(),n=o!==i?(r-i)/(o-i)*100:0,c["horizontal"===this.orientation?"left":"bottom"]=n+"%",this.handle.stop(1,1)[l?"animate":"css"](c,a.animate),"min"===s&&"horizontal"===this.orientation&&this.range.stop(1,1)[l?"animate":"css"]({width:n+"%"},a.animate),"max"===s&&"horizontal"===this.orientation&&this.range[l?"animate":"css"]({width:100-n+"%"},{queue:!1,duration:a.animate}),"min"===s&&"vertical"===this.orientation&&this.range.stop(1,1)[l?"animate":"css"]({height:n+"%"},a.animate),"max"===s&&"vertical"===this.orientation&&this.range[l?"animate":"css"]({height:100-n+"%"},{queue:!1,duration:a.animate}))},_handleEvents:{keydown:function(e){var r,i,o,s,a=t(e.target).data("ui-slider-handle-index");switch(e.keyCode){case t.ui.keyCode.HOME:case t.ui.keyCode.END:case t.ui.keyCode.PAGE_UP:case t.ui.keyCode.PAGE_DOWN:case t.ui.keyCode.UP:case t.ui.keyCode.RIGHT:case t.ui.keyCode.DOWN:case t.ui.keyCode.LEFT:if(e.preventDefault(),!this._keySliding&&(this._keySliding=!0,t(e.target).addClass("ui-state-active"),r=this._start(e,a),r===!1))return}switch(s=this.options.step,i=o=this.options.values&&this.options.values.length?this.values(a):this.value(),e.keyCode){case t.ui.keyCode.HOME:o=this._valueMin();break;case t.ui.keyCode.END:o=this._valueMax();break;case t.ui.keyCode.PAGE_UP:o=this._trimAlignValue(i+(this._valueMax()-this._valueMin())/n);break;case t.ui.keyCode.PAGE_DOWN:o=this._trimAlignValue(i-(this._valueMax()-this._valueMin())/n);break;case t.ui.keyCode.UP:case t.ui.keyCode.RIGHT:if(i===this._valueMax())return;o=this._trimAlignValue(i+s);break;case t.ui.keyCode.DOWN:case t.ui.keyCode.LEFT:if(i===this._valueMin())return;o=this._trimAlignValue(i-s)}this._slide(e,a,o)},click:function(t){t.preventDefault()},keyup:function(e){var n=t(e.target).data("ui-slider-handle-index");this._keySliding&&(this._keySliding=!1,this._stop(e,n),this._change(e,n),t(e.target).removeClass("ui-state-active"))}}})}(r)},{"./core":298,"./mouse":301,"./widget":304,jquery:305}],303:[function(t,e,n){var r=t("jquery");t("./core"),t("./mouse"),t("./widget"),function(t,e){function n(t,e,n){return t>e&&e+n>t}function r(t){return/left|right/.test(t.css("float"))||/inline|table-cell/.test(t.css("display"))}t.widget("ui.sortable",t.ui.mouse,{version:"1.10.4",widgetEventPrefix:"sort",ready:!1,options:{appendTo:"parent",axis:!1,connectWith:!1,containment:!1,cursor:"auto",cursorAt:!1,dropOnEmpty:!0,forcePlaceholderSize:!1,forceHelperSize:!1,grid:!1,handle:!1,helper:"original",items:"> *",opacity:!1,placeholder:!1,revert:!1,scroll:!0,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1e3,activate:null,beforeStop:null,change:null,deactivate:null,out:null,over:null,receive:null,remove:null,sort:null,start:null,stop:null,update:null},_create:function(){var t=this.options;this.containerCache={},this.element.addClass("ui-sortable"),this.refresh(),this.floating=this.items.length?"x"===t.axis||r(this.items[0].item):!1,this.offset=this.element.offset(),this._mouseInit(),this.ready=!0},_destroy:function(){this.element.removeClass("ui-sortable ui-sortable-disabled"),this._mouseDestroy();for(var t=this.items.length-1;t>=0;t--)this.items[t].item.removeData(this.widgetName+"-item");return this},_setOption:function(e,n){"disabled"===e?(this.options[e]=n,this.widget().toggleClass("ui-sortable-disabled",!!n)):t.Widget.prototype._setOption.apply(this,arguments)},_mouseCapture:function(e,n){var r=null,i=!1,o=this;return this.reverting?!1:this.options.disabled||"static"===this.options.type?!1:(this._refreshItems(e),t(e.target).parents().each(function(){return t.data(this,o.widgetName+"-item")===o?(r=t(this),!1):void 0}),t.data(e.target,o.widgetName+"-item")===o&&(r=t(e.target)),r&&(!this.options.handle||n||(t(this.options.handle,r).find("*").addBack().each(function(){this===e.target&&(i=!0)}),i))?(this.currentItem=r,this._removeCurrentsFromItems(),!0):!1)},_mouseStart:function(e,n,r){var i,o,s=this.options;if(this.currentContainer=this,this.refreshPositions(),this.helper=this._createHelper(e),this._cacheHelperProportions(),this._cacheMargins(),this.scrollParent=this.helper.scrollParent(),this.offset=this.currentItem.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},t.extend(this.offset,{click:{left:e.pageX-this.offset.left,top:e.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.helper.css("position","absolute"),this.cssPosition=this.helper.css("position"),this.originalPosition=this._generatePosition(e),this.originalPageX=e.pageX,this.originalPageY=e.pageY,s.cursorAt&&this._adjustOffsetFromHelper(s.cursorAt),this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]},this.helper[0]!==this.currentItem[0]&&this.currentItem.hide(),this._createPlaceholder(),s.containment&&this._setContainment(),s.cursor&&"auto"!==s.cursor&&(o=this.document.find("body"),this.storedCursor=o.css("cursor"),o.css("cursor",s.cursor),this.storedStylesheet=t("<style>*{ cursor: "+s.cursor+" !important; }</style>").appendTo(o)),s.opacity&&(this.helper.css("opacity")&&(this._storedOpacity=this.helper.css("opacity")),this.helper.css("opacity",s.opacity)),s.zIndex&&(this.helper.css("zIndex")&&(this._storedZIndex=this.helper.css("zIndex")),this.helper.css("zIndex",s.zIndex)),this.scrollParent[0]!==document&&"HTML"!==this.scrollParent[0].tagName&&(this.overflowOffset=this.scrollParent.offset()),this._trigger("start",e,this._uiHash()),this._preserveHelperProportions||this._cacheHelperProportions(),!r)for(i=this.containers.length-1;i>=0;i--)this.containers[i]._trigger("activate",e,this._uiHash(this));return t.ui.ddmanager&&(t.ui.ddmanager.current=this),t.ui.ddmanager&&!s.dropBehaviour&&t.ui.ddmanager.prepareOffsets(this,e),this.dragging=!0,this.helper.addClass("ui-sortable-helper"),this._mouseDrag(e),!0},_mouseDrag:function(e){var n,r,i,o,s=this.options,a=!1;for(this.position=this._generatePosition(e),this.positionAbs=this._convertPositionTo("absolute"),this.lastPositionAbs||(this.lastPositionAbs=this.positionAbs),this.options.scroll&&(this.scrollParent[0]!==document&&"HTML"!==this.scrollParent[0].tagName?(this.overflowOffset.top+this.scrollParent[0].offsetHeight-e.pageY<s.scrollSensitivity?this.scrollParent[0].scrollTop=a=this.scrollParent[0].scrollTop+s.scrollSpeed:e.pageY-this.overflowOffset.top<s.scrollSensitivity&&(this.scrollParent[0].scrollTop=a=this.scrollParent[0].scrollTop-s.scrollSpeed),this.overflowOffset.left+this.scrollParent[0].offsetWidth-e.pageX<s.scrollSensitivity?this.scrollParent[0].scrollLeft=a=this.scrollParent[0].scrollLeft+s.scrollSpeed:e.pageX-this.overflowOffset.left<s.scrollSensitivity&&(this.scrollParent[0].scrollLeft=a=this.scrollParent[0].scrollLeft-s.scrollSpeed)):(e.pageY-t(document).scrollTop()<s.scrollSensitivity?a=t(document).scrollTop(t(document).scrollTop()-s.scrollSpeed):t(window).height()-(e.pageY-t(document).scrollTop())<s.scrollSensitivity&&(a=t(document).scrollTop(t(document).scrollTop()+s.scrollSpeed)),e.pageX-t(document).scrollLeft()<s.scrollSensitivity?a=t(document).scrollLeft(t(document).scrollLeft()-s.scrollSpeed):t(window).width()-(e.pageX-t(document).scrollLeft())<s.scrollSensitivity&&(a=t(document).scrollLeft(t(document).scrollLeft()+s.scrollSpeed))),a!==!1&&t.ui.ddmanager&&!s.dropBehaviour&&t.ui.ddmanager.prepareOffsets(this,e)),this.positionAbs=this._convertPositionTo("absolute"),this.options.axis&&"y"===this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"===this.options.axis||(this.helper[0].style.top=this.position.top+"px"),n=this.items.length-1;n>=0;n--)if(r=this.items[n],i=r.item[0],o=this._intersectsWithPointer(r),o&&r.instance===this.currentContainer&&i!==this.currentItem[0]&&this.placeholder[1===o?"next":"prev"]()[0]!==i&&!t.contains(this.placeholder[0],i)&&("semi-dynamic"===this.options.type?!t.contains(this.element[0],i):!0)){if(this.direction=1===o?"down":"up","pointer"!==this.options.tolerance&&!this._intersectsWithSides(r))break;this._rearrange(e,r),this._trigger("change",e,this._uiHash());break}return this._contactContainers(e),t.ui.ddmanager&&t.ui.ddmanager.drag(this,e),this._trigger("sort",e,this._uiHash()),this.lastPositionAbs=this.positionAbs,!1},_mouseStop:function(e,n){if(e){if(t.ui.ddmanager&&!this.options.dropBehaviour&&t.ui.ddmanager.drop(this,e),this.options.revert){var r=this,i=this.placeholder.offset(),o=this.options.axis,s={};o&&"x"!==o||(s.left=i.left-this.offset.parent.left-this.margins.left+(this.offsetParent[0]===document.body?0:this.offsetParent[0].scrollLeft)),o&&"y"!==o||(s.top=i.top-this.offset.parent.top-this.margins.top+(this.offsetParent[0]===document.body?0:this.offsetParent[0].scrollTop)),this.reverting=!0,t(this.helper).animate(s,parseInt(this.options.revert,10)||500,function(){r._clear(e)})}else this._clear(e,n);return!1}},cancel:function(){if(this.dragging){this._mouseUp({target:null}),"original"===this.options.helper?this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper"):this.currentItem.show();for(var e=this.containers.length-1;e>=0;e--)this.containers[e]._trigger("deactivate",null,this._uiHash(this)),this.containers[e].containerCache.over&&(this.containers[e]._trigger("out",null,this._uiHash(this)),this.containers[e].containerCache.over=0)}return this.placeholder&&(this.placeholder[0].parentNode&&this.placeholder[0].parentNode.removeChild(this.placeholder[0]),"original"!==this.options.helper&&this.helper&&this.helper[0].parentNode&&this.helper.remove(),t.extend(this,{helper:null,dragging:!1,reverting:!1,_noFinalSort:null}),this.domPosition.prev?t(this.domPosition.prev).after(this.currentItem):t(this.domPosition.parent).prepend(this.currentItem)),this},serialize:function(e){var n=this._getItemsAsjQuery(e&&e.connected),r=[];return e=e||{},t(n).each(function(){var n=(t(e.item||this).attr(e.attribute||"id")||"").match(e.expression||/(.+)[\-=_](.+)/);n&&r.push((e.key||n[1]+"[]")+"="+(e.key&&e.expression?n[1]:n[2]))}),!r.length&&e.key&&r.push(e.key+"="),r.join("&")},toArray:function(e){var n=this._getItemsAsjQuery(e&&e.connected),r=[];return e=e||{},n.each(function(){r.push(t(e.item||this).attr(e.attribute||"id")||"")}),r},_intersectsWith:function(t){var e=this.positionAbs.left,n=e+this.helperProportions.width,r=this.positionAbs.top,i=r+this.helperProportions.height,o=t.left,s=o+t.width,a=t.top,u=a+t.height,l=this.offset.click.top,c=this.offset.click.left,h="x"===this.options.axis||r+l>a&&u>r+l,p="y"===this.options.axis||e+c>o&&s>e+c,f=h&&p;return"pointer"===this.options.tolerance||this.options.forcePointerForContainers||"pointer"!==this.options.tolerance&&this.helperProportions[this.floating?"width":"height"]>t[this.floating?"width":"height"]?f:o<e+this.helperProportions.width/2&&n-this.helperProportions.width/2<s&&a<r+this.helperProportions.height/2&&i-this.helperProportions.height/2<u},_intersectsWithPointer:function(t){var e="x"===this.options.axis||n(this.positionAbs.top+this.offset.click.top,t.top,t.height),r="y"===this.options.axis||n(this.positionAbs.left+this.offset.click.left,t.left,t.width),i=e&&r,o=this._getDragVerticalDirection(),s=this._getDragHorizontalDirection();return i?this.floating?s&&"right"===s||"down"===o?2:1:o&&("down"===o?2:1):!1},_intersectsWithSides:function(t){var e=n(this.positionAbs.top+this.offset.click.top,t.top+t.height/2,t.height),r=n(this.positionAbs.left+this.offset.click.left,t.left+t.width/2,t.width),i=this._getDragVerticalDirection(),o=this._getDragHorizontalDirection();return this.floating&&o?"right"===o&&r||"left"===o&&!r:i&&("down"===i&&e||"up"===i&&!e)},_getDragVerticalDirection:function(){var t=this.positionAbs.top-this.lastPositionAbs.top;return 0!==t&&(t>0?"down":"up")},_getDragHorizontalDirection:function(){var t=this.positionAbs.left-this.lastPositionAbs.left;return 0!==t&&(t>0?"right":"left")},refresh:function(t){return this._refreshItems(t),this.refreshPositions(),this},_connectWith:function(){var t=this.options;return t.connectWith.constructor===String?[t.connectWith]:t.connectWith},_getItemsAsjQuery:function(e){function n(){a.push(this)}var r,i,o,s,a=[],u=[],l=this._connectWith();if(l&&e)for(r=l.length-1;r>=0;r--)for(o=t(l[r]),i=o.length-1;i>=0;i--)s=t.data(o[i],this.widgetFullName),s&&s!==this&&!s.options.disabled&&u.push([t.isFunction(s.options.items)?s.options.items.call(s.element):t(s.options.items,s.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),s]);for(u.push([t.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):t(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]),r=u.length-1;r>=0;r--)u[r][0].each(n);return t(a)},_removeCurrentsFromItems:function(){var e=this.currentItem.find(":data("+this.widgetName+"-item)");this.items=t.grep(this.items,function(t){for(var n=0;n<e.length;n++)if(e[n]===t.item[0])return!1;return!0})},_refreshItems:function(e){this.items=[],this.containers=[this];var n,r,i,o,s,a,u,l,c=this.items,h=[[t.isFunction(this.options.items)?this.options.items.call(this.element[0],e,{item:this.currentItem}):t(this.options.items,this.element),this]],p=this._connectWith();if(p&&this.ready)for(n=p.length-1;n>=0;n--)for(i=t(p[n]),r=i.length-1;r>=0;r--)o=t.data(i[r],this.widgetFullName),o&&o!==this&&!o.options.disabled&&(h.push([t.isFunction(o.options.items)?o.options.items.call(o.element[0],e,{item:this.currentItem}):t(o.options.items,o.element),o]),this.containers.push(o));for(n=h.length-1;n>=0;n--)for(s=h[n][1],a=h[n][0],r=0,l=a.length;l>r;r++)u=t(a[r]),u.data(this.widgetName+"-item",s),c.push({item:u,instance:s,width:0,height:0,left:0,top:0})},refreshPositions:function(e){this.offsetParent&&this.helper&&(this.offset.parent=this._getParentOffset());var n,r,i,o;for(n=this.items.length-1;n>=0;n--)r=this.items[n],r.instance!==this.currentContainer&&this.currentContainer&&r.item[0]!==this.currentItem[0]||(i=this.options.toleranceElement?t(this.options.toleranceElement,r.item):r.item,e||(r.width=i.outerWidth(),r.height=i.outerHeight()),o=i.offset(),r.left=o.left,r.top=o.top);if(this.options.custom&&this.options.custom.refreshContainers)this.options.custom.refreshContainers.call(this);else for(n=this.containers.length-1;n>=0;n--)o=this.containers[n].element.offset(),this.containers[n].containerCache.left=o.left,this.containers[n].containerCache.top=o.top,this.containers[n].containerCache.width=this.containers[n].element.outerWidth(),this.containers[n].containerCache.height=this.containers[n].element.outerHeight();return this},_createPlaceholder:function(e){e=e||this;var n,r=e.options;r.placeholder&&r.placeholder.constructor!==String||(n=r.placeholder,r.placeholder={element:function(){var r=e.currentItem[0].nodeName.toLowerCase(),i=t("<"+r+">",e.document[0]).addClass(n||e.currentItem[0].className+" ui-sortable-placeholder").removeClass("ui-sortable-helper");return"tr"===r?e.currentItem.children().each(function(){t("<td>&#160;</td>",e.document[0]).attr("colspan",t(this).attr("colspan")||1).appendTo(i)}):"img"===r&&i.attr("src",e.currentItem.attr("src")),n||i.css("visibility","hidden"),i},update:function(t,i){(!n||r.forcePlaceholderSize)&&(i.height()||i.height(e.currentItem.innerHeight()-parseInt(e.currentItem.css("paddingTop")||0,10)-parseInt(e.currentItem.css("paddingBottom")||0,10)),i.width()||i.width(e.currentItem.innerWidth()-parseInt(e.currentItem.css("paddingLeft")||0,10)-parseInt(e.currentItem.css("paddingRight")||0,10)))}}),e.placeholder=t(r.placeholder.element.call(e.element,e.currentItem)),e.currentItem.after(e.placeholder),r.placeholder.update(e,e.placeholder)},_contactContainers:function(e){var i,o,s,a,u,l,c,h,p,f,d=null,m=null;for(i=this.containers.length-1;i>=0;i--)if(!t.contains(this.currentItem[0],this.containers[i].element[0]))if(this._intersectsWith(this.containers[i].containerCache)){if(d&&t.contains(this.containers[i].element[0],d.element[0]))continue;d=this.containers[i],m=i}else this.containers[i].containerCache.over&&(this.containers[i]._trigger("out",e,this._uiHash(this)),this.containers[i].containerCache.over=0);if(d)if(1===this.containers.length)this.containers[m].containerCache.over||(this.containers[m]._trigger("over",e,this._uiHash(this)),this.containers[m].containerCache.over=1);else{for(s=1e4,a=null,f=d.floating||r(this.currentItem),u=f?"left":"top",l=f?"width":"height",c=this.positionAbs[u]+this.offset.click[u],o=this.items.length-1;o>=0;o--)t.contains(this.containers[m].element[0],this.items[o].item[0])&&this.items[o].item[0]!==this.currentItem[0]&&(!f||n(this.positionAbs.top+this.offset.click.top,this.items[o].top,this.items[o].height))&&(h=this.items[o].item.offset()[u],p=!1,Math.abs(h-c)>Math.abs(h+this.items[o][l]-c)&&(p=!0,h+=this.items[o][l]),Math.abs(h-c)<s&&(s=Math.abs(h-c),a=this.items[o],this.direction=p?"up":"down"));if(!a&&!this.options.dropOnEmpty)return;if(this.currentContainer===this.containers[m])return;a?this._rearrange(e,a,null,!0):this._rearrange(e,null,this.containers[m].element,!0),this._trigger("change",e,this._uiHash()),this.containers[m]._trigger("change",e,this._uiHash(this)),this.currentContainer=this.containers[m],this.options.placeholder.update(this.currentContainer,this.placeholder),this.containers[m]._trigger("over",e,this._uiHash(this)),this.containers[m].containerCache.over=1}},_createHelper:function(e){var n=this.options,r=t.isFunction(n.helper)?t(n.helper.apply(this.element[0],[e,this.currentItem])):"clone"===n.helper?this.currentItem.clone():this.currentItem;return r.parents("body").length||t("parent"!==n.appendTo?n.appendTo:this.currentItem[0].parentNode)[0].appendChild(r[0]),
r[0]===this.currentItem[0]&&(this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")}),(!r[0].style.width||n.forceHelperSize)&&r.width(this.currentItem.width()),(!r[0].style.height||n.forceHelperSize)&&r.height(this.currentItem.height()),r},_adjustOffsetFromHelper:function(e){"string"==typeof e&&(e=e.split(" ")),t.isArray(e)&&(e={left:+e[0],top:+e[1]||0}),"left"in e&&(this.offset.click.left=e.left+this.margins.left),"right"in e&&(this.offset.click.left=this.helperProportions.width-e.right+this.margins.left),"top"in e&&(this.offset.click.top=e.top+this.margins.top),"bottom"in e&&(this.offset.click.top=this.helperProportions.height-e.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var e=this.offsetParent.offset();return"absolute"===this.cssPosition&&this.scrollParent[0]!==document&&t.contains(this.scrollParent[0],this.offsetParent[0])&&(e.left+=this.scrollParent.scrollLeft(),e.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]===document.body||this.offsetParent[0].tagName&&"html"===this.offsetParent[0].tagName.toLowerCase()&&t.ui.ie)&&(e={top:0,left:0}),{top:e.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:e.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"===this.cssPosition){var t=this.currentItem.position();return{top:t.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:t.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css("marginLeft"),10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var e,n,r,i=this.options;"parent"===i.containment&&(i.containment=this.helper[0].parentNode),("document"===i.containment||"window"===i.containment)&&(this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,t("document"===i.containment?document:window).width()-this.helperProportions.width-this.margins.left,(t("document"===i.containment?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]),/^(document|window|parent)$/.test(i.containment)||(e=t(i.containment)[0],n=t(i.containment).offset(),r="hidden"!==t(e).css("overflow"),this.containment=[n.left+(parseInt(t(e).css("borderLeftWidth"),10)||0)+(parseInt(t(e).css("paddingLeft"),10)||0)-this.margins.left,n.top+(parseInt(t(e).css("borderTopWidth"),10)||0)+(parseInt(t(e).css("paddingTop"),10)||0)-this.margins.top,n.left+(r?Math.max(e.scrollWidth,e.offsetWidth):e.offsetWidth)-(parseInt(t(e).css("borderLeftWidth"),10)||0)-(parseInt(t(e).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,n.top+(r?Math.max(e.scrollHeight,e.offsetHeight):e.offsetHeight)-(parseInt(t(e).css("borderTopWidth"),10)||0)-(parseInt(t(e).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top])},_convertPositionTo:function(e,n){n||(n=this.position);var r="absolute"===e?1:-1,i="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&t.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,o=/(html|body)/i.test(i[0].tagName);return{top:n.top+this.offset.relative.top*r+this.offset.parent.top*r-("fixed"===this.cssPosition?-this.scrollParent.scrollTop():o?0:i.scrollTop())*r,left:n.left+this.offset.relative.left*r+this.offset.parent.left*r-("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():o?0:i.scrollLeft())*r}},_generatePosition:function(e){var n,r,i=this.options,o=e.pageX,s=e.pageY,a="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&t.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,u=/(html|body)/i.test(a[0].tagName);return"relative"!==this.cssPosition||this.scrollParent[0]!==document&&this.scrollParent[0]!==this.offsetParent[0]||(this.offset.relative=this._getRelativeOffset()),this.originalPosition&&(this.containment&&(e.pageX-this.offset.click.left<this.containment[0]&&(o=this.containment[0]+this.offset.click.left),e.pageY-this.offset.click.top<this.containment[1]&&(s=this.containment[1]+this.offset.click.top),e.pageX-this.offset.click.left>this.containment[2]&&(o=this.containment[2]+this.offset.click.left),e.pageY-this.offset.click.top>this.containment[3]&&(s=this.containment[3]+this.offset.click.top)),i.grid&&(n=this.originalPageY+Math.round((s-this.originalPageY)/i.grid[1])*i.grid[1],s=this.containment?n-this.offset.click.top>=this.containment[1]&&n-this.offset.click.top<=this.containment[3]?n:n-this.offset.click.top>=this.containment[1]?n-i.grid[1]:n+i.grid[1]:n,r=this.originalPageX+Math.round((o-this.originalPageX)/i.grid[0])*i.grid[0],o=this.containment?r-this.offset.click.left>=this.containment[0]&&r-this.offset.click.left<=this.containment[2]?r:r-this.offset.click.left>=this.containment[0]?r-i.grid[0]:r+i.grid[0]:r)),{top:s-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.scrollParent.scrollTop():u?0:a.scrollTop()),left:o-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():u?0:a.scrollLeft())}},_rearrange:function(t,e,n,r){n?n[0].appendChild(this.placeholder[0]):e.item[0].parentNode.insertBefore(this.placeholder[0],"down"===this.direction?e.item[0]:e.item[0].nextSibling),this.counter=this.counter?++this.counter:1;var i=this.counter;this._delay(function(){i===this.counter&&this.refreshPositions(!r)})},_clear:function(t,e){function n(t,e,n){return function(r){n._trigger(t,r,e._uiHash(e))}}this.reverting=!1;var r,i=[];if(!this._noFinalSort&&this.currentItem.parent().length&&this.placeholder.before(this.currentItem),this._noFinalSort=null,this.helper[0]===this.currentItem[0]){for(r in this._storedCSS)("auto"===this._storedCSS[r]||"static"===this._storedCSS[r])&&(this._storedCSS[r]="");this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")}else this.currentItem.show();for(this.fromOutside&&!e&&i.push(function(t){this._trigger("receive",t,this._uiHash(this.fromOutside))}),!this.fromOutside&&this.domPosition.prev===this.currentItem.prev().not(".ui-sortable-helper")[0]&&this.domPosition.parent===this.currentItem.parent()[0]||e||i.push(function(t){this._trigger("update",t,this._uiHash())}),this!==this.currentContainer&&(e||(i.push(function(t){this._trigger("remove",t,this._uiHash())}),i.push(function(t){return function(e){t._trigger("receive",e,this._uiHash(this))}}.call(this,this.currentContainer)),i.push(function(t){return function(e){t._trigger("update",e,this._uiHash(this))}}.call(this,this.currentContainer)))),r=this.containers.length-1;r>=0;r--)e||i.push(n("deactivate",this,this.containers[r])),this.containers[r].containerCache.over&&(i.push(n("out",this,this.containers[r])),this.containers[r].containerCache.over=0);if(this.storedCursor&&(this.document.find("body").css("cursor",this.storedCursor),this.storedStylesheet.remove()),this._storedOpacity&&this.helper.css("opacity",this._storedOpacity),this._storedZIndex&&this.helper.css("zIndex","auto"===this._storedZIndex?"":this._storedZIndex),this.dragging=!1,this.cancelHelperRemoval){if(!e){for(this._trigger("beforeStop",t,this._uiHash()),r=0;r<i.length;r++)i[r].call(this,t);this._trigger("stop",t,this._uiHash())}return this.fromOutside=!1,!1}if(e||this._trigger("beforeStop",t,this._uiHash()),this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.helper[0]!==this.currentItem[0]&&this.helper.remove(),this.helper=null,!e){for(r=0;r<i.length;r++)i[r].call(this,t);this._trigger("stop",t,this._uiHash())}return this.fromOutside=!1,!0},_trigger:function(){t.Widget.prototype._trigger.apply(this,arguments)===!1&&this.cancel()},_uiHash:function(e){var n=e||this;return{helper:n.helper,placeholder:n.placeholder||t([]),position:n.position,originalPosition:n.originalPosition,offset:n.positionAbs,item:n.currentItem,sender:e?e.element:null}}})}(r)},{"./core":298,"./mouse":301,"./widget":304,jquery:305}],304:[function(t,e,n){var r=t("jquery");!function(t,e){var n=0,r=Array.prototype.slice,i=t.cleanData;t.cleanData=function(e){for(var n,r=0;null!=(n=e[r]);r++)try{t(n).triggerHandler("remove")}catch(o){}i(e)},t.widget=function(e,n,r){var i,o,s,a,u={},l=e.split(".")[0];e=e.split(".")[1],i=l+"-"+e,r||(r=n,n=t.Widget),t.expr[":"][i.toLowerCase()]=function(e){return!!t.data(e,i)},t[l]=t[l]||{},o=t[l][e],s=t[l][e]=function(t,e){return this._createWidget?void(arguments.length&&this._createWidget(t,e)):new s(t,e)},t.extend(s,o,{version:r.version,_proto:t.extend({},r),_childConstructors:[]}),a=new n,a.options=t.widget.extend({},a.options),t.each(r,function(e,r){return t.isFunction(r)?void(u[e]=function(){var t=function(){return n.prototype[e].apply(this,arguments)},i=function(t){return n.prototype[e].apply(this,t)};return function(){var e,n=this._super,o=this._superApply;return this._super=t,this._superApply=i,e=r.apply(this,arguments),this._super=n,this._superApply=o,e}}()):void(u[e]=r)}),s.prototype=t.widget.extend(a,{widgetEventPrefix:o?a.widgetEventPrefix||e:e},u,{constructor:s,namespace:l,widgetName:e,widgetFullName:i}),o?(t.each(o._childConstructors,function(e,n){var r=n.prototype;t.widget(r.namespace+"."+r.widgetName,s,n._proto)}),delete o._childConstructors):n._childConstructors.push(s),t.widget.bridge(e,s)},t.widget.extend=function(n){for(var i,o,s=r.call(arguments,1),a=0,u=s.length;u>a;a++)for(i in s[a])o=s[a][i],s[a].hasOwnProperty(i)&&o!==e&&(n[i]=t.isPlainObject(o)?t.isPlainObject(n[i])?t.widget.extend({},n[i],o):t.widget.extend({},o):o);return n},t.widget.bridge=function(n,i){var o=i.prototype.widgetFullName||n;t.fn[n]=function(s){var a="string"==typeof s,u=r.call(arguments,1),l=this;return s=!a&&u.length?t.widget.extend.apply(null,[s].concat(u)):s,this.each(a?function(){var r,i=t.data(this,o);return i?t.isFunction(i[s])&&"_"!==s.charAt(0)?(r=i[s].apply(i,u),r!==i&&r!==e?(l=r&&r.jquery?l.pushStack(r.get()):r,!1):void 0):t.error("no such method '"+s+"' for "+n+" widget instance"):t.error("cannot call methods on "+n+" prior to initialization; attempted to call method '"+s+"'")}:function(){var e=t.data(this,o);e?e.option(s||{})._init():t.data(this,o,new i(s,this))}),l}},t.Widget=function(){},t.Widget._childConstructors=[],t.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(e,r){r=t(r||this.defaultElement||this)[0],this.element=t(r),this.uuid=n++,this.eventNamespace="."+this.widgetName+this.uuid,this.options=t.widget.extend({},this.options,this._getCreateOptions(),e),this.bindings=t(),this.hoverable=t(),this.focusable=t(),r!==this&&(t.data(r,this.widgetFullName,this),this._on(!0,this.element,{remove:function(t){t.target===r&&this.destroy()}}),this.document=t(r.style?r.ownerDocument:r.document||r),this.window=t(this.document[0].defaultView||this.document[0].parentWindow)),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:t.noop,_getCreateEventData:t.noop,_create:t.noop,_init:t.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetName).removeData(this.widgetFullName).removeData(t.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:t.noop,widget:function(){return this.element},option:function(n,r){var i,o,s,a=n;if(0===arguments.length)return t.widget.extend({},this.options);if("string"==typeof n)if(a={},i=n.split("."),n=i.shift(),i.length){for(o=a[n]=t.widget.extend({},this.options[n]),s=0;s<i.length-1;s++)o[i[s]]=o[i[s]]||{},o=o[i[s]];if(n=i.pop(),1===arguments.length)return o[n]===e?null:o[n];o[n]=r}else{if(1===arguments.length)return this.options[n]===e?null:this.options[n];a[n]=r}return this._setOptions(a),this},_setOptions:function(t){var e;for(e in t)this._setOption(e,t[e]);return this},_setOption:function(t,e){return this.options[t]=e,"disabled"===t&&(this.widget().toggleClass(this.widgetFullName+"-disabled ui-state-disabled",!!e).attr("aria-disabled",e),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")),this},enable:function(){return this._setOption("disabled",!1)},disable:function(){return this._setOption("disabled",!0)},_on:function(e,n,r){var i,o=this;"boolean"!=typeof e&&(r=n,n=e,e=!1),r?(n=i=t(n),this.bindings=this.bindings.add(n)):(r=n,n=this.element,i=this.widget()),t.each(r,function(r,s){function a(){return e||o.options.disabled!==!0&&!t(this).hasClass("ui-state-disabled")?("string"==typeof s?o[s]:s).apply(o,arguments):void 0}"string"!=typeof s&&(a.guid=s.guid=s.guid||a.guid||t.guid++);var u=r.match(/^(\w+)\s*(.*)$/),l=u[1]+o.eventNamespace,c=u[2];c?i.delegate(c,l,a):n.bind(l,a)})},_off:function(t,e){e=(e||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,t.unbind(e).undelegate(e)},_delay:function(t,e){function n(){return("string"==typeof t?r[t]:t).apply(r,arguments)}var r=this;return setTimeout(n,e||0)},_hoverable:function(e){this.hoverable=this.hoverable.add(e),this._on(e,{mouseenter:function(e){t(e.currentTarget).addClass("ui-state-hover")},mouseleave:function(e){t(e.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(e){this.focusable=this.focusable.add(e),this._on(e,{focusin:function(e){t(e.currentTarget).addClass("ui-state-focus")},focusout:function(e){t(e.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(e,n,r){var i,o,s=this.options[e];if(r=r||{},n=t.Event(n),n.type=(e===this.widgetEventPrefix?e:this.widgetEventPrefix+e).toLowerCase(),n.target=this.element[0],o=n.originalEvent)for(i in o)i in n||(n[i]=o[i]);return this.element.trigger(n,r),!(t.isFunction(s)&&s.apply(this.element[0],[n].concat(r))===!1||n.isDefaultPrevented())}},t.each({show:"fadeIn",hide:"fadeOut"},function(e,n){t.Widget.prototype["_"+e]=function(r,i,o){"string"==typeof i&&(i={effect:i});var s,a=i?i===!0||"number"==typeof i?n:i.effect||n:e;i=i||{},"number"==typeof i&&(i={duration:i}),s=!t.isEmptyObject(i),i.complete=o,i.delay&&r.delay(i.delay),s&&t.effects&&t.effects.effect[a]?r[e](i):a!==e&&r[a]?r[a](i.duration,i.easing,o):r.queue(function(n){t(this)[e](),o&&o.call(r[0]),n()})}})}(r)},{jquery:305}],305:[function(t,e,n){!function(t,n){"object"==typeof e&&"object"==typeof e.exports?e.exports=t.document?n(t,!0):function(t){if(!t.document)throw new Error("jQuery requires a window with a document");return n(t)}:n(t)}("undefined"!=typeof window?window:this,function(t,e){function n(t){var e="length"in t&&t.length,n=Z.type(t);return"function"===n||Z.isWindow(t)?!1:1===t.nodeType&&e?!0:"array"===n||0===e||"number"==typeof e&&e>0&&e-1 in t}function r(t,e,n){if(Z.isFunction(e))return Z.grep(t,function(t,r){return!!e.call(t,r,t)!==n});if(e.nodeType)return Z.grep(t,function(t){return t===e!==n});if("string"==typeof e){if(at.test(e))return Z.filter(e,t,n);e=Z.filter(e,t)}return Z.grep(t,function(t){return W.call(e,t)>=0!==n})}function i(t,e){for(;(t=t[e])&&1!==t.nodeType;);return t}function o(t){var e=dt[t]={};return Z.each(t.match(ft)||[],function(t,n){e[n]=!0}),e}function s(){Y.removeEventListener("DOMContentLoaded",s,!1),t.removeEventListener("load",s,!1),Z.ready()}function a(){Object.defineProperty(this.cache={},0,{get:function(){return{}}}),this.expando=Z.expando+a.uid++}function u(t,e,n){var r;if(void 0===n&&1===t.nodeType)if(r="data-"+e.replace(_t,"-$1").toLowerCase(),n=t.getAttribute(r),"string"==typeof n){try{n="true"===n?!0:"false"===n?!1:"null"===n?null:+n+""===n?+n:bt.test(n)?Z.parseJSON(n):n}catch(i){}vt.set(t,e,n)}else n=void 0;return n}function l(){return!0}function c(){return!1}function h(){try{return Y.activeElement}catch(t){}}function p(t,e){return Z.nodeName(t,"table")&&Z.nodeName(11!==e.nodeType?e:e.firstChild,"tr")?t.getElementsByTagName("tbody")[0]||t.appendChild(t.ownerDocument.createElement("tbody")):t}function f(t){return t.type=(null!==t.getAttribute("type"))+"/"+t.type,t}function d(t){var e=Lt.exec(t.type);return e?t.type=e[1]:t.removeAttribute("type"),t}function m(t,e){for(var n=0,r=t.length;r>n;n++)yt.set(t[n],"globalEval",!e||yt.get(e[n],"globalEval"))}function g(t,e){var n,r,i,o,s,a,u,l;if(1===e.nodeType){if(yt.hasData(t)&&(o=yt.access(t),s=yt.set(e,o),l=o.events)){delete s.handle,s.events={};for(i in l)for(n=0,r=l[i].length;r>n;n++)Z.event.add(e,i,l[i][n])}vt.hasData(t)&&(a=vt.access(t),u=Z.extend({},a),vt.set(e,u))}}function y(t,e){var n=t.getElementsByTagName?t.getElementsByTagName(e||"*"):t.querySelectorAll?t.querySelectorAll(e||"*"):[];return void 0===e||e&&Z.nodeName(t,e)?Z.merge([t],n):n}function v(t,e){var n=e.nodeName.toLowerCase();"input"===n&&Tt.test(t.type)?e.checked=t.checked:("input"===n||"textarea"===n)&&(e.defaultValue=t.defaultValue)}function b(e,n){var r,i=Z(n.createElement(e)).appendTo(n.body),o=t.getDefaultComputedStyle&&(r=t.getDefaultComputedStyle(i[0]))?r.display:Z.css(i[0],"display");return i.detach(),o}function _(t){var e=Y,n=Ft[t];return n||(n=b(t,e),"none"!==n&&n||($t=($t||Z("<iframe frameborder='0' width='0' height='0'/>")).appendTo(e.documentElement),e=$t[0].contentDocument,e.write(),e.close(),n=b(t,e),$t.detach()),Ft[t]=n),n}function w(t,e,n){var r,i,o,s,a=t.style;return n=n||Ht(t),n&&(s=n.getPropertyValue(e)||n[e]),n&&(""!==s||Z.contains(t.ownerDocument,t)||(s=Z.style(t,e)),Ut.test(s)&&zt.test(e)&&(r=a.width,i=a.minWidth,o=a.maxWidth,a.minWidth=a.maxWidth=a.width=s,s=n.width,a.width=r,a.minWidth=i,a.maxWidth=o)),void 0!==s?s+"":s}function x(t,e){return{get:function(){return t()?void delete this.get:(this.get=e).apply(this,arguments)}}}function C(t,e){if(e in t)return e;for(var n=e[0].toUpperCase()+e.slice(1),r=e,i=Xt.length;i--;)if(e=Xt[i]+n,e in t)return e;return r}function T(t,e,n){var r=Vt.exec(e);return r?Math.max(0,r[1]-(n||0))+(r[2]||"px"):e}function S(t,e,n,r,i){for(var o=n===(r?"border":"content")?4:"width"===e?1:0,s=0;4>o;o+=2)"margin"===n&&(s+=Z.css(t,n+xt[o],!0,i)),r?("content"===n&&(s-=Z.css(t,"padding"+xt[o],!0,i)),"margin"!==n&&(s-=Z.css(t,"border"+xt[o]+"Width",!0,i))):(s+=Z.css(t,"padding"+xt[o],!0,i),"padding"!==n&&(s+=Z.css(t,"border"+xt[o]+"Width",!0,i)));return s}function E(t,e,n){var r=!0,i="width"===e?t.offsetWidth:t.offsetHeight,o=Ht(t),s="border-box"===Z.css(t,"boxSizing",!1,o);if(0>=i||null==i){if(i=w(t,e,o),(0>i||null==i)&&(i=t.style[e]),Ut.test(i))return i;r=s&&(Q.boxSizingReliable()||i===t.style[e]),i=parseFloat(i)||0}return i+S(t,e,n||(s?"border":"content"),r,o)+"px"}function N(t,e){for(var n,r,i,o=[],s=0,a=t.length;a>s;s++)r=t[s],r.style&&(o[s]=yt.get(r,"olddisplay"),n=r.style.display,e?(o[s]||"none"!==n||(r.style.display=""),""===r.style.display&&Ct(r)&&(o[s]=yt.access(r,"olddisplay",_(r.nodeName)))):(i=Ct(r),"none"===n&&i||yt.set(r,"olddisplay",i?n:Z.css(r,"display"))));for(s=0;a>s;s++)r=t[s],r.style&&(e&&"none"!==r.style.display&&""!==r.style.display||(r.style.display=e?o[s]||"":"none"));return t}function k(t,e,n,r,i){return new k.prototype.init(t,e,n,r,i)}function M(){return setTimeout(function(){Qt=void 0}),Qt=Z.now()}function P(t,e){var n,r=0,i={height:t};for(e=e?1:0;4>r;r+=2-e)n=xt[r],i["margin"+n]=i["padding"+n]=t;return e&&(i.opacity=i.width=t),i}function O(t,e,n){for(var r,i=(ne[e]||[]).concat(ne["*"]),o=0,s=i.length;s>o;o++)if(r=i[o].call(n,e,t))return r}function A(t,e,n){var r,i,o,s,a,u,l,c,h=this,p={},f=t.style,d=t.nodeType&&Ct(t),m=yt.get(t,"fxshow");n.queue||(a=Z._queueHooks(t,"fx"),null==a.unqueued&&(a.unqueued=0,u=a.empty.fire,a.empty.fire=function(){a.unqueued||u()}),a.unqueued++,h.always(function(){h.always(function(){a.unqueued--,Z.queue(t,"fx").length||a.empty.fire()})})),1===t.nodeType&&("height"in e||"width"in e)&&(n.overflow=[f.overflow,f.overflowX,f.overflowY],l=Z.css(t,"display"),c="none"===l?yt.get(t,"olddisplay")||_(t.nodeName):l,"inline"===c&&"none"===Z.css(t,"float")&&(f.display="inline-block")),n.overflow&&(f.overflow="hidden",h.always(function(){f.overflow=n.overflow[0],f.overflowX=n.overflow[1],f.overflowY=n.overflow[2]}));for(r in e)if(i=e[r],Kt.exec(i)){if(delete e[r],o=o||"toggle"===i,i===(d?"hide":"show")){if("show"!==i||!m||void 0===m[r])continue;d=!0}p[r]=m&&m[r]||Z.style(t,r)}else l=void 0;if(Z.isEmptyObject(p))"inline"===("none"===l?_(t.nodeName):l)&&(f.display=l);else{m?"hidden"in m&&(d=m.hidden):m=yt.access(t,"fxshow",{}),o&&(m.hidden=!d),d?Z(t).show():h.done(function(){Z(t).hide()}),h.done(function(){var e;yt.remove(t,"fxshow");for(e in p)Z.style(t,e,p[e])});for(r in p)s=O(d?m[r]:0,r,h),r in m||(m[r]=s.start,d&&(s.end=s.start,s.start="width"===r||"height"===r?1:0))}}function R(t,e){var n,r,i,o,s;for(n in t)if(r=Z.camelCase(n),i=e[r],o=t[n],Z.isArray(o)&&(i=o[1],o=t[n]=o[0]),n!==r&&(t[r]=o,delete t[n]),s=Z.cssHooks[r],s&&"expand"in s){o=s.expand(o),delete t[r];for(n in o)n in t||(t[n]=o[n],e[n]=i)}else e[r]=i}function I(t,e,n){var r,i,o=0,s=ee.length,a=Z.Deferred().always(function(){delete u.elem}),u=function(){if(i)return!1;for(var e=Qt||M(),n=Math.max(0,l.startTime+l.duration-e),r=n/l.duration||0,o=1-r,s=0,u=l.tweens.length;u>s;s++)l.tweens[s].run(o);return a.notifyWith(t,[l,o,n]),1>o&&u?n:(a.resolveWith(t,[l]),!1)},l=a.promise({elem:t,props:Z.extend({},e),opts:Z.extend(!0,{specialEasing:{}},n),originalProperties:e,originalOptions:n,startTime:Qt||M(),duration:n.duration,tweens:[],createTween:function(e,n){var r=Z.Tween(t,l.opts,e,n,l.opts.specialEasing[e]||l.opts.easing);return l.tweens.push(r),r},stop:function(e){var n=0,r=e?l.tweens.length:0;if(i)return this;for(i=!0;r>n;n++)l.tweens[n].run(1);return e?a.resolveWith(t,[l,e]):a.rejectWith(t,[l,e]),this}}),c=l.props;for(R(c,l.opts.specialEasing);s>o;o++)if(r=ee[o].call(l,t,c,l.opts))return r;return Z.map(c,O,l),Z.isFunction(l.opts.start)&&l.opts.start.call(t,l),Z.fx.timer(Z.extend(u,{elem:t,anim:l,queue:l.opts.queue})),l.progress(l.opts.progress).done(l.opts.done,l.opts.complete).fail(l.opts.fail).always(l.opts.always)}function D(t){return function(e,n){"string"!=typeof e&&(n=e,e="*");var r,i=0,o=e.toLowerCase().match(ft)||[];if(Z.isFunction(n))for(;r=o[i++];)"+"===r[0]?(r=r.slice(1)||"*",(t[r]=t[r]||[]).unshift(n)):(t[r]=t[r]||[]).push(n)}}function L(t,e,n,r){function i(a){var u;return o[a]=!0,Z.each(t[a]||[],function(t,a){var l=a(e,n,r);return"string"!=typeof l||s||o[l]?s?!(u=l):void 0:(e.dataTypes.unshift(l),i(l),!1)}),u}var o={},s=t===be;return i(e.dataTypes[0])||!o["*"]&&i("*")}function q(t,e){var n,r,i=Z.ajaxSettings.flatOptions||{};for(n in e)void 0!==e[n]&&((i[n]?t:r||(r={}))[n]=e[n]);return r&&Z.extend(!0,t,r),t}function j(t,e,n){for(var r,i,o,s,a=t.contents,u=t.dataTypes;"*"===u[0];)u.shift(),void 0===r&&(r=t.mimeType||e.getResponseHeader("Content-Type"));if(r)for(i in a)if(a[i]&&a[i].test(r)){u.unshift(i);break}if(u[0]in n)o=u[0];else{for(i in n){if(!u[0]||t.converters[i+" "+u[0]]){o=i;break}s||(s=i)}o=o||s}return o?(o!==u[0]&&u.unshift(o),n[o]):void 0}function $(t,e,n,r){var i,o,s,a,u,l={},c=t.dataTypes.slice();if(c[1])for(s in t.converters)l[s.toLowerCase()]=t.converters[s];for(o=c.shift();o;)if(t.responseFields[o]&&(n[t.responseFields[o]]=e),!u&&r&&t.dataFilter&&(e=t.dataFilter(e,t.dataType)),u=o,o=c.shift())if("*"===o)o=u;else if("*"!==u&&u!==o){if(s=l[u+" "+o]||l["* "+o],!s)for(i in l)if(a=i.split(" "),a[1]===o&&(s=l[u+" "+a[0]]||l["* "+a[0]])){s===!0?s=l[i]:l[i]!==!0&&(o=a[0],c.unshift(a[1]));break}if(s!==!0)if(s&&t["throws"])e=s(e);else try{e=s(e)}catch(h){return{state:"parsererror",error:s?h:"No conversion from "+u+" to "+o}}}return{state:"success",data:e}}function F(t,e,n,r){var i;if(Z.isArray(e))Z.each(e,function(e,i){n||Te.test(t)?r(t,i):F(t+"["+("object"==typeof i?e:"")+"]",i,n,r)});else if(n||"object"!==Z.type(e))r(t,e);else for(i in e)F(t+"["+i+"]",e[i],n,r)}function z(t){return Z.isWindow(t)?t:9===t.nodeType&&t.defaultView}var U=[],H=U.slice,B=U.concat,V=U.push,W=U.indexOf,J={},G=J.toString,X=J.hasOwnProperty,Q={},Y=t.document,K="2.1.4",Z=function(t,e){return new Z.fn.init(t,e)},tt=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,et=/^-ms-/,nt=/-([\da-z])/gi,rt=function(t,e){return e.toUpperCase()};Z.fn=Z.prototype={jquery:K,constructor:Z,selector:"",length:0,toArray:function(){return H.call(this)},get:function(t){return null!=t?0>t?this[t+this.length]:this[t]:H.call(this)},pushStack:function(t){var e=Z.merge(this.constructor(),t);return e.prevObject=this,e.context=this.context,e},each:function(t,e){return Z.each(this,t,e)},map:function(t){return this.pushStack(Z.map(this,function(e,n){return t.call(e,n,e)}))},slice:function(){return this.pushStack(H.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(t){var e=this.length,n=+t+(0>t?e:0);return this.pushStack(n>=0&&e>n?[this[n]]:[])},end:function(){return this.prevObject||this.constructor(null)},push:V,sort:U.sort,splice:U.splice},Z.extend=Z.fn.extend=function(){var t,e,n,r,i,o,s=arguments[0]||{},a=1,u=arguments.length,l=!1;for("boolean"==typeof s&&(l=s,s=arguments[a]||{},a++),"object"==typeof s||Z.isFunction(s)||(s={}),a===u&&(s=this,a--);u>a;a++)if(null!=(t=arguments[a]))for(e in t)n=s[e],r=t[e],s!==r&&(l&&r&&(Z.isPlainObject(r)||(i=Z.isArray(r)))?(i?(i=!1,o=n&&Z.isArray(n)?n:[]):o=n&&Z.isPlainObject(n)?n:{},s[e]=Z.extend(l,o,r)):void 0!==r&&(s[e]=r));return s},Z.extend({expando:"jQuery"+(K+Math.random()).replace(/\D/g,""),isReady:!0,error:function(t){throw new Error(t)},noop:function(){},isFunction:function(t){return"function"===Z.type(t)},isArray:Array.isArray,isWindow:function(t){return null!=t&&t===t.window},isNumeric:function(t){return!Z.isArray(t)&&t-parseFloat(t)+1>=0},isPlainObject:function(t){return"object"!==Z.type(t)||t.nodeType||Z.isWindow(t)?!1:t.constructor&&!X.call(t.constructor.prototype,"isPrototypeOf")?!1:!0},isEmptyObject:function(t){var e;for(e in t)return!1;return!0},type:function(t){return null==t?t+"":"object"==typeof t||"function"==typeof t?J[G.call(t)]||"object":typeof t},globalEval:function(t){var e,n=eval;t=Z.trim(t),t&&(1===t.indexOf("use strict")?(e=Y.createElement("script"),e.text=t,Y.head.appendChild(e).parentNode.removeChild(e)):n(t))},camelCase:function(t){return t.replace(et,"ms-").replace(nt,rt)},nodeName:function(t,e){return t.nodeName&&t.nodeName.toLowerCase()===e.toLowerCase()},each:function(t,e,r){var i,o=0,s=t.length,a=n(t);if(r){if(a)for(;s>o&&(i=e.apply(t[o],r),i!==!1);o++);else for(o in t)if(i=e.apply(t[o],r),i===!1)break}else if(a)for(;s>o&&(i=e.call(t[o],o,t[o]),i!==!1);o++);else for(o in t)if(i=e.call(t[o],o,t[o]),i===!1)break;return t},trim:function(t){return null==t?"":(t+"").replace(tt,"")},makeArray:function(t,e){var r=e||[];return null!=t&&(n(Object(t))?Z.merge(r,"string"==typeof t?[t]:t):V.call(r,t)),r},inArray:function(t,e,n){return null==e?-1:W.call(e,t,n)},merge:function(t,e){for(var n=+e.length,r=0,i=t.length;n>r;r++)t[i++]=e[r];return t.length=i,t},grep:function(t,e,n){for(var r,i=[],o=0,s=t.length,a=!n;s>o;o++)r=!e(t[o],o),r!==a&&i.push(t[o]);return i},map:function(t,e,r){var i,o=0,s=t.length,a=n(t),u=[];if(a)for(;s>o;o++)i=e(t[o],o,r),null!=i&&u.push(i);else for(o in t)i=e(t[o],o,r),null!=i&&u.push(i);return B.apply([],u)},guid:1,proxy:function(t,e){var n,r,i;return"string"==typeof e&&(n=t[e],e=t,t=n),Z.isFunction(t)?(r=H.call(arguments,2),i=function(){return t.apply(e||this,r.concat(H.call(arguments)))},i.guid=t.guid=t.guid||Z.guid++,i):void 0},now:Date.now,support:Q}),Z.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(t,e){J["[object "+e+"]"]=e.toLowerCase()});var it=function(t){function e(t,e,n,r){var i,o,s,a,u,l,h,f,d,m;if((e?e.ownerDocument||e:F)!==A&&O(e),e=e||A,n=n||[],a=e.nodeType,"string"!=typeof t||!t||1!==a&&9!==a&&11!==a)return n;if(!r&&I){if(11!==a&&(i=vt.exec(t)))if(s=i[1]){if(9===a){if(o=e.getElementById(s),!o||!o.parentNode)return n;if(o.id===s)return n.push(o),n}else if(e.ownerDocument&&(o=e.ownerDocument.getElementById(s))&&j(e,o)&&o.id===s)return n.push(o),n}else{if(i[2])return K.apply(n,e.getElementsByTagName(t)),n;if((s=i[3])&&w.getElementsByClassName)return K.apply(n,e.getElementsByClassName(s)),n}if(w.qsa&&(!D||!D.test(t))){if(f=h=$,d=e,m=1!==a&&t,1===a&&"object"!==e.nodeName.toLowerCase()){for(l=S(t),(h=e.getAttribute("id"))?f=h.replace(_t,"\\$&"):e.setAttribute("id",f),f="[id='"+f+"'] ",u=l.length;u--;)l[u]=f+p(l[u]);d=bt.test(t)&&c(e.parentNode)||e,m=l.join(",")}if(m)try{return K.apply(n,d.querySelectorAll(m)),n}catch(g){}finally{h||e.removeAttribute("id")}}}return N(t.replace(ut,"$1"),e,n,r)}function n(){function t(n,r){return e.push(n+" ")>x.cacheLength&&delete t[e.shift()],t[n+" "]=r}var e=[];return t}function r(t){return t[$]=!0,t}function i(t){var e=A.createElement("div");try{return!!t(e)}catch(n){return!1}finally{e.parentNode&&e.parentNode.removeChild(e),e=null}}function o(t,e){for(var n=t.split("|"),r=t.length;r--;)x.attrHandle[n[r]]=e}function s(t,e){var n=e&&t,r=n&&1===t.nodeType&&1===e.nodeType&&(~e.sourceIndex||J)-(~t.sourceIndex||J);if(r)return r;if(n)for(;n=n.nextSibling;)if(n===e)return-1;return t?1:-1}function a(t){return function(e){var n=e.nodeName.toLowerCase();return"input"===n&&e.type===t}}function u(t){return function(e){var n=e.nodeName.toLowerCase();return("input"===n||"button"===n)&&e.type===t}}function l(t){return r(function(e){return e=+e,r(function(n,r){for(var i,o=t([],n.length,e),s=o.length;s--;)n[i=o[s]]&&(n[i]=!(r[i]=n[i]))})})}function c(t){return t&&"undefined"!=typeof t.getElementsByTagName&&t}function h(){}function p(t){for(var e=0,n=t.length,r="";n>e;e++)r+=t[e].value;return r}function f(t,e,n){var r=e.dir,i=n&&"parentNode"===r,o=U++;return e.first?function(e,n,o){for(;e=e[r];)if(1===e.nodeType||i)return t(e,n,o)}:function(e,n,s){var a,u,l=[z,o];if(s){for(;e=e[r];)if((1===e.nodeType||i)&&t(e,n,s))return!0}else for(;e=e[r];)if(1===e.nodeType||i){if(u=e[$]||(e[$]={}),(a=u[r])&&a[0]===z&&a[1]===o)return l[2]=a[2];if(u[r]=l,l[2]=t(e,n,s))return!0}}}function d(t){return t.length>1?function(e,n,r){for(var i=t.length;i--;)if(!t[i](e,n,r))return!1;return!0}:t[0]}function m(t,n,r){for(var i=0,o=n.length;o>i;i++)e(t,n[i],r);return r}function g(t,e,n,r,i){for(var o,s=[],a=0,u=t.length,l=null!=e;u>a;a++)(o=t[a])&&(!n||n(o,r,i))&&(s.push(o),l&&e.push(a));return s}function y(t,e,n,i,o,s){return i&&!i[$]&&(i=y(i)),o&&!o[$]&&(o=y(o,s)),r(function(r,s,a,u){var l,c,h,p=[],f=[],d=s.length,y=r||m(e||"*",a.nodeType?[a]:a,[]),v=!t||!r&&e?y:g(y,p,t,a,u),b=n?o||(r?t:d||i)?[]:s:v;if(n&&n(v,b,a,u),i)for(l=g(b,f),i(l,[],a,u),c=l.length;c--;)(h=l[c])&&(b[f[c]]=!(v[f[c]]=h));if(r){if(o||t){if(o){for(l=[],c=b.length;c--;)(h=b[c])&&l.push(v[c]=h);o(null,b=[],l,u)}for(c=b.length;c--;)(h=b[c])&&(l=o?tt(r,h):p[c])>-1&&(r[l]=!(s[l]=h))}}else b=g(b===s?b.splice(d,b.length):b),o?o(null,s,b,u):K.apply(s,b)})}function v(t){for(var e,n,r,i=t.length,o=x.relative[t[0].type],s=o||x.relative[" "],a=o?1:0,u=f(function(t){return t===e},s,!0),l=f(function(t){return tt(e,t)>-1},s,!0),c=[function(t,n,r){var i=!o&&(r||n!==k)||((e=n).nodeType?u(t,n,r):l(t,n,r));return e=null,i}];i>a;a++)if(n=x.relative[t[a].type])c=[f(d(c),n)];else{if(n=x.filter[t[a].type].apply(null,t[a].matches),n[$]){for(r=++a;i>r&&!x.relative[t[r].type];r++);return y(a>1&&d(c),a>1&&p(t.slice(0,a-1).concat({value:" "===t[a-2].type?"*":""})).replace(ut,"$1"),n,r>a&&v(t.slice(a,r)),i>r&&v(t=t.slice(r)),i>r&&p(t))}c.push(n)}return d(c)}function b(t,n){var i=n.length>0,o=t.length>0,s=function(r,s,a,u,l){var c,h,p,f=0,d="0",m=r&&[],y=[],v=k,b=r||o&&x.find.TAG("*",l),_=z+=null==v?1:Math.random()||.1,w=b.length;

for(l&&(k=s!==A&&s);d!==w&&null!=(c=b[d]);d++){if(o&&c){for(h=0;p=t[h++];)if(p(c,s,a)){u.push(c);break}l&&(z=_)}i&&((c=!p&&c)&&f--,r&&m.push(c))}if(f+=d,i&&d!==f){for(h=0;p=n[h++];)p(m,y,s,a);if(r){if(f>0)for(;d--;)m[d]||y[d]||(y[d]=Q.call(u));y=g(y)}K.apply(u,y),l&&!r&&y.length>0&&f+n.length>1&&e.uniqueSort(u)}return l&&(z=_,k=v),m};return i?r(s):s}var _,w,x,C,T,S,E,N,k,M,P,O,A,R,I,D,L,q,j,$="sizzle"+1*new Date,F=t.document,z=0,U=0,H=n(),B=n(),V=n(),W=function(t,e){return t===e&&(P=!0),0},J=1<<31,G={}.hasOwnProperty,X=[],Q=X.pop,Y=X.push,K=X.push,Z=X.slice,tt=function(t,e){for(var n=0,r=t.length;r>n;n++)if(t[n]===e)return n;return-1},et="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",nt="[\\x20\\t\\r\\n\\f]",rt="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",it=rt.replace("w","w#"),ot="\\["+nt+"*("+rt+")(?:"+nt+"*([*^$|!~]?=)"+nt+"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|("+it+"))|)"+nt+"*\\]",st=":("+rt+")(?:\\((('((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\")|((?:\\\\.|[^\\\\()[\\]]|"+ot+")*)|.*)\\)|)",at=new RegExp(nt+"+","g"),ut=new RegExp("^"+nt+"+|((?:^|[^\\\\])(?:\\\\.)*)"+nt+"+$","g"),lt=new RegExp("^"+nt+"*,"+nt+"*"),ct=new RegExp("^"+nt+"*([>+~]|"+nt+")"+nt+"*"),ht=new RegExp("="+nt+"*([^\\]'\"]*?)"+nt+"*\\]","g"),pt=new RegExp(st),ft=new RegExp("^"+it+"$"),dt={ID:new RegExp("^#("+rt+")"),CLASS:new RegExp("^\\.("+rt+")"),TAG:new RegExp("^("+rt.replace("w","w*")+")"),ATTR:new RegExp("^"+ot),PSEUDO:new RegExp("^"+st),CHILD:new RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+nt+"*(even|odd|(([+-]|)(\\d*)n|)"+nt+"*(?:([+-]|)"+nt+"*(\\d+)|))"+nt+"*\\)|)","i"),bool:new RegExp("^(?:"+et+")$","i"),needsContext:new RegExp("^"+nt+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+nt+"*((?:-\\d)?\\d*)"+nt+"*\\)|)(?=[^-]|$)","i")},mt=/^(?:input|select|textarea|button)$/i,gt=/^h\d$/i,yt=/^[^{]+\{\s*\[native \w/,vt=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,bt=/[+~]/,_t=/'|\\/g,wt=new RegExp("\\\\([\\da-f]{1,6}"+nt+"?|("+nt+")|.)","ig"),xt=function(t,e,n){var r="0x"+e-65536;return r!==r||n?e:0>r?String.fromCharCode(r+65536):String.fromCharCode(r>>10|55296,1023&r|56320)},Ct=function(){O()};try{K.apply(X=Z.call(F.childNodes),F.childNodes),X[F.childNodes.length].nodeType}catch(Tt){K={apply:X.length?function(t,e){Y.apply(t,Z.call(e))}:function(t,e){for(var n=t.length,r=0;t[n++]=e[r++];);t.length=n-1}}}w=e.support={},T=e.isXML=function(t){var e=t&&(t.ownerDocument||t).documentElement;return e?"HTML"!==e.nodeName:!1},O=e.setDocument=function(t){var e,n,r=t?t.ownerDocument||t:F;return r!==A&&9===r.nodeType&&r.documentElement?(A=r,R=r.documentElement,n=r.defaultView,n&&n!==n.top&&(n.addEventListener?n.addEventListener("unload",Ct,!1):n.attachEvent&&n.attachEvent("onunload",Ct)),I=!T(r),w.attributes=i(function(t){return t.className="i",!t.getAttribute("className")}),w.getElementsByTagName=i(function(t){return t.appendChild(r.createComment("")),!t.getElementsByTagName("*").length}),w.getElementsByClassName=yt.test(r.getElementsByClassName),w.getById=i(function(t){return R.appendChild(t).id=$,!r.getElementsByName||!r.getElementsByName($).length}),w.getById?(x.find.ID=function(t,e){if("undefined"!=typeof e.getElementById&&I){var n=e.getElementById(t);return n&&n.parentNode?[n]:[]}},x.filter.ID=function(t){var e=t.replace(wt,xt);return function(t){return t.getAttribute("id")===e}}):(delete x.find.ID,x.filter.ID=function(t){var e=t.replace(wt,xt);return function(t){var n="undefined"!=typeof t.getAttributeNode&&t.getAttributeNode("id");return n&&n.value===e}}),x.find.TAG=w.getElementsByTagName?function(t,e){return"undefined"!=typeof e.getElementsByTagName?e.getElementsByTagName(t):w.qsa?e.querySelectorAll(t):void 0}:function(t,e){var n,r=[],i=0,o=e.getElementsByTagName(t);if("*"===t){for(;n=o[i++];)1===n.nodeType&&r.push(n);return r}return o},x.find.CLASS=w.getElementsByClassName&&function(t,e){return I?e.getElementsByClassName(t):void 0},L=[],D=[],(w.qsa=yt.test(r.querySelectorAll))&&(i(function(t){R.appendChild(t).innerHTML="<a id='"+$+"'></a><select id='"+$+"-\f]' msallowcapture=''><option selected=''></option></select>",t.querySelectorAll("[msallowcapture^='']").length&&D.push("[*^$]="+nt+"*(?:''|\"\")"),t.querySelectorAll("[selected]").length||D.push("\\["+nt+"*(?:value|"+et+")"),t.querySelectorAll("[id~="+$+"-]").length||D.push("~="),t.querySelectorAll(":checked").length||D.push(":checked"),t.querySelectorAll("a#"+$+"+*").length||D.push(".#.+[+~]")}),i(function(t){var e=r.createElement("input");e.setAttribute("type","hidden"),t.appendChild(e).setAttribute("name","D"),t.querySelectorAll("[name=d]").length&&D.push("name"+nt+"*[*^$|!~]?="),t.querySelectorAll(":enabled").length||D.push(":enabled",":disabled"),t.querySelectorAll("*,:x"),D.push(",.*:")})),(w.matchesSelector=yt.test(q=R.matches||R.webkitMatchesSelector||R.mozMatchesSelector||R.oMatchesSelector||R.msMatchesSelector))&&i(function(t){w.disconnectedMatch=q.call(t,"div"),q.call(t,"[s!='']:x"),L.push("!=",st)}),D=D.length&&new RegExp(D.join("|")),L=L.length&&new RegExp(L.join("|")),e=yt.test(R.compareDocumentPosition),j=e||yt.test(R.contains)?function(t,e){var n=9===t.nodeType?t.documentElement:t,r=e&&e.parentNode;return t===r||!(!r||1!==r.nodeType||!(n.contains?n.contains(r):t.compareDocumentPosition&&16&t.compareDocumentPosition(r)))}:function(t,e){if(e)for(;e=e.parentNode;)if(e===t)return!0;return!1},W=e?function(t,e){if(t===e)return P=!0,0;var n=!t.compareDocumentPosition-!e.compareDocumentPosition;return n?n:(n=(t.ownerDocument||t)===(e.ownerDocument||e)?t.compareDocumentPosition(e):1,1&n||!w.sortDetached&&e.compareDocumentPosition(t)===n?t===r||t.ownerDocument===F&&j(F,t)?-1:e===r||e.ownerDocument===F&&j(F,e)?1:M?tt(M,t)-tt(M,e):0:4&n?-1:1)}:function(t,e){if(t===e)return P=!0,0;var n,i=0,o=t.parentNode,a=e.parentNode,u=[t],l=[e];if(!o||!a)return t===r?-1:e===r?1:o?-1:a?1:M?tt(M,t)-tt(M,e):0;if(o===a)return s(t,e);for(n=t;n=n.parentNode;)u.unshift(n);for(n=e;n=n.parentNode;)l.unshift(n);for(;u[i]===l[i];)i++;return i?s(u[i],l[i]):u[i]===F?-1:l[i]===F?1:0},r):A},e.matches=function(t,n){return e(t,null,null,n)},e.matchesSelector=function(t,n){if((t.ownerDocument||t)!==A&&O(t),n=n.replace(ht,"='$1']"),!(!w.matchesSelector||!I||L&&L.test(n)||D&&D.test(n)))try{var r=q.call(t,n);if(r||w.disconnectedMatch||t.document&&11!==t.document.nodeType)return r}catch(i){}return e(n,A,null,[t]).length>0},e.contains=function(t,e){return(t.ownerDocument||t)!==A&&O(t),j(t,e)},e.attr=function(t,e){(t.ownerDocument||t)!==A&&O(t);var n=x.attrHandle[e.toLowerCase()],r=n&&G.call(x.attrHandle,e.toLowerCase())?n(t,e,!I):void 0;return void 0!==r?r:w.attributes||!I?t.getAttribute(e):(r=t.getAttributeNode(e))&&r.specified?r.value:null},e.error=function(t){throw new Error("Syntax error, unrecognized expression: "+t)},e.uniqueSort=function(t){var e,n=[],r=0,i=0;if(P=!w.detectDuplicates,M=!w.sortStable&&t.slice(0),t.sort(W),P){for(;e=t[i++];)e===t[i]&&(r=n.push(i));for(;r--;)t.splice(n[r],1)}return M=null,t},C=e.getText=function(t){var e,n="",r=0,i=t.nodeType;if(i){if(1===i||9===i||11===i){if("string"==typeof t.textContent)return t.textContent;for(t=t.firstChild;t;t=t.nextSibling)n+=C(t)}else if(3===i||4===i)return t.nodeValue}else for(;e=t[r++];)n+=C(e);return n},x=e.selectors={cacheLength:50,createPseudo:r,match:dt,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(t){return t[1]=t[1].replace(wt,xt),t[3]=(t[3]||t[4]||t[5]||"").replace(wt,xt),"~="===t[2]&&(t[3]=" "+t[3]+" "),t.slice(0,4)},CHILD:function(t){return t[1]=t[1].toLowerCase(),"nth"===t[1].slice(0,3)?(t[3]||e.error(t[0]),t[4]=+(t[4]?t[5]+(t[6]||1):2*("even"===t[3]||"odd"===t[3])),t[5]=+(t[7]+t[8]||"odd"===t[3])):t[3]&&e.error(t[0]),t},PSEUDO:function(t){var e,n=!t[6]&&t[2];return dt.CHILD.test(t[0])?null:(t[3]?t[2]=t[4]||t[5]||"":n&&pt.test(n)&&(e=S(n,!0))&&(e=n.indexOf(")",n.length-e)-n.length)&&(t[0]=t[0].slice(0,e),t[2]=n.slice(0,e)),t.slice(0,3))}},filter:{TAG:function(t){var e=t.replace(wt,xt).toLowerCase();return"*"===t?function(){return!0}:function(t){return t.nodeName&&t.nodeName.toLowerCase()===e}},CLASS:function(t){var e=H[t+" "];return e||(e=new RegExp("(^|"+nt+")"+t+"("+nt+"|$)"))&&H(t,function(t){return e.test("string"==typeof t.className&&t.className||"undefined"!=typeof t.getAttribute&&t.getAttribute("class")||"")})},ATTR:function(t,n,r){return function(i){var o=e.attr(i,t);return null==o?"!="===n:n?(o+="","="===n?o===r:"!="===n?o!==r:"^="===n?r&&0===o.indexOf(r):"*="===n?r&&o.indexOf(r)>-1:"$="===n?r&&o.slice(-r.length)===r:"~="===n?(" "+o.replace(at," ")+" ").indexOf(r)>-1:"|="===n?o===r||o.slice(0,r.length+1)===r+"-":!1):!0}},CHILD:function(t,e,n,r,i){var o="nth"!==t.slice(0,3),s="last"!==t.slice(-4),a="of-type"===e;return 1===r&&0===i?function(t){return!!t.parentNode}:function(e,n,u){var l,c,h,p,f,d,m=o!==s?"nextSibling":"previousSibling",g=e.parentNode,y=a&&e.nodeName.toLowerCase(),v=!u&&!a;if(g){if(o){for(;m;){for(h=e;h=h[m];)if(a?h.nodeName.toLowerCase()===y:1===h.nodeType)return!1;d=m="only"===t&&!d&&"nextSibling"}return!0}if(d=[s?g.firstChild:g.lastChild],s&&v){for(c=g[$]||(g[$]={}),l=c[t]||[],f=l[0]===z&&l[1],p=l[0]===z&&l[2],h=f&&g.childNodes[f];h=++f&&h&&h[m]||(p=f=0)||d.pop();)if(1===h.nodeType&&++p&&h===e){c[t]=[z,f,p];break}}else if(v&&(l=(e[$]||(e[$]={}))[t])&&l[0]===z)p=l[1];else for(;(h=++f&&h&&h[m]||(p=f=0)||d.pop())&&((a?h.nodeName.toLowerCase()!==y:1!==h.nodeType)||!++p||(v&&((h[$]||(h[$]={}))[t]=[z,p]),h!==e)););return p-=i,p===r||p%r===0&&p/r>=0}}},PSEUDO:function(t,n){var i,o=x.pseudos[t]||x.setFilters[t.toLowerCase()]||e.error("unsupported pseudo: "+t);return o[$]?o(n):o.length>1?(i=[t,t,"",n],x.setFilters.hasOwnProperty(t.toLowerCase())?r(function(t,e){for(var r,i=o(t,n),s=i.length;s--;)r=tt(t,i[s]),t[r]=!(e[r]=i[s])}):function(t){return o(t,0,i)}):o}},pseudos:{not:r(function(t){var e=[],n=[],i=E(t.replace(ut,"$1"));return i[$]?r(function(t,e,n,r){for(var o,s=i(t,null,r,[]),a=t.length;a--;)(o=s[a])&&(t[a]=!(e[a]=o))}):function(t,r,o){return e[0]=t,i(e,null,o,n),e[0]=null,!n.pop()}}),has:r(function(t){return function(n){return e(t,n).length>0}}),contains:r(function(t){return t=t.replace(wt,xt),function(e){return(e.textContent||e.innerText||C(e)).indexOf(t)>-1}}),lang:r(function(t){return ft.test(t||"")||e.error("unsupported lang: "+t),t=t.replace(wt,xt).toLowerCase(),function(e){var n;do if(n=I?e.lang:e.getAttribute("xml:lang")||e.getAttribute("lang"))return n=n.toLowerCase(),n===t||0===n.indexOf(t+"-");while((e=e.parentNode)&&1===e.nodeType);return!1}}),target:function(e){var n=t.location&&t.location.hash;return n&&n.slice(1)===e.id},root:function(t){return t===R},focus:function(t){return t===A.activeElement&&(!A.hasFocus||A.hasFocus())&&!!(t.type||t.href||~t.tabIndex)},enabled:function(t){return t.disabled===!1},disabled:function(t){return t.disabled===!0},checked:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&!!t.checked||"option"===e&&!!t.selected},selected:function(t){return t.parentNode&&t.parentNode.selectedIndex,t.selected===!0},empty:function(t){for(t=t.firstChild;t;t=t.nextSibling)if(t.nodeType<6)return!1;return!0},parent:function(t){return!x.pseudos.empty(t)},header:function(t){return gt.test(t.nodeName)},input:function(t){return mt.test(t.nodeName)},button:function(t){var e=t.nodeName.toLowerCase();return"input"===e&&"button"===t.type||"button"===e},text:function(t){var e;return"input"===t.nodeName.toLowerCase()&&"text"===t.type&&(null==(e=t.getAttribute("type"))||"text"===e.toLowerCase())},first:l(function(){return[0]}),last:l(function(t,e){return[e-1]}),eq:l(function(t,e,n){return[0>n?n+e:n]}),even:l(function(t,e){for(var n=0;e>n;n+=2)t.push(n);return t}),odd:l(function(t,e){for(var n=1;e>n;n+=2)t.push(n);return t}),lt:l(function(t,e,n){for(var r=0>n?n+e:n;--r>=0;)t.push(r);return t}),gt:l(function(t,e,n){for(var r=0>n?n+e:n;++r<e;)t.push(r);return t})}},x.pseudos.nth=x.pseudos.eq;for(_ in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})x.pseudos[_]=a(_);for(_ in{submit:!0,reset:!0})x.pseudos[_]=u(_);return h.prototype=x.filters=x.pseudos,x.setFilters=new h,S=e.tokenize=function(t,n){var r,i,o,s,a,u,l,c=B[t+" "];if(c)return n?0:c.slice(0);for(a=t,u=[],l=x.preFilter;a;){(!r||(i=lt.exec(a)))&&(i&&(a=a.slice(i[0].length)||a),u.push(o=[])),r=!1,(i=ct.exec(a))&&(r=i.shift(),o.push({value:r,type:i[0].replace(ut," ")}),a=a.slice(r.length));for(s in x.filter)!(i=dt[s].exec(a))||l[s]&&!(i=l[s](i))||(r=i.shift(),o.push({value:r,type:s,matches:i}),a=a.slice(r.length));if(!r)break}return n?a.length:a?e.error(t):B(t,u).slice(0)},E=e.compile=function(t,e){var n,r=[],i=[],o=V[t+" "];if(!o){for(e||(e=S(t)),n=e.length;n--;)o=v(e[n]),o[$]?r.push(o):i.push(o);o=V(t,b(i,r)),o.selector=t}return o},N=e.select=function(t,e,n,r){var i,o,s,a,u,l="function"==typeof t&&t,h=!r&&S(t=l.selector||t);if(n=n||[],1===h.length){if(o=h[0]=h[0].slice(0),o.length>2&&"ID"===(s=o[0]).type&&w.getById&&9===e.nodeType&&I&&x.relative[o[1].type]){if(e=(x.find.ID(s.matches[0].replace(wt,xt),e)||[])[0],!e)return n;l&&(e=e.parentNode),t=t.slice(o.shift().value.length)}for(i=dt.needsContext.test(t)?0:o.length;i--&&(s=o[i],!x.relative[a=s.type]);)if((u=x.find[a])&&(r=u(s.matches[0].replace(wt,xt),bt.test(o[0].type)&&c(e.parentNode)||e))){if(o.splice(i,1),t=r.length&&p(o),!t)return K.apply(n,r),n;break}}return(l||E(t,h))(r,e,!I,n,bt.test(t)&&c(e.parentNode)||e),n},w.sortStable=$.split("").sort(W).join("")===$,w.detectDuplicates=!!P,O(),w.sortDetached=i(function(t){return 1&t.compareDocumentPosition(A.createElement("div"))}),i(function(t){return t.innerHTML="<a href='#'></a>","#"===t.firstChild.getAttribute("href")})||o("type|href|height|width",function(t,e,n){return n?void 0:t.getAttribute(e,"type"===e.toLowerCase()?1:2)}),w.attributes&&i(function(t){return t.innerHTML="<input/>",t.firstChild.setAttribute("value",""),""===t.firstChild.getAttribute("value")})||o("value",function(t,e,n){return n||"input"!==t.nodeName.toLowerCase()?void 0:t.defaultValue}),i(function(t){return null==t.getAttribute("disabled")})||o(et,function(t,e,n){var r;return n?void 0:t[e]===!0?e.toLowerCase():(r=t.getAttributeNode(e))&&r.specified?r.value:null}),e}(t);Z.find=it,Z.expr=it.selectors,Z.expr[":"]=Z.expr.pseudos,Z.unique=it.uniqueSort,Z.text=it.getText,Z.isXMLDoc=it.isXML,Z.contains=it.contains;var ot=Z.expr.match.needsContext,st=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,at=/^.[^:#\[\.,]*$/;Z.filter=function(t,e,n){var r=e[0];return n&&(t=":not("+t+")"),1===e.length&&1===r.nodeType?Z.find.matchesSelector(r,t)?[r]:[]:Z.find.matches(t,Z.grep(e,function(t){return 1===t.nodeType}))},Z.fn.extend({find:function(t){var e,n=this.length,r=[],i=this;if("string"!=typeof t)return this.pushStack(Z(t).filter(function(){for(e=0;n>e;e++)if(Z.contains(i[e],this))return!0}));for(e=0;n>e;e++)Z.find(t,i[e],r);return r=this.pushStack(n>1?Z.unique(r):r),r.selector=this.selector?this.selector+" "+t:t,r},filter:function(t){return this.pushStack(r(this,t||[],!1))},not:function(t){return this.pushStack(r(this,t||[],!0))},is:function(t){return!!r(this,"string"==typeof t&&ot.test(t)?Z(t):t||[],!1).length}});var ut,lt=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,ct=Z.fn.init=function(t,e){var n,r;if(!t)return this;if("string"==typeof t){if(n="<"===t[0]&&">"===t[t.length-1]&&t.length>=3?[null,t,null]:lt.exec(t),!n||!n[1]&&e)return!e||e.jquery?(e||ut).find(t):this.constructor(e).find(t);if(n[1]){if(e=e instanceof Z?e[0]:e,Z.merge(this,Z.parseHTML(n[1],e&&e.nodeType?e.ownerDocument||e:Y,!0)),st.test(n[1])&&Z.isPlainObject(e))for(n in e)Z.isFunction(this[n])?this[n](e[n]):this.attr(n,e[n]);return this}return r=Y.getElementById(n[2]),r&&r.parentNode&&(this.length=1,this[0]=r),this.context=Y,this.selector=t,this}return t.nodeType?(this.context=this[0]=t,this.length=1,this):Z.isFunction(t)?"undefined"!=typeof ut.ready?ut.ready(t):t(Z):(void 0!==t.selector&&(this.selector=t.selector,this.context=t.context),Z.makeArray(t,this))};ct.prototype=Z.fn,ut=Z(Y);var ht=/^(?:parents|prev(?:Until|All))/,pt={children:!0,contents:!0,next:!0,prev:!0};Z.extend({dir:function(t,e,n){for(var r=[],i=void 0!==n;(t=t[e])&&9!==t.nodeType;)if(1===t.nodeType){if(i&&Z(t).is(n))break;r.push(t)}return r},sibling:function(t,e){for(var n=[];t;t=t.nextSibling)1===t.nodeType&&t!==e&&n.push(t);return n}}),Z.fn.extend({has:function(t){var e=Z(t,this),n=e.length;return this.filter(function(){for(var t=0;n>t;t++)if(Z.contains(this,e[t]))return!0})},closest:function(t,e){for(var n,r=0,i=this.length,o=[],s=ot.test(t)||"string"!=typeof t?Z(t,e||this.context):0;i>r;r++)for(n=this[r];n&&n!==e;n=n.parentNode)if(n.nodeType<11&&(s?s.index(n)>-1:1===n.nodeType&&Z.find.matchesSelector(n,t))){o.push(n);break}return this.pushStack(o.length>1?Z.unique(o):o)},index:function(t){return t?"string"==typeof t?W.call(Z(t),this[0]):W.call(this,t.jquery?t[0]:t):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(t,e){return this.pushStack(Z.unique(Z.merge(this.get(),Z(t,e))))},addBack:function(t){return this.add(null==t?this.prevObject:this.prevObject.filter(t))}}),Z.each({parent:function(t){var e=t.parentNode;return e&&11!==e.nodeType?e:null},parents:function(t){return Z.dir(t,"parentNode")},parentsUntil:function(t,e,n){return Z.dir(t,"parentNode",n)},next:function(t){return i(t,"nextSibling")},prev:function(t){return i(t,"previousSibling")},nextAll:function(t){return Z.dir(t,"nextSibling")},prevAll:function(t){return Z.dir(t,"previousSibling")},nextUntil:function(t,e,n){return Z.dir(t,"nextSibling",n)},prevUntil:function(t,e,n){return Z.dir(t,"previousSibling",n)},siblings:function(t){return Z.sibling((t.parentNode||{}).firstChild,t)},children:function(t){return Z.sibling(t.firstChild)},contents:function(t){return t.contentDocument||Z.merge([],t.childNodes)}},function(t,e){Z.fn[t]=function(n,r){var i=Z.map(this,e,n);return"Until"!==t.slice(-5)&&(r=n),r&&"string"==typeof r&&(i=Z.filter(r,i)),this.length>1&&(pt[t]||Z.unique(i),ht.test(t)&&i.reverse()),this.pushStack(i)}});var ft=/\S+/g,dt={};Z.Callbacks=function(t){t="string"==typeof t?dt[t]||o(t):Z.extend({},t);var e,n,r,i,s,a,u=[],l=!t.once&&[],c=function(o){for(e=t.memory&&o,n=!0,a=i||0,i=0,s=u.length,r=!0;u&&s>a;a++)if(u[a].apply(o[0],o[1])===!1&&t.stopOnFalse){e=!1;break}r=!1,u&&(l?l.length&&c(l.shift()):e?u=[]:h.disable())},h={add:function(){if(u){var n=u.length;!function o(e){Z.each(e,function(e,n){var r=Z.type(n);"function"===r?t.unique&&h.has(n)||u.push(n):n&&n.length&&"string"!==r&&o(n)})}(arguments),r?s=u.length:e&&(i=n,c(e))}return this},remove:function(){return u&&Z.each(arguments,function(t,e){for(var n;(n=Z.inArray(e,u,n))>-1;)u.splice(n,1),r&&(s>=n&&s--,a>=n&&a--)}),this},has:function(t){return t?Z.inArray(t,u)>-1:!(!u||!u.length)},empty:function(){return u=[],s=0,this},disable:function(){return u=l=e=void 0,this},disabled:function(){return!u},lock:function(){return l=void 0,e||h.disable(),this},locked:function(){return!l},fireWith:function(t,e){return!u||n&&!l||(e=e||[],e=[t,e.slice?e.slice():e],r?l.push(e):c(e)),this},fire:function(){return h.fireWith(this,arguments),this},fired:function(){return!!n}};return h},Z.extend({Deferred:function(t){var e=[["resolve","done",Z.Callbacks("once memory"),"resolved"],["reject","fail",Z.Callbacks("once memory"),"rejected"],["notify","progress",Z.Callbacks("memory")]],n="pending",r={state:function(){return n},always:function(){return i.done(arguments).fail(arguments),this},then:function(){var t=arguments;return Z.Deferred(function(n){Z.each(e,function(e,o){var s=Z.isFunction(t[e])&&t[e];i[o[1]](function(){var t=s&&s.apply(this,arguments);t&&Z.isFunction(t.promise)?t.promise().done(n.resolve).fail(n.reject).progress(n.notify):n[o[0]+"With"](this===r?n.promise():this,s?[t]:arguments)})}),t=null}).promise()},promise:function(t){return null!=t?Z.extend(t,r):r}},i={};return r.pipe=r.then,Z.each(e,function(t,o){var s=o[2],a=o[3];r[o[1]]=s.add,a&&s.add(function(){n=a},e[1^t][2].disable,e[2][2].lock),i[o[0]]=function(){return i[o[0]+"With"](this===i?r:this,arguments),this},i[o[0]+"With"]=s.fireWith}),r.promise(i),t&&t.call(i,i),i},when:function(t){var e,n,r,i=0,o=H.call(arguments),s=o.length,a=1!==s||t&&Z.isFunction(t.promise)?s:0,u=1===a?t:Z.Deferred(),l=function(t,n,r){return function(i){n[t]=this,r[t]=arguments.length>1?H.call(arguments):i,r===e?u.notifyWith(n,r):--a||u.resolveWith(n,r)}};if(s>1)for(e=new Array(s),n=new Array(s),r=new Array(s);s>i;i++)o[i]&&Z.isFunction(o[i].promise)?o[i].promise().done(l(i,r,o)).fail(u.reject).progress(l(i,n,e)):--a;return a||u.resolveWith(r,o),u.promise()}});var mt;Z.fn.ready=function(t){return Z.ready.promise().done(t),this},Z.extend({isReady:!1,readyWait:1,holdReady:function(t){t?Z.readyWait++:Z.ready(!0)},ready:function(t){(t===!0?--Z.readyWait:Z.isReady)||(Z.isReady=!0,t!==!0&&--Z.readyWait>0||(mt.resolveWith(Y,[Z]),Z.fn.triggerHandler&&(Z(Y).triggerHandler("ready"),Z(Y).off("ready"))))}}),Z.ready.promise=function(e){return mt||(mt=Z.Deferred(),"complete"===Y.readyState?setTimeout(Z.ready):(Y.addEventListener("DOMContentLoaded",s,!1),t.addEventListener("load",s,!1))),mt.promise(e)},Z.ready.promise();var gt=Z.access=function(t,e,n,r,i,o,s){var a=0,u=t.length,l=null==n;if("object"===Z.type(n)){i=!0;for(a in n)Z.access(t,e,a,n[a],!0,o,s)}else if(void 0!==r&&(i=!0,Z.isFunction(r)||(s=!0),l&&(s?(e.call(t,r),e=null):(l=e,e=function(t,e,n){return l.call(Z(t),n)})),e))for(;u>a;a++)e(t[a],n,s?r:r.call(t[a],a,e(t[a],n)));return i?t:l?e.call(t):u?e(t[0],n):o};Z.acceptData=function(t){return 1===t.nodeType||9===t.nodeType||!+t.nodeType},a.uid=1,a.accepts=Z.acceptData,a.prototype={key:function(t){if(!a.accepts(t))return 0;var e={},n=t[this.expando];if(!n){n=a.uid++;try{e[this.expando]={value:n},Object.defineProperties(t,e)}catch(r){e[this.expando]=n,Z.extend(t,e)}}return this.cache[n]||(this.cache[n]={}),n},set:function(t,e,n){var r,i=this.key(t),o=this.cache[i];if("string"==typeof e)o[e]=n;else if(Z.isEmptyObject(o))Z.extend(this.cache[i],e);else for(r in e)o[r]=e[r];return o},get:function(t,e){var n=this.cache[this.key(t)];return void 0===e?n:n[e]},access:function(t,e,n){var r;return void 0===e||e&&"string"==typeof e&&void 0===n?(r=this.get(t,e),void 0!==r?r:this.get(t,Z.camelCase(e))):(this.set(t,e,n),void 0!==n?n:e)},remove:function(t,e){var n,r,i,o=this.key(t),s=this.cache[o];if(void 0===e)this.cache[o]={};else{Z.isArray(e)?r=e.concat(e.map(Z.camelCase)):(i=Z.camelCase(e),e in s?r=[e,i]:(r=i,r=r in s?[r]:r.match(ft)||[])),n=r.length;for(;n--;)delete s[r[n]]}},hasData:function(t){return!Z.isEmptyObject(this.cache[t[this.expando]]||{})},discard:function(t){t[this.expando]&&delete this.cache[t[this.expando]]}};var yt=new a,vt=new a,bt=/^(?:\{[\w\W]*\}|\[[\w\W]*\])$/,_t=/([A-Z])/g;Z.extend({hasData:function(t){return vt.hasData(t)||yt.hasData(t)},data:function(t,e,n){return vt.access(t,e,n)},removeData:function(t,e){vt.remove(t,e)},_data:function(t,e,n){return yt.access(t,e,n)},_removeData:function(t,e){yt.remove(t,e)}}),Z.fn.extend({data:function(t,e){var n,r,i,o=this[0],s=o&&o.attributes;if(void 0===t){if(this.length&&(i=vt.get(o),1===o.nodeType&&!yt.get(o,"hasDataAttrs"))){for(n=s.length;n--;)s[n]&&(r=s[n].name,0===r.indexOf("data-")&&(r=Z.camelCase(r.slice(5)),u(o,r,i[r])));yt.set(o,"hasDataAttrs",!0)}return i}return"object"==typeof t?this.each(function(){vt.set(this,t)}):gt(this,function(e){var n,r=Z.camelCase(t);if(o&&void 0===e){if(n=vt.get(o,t),void 0!==n)return n;if(n=vt.get(o,r),void 0!==n)return n;if(n=u(o,r,void 0),void 0!==n)return n}else this.each(function(){var n=vt.get(this,r);vt.set(this,r,e),-1!==t.indexOf("-")&&void 0!==n&&vt.set(this,t,e)})},null,e,arguments.length>1,null,!0)},removeData:function(t){return this.each(function(){vt.remove(this,t)})}}),Z.extend({queue:function(t,e,n){var r;return t?(e=(e||"fx")+"queue",r=yt.get(t,e),n&&(!r||Z.isArray(n)?r=yt.access(t,e,Z.makeArray(n)):r.push(n)),r||[]):void 0},dequeue:function(t,e){e=e||"fx";var n=Z.queue(t,e),r=n.length,i=n.shift(),o=Z._queueHooks(t,e),s=function(){Z.dequeue(t,e)};"inprogress"===i&&(i=n.shift(),r--),i&&("fx"===e&&n.unshift("inprogress"),delete o.stop,i.call(t,s,o)),!r&&o&&o.empty.fire()},_queueHooks:function(t,e){var n=e+"queueHooks";return yt.get(t,n)||yt.access(t,n,{empty:Z.Callbacks("once memory").add(function(){yt.remove(t,[e+"queue",n])})})}}),Z.fn.extend({queue:function(t,e){var n=2;return"string"!=typeof t&&(e=t,t="fx",n--),arguments.length<n?Z.queue(this[0],t):void 0===e?this:this.each(function(){var n=Z.queue(this,t,e);Z._queueHooks(this,t),"fx"===t&&"inprogress"!==n[0]&&Z.dequeue(this,t)})},dequeue:function(t){return this.each(function(){Z.dequeue(this,t)})},clearQueue:function(t){return this.queue(t||"fx",[])},promise:function(t,e){var n,r=1,i=Z.Deferred(),o=this,s=this.length,a=function(){--r||i.resolveWith(o,[o])};for("string"!=typeof t&&(e=t,t=void 0),t=t||"fx";s--;)n=yt.get(o[s],t+"queueHooks"),n&&n.empty&&(r++,n.empty.add(a));return a(),i.promise(e)}});var wt=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,xt=["Top","Right","Bottom","Left"],Ct=function(t,e){return t=e||t,"none"===Z.css(t,"display")||!Z.contains(t.ownerDocument,t)},Tt=/^(?:checkbox|radio)$/i;!function(){var t=Y.createDocumentFragment(),e=t.appendChild(Y.createElement("div")),n=Y.createElement("input");n.setAttribute("type","radio"),n.setAttribute("checked","checked"),n.setAttribute("name","t"),e.appendChild(n),Q.checkClone=e.cloneNode(!0).cloneNode(!0).lastChild.checked,e.innerHTML="<textarea>x</textarea>",Q.noCloneChecked=!!e.cloneNode(!0).lastChild.defaultValue}();var St="undefined";Q.focusinBubbles="onfocusin"in t;var Et=/^key/,Nt=/^(?:mouse|pointer|contextmenu)|click/,kt=/^(?:focusinfocus|focusoutblur)$/,Mt=/^([^.]*)(?:\.(.+)|)$/;Z.event={global:{},add:function(t,e,n,r,i){var o,s,a,u,l,c,h,p,f,d,m,g=yt.get(t);if(g)for(n.handler&&(o=n,n=o.handler,i=o.selector),n.guid||(n.guid=Z.guid++),(u=g.events)||(u=g.events={}),(s=g.handle)||(s=g.handle=function(e){return typeof Z!==St&&Z.event.triggered!==e.type?Z.event.dispatch.apply(t,arguments):void 0}),e=(e||"").match(ft)||[""],l=e.length;l--;)a=Mt.exec(e[l])||[],f=m=a[1],d=(a[2]||"").split(".").sort(),f&&(h=Z.event.special[f]||{},f=(i?h.delegateType:h.bindType)||f,h=Z.event.special[f]||{},c=Z.extend({type:f,origType:m,data:r,handler:n,guid:n.guid,selector:i,needsContext:i&&Z.expr.match.needsContext.test(i),namespace:d.join(".")},o),(p=u[f])||(p=u[f]=[],p.delegateCount=0,h.setup&&h.setup.call(t,r,d,s)!==!1||t.addEventListener&&t.addEventListener(f,s,!1)),h.add&&(h.add.call(t,c),c.handler.guid||(c.handler.guid=n.guid)),i?p.splice(p.delegateCount++,0,c):p.push(c),Z.event.global[f]=!0)},remove:function(t,e,n,r,i){var o,s,a,u,l,c,h,p,f,d,m,g=yt.hasData(t)&&yt.get(t);if(g&&(u=g.events)){for(e=(e||"").match(ft)||[""],l=e.length;l--;)if(a=Mt.exec(e[l])||[],f=m=a[1],d=(a[2]||"").split(".").sort(),f){for(h=Z.event.special[f]||{},f=(r?h.delegateType:h.bindType)||f,p=u[f]||[],a=a[2]&&new RegExp("(^|\\.)"+d.join("\\.(?:.*\\.|)")+"(\\.|$)"),s=o=p.length;o--;)c=p[o],!i&&m!==c.origType||n&&n.guid!==c.guid||a&&!a.test(c.namespace)||r&&r!==c.selector&&("**"!==r||!c.selector)||(p.splice(o,1),c.selector&&p.delegateCount--,h.remove&&h.remove.call(t,c));s&&!p.length&&(h.teardown&&h.teardown.call(t,d,g.handle)!==!1||Z.removeEvent(t,f,g.handle),delete u[f])}else for(f in u)Z.event.remove(t,f+e[l],n,r,!0);Z.isEmptyObject(u)&&(delete g.handle,yt.remove(t,"events"))}},trigger:function(e,n,r,i){var o,s,a,u,l,c,h,p=[r||Y],f=X.call(e,"type")?e.type:e,d=X.call(e,"namespace")?e.namespace.split("."):[];if(s=a=r=r||Y,3!==r.nodeType&&8!==r.nodeType&&!kt.test(f+Z.event.triggered)&&(f.indexOf(".")>=0&&(d=f.split("."),f=d.shift(),d.sort()),l=f.indexOf(":")<0&&"on"+f,e=e[Z.expando]?e:new Z.Event(f,"object"==typeof e&&e),e.isTrigger=i?2:3,e.namespace=d.join("."),e.namespace_re=e.namespace?new RegExp("(^|\\.)"+d.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,e.result=void 0,e.target||(e.target=r),n=null==n?[e]:Z.makeArray(n,[e]),h=Z.event.special[f]||{},i||!h.trigger||h.trigger.apply(r,n)!==!1)){if(!i&&!h.noBubble&&!Z.isWindow(r)){for(u=h.delegateType||f,kt.test(u+f)||(s=s.parentNode);s;s=s.parentNode)p.push(s),a=s;a===(r.ownerDocument||Y)&&p.push(a.defaultView||a.parentWindow||t)}for(o=0;(s=p[o++])&&!e.isPropagationStopped();)e.type=o>1?u:h.bindType||f,c=(yt.get(s,"events")||{})[e.type]&&yt.get(s,"handle"),c&&c.apply(s,n),c=l&&s[l],c&&c.apply&&Z.acceptData(s)&&(e.result=c.apply(s,n),e.result===!1&&e.preventDefault());return e.type=f,i||e.isDefaultPrevented()||h._default&&h._default.apply(p.pop(),n)!==!1||!Z.acceptData(r)||l&&Z.isFunction(r[f])&&!Z.isWindow(r)&&(a=r[l],a&&(r[l]=null),Z.event.triggered=f,r[f](),Z.event.triggered=void 0,a&&(r[l]=a)),e.result}},dispatch:function(t){t=Z.event.fix(t);var e,n,r,i,o,s=[],a=H.call(arguments),u=(yt.get(this,"events")||{})[t.type]||[],l=Z.event.special[t.type]||{};if(a[0]=t,t.delegateTarget=this,!l.preDispatch||l.preDispatch.call(this,t)!==!1){for(s=Z.event.handlers.call(this,t,u),e=0;(i=s[e++])&&!t.isPropagationStopped();)for(t.currentTarget=i.elem,n=0;(o=i.handlers[n++])&&!t.isImmediatePropagationStopped();)(!t.namespace_re||t.namespace_re.test(o.namespace))&&(t.handleObj=o,t.data=o.data,r=((Z.event.special[o.origType]||{}).handle||o.handler).apply(i.elem,a),void 0!==r&&(t.result=r)===!1&&(t.preventDefault(),t.stopPropagation()));return l.postDispatch&&l.postDispatch.call(this,t),t.result}},handlers:function(t,e){var n,r,i,o,s=[],a=e.delegateCount,u=t.target;if(a&&u.nodeType&&(!t.button||"click"!==t.type))for(;u!==this;u=u.parentNode||this)if(u.disabled!==!0||"click"!==t.type){for(r=[],n=0;a>n;n++)o=e[n],i=o.selector+" ",void 0===r[i]&&(r[i]=o.needsContext?Z(i,this).index(u)>=0:Z.find(i,this,null,[u]).length),r[i]&&r.push(o);r.length&&s.push({elem:u,handlers:r})}return a<e.length&&s.push({elem:this,handlers:e.slice(a)}),s},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(t,e){return null==t.which&&(t.which=null!=e.charCode?e.charCode:e.keyCode),t}},mouseHooks:{props:"button buttons clientX clientY offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(t,e){var n,r,i,o=e.button;return null==t.pageX&&null!=e.clientX&&(n=t.target.ownerDocument||Y,r=n.documentElement,i=n.body,t.pageX=e.clientX+(r&&r.scrollLeft||i&&i.scrollLeft||0)-(r&&r.clientLeft||i&&i.clientLeft||0),t.pageY=e.clientY+(r&&r.scrollTop||i&&i.scrollTop||0)-(r&&r.clientTop||i&&i.clientTop||0)),t.which||void 0===o||(t.which=1&o?1:2&o?3:4&o?2:0),t}},fix:function(t){if(t[Z.expando])return t;var e,n,r,i=t.type,o=t,s=this.fixHooks[i];for(s||(this.fixHooks[i]=s=Nt.test(i)?this.mouseHooks:Et.test(i)?this.keyHooks:{}),r=s.props?this.props.concat(s.props):this.props,t=new Z.Event(o),e=r.length;e--;)n=r[e],t[n]=o[n];return t.target||(t.target=Y),3===t.target.nodeType&&(t.target=t.target.parentNode),s.filter?s.filter(t,o):t},special:{load:{noBubble:!0},focus:{trigger:function(){return this!==h()&&this.focus?(this.focus(),!1):void 0},delegateType:"focusin"},blur:{trigger:function(){return this===h()&&this.blur?(this.blur(),!1):void 0},delegateType:"focusout"},click:{trigger:function(){return"checkbox"===this.type&&this.click&&Z.nodeName(this,"input")?(this.click(),!1):void 0},_default:function(t){return Z.nodeName(t.target,"a")}},beforeunload:{postDispatch:function(t){void 0!==t.result&&t.originalEvent&&(t.originalEvent.returnValue=t.result)}}},simulate:function(t,e,n,r){var i=Z.extend(new Z.Event,n,{type:t,isSimulated:!0,originalEvent:{}});r?Z.event.trigger(i,null,e):Z.event.dispatch.call(e,i),i.isDefaultPrevented()&&n.preventDefault()}},Z.removeEvent=function(t,e,n){t.removeEventListener&&t.removeEventListener(e,n,!1)},Z.Event=function(t,e){return this instanceof Z.Event?(t&&t.type?(this.originalEvent=t,this.type=t.type,
this.isDefaultPrevented=t.defaultPrevented||void 0===t.defaultPrevented&&t.returnValue===!1?l:c):this.type=t,e&&Z.extend(this,e),this.timeStamp=t&&t.timeStamp||Z.now(),void(this[Z.expando]=!0)):new Z.Event(t,e)},Z.Event.prototype={isDefaultPrevented:c,isPropagationStopped:c,isImmediatePropagationStopped:c,preventDefault:function(){var t=this.originalEvent;this.isDefaultPrevented=l,t&&t.preventDefault&&t.preventDefault()},stopPropagation:function(){var t=this.originalEvent;this.isPropagationStopped=l,t&&t.stopPropagation&&t.stopPropagation()},stopImmediatePropagation:function(){var t=this.originalEvent;this.isImmediatePropagationStopped=l,t&&t.stopImmediatePropagation&&t.stopImmediatePropagation(),this.stopPropagation()}},Z.each({mouseenter:"mouseover",mouseleave:"mouseout",pointerenter:"pointerover",pointerleave:"pointerout"},function(t,e){Z.event.special[t]={delegateType:e,bindType:e,handle:function(t){var n,r=this,i=t.relatedTarget,o=t.handleObj;return(!i||i!==r&&!Z.contains(r,i))&&(t.type=o.origType,n=o.handler.apply(this,arguments),t.type=e),n}}}),Q.focusinBubbles||Z.each({focus:"focusin",blur:"focusout"},function(t,e){var n=function(t){Z.event.simulate(e,t.target,Z.event.fix(t),!0)};Z.event.special[e]={setup:function(){var r=this.ownerDocument||this,i=yt.access(r,e);i||r.addEventListener(t,n,!0),yt.access(r,e,(i||0)+1)},teardown:function(){var r=this.ownerDocument||this,i=yt.access(r,e)-1;i?yt.access(r,e,i):(r.removeEventListener(t,n,!0),yt.remove(r,e))}}}),Z.fn.extend({on:function(t,e,n,r,i){var o,s;if("object"==typeof t){"string"!=typeof e&&(n=n||e,e=void 0);for(s in t)this.on(s,e,n,t[s],i);return this}if(null==n&&null==r?(r=e,n=e=void 0):null==r&&("string"==typeof e?(r=n,n=void 0):(r=n,n=e,e=void 0)),r===!1)r=c;else if(!r)return this;return 1===i&&(o=r,r=function(t){return Z().off(t),o.apply(this,arguments)},r.guid=o.guid||(o.guid=Z.guid++)),this.each(function(){Z.event.add(this,t,r,n,e)})},one:function(t,e,n,r){return this.on(t,e,n,r,1)},off:function(t,e,n){var r,i;if(t&&t.preventDefault&&t.handleObj)return r=t.handleObj,Z(t.delegateTarget).off(r.namespace?r.origType+"."+r.namespace:r.origType,r.selector,r.handler),this;if("object"==typeof t){for(i in t)this.off(i,e,t[i]);return this}return(e===!1||"function"==typeof e)&&(n=e,e=void 0),n===!1&&(n=c),this.each(function(){Z.event.remove(this,t,n,e)})},trigger:function(t,e){return this.each(function(){Z.event.trigger(t,e,this)})},triggerHandler:function(t,e){var n=this[0];return n?Z.event.trigger(t,e,n,!0):void 0}});var Pt=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,Ot=/<([\w:]+)/,At=/<|&#?\w+;/,Rt=/<(?:script|style|link)/i,It=/checked\s*(?:[^=]|=\s*.checked.)/i,Dt=/^$|\/(?:java|ecma)script/i,Lt=/^true\/(.*)/,qt=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,jt={option:[1,"<select multiple='multiple'>","</select>"],thead:[1,"<table>","</table>"],col:[2,"<table><colgroup>","</colgroup></table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:[0,"",""]};jt.optgroup=jt.option,jt.tbody=jt.tfoot=jt.colgroup=jt.caption=jt.thead,jt.th=jt.td,Z.extend({clone:function(t,e,n){var r,i,o,s,a=t.cloneNode(!0),u=Z.contains(t.ownerDocument,t);if(!(Q.noCloneChecked||1!==t.nodeType&&11!==t.nodeType||Z.isXMLDoc(t)))for(s=y(a),o=y(t),r=0,i=o.length;i>r;r++)v(o[r],s[r]);if(e)if(n)for(o=o||y(t),s=s||y(a),r=0,i=o.length;i>r;r++)g(o[r],s[r]);else g(t,a);return s=y(a,"script"),s.length>0&&m(s,!u&&y(t,"script")),a},buildFragment:function(t,e,n,r){for(var i,o,s,a,u,l,c=e.createDocumentFragment(),h=[],p=0,f=t.length;f>p;p++)if(i=t[p],i||0===i)if("object"===Z.type(i))Z.merge(h,i.nodeType?[i]:i);else if(At.test(i)){for(o=o||c.appendChild(e.createElement("div")),s=(Ot.exec(i)||["",""])[1].toLowerCase(),a=jt[s]||jt._default,o.innerHTML=a[1]+i.replace(Pt,"<$1></$2>")+a[2],l=a[0];l--;)o=o.lastChild;Z.merge(h,o.childNodes),o=c.firstChild,o.textContent=""}else h.push(e.createTextNode(i));for(c.textContent="",p=0;i=h[p++];)if((!r||-1===Z.inArray(i,r))&&(u=Z.contains(i.ownerDocument,i),o=y(c.appendChild(i),"script"),u&&m(o),n))for(l=0;i=o[l++];)Dt.test(i.type||"")&&n.push(i);return c},cleanData:function(t){for(var e,n,r,i,o=Z.event.special,s=0;void 0!==(n=t[s]);s++){if(Z.acceptData(n)&&(i=n[yt.expando],i&&(e=yt.cache[i]))){if(e.events)for(r in e.events)o[r]?Z.event.remove(n,r):Z.removeEvent(n,r,e.handle);yt.cache[i]&&delete yt.cache[i]}delete vt.cache[n[vt.expando]]}}}),Z.fn.extend({text:function(t){return gt(this,function(t){return void 0===t?Z.text(this):this.empty().each(function(){(1===this.nodeType||11===this.nodeType||9===this.nodeType)&&(this.textContent=t)})},null,t,arguments.length)},append:function(){return this.domManip(arguments,function(t){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var e=p(this,t);e.appendChild(t)}})},prepend:function(){return this.domManip(arguments,function(t){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var e=p(this,t);e.insertBefore(t,e.firstChild)}})},before:function(){return this.domManip(arguments,function(t){this.parentNode&&this.parentNode.insertBefore(t,this)})},after:function(){return this.domManip(arguments,function(t){this.parentNode&&this.parentNode.insertBefore(t,this.nextSibling)})},remove:function(t,e){for(var n,r=t?Z.filter(t,this):this,i=0;null!=(n=r[i]);i++)e||1!==n.nodeType||Z.cleanData(y(n)),n.parentNode&&(e&&Z.contains(n.ownerDocument,n)&&m(y(n,"script")),n.parentNode.removeChild(n));return this},empty:function(){for(var t,e=0;null!=(t=this[e]);e++)1===t.nodeType&&(Z.cleanData(y(t,!1)),t.textContent="");return this},clone:function(t,e){return t=null==t?!1:t,e=null==e?t:e,this.map(function(){return Z.clone(this,t,e)})},html:function(t){return gt(this,function(t){var e=this[0]||{},n=0,r=this.length;if(void 0===t&&1===e.nodeType)return e.innerHTML;if("string"==typeof t&&!Rt.test(t)&&!jt[(Ot.exec(t)||["",""])[1].toLowerCase()]){t=t.replace(Pt,"<$1></$2>");try{for(;r>n;n++)e=this[n]||{},1===e.nodeType&&(Z.cleanData(y(e,!1)),e.innerHTML=t);e=0}catch(i){}}e&&this.empty().append(t)},null,t,arguments.length)},replaceWith:function(){var t=arguments[0];return this.domManip(arguments,function(e){t=this.parentNode,Z.cleanData(y(this)),t&&t.replaceChild(e,this)}),t&&(t.length||t.nodeType)?this:this.remove()},detach:function(t){return this.remove(t,!0)},domManip:function(t,e){t=B.apply([],t);var n,r,i,o,s,a,u=0,l=this.length,c=this,h=l-1,p=t[0],m=Z.isFunction(p);if(m||l>1&&"string"==typeof p&&!Q.checkClone&&It.test(p))return this.each(function(n){var r=c.eq(n);m&&(t[0]=p.call(this,n,r.html())),r.domManip(t,e)});if(l&&(n=Z.buildFragment(t,this[0].ownerDocument,!1,this),r=n.firstChild,1===n.childNodes.length&&(n=r),r)){for(i=Z.map(y(n,"script"),f),o=i.length;l>u;u++)s=n,u!==h&&(s=Z.clone(s,!0,!0),o&&Z.merge(i,y(s,"script"))),e.call(this[u],s,u);if(o)for(a=i[i.length-1].ownerDocument,Z.map(i,d),u=0;o>u;u++)s=i[u],Dt.test(s.type||"")&&!yt.access(s,"globalEval")&&Z.contains(a,s)&&(s.src?Z._evalUrl&&Z._evalUrl(s.src):Z.globalEval(s.textContent.replace(qt,"")))}return this}}),Z.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(t,e){Z.fn[t]=function(t){for(var n,r=[],i=Z(t),o=i.length-1,s=0;o>=s;s++)n=s===o?this:this.clone(!0),Z(i[s])[e](n),V.apply(r,n.get());return this.pushStack(r)}});var $t,Ft={},zt=/^margin/,Ut=new RegExp("^("+wt+")(?!px)[a-z%]+$","i"),Ht=function(e){return e.ownerDocument.defaultView.opener?e.ownerDocument.defaultView.getComputedStyle(e,null):t.getComputedStyle(e,null)};!function(){function e(){s.style.cssText="-webkit-box-sizing:border-box;-moz-box-sizing:border-box;box-sizing:border-box;display:block;margin-top:1%;top:1%;border:1px;padding:1px;width:4px;position:absolute",s.innerHTML="",i.appendChild(o);var e=t.getComputedStyle(s,null);n="1%"!==e.top,r="4px"===e.width,i.removeChild(o)}var n,r,i=Y.documentElement,o=Y.createElement("div"),s=Y.createElement("div");s.style&&(s.style.backgroundClip="content-box",s.cloneNode(!0).style.backgroundClip="",Q.clearCloneStyle="content-box"===s.style.backgroundClip,o.style.cssText="border:0;width:0;height:0;top:0;left:-9999px;margin-top:1px;position:absolute",o.appendChild(s),t.getComputedStyle&&Z.extend(Q,{pixelPosition:function(){return e(),n},boxSizingReliable:function(){return null==r&&e(),r},reliableMarginRight:function(){var e,n=s.appendChild(Y.createElement("div"));return n.style.cssText=s.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0",n.style.marginRight=n.style.width="0",s.style.width="1px",i.appendChild(o),e=!parseFloat(t.getComputedStyle(n,null).marginRight),i.removeChild(o),s.removeChild(n),e}}))}(),Z.swap=function(t,e,n,r){var i,o,s={};for(o in e)s[o]=t.style[o],t.style[o]=e[o];i=n.apply(t,r||[]);for(o in e)t.style[o]=s[o];return i};var Bt=/^(none|table(?!-c[ea]).+)/,Vt=new RegExp("^("+wt+")(.*)$","i"),Wt=new RegExp("^([+-])=("+wt+")","i"),Jt={position:"absolute",visibility:"hidden",display:"block"},Gt={letterSpacing:"0",fontWeight:"400"},Xt=["Webkit","O","Moz","ms"];Z.extend({cssHooks:{opacity:{get:function(t,e){if(e){var n=w(t,"opacity");return""===n?"1":n}}}},cssNumber:{columnCount:!0,fillOpacity:!0,flexGrow:!0,flexShrink:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":"cssFloat"},style:function(t,e,n,r){if(t&&3!==t.nodeType&&8!==t.nodeType&&t.style){var i,o,s,a=Z.camelCase(e),u=t.style;return e=Z.cssProps[a]||(Z.cssProps[a]=C(u,a)),s=Z.cssHooks[e]||Z.cssHooks[a],void 0===n?s&&"get"in s&&void 0!==(i=s.get(t,!1,r))?i:u[e]:(o=typeof n,"string"===o&&(i=Wt.exec(n))&&(n=(i[1]+1)*i[2]+parseFloat(Z.css(t,e)),o="number"),null!=n&&n===n&&("number"!==o||Z.cssNumber[a]||(n+="px"),Q.clearCloneStyle||""!==n||0!==e.indexOf("background")||(u[e]="inherit"),s&&"set"in s&&void 0===(n=s.set(t,n,r))||(u[e]=n)),void 0)}},css:function(t,e,n,r){var i,o,s,a=Z.camelCase(e);return e=Z.cssProps[a]||(Z.cssProps[a]=C(t.style,a)),s=Z.cssHooks[e]||Z.cssHooks[a],s&&"get"in s&&(i=s.get(t,!0,n)),void 0===i&&(i=w(t,e,r)),"normal"===i&&e in Gt&&(i=Gt[e]),""===n||n?(o=parseFloat(i),n===!0||Z.isNumeric(o)?o||0:i):i}}),Z.each(["height","width"],function(t,e){Z.cssHooks[e]={get:function(t,n,r){return n?Bt.test(Z.css(t,"display"))&&0===t.offsetWidth?Z.swap(t,Jt,function(){return E(t,e,r)}):E(t,e,r):void 0},set:function(t,n,r){var i=r&&Ht(t);return T(t,n,r?S(t,e,r,"border-box"===Z.css(t,"boxSizing",!1,i),i):0)}}}),Z.cssHooks.marginRight=x(Q.reliableMarginRight,function(t,e){return e?Z.swap(t,{display:"inline-block"},w,[t,"marginRight"]):void 0}),Z.each({margin:"",padding:"",border:"Width"},function(t,e){Z.cssHooks[t+e]={expand:function(n){for(var r=0,i={},o="string"==typeof n?n.split(" "):[n];4>r;r++)i[t+xt[r]+e]=o[r]||o[r-2]||o[0];return i}},zt.test(t)||(Z.cssHooks[t+e].set=T)}),Z.fn.extend({css:function(t,e){return gt(this,function(t,e,n){var r,i,o={},s=0;if(Z.isArray(e)){for(r=Ht(t),i=e.length;i>s;s++)o[e[s]]=Z.css(t,e[s],!1,r);return o}return void 0!==n?Z.style(t,e,n):Z.css(t,e)},t,e,arguments.length>1)},show:function(){return N(this,!0)},hide:function(){return N(this)},toggle:function(t){return"boolean"==typeof t?t?this.show():this.hide():this.each(function(){Ct(this)?Z(this).show():Z(this).hide()})}}),Z.Tween=k,k.prototype={constructor:k,init:function(t,e,n,r,i,o){this.elem=t,this.prop=n,this.easing=i||"swing",this.options=e,this.start=this.now=this.cur(),this.end=r,this.unit=o||(Z.cssNumber[n]?"":"px")},cur:function(){var t=k.propHooks[this.prop];return t&&t.get?t.get(this):k.propHooks._default.get(this)},run:function(t){var e,n=k.propHooks[this.prop];return this.pos=e=this.options.duration?Z.easing[this.easing](t,this.options.duration*t,0,1,this.options.duration):t,this.now=(this.end-this.start)*e+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):k.propHooks._default.set(this),this}},k.prototype.init.prototype=k.prototype,k.propHooks={_default:{get:function(t){var e;return null==t.elem[t.prop]||t.elem.style&&null!=t.elem.style[t.prop]?(e=Z.css(t.elem,t.prop,""),e&&"auto"!==e?e:0):t.elem[t.prop]},set:function(t){Z.fx.step[t.prop]?Z.fx.step[t.prop](t):t.elem.style&&(null!=t.elem.style[Z.cssProps[t.prop]]||Z.cssHooks[t.prop])?Z.style(t.elem,t.prop,t.now+t.unit):t.elem[t.prop]=t.now}}},k.propHooks.scrollTop=k.propHooks.scrollLeft={set:function(t){t.elem.nodeType&&t.elem.parentNode&&(t.elem[t.prop]=t.now)}},Z.easing={linear:function(t){return t},swing:function(t){return.5-Math.cos(t*Math.PI)/2}},Z.fx=k.prototype.init,Z.fx.step={};var Qt,Yt,Kt=/^(?:toggle|show|hide)$/,Zt=new RegExp("^(?:([+-])=|)("+wt+")([a-z%]*)$","i"),te=/queueHooks$/,ee=[A],ne={"*":[function(t,e){var n=this.createTween(t,e),r=n.cur(),i=Zt.exec(e),o=i&&i[3]||(Z.cssNumber[t]?"":"px"),s=(Z.cssNumber[t]||"px"!==o&&+r)&&Zt.exec(Z.css(n.elem,t)),a=1,u=20;if(s&&s[3]!==o){o=o||s[3],i=i||[],s=+r||1;do a=a||".5",s/=a,Z.style(n.elem,t,s+o);while(a!==(a=n.cur()/r)&&1!==a&&--u)}return i&&(s=n.start=+s||+r||0,n.unit=o,n.end=i[1]?s+(i[1]+1)*i[2]:+i[2]),n}]};Z.Animation=Z.extend(I,{tweener:function(t,e){Z.isFunction(t)?(e=t,t=["*"]):t=t.split(" ");for(var n,r=0,i=t.length;i>r;r++)n=t[r],ne[n]=ne[n]||[],ne[n].unshift(e)},prefilter:function(t,e){e?ee.unshift(t):ee.push(t)}}),Z.speed=function(t,e,n){var r=t&&"object"==typeof t?Z.extend({},t):{complete:n||!n&&e||Z.isFunction(t)&&t,duration:t,easing:n&&e||e&&!Z.isFunction(e)&&e};return r.duration=Z.fx.off?0:"number"==typeof r.duration?r.duration:r.duration in Z.fx.speeds?Z.fx.speeds[r.duration]:Z.fx.speeds._default,(null==r.queue||r.queue===!0)&&(r.queue="fx"),r.old=r.complete,r.complete=function(){Z.isFunction(r.old)&&r.old.call(this),r.queue&&Z.dequeue(this,r.queue)},r},Z.fn.extend({fadeTo:function(t,e,n,r){return this.filter(Ct).css("opacity",0).show().end().animate({opacity:e},t,n,r)},animate:function(t,e,n,r){var i=Z.isEmptyObject(t),o=Z.speed(e,n,r),s=function(){var e=I(this,Z.extend({},t),o);(i||yt.get(this,"finish"))&&e.stop(!0)};return s.finish=s,i||o.queue===!1?this.each(s):this.queue(o.queue,s)},stop:function(t,e,n){var r=function(t){var e=t.stop;delete t.stop,e(n)};return"string"!=typeof t&&(n=e,e=t,t=void 0),e&&t!==!1&&this.queue(t||"fx",[]),this.each(function(){var e=!0,i=null!=t&&t+"queueHooks",o=Z.timers,s=yt.get(this);if(i)s[i]&&s[i].stop&&r(s[i]);else for(i in s)s[i]&&s[i].stop&&te.test(i)&&r(s[i]);for(i=o.length;i--;)o[i].elem!==this||null!=t&&o[i].queue!==t||(o[i].anim.stop(n),e=!1,o.splice(i,1));(e||!n)&&Z.dequeue(this,t)})},finish:function(t){return t!==!1&&(t=t||"fx"),this.each(function(){var e,n=yt.get(this),r=n[t+"queue"],i=n[t+"queueHooks"],o=Z.timers,s=r?r.length:0;for(n.finish=!0,Z.queue(this,t,[]),i&&i.stop&&i.stop.call(this,!0),e=o.length;e--;)o[e].elem===this&&o[e].queue===t&&(o[e].anim.stop(!0),o.splice(e,1));for(e=0;s>e;e++)r[e]&&r[e].finish&&r[e].finish.call(this);delete n.finish})}}),Z.each(["toggle","show","hide"],function(t,e){var n=Z.fn[e];Z.fn[e]=function(t,r,i){return null==t||"boolean"==typeof t?n.apply(this,arguments):this.animate(P(e,!0),t,r,i)}}),Z.each({slideDown:P("show"),slideUp:P("hide"),slideToggle:P("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(t,e){Z.fn[t]=function(t,n,r){return this.animate(e,t,n,r)}}),Z.timers=[],Z.fx.tick=function(){var t,e=0,n=Z.timers;for(Qt=Z.now();e<n.length;e++)t=n[e],t()||n[e]!==t||n.splice(e--,1);n.length||Z.fx.stop(),Qt=void 0},Z.fx.timer=function(t){Z.timers.push(t),t()?Z.fx.start():Z.timers.pop()},Z.fx.interval=13,Z.fx.start=function(){Yt||(Yt=setInterval(Z.fx.tick,Z.fx.interval))},Z.fx.stop=function(){clearInterval(Yt),Yt=null},Z.fx.speeds={slow:600,fast:200,_default:400},Z.fn.delay=function(t,e){return t=Z.fx?Z.fx.speeds[t]||t:t,e=e||"fx",this.queue(e,function(e,n){var r=setTimeout(e,t);n.stop=function(){clearTimeout(r)}})},function(){var t=Y.createElement("input"),e=Y.createElement("select"),n=e.appendChild(Y.createElement("option"));t.type="checkbox",Q.checkOn=""!==t.value,Q.optSelected=n.selected,e.disabled=!0,Q.optDisabled=!n.disabled,t=Y.createElement("input"),t.value="t",t.type="radio",Q.radioValue="t"===t.value}();var re,ie,oe=Z.expr.attrHandle;Z.fn.extend({attr:function(t,e){return gt(this,Z.attr,t,e,arguments.length>1)},removeAttr:function(t){return this.each(function(){Z.removeAttr(this,t)})}}),Z.extend({attr:function(t,e,n){var r,i,o=t.nodeType;if(t&&3!==o&&8!==o&&2!==o)return typeof t.getAttribute===St?Z.prop(t,e,n):(1===o&&Z.isXMLDoc(t)||(e=e.toLowerCase(),r=Z.attrHooks[e]||(Z.expr.match.bool.test(e)?ie:re)),void 0===n?r&&"get"in r&&null!==(i=r.get(t,e))?i:(i=Z.find.attr(t,e),null==i?void 0:i):null!==n?r&&"set"in r&&void 0!==(i=r.set(t,n,e))?i:(t.setAttribute(e,n+""),n):void Z.removeAttr(t,e))},removeAttr:function(t,e){var n,r,i=0,o=e&&e.match(ft);if(o&&1===t.nodeType)for(;n=o[i++];)r=Z.propFix[n]||n,Z.expr.match.bool.test(n)&&(t[r]=!1),t.removeAttribute(n)},attrHooks:{type:{set:function(t,e){if(!Q.radioValue&&"radio"===e&&Z.nodeName(t,"input")){var n=t.value;return t.setAttribute("type",e),n&&(t.value=n),e}}}}}),ie={set:function(t,e,n){return e===!1?Z.removeAttr(t,n):t.setAttribute(n,n),n}},Z.each(Z.expr.match.bool.source.match(/\w+/g),function(t,e){var n=oe[e]||Z.find.attr;oe[e]=function(t,e,r){var i,o;return r||(o=oe[e],oe[e]=i,i=null!=n(t,e,r)?e.toLowerCase():null,oe[e]=o),i}});var se=/^(?:input|select|textarea|button)$/i;Z.fn.extend({prop:function(t,e){return gt(this,Z.prop,t,e,arguments.length>1)},removeProp:function(t){return this.each(function(){delete this[Z.propFix[t]||t]})}}),Z.extend({propFix:{"for":"htmlFor","class":"className"},prop:function(t,e,n){var r,i,o,s=t.nodeType;if(t&&3!==s&&8!==s&&2!==s)return o=1!==s||!Z.isXMLDoc(t),o&&(e=Z.propFix[e]||e,i=Z.propHooks[e]),void 0!==n?i&&"set"in i&&void 0!==(r=i.set(t,n,e))?r:t[e]=n:i&&"get"in i&&null!==(r=i.get(t,e))?r:t[e]},propHooks:{tabIndex:{get:function(t){return t.hasAttribute("tabindex")||se.test(t.nodeName)||t.href?t.tabIndex:-1}}}}),Q.optSelected||(Z.propHooks.selected={get:function(t){var e=t.parentNode;return e&&e.parentNode&&e.parentNode.selectedIndex,null}}),Z.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){Z.propFix[this.toLowerCase()]=this});var ae=/[\t\r\n\f]/g;Z.fn.extend({addClass:function(t){var e,n,r,i,o,s,a="string"==typeof t&&t,u=0,l=this.length;if(Z.isFunction(t))return this.each(function(e){Z(this).addClass(t.call(this,e,this.className))});if(a)for(e=(t||"").match(ft)||[];l>u;u++)if(n=this[u],r=1===n.nodeType&&(n.className?(" "+n.className+" ").replace(ae," "):" ")){for(o=0;i=e[o++];)r.indexOf(" "+i+" ")<0&&(r+=i+" ");s=Z.trim(r),n.className!==s&&(n.className=s)}return this},removeClass:function(t){var e,n,r,i,o,s,a=0===arguments.length||"string"==typeof t&&t,u=0,l=this.length;if(Z.isFunction(t))return this.each(function(e){Z(this).removeClass(t.call(this,e,this.className))});if(a)for(e=(t||"").match(ft)||[];l>u;u++)if(n=this[u],r=1===n.nodeType&&(n.className?(" "+n.className+" ").replace(ae," "):"")){for(o=0;i=e[o++];)for(;r.indexOf(" "+i+" ")>=0;)r=r.replace(" "+i+" "," ");s=t?Z.trim(r):"",n.className!==s&&(n.className=s)}return this},toggleClass:function(t,e){var n=typeof t;return"boolean"==typeof e&&"string"===n?e?this.addClass(t):this.removeClass(t):this.each(Z.isFunction(t)?function(n){Z(this).toggleClass(t.call(this,n,this.className,e),e)}:function(){if("string"===n)for(var e,r=0,i=Z(this),o=t.match(ft)||[];e=o[r++];)i.hasClass(e)?i.removeClass(e):i.addClass(e);else(n===St||"boolean"===n)&&(this.className&&yt.set(this,"__className__",this.className),this.className=this.className||t===!1?"":yt.get(this,"__className__")||"")})},hasClass:function(t){for(var e=" "+t+" ",n=0,r=this.length;r>n;n++)if(1===this[n].nodeType&&(" "+this[n].className+" ").replace(ae," ").indexOf(e)>=0)return!0;return!1}});var ue=/\r/g;Z.fn.extend({val:function(t){var e,n,r,i=this[0];{if(arguments.length)return r=Z.isFunction(t),this.each(function(n){var i;1===this.nodeType&&(i=r?t.call(this,n,Z(this).val()):t,null==i?i="":"number"==typeof i?i+="":Z.isArray(i)&&(i=Z.map(i,function(t){return null==t?"":t+""})),e=Z.valHooks[this.type]||Z.valHooks[this.nodeName.toLowerCase()],e&&"set"in e&&void 0!==e.set(this,i,"value")||(this.value=i))});if(i)return e=Z.valHooks[i.type]||Z.valHooks[i.nodeName.toLowerCase()],e&&"get"in e&&void 0!==(n=e.get(i,"value"))?n:(n=i.value,"string"==typeof n?n.replace(ue,""):null==n?"":n)}}}),Z.extend({valHooks:{option:{get:function(t){var e=Z.find.attr(t,"value");return null!=e?e:Z.trim(Z.text(t))}},select:{get:function(t){for(var e,n,r=t.options,i=t.selectedIndex,o="select-one"===t.type||0>i,s=o?null:[],a=o?i+1:r.length,u=0>i?a:o?i:0;a>u;u++)if(n=r[u],!(!n.selected&&u!==i||(Q.optDisabled?n.disabled:null!==n.getAttribute("disabled"))||n.parentNode.disabled&&Z.nodeName(n.parentNode,"optgroup"))){if(e=Z(n).val(),o)return e;s.push(e)}return s},set:function(t,e){for(var n,r,i=t.options,o=Z.makeArray(e),s=i.length;s--;)r=i[s],(r.selected=Z.inArray(r.value,o)>=0)&&(n=!0);return n||(t.selectedIndex=-1),o}}}}),Z.each(["radio","checkbox"],function(){Z.valHooks[this]={set:function(t,e){return Z.isArray(e)?t.checked=Z.inArray(Z(t).val(),e)>=0:void 0}},Q.checkOn||(Z.valHooks[this].get=function(t){return null===t.getAttribute("value")?"on":t.value})}),Z.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(t,e){Z.fn[e]=function(t,n){return arguments.length>0?this.on(e,null,t,n):this.trigger(e)}}),Z.fn.extend({hover:function(t,e){return this.mouseenter(t).mouseleave(e||t)},bind:function(t,e,n){return this.on(t,null,e,n)},unbind:function(t,e){return this.off(t,null,e)},delegate:function(t,e,n,r){return this.on(e,t,n,r)},undelegate:function(t,e,n){return 1===arguments.length?this.off(t,"**"):this.off(e,t||"**",n)}});var le=Z.now(),ce=/\?/;Z.parseJSON=function(t){return JSON.parse(t+"")},Z.parseXML=function(t){var e,n;if(!t||"string"!=typeof t)return null;try{n=new DOMParser,e=n.parseFromString(t,"text/xml")}catch(r){e=void 0}return(!e||e.getElementsByTagName("parsererror").length)&&Z.error("Invalid XML: "+t),e};var he=/#.*$/,pe=/([?&])_=[^&]*/,fe=/^(.*?):[ \t]*([^\r\n]*)$/gm,de=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,me=/^(?:GET|HEAD)$/,ge=/^\/\//,ye=/^([\w.+-]+:)(?:\/\/(?:[^\/?#]*@|)([^\/?#:]*)(?::(\d+)|)|)/,ve={},be={},_e="*/".concat("*"),we=t.location.href,xe=ye.exec(we.toLowerCase())||[];Z.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:we,type:"GET",isLocal:de.test(xe[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":_e,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":Z.parseJSON,"text xml":Z.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(t,e){return e?q(q(t,Z.ajaxSettings),e):q(Z.ajaxSettings,t)},ajaxPrefilter:D(ve),ajaxTransport:D(be),ajax:function(t,e){function n(t,e,n,s){var u,c,y,v,_,x=e;2!==b&&(b=2,a&&clearTimeout(a),r=void 0,o=s||"",w.readyState=t>0?4:0,u=t>=200&&300>t||304===t,n&&(v=j(h,w,n)),v=$(h,v,w,u),u?(h.ifModified&&(_=w.getResponseHeader("Last-Modified"),_&&(Z.lastModified[i]=_),_=w.getResponseHeader("etag"),_&&(Z.etag[i]=_)),204===t||"HEAD"===h.type?x="nocontent":304===t?x="notmodified":(x=v.state,c=v.data,y=v.error,u=!y)):(y=x,(t||!x)&&(x="error",0>t&&(t=0))),w.status=t,w.statusText=(e||x)+"",u?d.resolveWith(p,[c,x,w]):d.rejectWith(p,[w,x,y]),w.statusCode(g),g=void 0,l&&f.trigger(u?"ajaxSuccess":"ajaxError",[w,h,u?c:y]),m.fireWith(p,[w,x]),l&&(f.trigger("ajaxComplete",[w,h]),--Z.active||Z.event.trigger("ajaxStop")))}"object"==typeof t&&(e=t,t=void 0),e=e||{};var r,i,o,s,a,u,l,c,h=Z.ajaxSetup({},e),p=h.context||h,f=h.context&&(p.nodeType||p.jquery)?Z(p):Z.event,d=Z.Deferred(),m=Z.Callbacks("once memory"),g=h.statusCode||{},y={},v={},b=0,_="canceled",w={readyState:0,getResponseHeader:function(t){var e;if(2===b){if(!s)for(s={};e=fe.exec(o);)s[e[1].toLowerCase()]=e[2];e=s[t.toLowerCase()]}return null==e?null:e},getAllResponseHeaders:function(){return 2===b?o:null},setRequestHeader:function(t,e){var n=t.toLowerCase();return b||(t=v[n]=v[n]||t,y[t]=e),this},overrideMimeType:function(t){return b||(h.mimeType=t),this},statusCode:function(t){var e;if(t)if(2>b)for(e in t)g[e]=[g[e],t[e]];else w.always(t[w.status]);return this},abort:function(t){var e=t||_;return r&&r.abort(e),n(0,e),this}};if(d.promise(w).complete=m.add,w.success=w.done,w.error=w.fail,h.url=((t||h.url||we)+"").replace(he,"").replace(ge,xe[1]+"//"),h.type=e.method||e.type||h.method||h.type,h.dataTypes=Z.trim(h.dataType||"*").toLowerCase().match(ft)||[""],null==h.crossDomain&&(u=ye.exec(h.url.toLowerCase()),h.crossDomain=!(!u||u[1]===xe[1]&&u[2]===xe[2]&&(u[3]||("http:"===u[1]?"80":"443"))===(xe[3]||("http:"===xe[1]?"80":"443")))),h.data&&h.processData&&"string"!=typeof h.data&&(h.data=Z.param(h.data,h.traditional)),L(ve,h,e,w),2===b)return w;l=Z.event&&h.global,l&&0===Z.active++&&Z.event.trigger("ajaxStart"),h.type=h.type.toUpperCase(),h.hasContent=!me.test(h.type),i=h.url,h.hasContent||(h.data&&(i=h.url+=(ce.test(i)?"&":"?")+h.data,delete h.data),h.cache===!1&&(h.url=pe.test(i)?i.replace(pe,"$1_="+le++):i+(ce.test(i)?"&":"?")+"_="+le++)),h.ifModified&&(Z.lastModified[i]&&w.setRequestHeader("If-Modified-Since",Z.lastModified[i]),Z.etag[i]&&w.setRequestHeader("If-None-Match",Z.etag[i])),(h.data&&h.hasContent&&h.contentType!==!1||e.contentType)&&w.setRequestHeader("Content-Type",h.contentType),w.setRequestHeader("Accept",h.dataTypes[0]&&h.accepts[h.dataTypes[0]]?h.accepts[h.dataTypes[0]]+("*"!==h.dataTypes[0]?", "+_e+"; q=0.01":""):h.accepts["*"]);for(c in h.headers)w.setRequestHeader(c,h.headers[c]);if(h.beforeSend&&(h.beforeSend.call(p,w,h)===!1||2===b))return w.abort();_="abort";for(c in{success:1,error:1,complete:1})w[c](h[c]);if(r=L(be,h,e,w)){w.readyState=1,l&&f.trigger("ajaxSend",[w,h]),h.async&&h.timeout>0&&(a=setTimeout(function(){w.abort("timeout")},h.timeout));try{b=1,r.send(y,n)}catch(x){if(!(2>b))throw x;n(-1,x)}}else n(-1,"No Transport");return w},getJSON:function(t,e,n){return Z.get(t,e,n,"json")},getScript:function(t,e){return Z.get(t,void 0,e,"script")}}),Z.each(["get","post"],function(t,e){Z[e]=function(t,n,r,i){return Z.isFunction(n)&&(i=i||r,r=n,n=void 0),Z.ajax({url:t,type:e,dataType:i,data:n,success:r})}}),Z._evalUrl=function(t){return Z.ajax({url:t,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0})},Z.fn.extend({wrapAll:function(t){var e;return Z.isFunction(t)?this.each(function(e){Z(this).wrapAll(t.call(this,e))}):(this[0]&&(e=Z(t,this[0].ownerDocument).eq(0).clone(!0),this[0].parentNode&&e.insertBefore(this[0]),e.map(function(){for(var t=this;t.firstElementChild;)t=t.firstElementChild;return t}).append(this)),this)},wrapInner:function(t){return this.each(Z.isFunction(t)?function(e){Z(this).wrapInner(t.call(this,e))}:function(){var e=Z(this),n=e.contents();n.length?n.wrapAll(t):e.append(t)})},wrap:function(t){var e=Z.isFunction(t);return this.each(function(n){Z(this).wrapAll(e?t.call(this,n):t)})},unwrap:function(){return this.parent().each(function(){Z.nodeName(this,"body")||Z(this).replaceWith(this.childNodes)}).end()}}),Z.expr.filters.hidden=function(t){return t.offsetWidth<=0&&t.offsetHeight<=0},Z.expr.filters.visible=function(t){return!Z.expr.filters.hidden(t)};var Ce=/%20/g,Te=/\[\]$/,Se=/\r?\n/g,Ee=/^(?:submit|button|image|reset|file)$/i,Ne=/^(?:input|select|textarea|keygen)/i;Z.param=function(t,e){var n,r=[],i=function(t,e){e=Z.isFunction(e)?e():null==e?"":e,r[r.length]=encodeURIComponent(t)+"="+encodeURIComponent(e)};if(void 0===e&&(e=Z.ajaxSettings&&Z.ajaxSettings.traditional),Z.isArray(t)||t.jquery&&!Z.isPlainObject(t))Z.each(t,function(){i(this.name,this.value)});else for(n in t)F(n,t[n],e,i);return r.join("&").replace(Ce,"+")},Z.fn.extend({serialize:function(){return Z.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var t=Z.prop(this,"elements");return t?Z.makeArray(t):this}).filter(function(){var t=this.type;return this.name&&!Z(this).is(":disabled")&&Ne.test(this.nodeName)&&!Ee.test(t)&&(this.checked||!Tt.test(t))}).map(function(t,e){var n=Z(this).val();return null==n?null:Z.isArray(n)?Z.map(n,function(t){return{name:e.name,value:t.replace(Se,"\r\n")}}):{name:e.name,value:n.replace(Se,"\r\n")}}).get()}}),Z.ajaxSettings.xhr=function(){try{return new XMLHttpRequest}catch(t){}};var ke=0,Me={},Pe={0:200,1223:204},Oe=Z.ajaxSettings.xhr();t.attachEvent&&t.attachEvent("onunload",function(){for(var t in Me)Me[t]()}),Q.cors=!!Oe&&"withCredentials"in Oe,Q.ajax=Oe=!!Oe,Z.ajaxTransport(function(t){var e;return Q.cors||Oe&&!t.crossDomain?{send:function(n,r){var i,o=t.xhr(),s=++ke;if(o.open(t.type,t.url,t.async,t.username,t.password),t.xhrFields)for(i in t.xhrFields)o[i]=t.xhrFields[i];t.mimeType&&o.overrideMimeType&&o.overrideMimeType(t.mimeType),t.crossDomain||n["X-Requested-With"]||(n["X-Requested-With"]="XMLHttpRequest");for(i in n)o.setRequestHeader(i,n[i]);e=function(t){return function(){e&&(delete Me[s],e=o.onload=o.onerror=null,"abort"===t?o.abort():"error"===t?r(o.status,o.statusText):r(Pe[o.status]||o.status,o.statusText,"string"==typeof o.responseText?{text:o.responseText}:void 0,o.getAllResponseHeaders()))}},o.onload=e(),o.onerror=e("error"),e=Me[s]=e("abort");try{o.send(t.hasContent&&t.data||null)}catch(a){if(e)throw a}},abort:function(){e&&e()}}:void 0}),Z.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(t){return Z.globalEval(t),t}}}),Z.ajaxPrefilter("script",function(t){void 0===t.cache&&(t.cache=!1),t.crossDomain&&(t.type="GET")}),Z.ajaxTransport("script",function(t){if(t.crossDomain){var e,n;return{send:function(r,i){e=Z("<script>").prop({async:!0,charset:t.scriptCharset,src:t.url}).on("load error",n=function(t){e.remove(),n=null,t&&i("error"===t.type?404:200,t.type)}),Y.head.appendChild(e[0])},abort:function(){n&&n()}}}});var Ae=[],Re=/(=)\?(?=&|$)|\?\?/;Z.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var t=Ae.pop()||Z.expando+"_"+le++;return this[t]=!0,t}}),Z.ajaxPrefilter("json jsonp",function(e,n,r){var i,o,s,a=e.jsonp!==!1&&(Re.test(e.url)?"url":"string"==typeof e.data&&!(e.contentType||"").indexOf("application/x-www-form-urlencoded")&&Re.test(e.data)&&"data");return a||"jsonp"===e.dataTypes[0]?(i=e.jsonpCallback=Z.isFunction(e.jsonpCallback)?e.jsonpCallback():e.jsonpCallback,a?e[a]=e[a].replace(Re,"$1"+i):e.jsonp!==!1&&(e.url+=(ce.test(e.url)?"&":"?")+e.jsonp+"="+i),e.converters["script json"]=function(){return s||Z.error(i+" was not called"),s[0]},e.dataTypes[0]="json",o=t[i],t[i]=function(){s=arguments},r.always(function(){t[i]=o,e[i]&&(e.jsonpCallback=n.jsonpCallback,Ae.push(i)),s&&Z.isFunction(o)&&o(s[0]),s=o=void 0}),"script"):void 0}),Z.parseHTML=function(t,e,n){if(!t||"string"!=typeof t)return null;"boolean"==typeof e&&(n=e,e=!1),e=e||Y;var r=st.exec(t),i=!n&&[];return r?[e.createElement(r[1])]:(r=Z.buildFragment([t],e,i),i&&i.length&&Z(i).remove(),Z.merge([],r.childNodes))};var Ie=Z.fn.load;Z.fn.load=function(t,e,n){if("string"!=typeof t&&Ie)return Ie.apply(this,arguments);var r,i,o,s=this,a=t.indexOf(" ");return a>=0&&(r=Z.trim(t.slice(a)),t=t.slice(0,a)),Z.isFunction(e)?(n=e,e=void 0):e&&"object"==typeof e&&(i="POST"),s.length>0&&Z.ajax({url:t,type:i,dataType:"html",data:e}).done(function(t){o=arguments,s.html(r?Z("<div>").append(Z.parseHTML(t)).find(r):t)}).complete(n&&function(t,e){
s.each(n,o||[t.responseText,e,t])}),this},Z.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(t,e){Z.fn[e]=function(t){return this.on(e,t)}}),Z.expr.filters.animated=function(t){return Z.grep(Z.timers,function(e){return t===e.elem}).length};var De=t.document.documentElement;Z.offset={setOffset:function(t,e,n){var r,i,o,s,a,u,l,c=Z.css(t,"position"),h=Z(t),p={};"static"===c&&(t.style.position="relative"),a=h.offset(),o=Z.css(t,"top"),u=Z.css(t,"left"),l=("absolute"===c||"fixed"===c)&&(o+u).indexOf("auto")>-1,l?(r=h.position(),s=r.top,i=r.left):(s=parseFloat(o)||0,i=parseFloat(u)||0),Z.isFunction(e)&&(e=e.call(t,n,a)),null!=e.top&&(p.top=e.top-a.top+s),null!=e.left&&(p.left=e.left-a.left+i),"using"in e?e.using.call(t,p):h.css(p)}},Z.fn.extend({offset:function(t){if(arguments.length)return void 0===t?this:this.each(function(e){Z.offset.setOffset(this,t,e)});var e,n,r=this[0],i={top:0,left:0},o=r&&r.ownerDocument;if(o)return e=o.documentElement,Z.contains(e,r)?(typeof r.getBoundingClientRect!==St&&(i=r.getBoundingClientRect()),n=z(o),{top:i.top+n.pageYOffset-e.clientTop,left:i.left+n.pageXOffset-e.clientLeft}):i},position:function(){if(this[0]){var t,e,n=this[0],r={top:0,left:0};return"fixed"===Z.css(n,"position")?e=n.getBoundingClientRect():(t=this.offsetParent(),e=this.offset(),Z.nodeName(t[0],"html")||(r=t.offset()),r.top+=Z.css(t[0],"borderTopWidth",!0),r.left+=Z.css(t[0],"borderLeftWidth",!0)),{top:e.top-r.top-Z.css(n,"marginTop",!0),left:e.left-r.left-Z.css(n,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){for(var t=this.offsetParent||De;t&&!Z.nodeName(t,"html")&&"static"===Z.css(t,"position");)t=t.offsetParent;return t||De})}}),Z.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,n){var r="pageYOffset"===n;Z.fn[e]=function(i){return gt(this,function(e,i,o){var s=z(e);return void 0===o?s?s[n]:e[i]:void(s?s.scrollTo(r?t.pageXOffset:o,r?o:t.pageYOffset):e[i]=o)},e,i,arguments.length,null)}}),Z.each(["top","left"],function(t,e){Z.cssHooks[e]=x(Q.pixelPosition,function(t,n){return n?(n=w(t,e),Ut.test(n)?Z(t).position()[e]+"px":n):void 0})}),Z.each({Height:"height",Width:"width"},function(t,e){Z.each({padding:"inner"+t,content:e,"":"outer"+t},function(n,r){Z.fn[r]=function(r,i){var o=arguments.length&&(n||"boolean"!=typeof r),s=n||(r===!0||i===!0?"margin":"border");return gt(this,function(e,n,r){var i;return Z.isWindow(e)?e.document.documentElement["client"+t]:9===e.nodeType?(i=e.documentElement,Math.max(e.body["scroll"+t],i["scroll"+t],e.body["offset"+t],i["offset"+t],i["client"+t])):void 0===r?Z.css(e,n,s):Z.style(e,n,r,s)},e,o?r:void 0,o,null)}})}),Z.fn.size=function(){return this.length},Z.fn.andSelf=Z.fn.addBack,"function"==typeof define&&define.amd&&define("jquery",[],function(){return Z});var Le=t.jQuery,qe=t.$;return Z.noConflict=function(e){return t.$===Z&&(t.$=qe),e&&t.jQuery===Z&&(t.jQuery=Le),Z},typeof e===St&&(t.jQuery=t.$=Z),Z})},{}],306:[function(t,e,n){!function(r,i){"function"==typeof t&&"object"==typeof n&&"object"==typeof e?e.exports=i():"function"==typeof define&&define.amd?define(function(){return i()}):r.pluralize=i()}(this,function(){function t(t){return t.charAt(0).toUpperCase()+t.substr(1).toLowerCase()}function e(t){return"string"==typeof t?new RegExp("^"+t+"$","i"):t}function n(e,n){return e===e.toUpperCase()?n.toUpperCase():e[0]===e[0].toUpperCase()?t(n):n.toLowerCase()}function r(t,e){return t.replace(/\$(\d{1,2})/g,function(t,n){return e[n]||""})}function i(t,e){if(!t.length||l.hasOwnProperty(t))return t;for(var i=e.length;i--;){var o=e[i];if(o[0].test(t))return t.replace(o[0],function(t,e,i){var s=r(o[1],arguments);return""===t?n(i[e-1],s):n(t,s)})}return t}function o(t,e,r){return function(o){var s=o.toLowerCase();return e.hasOwnProperty(s)?n(o,s):t.hasOwnProperty(s)?n(o,t[s]):i(o,r)}}function s(t,e,n){var r=1===e?s.singular(t):s.plural(t);return(n?e+" ":"")+r}var a=[],u=[],l={},c={},h={};return s.plural=o(h,c,a),s.singular=o(c,h,u),s.addPluralRule=function(t,n){a.push([e(t),n])},s.addSingularRule=function(t,n){u.push([e(t),n])},s.addUncountableRule=function(t){return"string"==typeof t?void(l[t.toLowerCase()]=!0):(s.addPluralRule(t,"$0"),void s.addSingularRule(t,"$0"))},s.addIrregularRule=function(t,e){e=e.toLowerCase(),t=t.toLowerCase(),h[t]=e,c[e]=t},[["I","we"],["me","us"],["he","they"],["she","they"],["them","them"],["myself","ourselves"],["yourself","yourselves"],["itself","themselves"],["herself","themselves"],["himself","themselves"],["themself","themselves"],["this","these"],["that","those"],["echo","echoes"],["dingo","dingoes"],["volcano","volcanoes"],["tornado","tornadoes"],["torpedo","torpedoes"],["genus","genera"],["viscus","viscera"],["stigma","stigmata"],["stoma","stomata"],["dogma","dogmata"],["lemma","lemmata"],["schema","schemata"],["anathema","anathemata"],["ox","oxen"],["axe","axes"],["die","dice"],["yes","yeses"],["foot","feet"],["eave","eaves"],["goose","geese"],["tooth","teeth"],["quiz","quizzes"],["human","humans"],["proof","proofs"],["carve","carves"],["valve","valves"],["thief","thieves"],["genie","genies"],["groove","grooves"],["pickaxe","pickaxes"],["whiskey","whiskies"]].forEach(function(t){return s.addIrregularRule(t[0],t[1])}),[[/s?$/i,"s"],[/([^aeiou]ese)$/i,"$1"],[/(ax|test)is$/i,"$1es"],[/(alias|[^aou]us|tlas|gas|ris)$/i,"$1es"],[/(e[mn]u)s?$/i,"$1s"],[/([^l]ias|[aeiou]las|[emjzr]as|[iu]am)$/i,"$1"],[/(alumn|syllab|octop|vir|radi|nucle|fung|cact|stimul|termin|bacill|foc|uter|loc|strat)(?:us|i)$/i,"$1i"],[/(alumn|alg|vertebr)(?:a|ae)$/i,"$1ae"],[/(seraph|cherub)(?:im)?$/i,"$1im"],[/(her|at|gr)o$/i,"$1oes"],[/(agend|addend|millenni|dat|extrem|bacteri|desiderat|strat|candelabr|errat|ov|symposi|curricul|automat|quor)(?:a|um)$/i,"$1a"],[/(apheli|hyperbat|periheli|asyndet|noumen|phenomen|criteri|organ|prolegomen|hedr|automat)(?:a|on)$/i,"$1a"],[/sis$/i,"ses"],[/(?:(kni|wi|li)fe|(ar|l|ea|eo|oa|hoo)f)$/i,"$1$2ves"],[/([^aeiouy]|qu)y$/i,"$1ies"],[/([^ch][ieo][ln])ey$/i,"$1ies"],[/(x|ch|ss|sh|zz)$/i,"$1es"],[/(matr|cod|mur|sil|vert|ind|append)(?:ix|ex)$/i,"$1ices"],[/(m|l)(?:ice|ouse)$/i,"$1ice"],[/(pe)(?:rson|ople)$/i,"$1ople"],[/(child)(?:ren)?$/i,"$1ren"],[/eaux$/i,"$0"],[/m[ae]n$/i,"men"],["thou","you"]].forEach(function(t){return s.addPluralRule(t[0],t[1])}),[[/s$/i,""],[/(ss)$/i,"$1"],[/((a)naly|(b)a|(d)iagno|(p)arenthe|(p)rogno|(s)ynop|(t)he)(?:sis|ses)$/i,"$1sis"],[/(^analy)(?:sis|ses)$/i,"$1sis"],[/(wi|kni|(?:after|half|high|low|mid|non|night|[^\w]|^)li)ves$/i,"$1fe"],[/(ar|(?:wo|[ae])l|[eo][ao])ves$/i,"$1f"],[/([^aeiouy]|qu)ies$/i,"$1y"],[/(^[pl]|zomb|^(?:neck)?t|[aeo][lt]|cut)ies$/i,"$1ie"],[/([^c][eor]n|smil)ies$/i,"$1ey"],[/(m|l)ice$/i,"$1ouse"],[/(seraph|cherub)im$/i,"$1"],[/(x|ch|ss|sh|zz|tto|go|cho|alias|[^aou]us|tlas|gas|(?:her|at|gr)o|ris)(?:es)?$/i,"$1"],[/(e[mn]u)s?$/i,"$1"],[/(movie|twelve)s$/i,"$1"],[/(cris|test|diagnos)(?:is|es)$/i,"$1is"],[/(alumn|syllab|octop|vir|radi|nucle|fung|cact|stimul|termin|bacill|foc|uter|loc|strat)(?:us|i)$/i,"$1us"],[/(agend|addend|millenni|dat|extrem|bacteri|desiderat|strat|candelabr|errat|ov|symposi|curricul|quor)a$/i,"$1um"],[/(apheli|hyperbat|periheli|asyndet|noumen|phenomen|criteri|organ|prolegomen|hedr|automat)a$/i,"$1on"],[/(alumn|alg|vertebr)ae$/i,"$1a"],[/(cod|mur|sil|vert|ind)ices$/i,"$1ex"],[/(matr|append)ices$/i,"$1ix"],[/(pe)(rson|ople)$/i,"$1rson"],[/(child)ren$/i,"$1"],[/(eau)x?$/i,"$1"],[/men$/i,"man"]].forEach(function(t){return s.addSingularRule(t[0],t[1])}),["advice","agenda","bison","bream","buffalo","carp","chassis","cod","cooperation","corps","digestion","debris","diabetes","energy","equipment","elk","excretion","expertise","flounder","gallows","garbage","graffiti","headquarters","health","herpes","highjinks","homework","information","jeans","justice","kudos","labour","machinery","mackerel","media","mews","moose","news","pike","plankton","pliers","pollution","premises","rain","rice","salmon","scissors","series","sewage","shambles","shrimp","species","staff","swine","trout","tuna","whiting","wildebeest","wildlife","you",/pox$/i,/ois$/i,/deer$/i,/fish$/i,/sheep$/i,/measles$/i,/[^aeiou]ese$/i].forEach(s.addUncountableRule),s})},{}],307:[function(t,e,n){!function(t){var e=function(){"use strict";return{isMsie:function(){return/(msie|trident)/i.test(navigator.userAgent)?navigator.userAgent.match(/(msie |rv:)(\d+(.\d+)?)/i)[2]:!1},isBlankString:function(t){return!t||/^\s*$/.test(t)},escapeRegExChars:function(t){return t.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")},isString:function(t){return"string"==typeof t},isNumber:function(t){return"number"==typeof t},isArray:t.isArray,isFunction:t.isFunction,isObject:t.isPlainObject,isUndefined:function(t){return"undefined"==typeof t},toStr:function(t){return e.isUndefined(t)||null===t?"":t+""},bind:t.proxy,each:function(e,n){function r(t,e){return n(e,t)}t.each(e,r)},map:t.map,filter:t.grep,every:function(e,n){var r=!0;return e?(t.each(e,function(t,i){return(r=n.call(null,i,t,e))?void 0:!1}),!!r):r},some:function(e,n){var r=!1;return e?(t.each(e,function(t,i){return(r=n.call(null,i,t,e))?!1:void 0}),!!r):r},mixin:t.extend,getUniqueId:function(){var t=0;return function(){return t++}}(),templatify:function(e){function n(){return String(e)}return t.isFunction(e)?e:n},defer:function(t){setTimeout(t,0)},debounce:function(t,e,n){var r,i;return function(){var o,s,a=this,u=arguments;return o=function(){r=null,n||(i=t.apply(a,u))},s=n&&!r,clearTimeout(r),r=setTimeout(o,e),s&&(i=t.apply(a,u)),i}},throttle:function(t,e){var n,r,i,o,s,a;return s=0,a=function(){s=new Date,i=null,o=t.apply(n,r)},function(){var u=new Date,l=e-(u-s);return n=this,r=arguments,0>=l?(clearTimeout(i),i=null,s=u,o=t.apply(n,r)):i||(i=setTimeout(a,l)),o}},noop:function(){}}}(),n="0.10.5",r=function(){"use strict";function t(t){return t=e.toStr(t),t?t.split(/\s+/):[]}function n(t){return t=e.toStr(t),t?t.split(/\W+/):[]}function r(t){return function(){var n=[].slice.call(arguments,0);return function(r){var i=[];return e.each(n,function(n){i=i.concat(t(e.toStr(r[n])))}),i}}}return{nonword:n,whitespace:t,obj:{nonword:r(n),whitespace:r(t)}}}(),i=function(){"use strict";function n(n){this.maxSize=e.isNumber(n)?n:100,this.reset(),this.maxSize<=0&&(this.set=this.get=t.noop)}function r(){this.head=this.tail=null}function i(t,e){this.key=t,this.val=e,this.prev=this.next=null}return e.mixin(n.prototype,{set:function(t,e){var n,r=this.list.tail;this.size>=this.maxSize&&(this.list.remove(r),delete this.hash[r.key]),(n=this.hash[t])?(n.val=e,this.list.moveToFront(n)):(n=new i(t,e),this.list.add(n),this.hash[t]=n,this.size++)},get:function(t){var e=this.hash[t];return e?(this.list.moveToFront(e),e.val):void 0},reset:function(){this.size=0,this.hash={},this.list=new r}}),e.mixin(r.prototype,{add:function(t){this.head&&(t.next=this.head,this.head.prev=t),this.head=t,this.tail=this.tail||t},remove:function(t){t.prev?t.prev.next=t.next:this.head=t.next,t.next?t.next.prev=t.prev:this.tail=t.prev},moveToFront:function(t){this.remove(t),this.add(t)}}),n}(),o=function(){"use strict";function t(t){this.prefix=["__",t,"__"].join(""),this.ttlKey="__ttl__",this.keyMatcher=new RegExp("^"+e.escapeRegExChars(this.prefix))}function n(){return(new Date).getTime()}function r(t){return JSON.stringify(e.isUndefined(t)?null:t)}function i(t){return JSON.parse(t)}var o,s;try{o=window.localStorage,o.setItem("~~~","!"),o.removeItem("~~~")}catch(a){o=null}return s=o&&window.JSON?{_prefix:function(t){return this.prefix+t},_ttlKey:function(t){return this._prefix(t)+this.ttlKey},get:function(t){return this.isExpired(t)&&this.remove(t),i(o.getItem(this._prefix(t)))},set:function(t,i,s){return e.isNumber(s)?o.setItem(this._ttlKey(t),r(n()+s)):o.removeItem(this._ttlKey(t)),o.setItem(this._prefix(t),r(i))},remove:function(t){return o.removeItem(this._ttlKey(t)),o.removeItem(this._prefix(t)),this},clear:function(){var t,e,n=[],r=o.length;for(t=0;r>t;t++)(e=o.key(t)).match(this.keyMatcher)&&n.push(e.replace(this.keyMatcher,""));for(t=n.length;t--;)this.remove(n[t]);return this},isExpired:function(t){var r=i(o.getItem(this._ttlKey(t)));return e.isNumber(r)&&n()>r?!0:!1}}:{get:e.noop,set:e.noop,remove:e.noop,clear:e.noop,isExpired:e.noop},e.mixin(t.prototype,s),t}(),s=function(){"use strict";function n(e){e=e||{},this.cancelled=!1,this.lastUrl=null,this._send=e.transport?r(e.transport):t.ajax,this._get=e.rateLimiter?e.rateLimiter(this._get):this._get,this._cache=e.cache===!1?new i(0):u}function r(n){return function(r,i){function o(t){e.defer(function(){a.resolve(t)})}function s(t){e.defer(function(){a.reject(t)})}var a=t.Deferred();return n(r,i,o,s),a}}var o=0,s={},a=6,u=new i(10);return n.setMaxPendingRequests=function(t){a=t},n.resetCache=function(){u.reset()},e.mixin(n.prototype,{_get:function(t,e,n){function r(e){n&&n(null,e),c._cache.set(t,e)}function i(){n&&n(!0)}function u(){o--,delete s[t],c.onDeckRequestArgs&&(c._get.apply(c,c.onDeckRequestArgs),c.onDeckRequestArgs=null)}var l,c=this;this.cancelled||t!==this.lastUrl||((l=s[t])?l.done(r).fail(i):a>o?(o++,s[t]=this._send(t,e).done(r).fail(i).always(u)):this.onDeckRequestArgs=[].slice.call(arguments,0))},get:function(t,n,r){var i;return e.isFunction(n)&&(r=n,n={}),this.cancelled=!1,this.lastUrl=t,(i=this._cache.get(t))?e.defer(function(){r&&r(null,i)}):this._get(t,n,r),!!i},cancel:function(){this.cancelled=!0}}),n}(),a=function(){"use strict";function n(e){e=e||{},e.datumTokenizer&&e.queryTokenizer||t.error("datumTokenizer and queryTokenizer are both required"),this.datumTokenizer=e.datumTokenizer,this.queryTokenizer=e.queryTokenizer,this.reset()}function r(t){return t=e.filter(t,function(t){return!!t}),t=e.map(t,function(t){return t.toLowerCase()})}function i(){return{ids:[],children:{}}}function o(t){for(var e={},n=[],r=0,i=t.length;i>r;r++)e[t[r]]||(e[t[r]]=!0,n.push(t[r]));return n}function s(t,e){function n(t,e){return t-e}var r=0,i=0,o=[];t=t.sort(n),e=e.sort(n);for(var s=t.length,a=e.length;s>r&&a>i;)t[r]<e[i]?r++:t[r]>e[i]?i++:(o.push(t[r]),r++,i++);return o}return e.mixin(n.prototype,{bootstrap:function(t){this.datums=t.datums,this.trie=t.trie},add:function(t){var n=this;t=e.isArray(t)?t:[t],e.each(t,function(t){var o,s;o=n.datums.push(t)-1,s=r(n.datumTokenizer(t)),e.each(s,function(t){var e,r,s;for(e=n.trie,r=t.split("");s=r.shift();)e=e.children[s]||(e.children[s]=i()),e.ids.push(o)})})},get:function(t){var n,i,a=this;return n=r(this.queryTokenizer(t)),e.each(n,function(t){var e,n,r,o;if(i&&0===i.length)return!1;for(e=a.trie,n=t.split("");e&&(r=n.shift());)e=e.children[r];return e&&0===n.length?(o=e.ids.slice(0),void(i=i?s(i,o):o)):(i=[],!1)}),i?e.map(o(i),function(t){return a.datums[t]}):[]},reset:function(){this.datums=[],this.trie=i()},serialize:function(){return{datums:this.datums,trie:this.trie}}}),n}(),u=function(){"use strict";function r(t){return t.local||null}function i(r){var i,o;return o={url:null,thumbprint:"",ttl:864e5,filter:null,ajax:{}},(i=r.prefetch||null)&&(i=e.isString(i)?{url:i}:i,i=e.mixin(o,i),i.thumbprint=n+i.thumbprint,i.ajax.type=i.ajax.type||"GET",i.ajax.dataType=i.ajax.dataType||"json",!i.url&&t.error("prefetch requires url to be set")),i}function o(n){function r(t){return function(n){return e.debounce(n,t)}}function i(t){return function(n){return e.throttle(n,t)}}var o,s;return s={url:null,cache:!0,wildcard:"%QUERY",replace:null,rateLimitBy:"debounce",rateLimitWait:300,send:null,filter:null,ajax:{}},(o=n.remote||null)&&(o=e.isString(o)?{url:o}:o,o=e.mixin(s,o),o.rateLimiter=/^throttle$/i.test(o.rateLimitBy)?i(o.rateLimitWait):r(o.rateLimitWait),o.ajax.type=o.ajax.type||"GET",o.ajax.dataType=o.ajax.dataType||"json",delete o.rateLimitBy,delete o.rateLimitWait,!o.url&&t.error("remote requires url to be set")),o}return{local:r,prefetch:i,remote:o}}();!function(n){"use strict";function i(e){e&&(e.local||e.prefetch||e.remote)||t.error("one of local, prefetch, or remote is required"),this.limit=e.limit||5,this.sorter=l(e.sorter),this.dupDetector=e.dupDetector||c,this.local=u.local(e),this.prefetch=u.prefetch(e),this.remote=u.remote(e),this.cacheKey=this.prefetch?this.prefetch.cacheKey||this.prefetch.url:null,this.index=new a({datumTokenizer:e.datumTokenizer,queryTokenizer:e.queryTokenizer}),this.storage=this.cacheKey?new o(this.cacheKey):null}function l(t){function n(e){return e.sort(t)}function r(t){return t}return e.isFunction(t)?n:r}function c(){return!1}var h,p;return h=n.Bloodhound,p={data:"data",protocol:"protocol",thumbprint:"thumbprint"},n.Bloodhound=i,i.noConflict=function(){return n.Bloodhound=h,i},i.tokenizers=r,e.mixin(i.prototype,{_loadPrefetch:function(e){function n(t){o.clear(),o.add(e.filter?e.filter(t):t),o._saveToStorage(o.index.serialize(),e.thumbprint,e.ttl)}var r,i,o=this;return(r=this._readFromStorage(e.thumbprint))?(this.index.bootstrap(r),i=t.Deferred().resolve()):i=t.ajax(e.url,e.ajax).done(n),i},_getFromRemote:function(t,e){function n(t,n){e(t?[]:o.remote.filter?o.remote.filter(n):n)}var r,i,o=this;if(this.transport)return t=t||"",i=encodeURIComponent(t),r=this.remote.replace?this.remote.replace(this.remote.url,t):this.remote.url.replace(this.remote.wildcard,i),this.transport.get(r,this.remote.ajax,n)},_cancelLastRemoteRequest:function(){this.transport&&this.transport.cancel()},_saveToStorage:function(t,e,n){this.storage&&(this.storage.set(p.data,t,n),this.storage.set(p.protocol,location.protocol,n),this.storage.set(p.thumbprint,e,n))},_readFromStorage:function(t){var e,n={};return this.storage&&(n.data=this.storage.get(p.data),n.protocol=this.storage.get(p.protocol),n.thumbprint=this.storage.get(p.thumbprint)),e=n.thumbprint!==t||n.protocol!==location.protocol,n.data&&!e?n.data:null},_initialize:function(){function n(){i.add(e.isFunction(o)?o():o)}var r,i=this,o=this.local;return r=this.prefetch?this._loadPrefetch(this.prefetch):t.Deferred().resolve(),o&&r.done(n),this.transport=this.remote?new s(this.remote):null,this.initPromise=r.promise()},initialize:function(t){return!this.initPromise||t?this._initialize():this.initPromise},add:function(t){this.index.add(t)},get:function(t,n){function r(t){var r=o.slice(0);e.each(t,function(t){var n;return n=e.some(r,function(e){return i.dupDetector(t,e)}),!n&&r.push(t),r.length<i.limit}),n&&n(i.sorter(r))}var i=this,o=[],s=!1;o=this.index.get(t),o=this.sorter(o).slice(0,this.limit),o.length<this.limit?s=this._getFromRemote(t,r):this._cancelLastRemoteRequest(),s||(o.length>0||!this.transport)&&n&&n(o)},clear:function(){this.index.reset()},clearPrefetchCache:function(){this.storage&&this.storage.clear()},clearRemoteCache:function(){this.transport&&s.resetCache()},ttAdapter:function(){return e.bind(this.get,this)}}),i}(this);var l=function(){return{wrapper:'<span class="twitter-typeahead"></span>',dropdown:'<span class="tt-dropdown-menu"></span>',dataset:'<div class="tt-dataset-%CLASS%"></div>',suggestions:'<span class="tt-suggestions"></span>',suggestion:'<div class="tt-suggestion"></div>'}}(),c=function(){"use strict";var t={wrapper:{position:"relative",display:"inline-block"},hint:{position:"absolute",top:"0",left:"0",borderColor:"transparent",boxShadow:"none",opacity:"1"},input:{position:"relative",verticalAlign:"top",backgroundColor:"transparent"},inputWithNoHint:{position:"relative",verticalAlign:"top"},dropdown:{position:"absolute",top:"100%",left:"0",zIndex:"100",display:"none"},suggestions:{display:"block"},suggestion:{whiteSpace:"nowrap",cursor:"pointer"},suggestionChild:{whiteSpace:"normal"},ltr:{left:"0",right:"auto"},rtl:{left:"auto",right:" 0"}};return e.isMsie()&&e.mixin(t.input,{backgroundImage:"url(data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7)"}),e.isMsie()&&e.isMsie()<=7&&e.mixin(t.input,{marginTop:"-1px"}),t}(),h=function(){"use strict";function n(e){e&&e.el||t.error("EventBus initialized without el"),this.$el=t(e.el)}var r="typeahead:";return e.mixin(n.prototype,{trigger:function(t){var e=[].slice.call(arguments,1);this.$el.trigger(r+t,e)}}),n}(),p=function(){"use strict";function t(t,e,n,r){var i;if(!n)return this;for(e=e.split(u),n=r?a(n,r):n,this._callbacks=this._callbacks||{};i=e.shift();)this._callbacks[i]=this._callbacks[i]||{sync:[],async:[]},this._callbacks[i][t].push(n);return this}function e(e,n,r){return t.call(this,"async",e,n,r)}function n(e,n,r){return t.call(this,"sync",e,n,r)}function r(t){var e;if(!this._callbacks)return this;for(t=t.split(u);e=t.shift();)delete this._callbacks[e];return this}function i(t){var e,n,r,i,s;if(!this._callbacks)return this;for(t=t.split(u),r=[].slice.call(arguments,1);(e=t.shift())&&(n=this._callbacks[e]);)i=o(n.sync,this,[e].concat(r)),s=o(n.async,this,[e].concat(r)),i()&&l(s);return this}function o(t,e,n){function r(){for(var r,i=0,o=t.length;!r&&o>i;i+=1)r=t[i].apply(e,n)===!1;return!r}return r}function s(){var t;return t=window.setImmediate?function(t){setImmediate(function(){t()})}:function(t){setTimeout(function(){t()},0)}}function a(t,e){return t.bind?t.bind(e):function(){t.apply(e,[].slice.call(arguments,0))}}var u=/\s+/,l=s();return{onSync:n,onAsync:e,off:r,trigger:i}}(),f=function(t){"use strict";function n(t,n,r){for(var i,o=[],s=0,a=t.length;a>s;s++)o.push(e.escapeRegExChars(t[s]));return i=r?"\\b("+o.join("|")+")\\b":"("+o.join("|")+")",n?new RegExp(i):new RegExp(i,"i")}var r={node:null,pattern:null,tagName:"strong",className:null,wordsOnly:!1,caseSensitive:!1};return function(i){function o(e){var n,r,o;return(n=a.exec(e.data))&&(o=t.createElement(i.tagName),i.className&&(o.className=i.className),r=e.splitText(n.index),r.splitText(n[0].length),o.appendChild(r.cloneNode(!0)),e.parentNode.replaceChild(o,r)),!!n}function s(t,e){for(var n,r=3,i=0;i<t.childNodes.length;i++)n=t.childNodes[i],n.nodeType===r?i+=e(n)?1:0:s(n,e)}var a;i=e.mixin({},r,i),i.node&&i.pattern&&(i.pattern=e.isArray(i.pattern)?i.pattern:[i.pattern],a=n(i.pattern,i.caseSensitive,i.wordsOnly),s(i.node,o))}}(window.document),d=function(){"use strict";function n(n){var i,o,a,u,l=this;n=n||{},n.input||t.error("input is missing"),i=e.bind(this._onBlur,this),o=e.bind(this._onFocus,this),a=e.bind(this._onKeydown,this),u=e.bind(this._onInput,this),this.$hint=t(n.hint),this.$input=t(n.input).on("blur.tt",i).on("focus.tt",o).on("keydown.tt",a),0===this.$hint.length&&(this.setHint=this.getHint=this.clearHint=this.clearHintIfInvalid=e.noop),e.isMsie()?this.$input.on("keydown.tt keypress.tt cut.tt paste.tt",function(t){s[t.which||t.keyCode]||e.defer(e.bind(l._onInput,l,t))}):this.$input.on("input.tt",u),this.query=this.$input.val(),this.$overflowHelper=r(this.$input)}function r(e){return t('<pre aria-hidden="true"></pre>').css({position:"absolute",visibility:"hidden",whiteSpace:"pre",fontFamily:e.css("font-family"),fontSize:e.css("font-size"),fontStyle:e.css("font-style"),fontVariant:e.css("font-variant"),fontWeight:e.css("font-weight"),wordSpacing:e.css("word-spacing"),letterSpacing:e.css("letter-spacing"),textIndent:e.css("text-indent"),textRendering:e.css("text-rendering"),textTransform:e.css("text-transform")}).insertAfter(e)}function i(t,e){return n.normalizeQuery(t)===n.normalizeQuery(e)}function o(t){return t.altKey||t.ctrlKey||t.metaKey||t.shiftKey}var s;return s={9:"tab",27:"esc",37:"left",39:"right",13:"enter",38:"up",40:"down"},n.normalizeQuery=function(t){return(t||"").replace(/^\s*/g,"").replace(/\s{2,}/g," ")},e.mixin(n.prototype,p,{_onBlur:function(){this.resetInputValue(),this.trigger("blurred")},_onFocus:function(){this.trigger("focused")},_onKeydown:function(t){var e=s[t.which||t.keyCode];this._managePreventDefault(e,t),e&&this._shouldTrigger(e,t)&&this.trigger(e+"Keyed",t)},_onInput:function(){this._checkInputValue()},_managePreventDefault:function(t,e){var n,r,i;switch(t){case"tab":r=this.getHint(),i=this.getInputValue(),n=r&&r!==i&&!o(e);break;case"up":case"down":n=!o(e);break;default:n=!1}n&&e.preventDefault()},_shouldTrigger:function(t,e){var n;switch(t){case"tab":n=!o(e);break;default:n=!0}return n},_checkInputValue:function(){var t,e,n;t=this.getInputValue(),e=i(t,this.query),n=e?this.query.length!==t.length:!1,this.query=t,e?n&&this.trigger("whitespaceChanged",this.query):this.trigger("queryChanged",this.query)},focus:function(){this.$input.focus()},blur:function(){this.$input.blur()},getQuery:function(){return this.query},setQuery:function(t){this.query=t},getInputValue:function(){return this.$input.val()},setInputValue:function(t,e){this.$input.val(t),e?this.clearHint():this._checkInputValue()},resetInputValue:function(){this.setInputValue(this.query,!0)},getHint:function(){return this.$hint.val()},setHint:function(t){this.$hint.val(t)},clearHint:function(){this.setHint("")},clearHintIfInvalid:function(){var t,e,n,r;t=this.getInputValue(),e=this.getHint(),n=t!==e&&0===e.indexOf(t),r=""!==t&&n&&!this.hasOverflow(),!r&&this.clearHint()},getLanguageDirection:function(){return(this.$input.css("direction")||"ltr").toLowerCase()},hasOverflow:function(){var t=this.$input.width()-2;return this.$overflowHelper.text(this.getInputValue()),this.$overflowHelper.width()>=t},isCursorAtEnd:function(){var t,n,r;return t=this.$input.val().length,n=this.$input[0].selectionStart,e.isNumber(n)?n===t:document.selection?(r=document.selection.createRange(),r.moveStart("character",-t),t===r.text.length):!0},destroy:function(){this.$hint.off(".tt"),this.$input.off(".tt"),this.$hint=this.$input=this.$overflowHelper=null}}),n}(),m=function(){"use strict";function n(n){n=n||{},n.templates=n.templates||{},n.source||t.error("missing source"),n.name&&!o(n.name)&&t.error("invalid dataset name: "+n.name),this.query=null,this.highlight=!!n.highlight,this.name=n.name||e.getUniqueId(),this.source=n.source,this.displayFn=r(n.display||n.displayKey),this.templates=i(n.templates,this.displayFn),this.$el=t(l.dataset.replace("%CLASS%",this.name))}function r(t){function n(e){return e[t]}return t=t||"value",e.isFunction(t)?t:n}function i(t,n){function r(t){return"<p>"+n(t)+"</p>"}return{empty:t.empty&&e.templatify(t.empty),header:t.header&&e.templatify(t.header),footer:t.footer&&e.templatify(t.footer),suggestion:t.suggestion||r}}function o(t){return/^[_a-zA-Z0-9-]+$/.test(t)}var s="ttDataset",a="ttValue",u="ttDatum";return n.extractDatasetName=function(e){return t(e).data(s)},n.extractValue=function(e){return t(e).data(a)},n.extractDatum=function(e){return t(e).data(u)},e.mixin(n.prototype,p,{_render:function(n,r){function i(){return m.templates.empty({query:n,isEmpty:!0})}function o(){function i(e){var n;return n=t(l.suggestion).append(m.templates.suggestion(e)).data(s,m.name).data(a,m.displayFn(e)).data(u,e),n.children().each(function(){t(this).css(c.suggestionChild)}),n}var o,h;return o=t(l.suggestions).css(c.suggestions),h=e.map(r,i),o.append.apply(o,h),m.highlight&&f({className:"tt-highlight",node:o[0],pattern:n}),o}function h(){return m.templates.header({query:n,isEmpty:!d})}function p(){return m.templates.footer({query:n,isEmpty:!d})}if(this.$el){var d,m=this;this.$el.empty(),d=r&&r.length,!d&&this.templates.empty?this.$el.html(i()).prepend(m.templates.header?h():null).append(m.templates.footer?p():null):d&&this.$el.html(o()).prepend(m.templates.header?h():null).append(m.templates.footer?p():null),this.trigger("rendered")}},getRoot:function(){return this.$el},update:function(t){function e(e){n.canceled||t!==n.query||n._render(t,e)}var n=this;this.query=t,this.canceled=!1,this.source(t,e)},cancel:function(){this.canceled=!0},clear:function(){this.cancel(),this.$el.empty(),this.trigger("rendered")},isEmpty:function(){return this.$el.is(":empty")},destroy:function(){this.$el=null}}),n}(),g=function(){"use strict";function n(n){var i,o,s,a=this;n=n||{},n.menu||t.error("menu is required"),this.isOpen=!1,this.isEmpty=!0,this.datasets=e.map(n.datasets,r),i=e.bind(this._onSuggestionClick,this),o=e.bind(this._onSuggestionMouseEnter,this),s=e.bind(this._onSuggestionMouseLeave,this),this.$menu=t(n.menu).on("click.tt",".tt-suggestion",i).on("mouseenter.tt",".tt-suggestion",o).on("mouseleave.tt",".tt-suggestion",s),e.each(this.datasets,function(t){a.$menu.append(t.getRoot()),t.onSync("rendered",a._onRendered,a)})}function r(t){return new m(t)}return e.mixin(n.prototype,p,{_onSuggestionClick:function(e){this.trigger("suggestionClicked",t(e.currentTarget))},_onSuggestionMouseEnter:function(e){this._removeCursor(),this._setCursor(t(e.currentTarget),!0)},_onSuggestionMouseLeave:function(){this._removeCursor()},_onRendered:function(){function t(t){return t.isEmpty()}this.isEmpty=e.every(this.datasets,t),this.isEmpty?this._hide():this.isOpen&&this._show(),this.trigger("datasetRendered")},_hide:function(){this.$menu.hide()},_show:function(){this.$menu.css("display","block")},_getSuggestions:function(){return this.$menu.find(".tt-suggestion")},_getCursor:function(){return this.$menu.find(".tt-cursor").first()},_setCursor:function(t,e){t.first().addClass("tt-cursor"),!e&&this.trigger("cursorMoved")},_removeCursor:function(){this._getCursor().removeClass("tt-cursor")},_moveCursor:function(t){var e,n,r,i;if(this.isOpen){if(n=this._getCursor(),e=this._getSuggestions(),this._removeCursor(),r=e.index(n)+t,r=(r+1)%(e.length+1)-1,-1===r)return void this.trigger("cursorRemoved");-1>r&&(r=e.length-1),this._setCursor(i=e.eq(r)),this._ensureVisible(i)}},_ensureVisible:function(t){var e,n,r,i;e=t.position().top,n=e+t.outerHeight(!0),r=this.$menu.scrollTop(),i=this.$menu.height()+parseInt(this.$menu.css("paddingTop"),10)+parseInt(this.$menu.css("paddingBottom"),10),0>e?this.$menu.scrollTop(r+e):n>i&&this.$menu.scrollTop(r+(n-i))},close:function(){this.isOpen&&(this.isOpen=!1,this._removeCursor(),this._hide(),this.trigger("closed"))},open:function(){this.isOpen||(this.isOpen=!0,!this.isEmpty&&this._show(),this.trigger("opened"))},setLanguageDirection:function(t){this.$menu.css("ltr"===t?c.ltr:c.rtl)},moveCursorUp:function(){this._moveCursor(-1)},moveCursorDown:function(){this._moveCursor(1)},getDatumForSuggestion:function(t){var e=null;return t.length&&(e={raw:m.extractDatum(t),value:m.extractValue(t),datasetName:m.extractDatasetName(t)}),e},getDatumForCursor:function(){return this.getDatumForSuggestion(this._getCursor().first())},getDatumForTopSuggestion:function(){return this.getDatumForSuggestion(this._getSuggestions().first())},update:function(t){function n(e){e.update(t)}e.each(this.datasets,n)},empty:function(){function t(t){t.clear()}e.each(this.datasets,t),this.isEmpty=!0},isVisible:function(){return this.isOpen&&!this.isEmpty},destroy:function(){function t(t){t.destroy()}this.$menu.off(".tt"),this.$menu=null,e.each(this.datasets,t)}}),n}(),y=function(){"use strict";function n(n){var i,o,s;n=n||{},n.input||t.error("missing input"),this.isActivated=!1,this.autoselect=!!n.autoselect,this.minLength=e.isNumber(n.minLength)?n.minLength:1,this.$node=r(n.input,n.withHint),i=this.$node.find(".tt-dropdown-menu"),o=this.$node.find(".tt-input"),s=this.$node.find(".tt-hint"),o.on("blur.tt",function(t){var n,r,s;n=document.activeElement,r=i.is(n),s=i.has(n).length>0,e.isMsie()&&(r||s)&&(t.preventDefault(),t.stopImmediatePropagation(),e.defer(function(){o.focus()}))}),i.on("mousedown.tt",function(t){t.preventDefault()}),this.eventBus=n.eventBus||new h({el:o}),this.dropdown=new g({menu:i,datasets:n.datasets}).onSync("suggestionClicked",this._onSuggestionClicked,this).onSync("cursorMoved",this._onCursorMoved,this).onSync("cursorRemoved",this._onCursorRemoved,this).onSync("opened",this._onOpened,this).onSync("closed",this._onClosed,this).onAsync("datasetRendered",this._onDatasetRendered,this),this.input=new d({input:o,hint:s}).onSync("focused",this._onFocused,this).onSync("blurred",this._onBlurred,this).onSync("enterKeyed",this._onEnterKeyed,this).onSync("tabKeyed",this._onTabKeyed,this).onSync("escKeyed",this._onEscKeyed,this).onSync("upKeyed",this._onUpKeyed,this).onSync("downKeyed",this._onDownKeyed,this).onSync("leftKeyed",this._onLeftKeyed,this).onSync("rightKeyed",this._onRightKeyed,this).onSync("queryChanged",this._onQueryChanged,this).onSync("whitespaceChanged",this._onWhitespaceChanged,this),
this._setLanguageDirection()}function r(e,n){var r,o,a,u;r=t(e),o=t(l.wrapper).css(c.wrapper),a=t(l.dropdown).css(c.dropdown),u=r.clone().css(c.hint).css(i(r)),u.val("").removeData().addClass("tt-hint").removeAttr("id name placeholder required").prop("readonly",!0).attr({autocomplete:"off",spellcheck:"false",tabindex:-1}),r.data(s,{dir:r.attr("dir"),autocomplete:r.attr("autocomplete"),spellcheck:r.attr("spellcheck"),style:r.attr("style")}),r.addClass("tt-input").attr({autocomplete:"off",spellcheck:!1}).css(n?c.input:c.inputWithNoHint);try{!r.attr("dir")&&r.attr("dir","auto")}catch(h){}return r.wrap(o).parent().prepend(n?u:null).append(a)}function i(t){return{backgroundAttachment:t.css("background-attachment"),backgroundClip:t.css("background-clip"),backgroundColor:t.css("background-color"),backgroundImage:t.css("background-image"),backgroundOrigin:t.css("background-origin"),backgroundPosition:t.css("background-position"),backgroundRepeat:t.css("background-repeat"),backgroundSize:t.css("background-size")}}function o(t){var n=t.find(".tt-input");e.each(n.data(s),function(t,r){e.isUndefined(t)?n.removeAttr(r):n.attr(r,t)}),n.detach().removeData(s).removeClass("tt-input").insertAfter(t),t.remove()}var s="ttAttrs";return e.mixin(n.prototype,{_onSuggestionClicked:function(t,e){var n;(n=this.dropdown.getDatumForSuggestion(e))&&this._select(n)},_onCursorMoved:function(){var t=this.dropdown.getDatumForCursor();this.input.setInputValue(t.value,!0),this.eventBus.trigger("cursorchanged",t.raw,t.datasetName)},_onCursorRemoved:function(){this.input.resetInputValue(),this._updateHint()},_onDatasetRendered:function(){this._updateHint()},_onOpened:function(){this._updateHint(),this.eventBus.trigger("opened")},_onClosed:function(){this.input.clearHint(),this.eventBus.trigger("closed")},_onFocused:function(){this.isActivated=!0,this.dropdown.open()},_onBlurred:function(){this.isActivated=!1,this.dropdown.empty(),this.dropdown.close()},_onEnterKeyed:function(t,e){var n,r;n=this.dropdown.getDatumForCursor(),r=this.dropdown.getDatumForTopSuggestion(),n?(this._select(n),e.preventDefault()):this.autoselect&&r&&(this._select(r),e.preventDefault())},_onTabKeyed:function(t,e){var n;(n=this.dropdown.getDatumForCursor())?(this._select(n),e.preventDefault()):this._autocomplete(!0)},_onEscKeyed:function(){this.dropdown.close(),this.input.resetInputValue()},_onUpKeyed:function(){var t=this.input.getQuery();this.dropdown.isEmpty&&t.length>=this.minLength?this.dropdown.update(t):this.dropdown.moveCursorUp(),this.dropdown.open()},_onDownKeyed:function(){var t=this.input.getQuery();this.dropdown.isEmpty&&t.length>=this.minLength?this.dropdown.update(t):this.dropdown.moveCursorDown(),this.dropdown.open()},_onLeftKeyed:function(){"rtl"===this.dir&&this._autocomplete()},_onRightKeyed:function(){"ltr"===this.dir&&this._autocomplete()},_onQueryChanged:function(t,e){this.input.clearHintIfInvalid(),e.length>=this.minLength?this.dropdown.update(e):this.dropdown.empty(),this.dropdown.open(),this._setLanguageDirection()},_onWhitespaceChanged:function(){this._updateHint(),this.dropdown.open()},_setLanguageDirection:function(){var t;this.dir!==(t=this.input.getLanguageDirection())&&(this.dir=t,this.$node.css("direction",t),this.dropdown.setLanguageDirection(t))},_updateHint:function(){var t,n,r,i,o,s;t=this.dropdown.getDatumForTopSuggestion(),t&&this.dropdown.isVisible()&&!this.input.hasOverflow()?(n=this.input.getInputValue(),r=d.normalizeQuery(n),i=e.escapeRegExChars(r),o=new RegExp("^(?:"+i+")(.+$)","i"),s=o.exec(t.value),s?this.input.setHint(n+s[1]):this.input.clearHint()):this.input.clearHint()},_autocomplete:function(t){var e,n,r,i;e=this.input.getHint(),n=this.input.getQuery(),r=t||this.input.isCursorAtEnd(),e&&n!==e&&r&&(i=this.dropdown.getDatumForTopSuggestion(),i&&this.input.setInputValue(i.value),this.eventBus.trigger("autocompleted",i.raw,i.datasetName))},_select:function(t){this.input.setQuery(t.value),this.input.setInputValue(t.value,!0),this._setLanguageDirection(),this.eventBus.trigger("selected",t.raw,t.datasetName),this.dropdown.close(),e.defer(e.bind(this.dropdown.empty,this.dropdown))},open:function(){this.dropdown.open()},close:function(){this.dropdown.close()},setVal:function(t){t=e.toStr(t),this.isActivated?this.input.setInputValue(t):(this.input.setQuery(t),this.input.setInputValue(t,!0)),this._setLanguageDirection()},getVal:function(){return this.input.getQuery()},destroy:function(){this.input.destroy(),this.dropdown.destroy(),o(this.$node),this.$node=null}}),n}();!function(){"use strict";var n,r,i;n=t.fn.typeahead,r="ttTypeahead",i={initialize:function(n,i){function o(){var o,s,a=t(this);e.each(i,function(t){t.highlight=!!n.highlight}),s=new y({input:a,eventBus:o=new h({el:a}),withHint:e.isUndefined(n.hint)?!0:!!n.hint,minLength:n.minLength,autoselect:n.autoselect,datasets:i}),a.data(r,s)}return i=e.isArray(i)?i:[].slice.call(arguments,1),n=n||{},this.each(o)},open:function(){function e(){var e,n=t(this);(e=n.data(r))&&e.open()}return this.each(e)},close:function(){function e(){var e,n=t(this);(e=n.data(r))&&e.close()}return this.each(e)},val:function(e){function n(){var n,i=t(this);(n=i.data(r))&&n.setVal(e)}function i(t){var e,n;return(e=t.data(r))&&(n=e.getVal()),n}return arguments.length?this.each(n):i(this.first())},destroy:function(){function e(){var e,n=t(this);(e=n.data(r))&&(e.destroy(),n.removeData(r))}return this.each(e)}},t.fn.typeahead=function(e){var n;return i[e]&&"initialize"!==e?(n=this.filter(function(){return!!t(this).data(r)}),i[e].apply(n,[].slice.call(arguments,1))):i.initialize.apply(this,arguments)},t.fn.typeahead.noConflict=function(){return t.fn.typeahead=n,this}}()}(window.jQuery)},{}],308:[function(t,e,n){(function(){function t(t){function e(e,n,r,i,o,s){for(;o>=0&&s>o;o+=t){var a=i?i[o]:o;r=n(r,e[a],a,e)}return r}return function(n,r,i,o){r=w(r,o,4);var s=!k(n)&&_.keys(n),a=(s||n).length,u=t>0?0:a-1;return arguments.length<3&&(i=n[s?s[u]:u],u+=t),e(n,r,i,s,u,a)}}function r(t){return function(e,n,r){n=x(n,r);for(var i=N(e),o=t>0?0:i-1;o>=0&&i>o;o+=t)if(n(e[o],o,e))return o;return-1}}function i(t,e,n){return function(r,i,o){var s=0,a=N(r);if("number"==typeof o)t>0?s=o>=0?o:Math.max(o+a,s):a=o>=0?Math.min(o+1,a):o+a+1;else if(n&&o&&a)return o=n(r,i),r[o]===i?o:-1;if(i!==i)return o=e(p.call(r,s,a),_.isNaN),o>=0?o+s:-1;for(o=t>0?s:a-1;o>=0&&a>o;o+=t)if(r[o]===i)return o;return-1}}function o(t,e){var n=R.length,r=t.constructor,i=_.isFunction(r)&&r.prototype||l,o="constructor";for(_.has(t,o)&&!_.contains(e,o)&&e.push(o);n--;)o=R[n],o in t&&t[o]!==i[o]&&!_.contains(e,o)&&e.push(o)}var s=this,a=s._,u=Array.prototype,l=Object.prototype,c=Function.prototype,h=u.push,p=u.slice,f=l.toString,d=l.hasOwnProperty,m=Array.isArray,g=Object.keys,y=c.bind,v=Object.create,b=function(){},_=function(t){return t instanceof _?t:this instanceof _?void(this._wrapped=t):new _(t)};"undefined"!=typeof n?("undefined"!=typeof e&&e.exports&&(n=e.exports=_),n._=_):s._=_,_.VERSION="1.8.3";var w=function(t,e,n){if(void 0===e)return t;switch(null==n?3:n){case 1:return function(n){return t.call(e,n)};case 2:return function(n,r){return t.call(e,n,r)};case 3:return function(n,r,i){return t.call(e,n,r,i)};case 4:return function(n,r,i,o){return t.call(e,n,r,i,o)}}return function(){return t.apply(e,arguments)}},x=function(t,e,n){return null==t?_.identity:_.isFunction(t)?w(t,e,n):_.isObject(t)?_.matcher(t):_.property(t)};_.iteratee=function(t,e){return x(t,e,1/0)};var C=function(t,e){return function(n){var r=arguments.length;if(2>r||null==n)return n;for(var i=1;r>i;i++)for(var o=arguments[i],s=t(o),a=s.length,u=0;a>u;u++){var l=s[u];e&&void 0!==n[l]||(n[l]=o[l])}return n}},T=function(t){if(!_.isObject(t))return{};if(v)return v(t);b.prototype=t;var e=new b;return b.prototype=null,e},S=function(t){return function(e){return null==e?void 0:e[t]}},E=Math.pow(2,53)-1,N=S("length"),k=function(t){var e=N(t);return"number"==typeof e&&e>=0&&E>=e};_.each=_.forEach=function(t,e,n){e=w(e,n);var r,i;if(k(t))for(r=0,i=t.length;i>r;r++)e(t[r],r,t);else{var o=_.keys(t);for(r=0,i=o.length;i>r;r++)e(t[o[r]],o[r],t)}return t},_.map=_.collect=function(t,e,n){e=x(e,n);for(var r=!k(t)&&_.keys(t),i=(r||t).length,o=Array(i),s=0;i>s;s++){var a=r?r[s]:s;o[s]=e(t[a],a,t)}return o},_.reduce=_.foldl=_.inject=t(1),_.reduceRight=_.foldr=t(-1),_.find=_.detect=function(t,e,n){var r;return r=k(t)?_.findIndex(t,e,n):_.findKey(t,e,n),void 0!==r&&-1!==r?t[r]:void 0},_.filter=_.select=function(t,e,n){var r=[];return e=x(e,n),_.each(t,function(t,n,i){e(t,n,i)&&r.push(t)}),r},_.reject=function(t,e,n){return _.filter(t,_.negate(x(e)),n)},_.every=_.all=function(t,e,n){e=x(e,n);for(var r=!k(t)&&_.keys(t),i=(r||t).length,o=0;i>o;o++){var s=r?r[o]:o;if(!e(t[s],s,t))return!1}return!0},_.some=_.any=function(t,e,n){e=x(e,n);for(var r=!k(t)&&_.keys(t),i=(r||t).length,o=0;i>o;o++){var s=r?r[o]:o;if(e(t[s],s,t))return!0}return!1},_.contains=_.includes=_.include=function(t,e,n,r){return k(t)||(t=_.values(t)),("number"!=typeof n||r)&&(n=0),_.indexOf(t,e,n)>=0},_.invoke=function(t,e){var n=p.call(arguments,2),r=_.isFunction(e);return _.map(t,function(t){var i=r?e:t[e];return null==i?i:i.apply(t,n)})},_.pluck=function(t,e){return _.map(t,_.property(e))},_.where=function(t,e){return _.filter(t,_.matcher(e))},_.findWhere=function(t,e){return _.find(t,_.matcher(e))},_.max=function(t,e,n){var r,i,o=-(1/0),s=-(1/0);if(null==e&&null!=t){t=k(t)?t:_.values(t);for(var a=0,u=t.length;u>a;a++)r=t[a],r>o&&(o=r)}else e=x(e,n),_.each(t,function(t,n,r){i=e(t,n,r),(i>s||i===-(1/0)&&o===-(1/0))&&(o=t,s=i)});return o},_.min=function(t,e,n){var r,i,o=1/0,s=1/0;if(null==e&&null!=t){t=k(t)?t:_.values(t);for(var a=0,u=t.length;u>a;a++)r=t[a],o>r&&(o=r)}else e=x(e,n),_.each(t,function(t,n,r){i=e(t,n,r),(s>i||i===1/0&&o===1/0)&&(o=t,s=i)});return o},_.shuffle=function(t){for(var e,n=k(t)?t:_.values(t),r=n.length,i=Array(r),o=0;r>o;o++)e=_.random(0,o),e!==o&&(i[o]=i[e]),i[e]=n[o];return i},_.sample=function(t,e,n){return null==e||n?(k(t)||(t=_.values(t)),t[_.random(t.length-1)]):_.shuffle(t).slice(0,Math.max(0,e))},_.sortBy=function(t,e,n){return e=x(e,n),_.pluck(_.map(t,function(t,n,r){return{value:t,index:n,criteria:e(t,n,r)}}).sort(function(t,e){var n=t.criteria,r=e.criteria;if(n!==r){if(n>r||void 0===n)return 1;if(r>n||void 0===r)return-1}return t.index-e.index}),"value")};var M=function(t){return function(e,n,r){var i={};return n=x(n,r),_.each(e,function(r,o){var s=n(r,o,e);t(i,r,s)}),i}};_.groupBy=M(function(t,e,n){_.has(t,n)?t[n].push(e):t[n]=[e]}),_.indexBy=M(function(t,e,n){t[n]=e}),_.countBy=M(function(t,e,n){_.has(t,n)?t[n]++:t[n]=1}),_.toArray=function(t){return t?_.isArray(t)?p.call(t):k(t)?_.map(t,_.identity):_.values(t):[]},_.size=function(t){return null==t?0:k(t)?t.length:_.keys(t).length},_.partition=function(t,e,n){e=x(e,n);var r=[],i=[];return _.each(t,function(t,n,o){(e(t,n,o)?r:i).push(t)}),[r,i]},_.first=_.head=_.take=function(t,e,n){return null==t?void 0:null==e||n?t[0]:_.initial(t,t.length-e)},_.initial=function(t,e,n){return p.call(t,0,Math.max(0,t.length-(null==e||n?1:e)))},_.last=function(t,e,n){return null==t?void 0:null==e||n?t[t.length-1]:_.rest(t,Math.max(0,t.length-e))},_.rest=_.tail=_.drop=function(t,e,n){return p.call(t,null==e||n?1:e)},_.compact=function(t){return _.filter(t,_.identity)};var P=function(t,e,n,r){for(var i=[],o=0,s=r||0,a=N(t);a>s;s++){var u=t[s];if(k(u)&&(_.isArray(u)||_.isArguments(u))){e||(u=P(u,e,n));var l=0,c=u.length;for(i.length+=c;c>l;)i[o++]=u[l++]}else n||(i[o++]=u)}return i};_.flatten=function(t,e){return P(t,e,!1)},_.without=function(t){return _.difference(t,p.call(arguments,1))},_.uniq=_.unique=function(t,e,n,r){_.isBoolean(e)||(r=n,n=e,e=!1),null!=n&&(n=x(n,r));for(var i=[],o=[],s=0,a=N(t);a>s;s++){var u=t[s],l=n?n(u,s,t):u;e?(s&&o===l||i.push(u),o=l):n?_.contains(o,l)||(o.push(l),i.push(u)):_.contains(i,u)||i.push(u)}return i},_.union=function(){return _.uniq(P(arguments,!0,!0))},_.intersection=function(t){for(var e=[],n=arguments.length,r=0,i=N(t);i>r;r++){var o=t[r];if(!_.contains(e,o)){for(var s=1;n>s&&_.contains(arguments[s],o);s++);s===n&&e.push(o)}}return e},_.difference=function(t){var e=P(arguments,!0,!0,1);return _.filter(t,function(t){return!_.contains(e,t)})},_.zip=function(){return _.unzip(arguments)},_.unzip=function(t){for(var e=t&&_.max(t,N).length||0,n=Array(e),r=0;e>r;r++)n[r]=_.pluck(t,r);return n},_.object=function(t,e){for(var n={},r=0,i=N(t);i>r;r++)e?n[t[r]]=e[r]:n[t[r][0]]=t[r][1];return n},_.findIndex=r(1),_.findLastIndex=r(-1),_.sortedIndex=function(t,e,n,r){n=x(n,r,1);for(var i=n(e),o=0,s=N(t);s>o;){var a=Math.floor((o+s)/2);n(t[a])<i?o=a+1:s=a}return o},_.indexOf=i(1,_.findIndex,_.sortedIndex),_.lastIndexOf=i(-1,_.findLastIndex),_.range=function(t,e,n){null==e&&(e=t||0,t=0),n=n||1;for(var r=Math.max(Math.ceil((e-t)/n),0),i=Array(r),o=0;r>o;o++,t+=n)i[o]=t;return i};var O=function(t,e,n,r,i){if(!(r instanceof e))return t.apply(n,i);var o=T(t.prototype),s=t.apply(o,i);return _.isObject(s)?s:o};_.bind=function(t,e){if(y&&t.bind===y)return y.apply(t,p.call(arguments,1));if(!_.isFunction(t))throw new TypeError("Bind must be called on a function");var n=p.call(arguments,2),r=function(){return O(t,r,e,this,n.concat(p.call(arguments)))};return r},_.partial=function(t){var e=p.call(arguments,1),n=function(){for(var r=0,i=e.length,o=Array(i),s=0;i>s;s++)o[s]=e[s]===_?arguments[r++]:e[s];for(;r<arguments.length;)o.push(arguments[r++]);return O(t,n,this,this,o)};return n},_.bindAll=function(t){var e,n,r=arguments.length;if(1>=r)throw new Error("bindAll must be passed function names");for(e=1;r>e;e++)n=arguments[e],t[n]=_.bind(t[n],t);return t},_.memoize=function(t,e){var n=function(r){var i=n.cache,o=""+(e?e.apply(this,arguments):r);return _.has(i,o)||(i[o]=t.apply(this,arguments)),i[o]};return n.cache={},n},_.delay=function(t,e){var n=p.call(arguments,2);return setTimeout(function(){return t.apply(null,n)},e)},_.defer=_.partial(_.delay,_,1),_.throttle=function(t,e,n){var r,i,o,s=null,a=0;n||(n={});var u=function(){a=n.leading===!1?0:_.now(),s=null,o=t.apply(r,i),s||(r=i=null)};return function(){var l=_.now();a||n.leading!==!1||(a=l);var c=e-(l-a);return r=this,i=arguments,0>=c||c>e?(s&&(clearTimeout(s),s=null),a=l,o=t.apply(r,i),s||(r=i=null)):s||n.trailing===!1||(s=setTimeout(u,c)),o}},_.debounce=function(t,e,n){var r,i,o,s,a,u=function(){var l=_.now()-s;e>l&&l>=0?r=setTimeout(u,e-l):(r=null,n||(a=t.apply(o,i),r||(o=i=null)))};return function(){o=this,i=arguments,s=_.now();var l=n&&!r;return r||(r=setTimeout(u,e)),l&&(a=t.apply(o,i),o=i=null),a}},_.wrap=function(t,e){return _.partial(e,t)},_.negate=function(t){return function(){return!t.apply(this,arguments)}},_.compose=function(){var t=arguments,e=t.length-1;return function(){for(var n=e,r=t[e].apply(this,arguments);n--;)r=t[n].call(this,r);return r}},_.after=function(t,e){return function(){return--t<1?e.apply(this,arguments):void 0}},_.before=function(t,e){var n;return function(){return--t>0&&(n=e.apply(this,arguments)),1>=t&&(e=null),n}},_.once=_.partial(_.before,2);var A=!{toString:null}.propertyIsEnumerable("toString"),R=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"];_.keys=function(t){if(!_.isObject(t))return[];if(g)return g(t);var e=[];for(var n in t)_.has(t,n)&&e.push(n);return A&&o(t,e),e},_.allKeys=function(t){if(!_.isObject(t))return[];var e=[];for(var n in t)e.push(n);return A&&o(t,e),e},_.values=function(t){for(var e=_.keys(t),n=e.length,r=Array(n),i=0;n>i;i++)r[i]=t[e[i]];return r},_.mapObject=function(t,e,n){e=x(e,n);for(var r,i=_.keys(t),o=i.length,s={},a=0;o>a;a++)r=i[a],s[r]=e(t[r],r,t);return s},_.pairs=function(t){for(var e=_.keys(t),n=e.length,r=Array(n),i=0;n>i;i++)r[i]=[e[i],t[e[i]]];return r},_.invert=function(t){for(var e={},n=_.keys(t),r=0,i=n.length;i>r;r++)e[t[n[r]]]=n[r];return e},_.functions=_.methods=function(t){var e=[];for(var n in t)_.isFunction(t[n])&&e.push(n);return e.sort()},_.extend=C(_.allKeys),_.extendOwn=_.assign=C(_.keys),_.findKey=function(t,e,n){e=x(e,n);for(var r,i=_.keys(t),o=0,s=i.length;s>o;o++)if(r=i[o],e(t[r],r,t))return r},_.pick=function(t,e,n){var r,i,o={},s=t;if(null==s)return o;_.isFunction(e)?(i=_.allKeys(s),r=w(e,n)):(i=P(arguments,!1,!1,1),r=function(t,e,n){return e in n},s=Object(s));for(var a=0,u=i.length;u>a;a++){var l=i[a],c=s[l];r(c,l,s)&&(o[l]=c)}return o},_.omit=function(t,e,n){if(_.isFunction(e))e=_.negate(e);else{var r=_.map(P(arguments,!1,!1,1),String);e=function(t,e){return!_.contains(r,e)}}return _.pick(t,e,n)},_.defaults=C(_.allKeys,!0),_.create=function(t,e){var n=T(t);return e&&_.extendOwn(n,e),n},_.clone=function(t){return _.isObject(t)?_.isArray(t)?t.slice():_.extend({},t):t},_.tap=function(t,e){return e(t),t},_.isMatch=function(t,e){var n=_.keys(e),r=n.length;if(null==t)return!r;for(var i=Object(t),o=0;r>o;o++){var s=n[o];if(e[s]!==i[s]||!(s in i))return!1}return!0};var I=function(t,e,n,r){if(t===e)return 0!==t||1/t===1/e;if(null==t||null==e)return t===e;t instanceof _&&(t=t._wrapped),e instanceof _&&(e=e._wrapped);var i=f.call(t);if(i!==f.call(e))return!1;switch(i){case"[object RegExp]":case"[object String]":return""+t==""+e;case"[object Number]":return+t!==+t?+e!==+e:0===+t?1/+t===1/e:+t===+e;case"[object Date]":case"[object Boolean]":return+t===+e}var o="[object Array]"===i;if(!o){if("object"!=typeof t||"object"!=typeof e)return!1;var s=t.constructor,a=e.constructor;if(s!==a&&!(_.isFunction(s)&&s instanceof s&&_.isFunction(a)&&a instanceof a)&&"constructor"in t&&"constructor"in e)return!1}n=n||[],r=r||[];for(var u=n.length;u--;)if(n[u]===t)return r[u]===e;if(n.push(t),r.push(e),o){if(u=t.length,u!==e.length)return!1;for(;u--;)if(!I(t[u],e[u],n,r))return!1}else{var l,c=_.keys(t);if(u=c.length,_.keys(e).length!==u)return!1;for(;u--;)if(l=c[u],!_.has(e,l)||!I(t[l],e[l],n,r))return!1}return n.pop(),r.pop(),!0};_.isEqual=function(t,e){return I(t,e)},_.isEmpty=function(t){return null==t?!0:k(t)&&(_.isArray(t)||_.isString(t)||_.isArguments(t))?0===t.length:0===_.keys(t).length},_.isElement=function(t){return!(!t||1!==t.nodeType)},_.isArray=m||function(t){return"[object Array]"===f.call(t)},_.isObject=function(t){var e=typeof t;return"function"===e||"object"===e&&!!t},_.each(["Arguments","Function","String","Number","Date","RegExp","Error"],function(t){_["is"+t]=function(e){return f.call(e)==="[object "+t+"]"}}),_.isArguments(arguments)||(_.isArguments=function(t){return _.has(t,"callee")}),"function"!=typeof/./&&"object"!=typeof Int8Array&&(_.isFunction=function(t){return"function"==typeof t||!1}),_.isFinite=function(t){return isFinite(t)&&!isNaN(parseFloat(t))},_.isNaN=function(t){return _.isNumber(t)&&t!==+t},_.isBoolean=function(t){return t===!0||t===!1||"[object Boolean]"===f.call(t)},_.isNull=function(t){return null===t},_.isUndefined=function(t){return void 0===t},_.has=function(t,e){return null!=t&&d.call(t,e)},_.noConflict=function(){return s._=a,this},_.identity=function(t){return t},_.constant=function(t){return function(){return t}},_.noop=function(){},_.property=S,_.propertyOf=function(t){return null==t?function(){}:function(e){return t[e]}},_.matcher=_.matches=function(t){return t=_.extendOwn({},t),function(e){return _.isMatch(e,t)}},_.times=function(t,e,n){var r=Array(Math.max(0,t));e=w(e,n,1);for(var i=0;t>i;i++)r[i]=e(i);return r},_.random=function(t,e){return null==e&&(e=t,t=0),t+Math.floor(Math.random()*(e-t+1))},_.now=Date.now||function(){return(new Date).getTime()};var D={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},L=_.invert(D),q=function(t){var e=function(e){return t[e]},n="(?:"+_.keys(t).join("|")+")",r=RegExp(n),i=RegExp(n,"g");return function(t){return t=null==t?"":""+t,r.test(t)?t.replace(i,e):t}};_.escape=q(D),_.unescape=q(L),_.result=function(t,e,n){var r=null==t?void 0:t[e];return void 0===r&&(r=n),_.isFunction(r)?r.call(t):r};var j=0;_.uniqueId=function(t){var e=++j+"";return t?t+e:e},_.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var $=/(.)^/,F={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},z=/\\|'|\r|\n|\u2028|\u2029/g,U=function(t){return"\\"+F[t]};_.template=function(t,e,n){!e&&n&&(e=n),e=_.defaults({},e,_.templateSettings);var r=RegExp([(e.escape||$).source,(e.interpolate||$).source,(e.evaluate||$).source].join("|")+"|$","g"),i=0,o="__p+='";t.replace(r,function(e,n,r,s,a){return o+=t.slice(i,a).replace(z,U),i=a+e.length,n?o+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'":r?o+="'+\n((__t=("+r+"))==null?'':__t)+\n'":s&&(o+="';\n"+s+"\n__p+='"),e}),o+="';\n",e.variable||(o="with(obj||{}){\n"+o+"}\n"),o="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+o+"return __p;\n";try{var s=new Function(e.variable||"obj","_",o)}catch(a){throw a.source=o,a}var u=function(t){return s.call(this,t,_)},l=e.variable||"obj";return u.source="function("+l+"){\n"+o+"}",u},_.chain=function(t){var e=_(t);return e._chain=!0,e};var H=function(t,e){return t._chain?_(e).chain():e};_.mixin=function(t){_.each(_.functions(t),function(e){var n=_[e]=t[e];_.prototype[e]=function(){var t=[this._wrapped];return h.apply(t,arguments),H(this,n.apply(_,t))}})},_.mixin(_),_.each(["pop","push","reverse","shift","sort","splice","unshift"],function(t){var e=u[t];_.prototype[t]=function(){var n=this._wrapped;return e.apply(n,arguments),"shift"!==t&&"splice"!==t||0!==n.length||delete n[0],H(this,n)}}),_.each(["concat","join","slice"],function(t){var e=u[t];_.prototype[t]=function(){return H(this,e.apply(this._wrapped,arguments))}}),_.prototype.value=function(){return this._wrapped},_.prototype.valueOf=_.prototype.toJSON=_.prototype.value,_.prototype.toString=function(){return""+this._wrapped},"function"==typeof define&&define.amd&&define("underscore",[],function(){return _})}).call(this)},{}],309:[function(t,e,n){e.exports=t(305)},{}],310:[function(t,e,n){e.exports=t(308)},{}]},{},[1]);